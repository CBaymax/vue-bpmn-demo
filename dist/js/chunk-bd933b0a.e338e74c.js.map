{"version":3,"sources":["webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ListenerDetailProps.js","webpack:///./node_modules/lodash/_getRawTag.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/CallActivityProps.js","webpack:///./node_modules/lodash/_baseKeys.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/index.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ConnectorInputOutputProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ConnectorDetailProps.js","webpack:///./node_modules/lodash/_isFlattenable.js","webpack:///./node_modules/lodash/stubFalse.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Properties.js","webpack:///./node_modules/lodash/_arrayPush.js","webpack:///./node_modules/lodash/_isStrictComparable.js","webpack:///./node_modules/lodash/_strictIndexOf.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/CreateHelper.js","webpack:///./node_modules/lodash/_getNative.js","webpack:///./node_modules/lodash/isBuffer.js","webpack:///./node_modules/core-js/internals/native-url.js","webpack:///./node_modules/lodash/_baseRest.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/EventProps.js","webpack:///./node_modules/lodash/_getFuncName.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/ElementHelper.js","webpack:///./node_modules/bpmnlint/rules/conditional-flows.js","webpack:///./node_modules/lodash/_createCtor.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/HistoryTimeToLiveProps.js","webpack:///./node_modules/lodash/_isKeyable.js","webpack:///./node_modules/lodash/_castFunction.js","webpack:///./node_modules/lodash/isObjectLike.js","webpack:///./node_modules/lodash/_isMasked.js","webpack:///./node_modules/lodash/isEmpty.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/util/ModelingUtil.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/CandidateStarter.js","webpack:///./node_modules/lodash/_baseMatchesProperty.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/LinkEntryFactory.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Callable.js","webpack:///./node_modules/lodash/_stringToPath.js","webpack:///./node_modules/lodash/isObject.js","webpack:///./node_modules/lodash/_equalByTag.js","webpack:///./node_modules/bpmn-js-properties-panel/index.js","webpack:///./node_modules/lodash/_Promise.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/CreateBusinessObjectListHandler.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/TimerEventDefinition.js","webpack:///./node_modules/lodash/_hashDelete.js","webpack:///./node_modules/lodash/_mapCacheSet.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/External.js","webpack:///./node_modules/lodash/_matchesStrictComparable.js","webpack:///./node_modules/lodash/_overRest.js","webpack:///./node_modules/lodash/_memoizeCapped.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/CustomElementsPropertiesActivator.js","webpack:///./node_modules/lodash/_baseForOwn.js","webpack:///./node_modules/lodash/_baseAggregator.js","webpack:///./node_modules/lodash/_Uint8Array.js","webpack:///./node_modules/lodash/_mapCacheGet.js","webpack:///./node_modules/lodash/_hashSet.js","webpack:///./node_modules/lodash/_baseIsArguments.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ListenerFieldInjectionProps.js","webpack:///./node_modules/lodash/_realNames.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/NameProps.js","webpack:///./node_modules/lodash/_baseValues.js","webpack:///./node_modules/lodash/bind.js","webpack:///./node_modules/lodash/_baseHasIn.js","webpack:///./node_modules/lodash/find.js","webpack:///./node_modules/lodash/_getData.js","webpack:///./node_modules/lodash/_listCacheClear.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/Name.js","webpack:///./node_modules/lodash/_objectToString.js","webpack:///./node_modules/lodash/wrapperLodash.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/ElementTemplates.js","webpack:///./node_modules/bpmnlint/lib/linter.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/CmdHelper.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/ExtensionElementsHelper.js","webpack:///./node_modules/lodash/_baseFindIndex.js","webpack:///./node_modules/core-js/modules/web.url.js","webpack:///./node_modules/lodash/_root.js","webpack:///./node_modules/lodash/_baseUniq.js","webpack:///./node_modules/lodash/_arrayFilter.js","webpack:///./node_modules/lodash/_getPrototype.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/UserTaskProps.js","webpack:///./node_modules/lodash/_baseDifference.js","webpack:///./node_modules/lodash/_createAssigner.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ListenerProps.js","webpack:///./node_modules/lodash/_stackDelete.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/IdProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/Utils.js","webpack:///./node_modules/lodash/_composeArgsRight.js","webpack:///./node_modules/lodash/isArrayLike.js","webpack:///./node_modules/bpmnlint/rules/single-event-definition.js","webpack:///./node_modules/lodash/_assignValue.js","webpack:///./node_modules/lodash/_getSymbols.js","webpack:///./node_modules/lodash/_baseIsNative.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/Validator.js","webpack:///./node_modules/lodash/_getValue.js","webpack:///./node_modules/lodash/_baseGetTag.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/InputOutput.js","webpack:///./node_modules/lodash/_isLaziable.js","webpack:///./node_modules/bpmnlint/rules/end-event-required.js","webpack:///./node_modules/lodash/_WeakMap.js","webpack:///./node_modules/lodash/_defineProperty.js","webpack:///./node_modules/lodash/_getMatchData.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/HistoryTimeToLive.js","webpack:///./node_modules/core-js/modules/es.string.iterator.js","webpack:///./node_modules/lodash/values.js","webpack:///./node_modules/lodash/now.js","webpack:///./node_modules/bpmnlint/rules/sub-process-blank-start-event.js","webpack:///./node_modules/lodash/keyBy.js","webpack:///./node_modules/lodash/xor.js","webpack:///./node_modules/lodash/_getMapData.js","webpack:///./node_modules/lodash/_arraySome.js","webpack:///./node_modules/lodash/_getTag.js","webpack:///./node_modules/lodash/_copyArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ServiceTaskDelegateProps.js","webpack:///./node_modules/lodash/_baseLodash.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/parts/ChooserProps.js","webpack:///./node_modules/lodash/_createCurry.js","webpack:///./node_modules/lodash/_baseIndexOf.js","webpack:///./node_modules/lodash/_baseEach.js","webpack:///./src/views/Editor.vue?1e56","webpack:///./node_modules/bpmn-js/lib/BaseModeler.js","webpack:///./node_modules/diagram-js/lib/features/touch/TouchInteractionEvents.js","webpack:///./node_modules/diagram-js/lib/features/touch/TouchFix.js","webpack:///./node_modules/diagram-js/lib/features/touch/index.js","webpack:///./node_modules/diagram-js/lib/navigation/touch/index.js","webpack:///./node_modules/diagram-js/lib/features/align-elements/AlignElements.js","webpack:///./node_modules/diagram-js/lib/features/align-elements/index.js","webpack:///./node_modules/bpmn-js/lib/features/auto-place/AutoPlaceUtil.js","webpack:///./node_modules/bpmn-js/lib/features/auto-place/AutoPlace.js","webpack:///./node_modules/bpmn-js/lib/features/auto-place/AutoPlaceSelectionBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/auto-place/index.js","webpack:///./node_modules/diagram-js/lib/command/CommandInterceptor.js","webpack:///./node_modules/diagram-js/lib/features/auto-resize/AutoResize.js","webpack:///./node_modules/bpmn-js/lib/features/auto-resize/BpmnAutoResize.js","webpack:///./node_modules/diagram-js/lib/features/rules/RuleProvider.js","webpack:///./node_modules/diagram-js/lib/features/auto-resize/AutoResizeProvider.js","webpack:///./node_modules/bpmn-js/lib/features/auto-resize/BpmnAutoResizeProvider.js","webpack:///./node_modules/bpmn-js/lib/features/auto-resize/index.js","webpack:///./node_modules/diagram-js/lib/features/dragging/Dragging.js","webpack:///./node_modules/diagram-js/lib/features/dragging/HoverFix.js","webpack:///./node_modules/diagram-js/lib/features/dragging/index.js","webpack:///./node_modules/diagram-js/lib/features/auto-scroll/AutoScroll.js","webpack:///./node_modules/diagram-js/lib/features/auto-scroll/index.js","webpack:///./node_modules/diagram-js/lib/features/rules/Rules.js","webpack:///./node_modules/diagram-js/lib/features/rules/index.js","webpack:///./node_modules/diagram-js/lib/util/LineIntersection.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/BendpointUtil.js","webpack:///./node_modules/diagram-js/lib/util/EscapeUtil.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/Bendpoints.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/BendpointMove.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/BendpointMovePreview.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/ConnectionSegmentMove.js","webpack:///./node_modules/diagram-js/lib/features/snapping/SnapUtil.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/BendpointSnapping.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/index.js","webpack:///./node_modules/diagram-js/lib/features/connect/Connect.js","webpack:///./node_modules/diagram-js/lib/features/connect/ConnectPreview.js","webpack:///./node_modules/diagram-js/lib/features/connect/index.js","webpack:///./node_modules/diagram-js/lib/features/connection-preview/ConnectionPreview.js","webpack:///./node_modules/diagram-js/lib/features/connection-preview/index.js","webpack:///./node_modules/diagram-js-direct-editing/lib/TextBox.js","webpack:///./node_modules/diagram-js-direct-editing/lib/DirectEditing.js","webpack:///./node_modules/diagram-js-direct-editing/index.js","webpack:///./node_modules/diagram-js/lib/features/context-pad/ContextPad.js","webpack:///./node_modules/diagram-js/lib/features/context-pad/index.js","webpack:///./node_modules/diagram-js/lib/features/preview-support/PreviewSupport.js","webpack:///./node_modules/diagram-js/lib/features/preview-support/index.js","webpack:///./node_modules/diagram-js/lib/features/create/Create.js","webpack:///./node_modules/diagram-js/lib/features/create/CreatePreview.js","webpack:///./node_modules/diagram-js/lib/features/create/index.js","webpack:///./node_modules/diagram-js/lib/features/popup-menu/PopupMenu.js","webpack:///./node_modules/diagram-js/lib/features/popup-menu/index.js","webpack:///./node_modules/diagram-js/lib/features/clipboard/Clipboard.js","webpack:///./node_modules/diagram-js/lib/features/clipboard/index.js","webpack:///./node_modules/diagram-js/lib/features/mouse/Mouse.js","webpack:///./node_modules/diagram-js/lib/features/mouse/index.js","webpack:///./node_modules/diagram-js/lib/features/copy-paste/CopyPaste.js","webpack:///./node_modules/diagram-js/lib/features/copy-paste/index.js","webpack:///./node_modules/bpmn-js/lib/features/copy-paste/BpmnCopyPaste.js","webpack:///./node_modules/bpmn-js/lib/features/copy-paste/ModdleCopy.js","webpack:///./node_modules/bpmn-js/lib/features/copy-paste/index.js","webpack:///./node_modules/diagram-js/lib/features/replace/Replace.js","webpack:///./node_modules/diagram-js/lib/features/replace/index.js","webpack:///./node_modules/bpmn-js/lib/features/replace/BpmnReplace.js","webpack:///./node_modules/bpmn-js/lib/features/replace/index.js","webpack:///./node_modules/bpmn-js/lib/features/popup-menu/util/TypeUtil.js","webpack:///./node_modules/bpmn-js/lib/features/replace/ReplaceOptions.js","webpack:///./node_modules/bpmn-js/lib/features/popup-menu/ReplaceMenuProvider.js","webpack:///./node_modules/bpmn-js/lib/features/popup-menu/index.js","webpack:///./node_modules/diagram-js/lib/features/resize/ResizeUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/util/LaneUtil.js","webpack:///./node_modules/bpmn-js/lib/features/context-pad/ContextPadProvider.js","webpack:///./node_modules/bpmn-js/lib/features/context-pad/index.js","webpack:///./node_modules/diagram-js/lib/features/distribute-elements/DistributeElements.js","webpack:///./node_modules/diagram-js/lib/features/distribute-elements/index.js","webpack:///./node_modules/bpmn-js/lib/features/distribute-elements/BpmnDistributeElements.js","webpack:///./node_modules/bpmn-js/lib/features/distribute-elements/index.js","webpack:///./node_modules/diagram-js/lib/features/editor-actions/EditorActions.js","webpack:///./node_modules/diagram-js/lib/features/editor-actions/index.js","webpack:///./node_modules/bpmn-js/lib/features/editor-actions/BpmnEditorActions.js","webpack:///./node_modules/bpmn-js/lib/features/editor-actions/index.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/BpmnGridSnapping.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/GridUtil.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/GridSnapping.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/behavior/ResizeBehavior.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/behavior/SpaceToolBehavior.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/behavior/index.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/index.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/behavior/AutoPlaceBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/behavior/CreateParticipantBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/behavior/LayoutConnectionBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/behavior/index.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/index.js","webpack:///./node_modules/bpmn-js/lib/features/interaction-events/BpmnInteractionEvents.js","webpack:///./node_modules/bpmn-js/lib/features/interaction-events/index.js","webpack:///./node_modules/bpmn-js/lib/features/keyboard/BpmnKeyboardBindings.js","webpack:///./node_modules/bpmn-js/lib/features/keyboard/index.js","webpack:///./node_modules/diagram-js/lib/features/keyboard-move-selection/KeyboardMoveSelection.js","webpack:///./node_modules/diagram-js/lib/features/keyboard-move-selection/index.js","webpack:///./node_modules/diagram-js/lib/features/change-support/ChangeSupport.js","webpack:///./node_modules/diagram-js/lib/features/change-support/index.js","webpack:///./node_modules/diagram-js/lib/features/resize/Resize.js","webpack:///./node_modules/diagram-js/lib/features/resize/ResizePreview.js","webpack:///./node_modules/diagram-js/lib/features/resize/ResizeHandles.js","webpack:///./node_modules/diagram-js/lib/features/resize/index.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/CategoryUtil.js","webpack:///./node_modules/bpmn-js/lib/features/label-editing/LabelEditingProvider.js","webpack:///./node_modules/bpmn-js/lib/features/label-editing/LabelEditingPreview.js","webpack:///./node_modules/bpmn-js/lib/features/label-editing/index.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/AdaptiveLabelPositioningBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/AppendBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/AssociationBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/AttachEventBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/BoundaryEventBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/RootElementReferenceBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/CreateBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/FixHoverBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/CreateDataObjectBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/CreateParticipantBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DataInputAssociationBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/UpdateSemanticParentHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DataStoreBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DeleteLaneBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DetachEventBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DropOnFlowBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/EventBasedGatewayBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/GroupBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/LineIntersect.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ImportDockingFix.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/IsHorizontalFix.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/GeometricUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/LineAttachmentUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/LabelLayoutUtil.js","webpack:///./node_modules/diagram-js/lib/util/AttachUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/LabelBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ModelingFeedback.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ReplaceConnectionBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/RemoveParticipantBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ReplaceElementBehaviour.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/ResizeUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ResizeBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ResizeLaneBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/RemoveElementBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/SpaceToolBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/SubProcessStartEventBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ToggleElementCollapseBehaviour.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/UnclaimIdBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/UpdateFlowNodeRefsBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/UnsetDefaultFlowBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/index.js","webpack:///./node_modules/bpmn-js/lib/features/snapping/BpmnSnappingUtil.js","webpack:///./node_modules/bpmn-js/lib/features/rules/BpmnRules.js","webpack:///./node_modules/bpmn-js/lib/features/rules/index.js","webpack:///./node_modules/diagram-js/lib/features/ordering/OrderingProvider.js","webpack:///./node_modules/bpmn-js/lib/features/ordering/BpmnOrderingProvider.js","webpack:///./node_modules/bpmn-js/lib/features/ordering/index.js","webpack:///./node_modules/diagram-js/lib/command/CommandStack.js","webpack:///./node_modules/diagram-js/lib/command/index.js","webpack:///./node_modules/diagram-js/lib/features/tooltips/Tooltips.js","webpack:///./node_modules/diagram-js/lib/features/tooltips/index.js","webpack:///./node_modules/diagram-js/lib/util/Removal.js","webpack:///./node_modules/diagram-js/lib/features/label-support/LabelSupport.js","webpack:///./node_modules/diagram-js/lib/features/label-support/index.js","webpack:///./node_modules/diagram-js/lib/features/attach-support/AttachSupport.js","webpack:///./node_modules/diagram-js/lib/features/attach-support/index.js","webpack:///./node_modules/diagram-js/lib/features/tool-manager/ToolManager.js","webpack:///./node_modules/diagram-js/lib/features/tool-manager/index.js","webpack:///./node_modules/diagram-js/lib/features/space-tool/SpaceUtil.js","webpack:///./node_modules/diagram-js/lib/features/space-tool/SpaceTool.js","webpack:///./node_modules/diagram-js/lib/features/space-tool/SpaceToolPreview.js","webpack:///./node_modules/diagram-js/lib/features/space-tool/index.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/BpmnFactory.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/BpmnUpdater.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/ElementFactory.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/AlignElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/AppendShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/CreateConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/CreateElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/CreateShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/CreateLabelHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/DeleteConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/DeleteElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/DeleteShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/DistributeElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/LayoutConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/MoveConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/helper/AnchorsHelper.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/helper/MoveClosure.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/helper/MoveHelper.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/MoveElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/MoveShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/ReconnectConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/ReplaceShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/ResizeShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/SpaceToolHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/ToggleShapeCollapseHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/UpdateAttachmentHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/UpdateWaypointsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/Modeling.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/UpdatePropertiesHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/UpdateCanvasRootHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/AddLaneHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/SplitLaneHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/ResizeLaneHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/UpdateFlowNodeRefsHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/IdClaimHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/SetColorHandler.js","webpack:///./node_modules/bpmn-js/lib/features/label-editing/cmd/UpdateLabelHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/Modeling.js","webpack:///./node_modules/diagram-js/lib/layout/BaseLayouter.js","webpack:///./node_modules/diagram-js/lib/layout/ManhattanLayout.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/BpmnLayouter.js","webpack:///./node_modules/diagram-js/lib/layout/CroppingConnectionDocking.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/index.js","webpack:///./node_modules/diagram-js/lib/features/move/Move.js","webpack:///./node_modules/diagram-js/lib/features/move/MovePreview.js","webpack:///./node_modules/diagram-js/lib/features/move/index.js","webpack:///./node_modules/diagram-js/lib/features/palette/Palette.js","webpack:///./node_modules/diagram-js/lib/features/palette/index.js","webpack:///./node_modules/diagram-js/lib/features/lasso-tool/LassoTool.js","webpack:///./node_modules/diagram-js/lib/features/lasso-tool/index.js","webpack:///./node_modules/diagram-js/lib/features/hand-tool/HandTool.js","webpack:///./node_modules/diagram-js/lib/features/hand-tool/index.js","webpack:///./node_modules/diagram-js/lib/features/global-connect/GlobalConnect.js","webpack:///./node_modules/diagram-js/lib/features/global-connect/index.js","webpack:///./node_modules/bpmn-js/lib/features/palette/PaletteProvider.js","webpack:///./node_modules/bpmn-js/lib/features/palette/index.js","webpack:///./node_modules/bpmn-js/lib/features/replace-preview/BpmnReplacePreview.js","webpack:///./node_modules/bpmn-js/lib/features/replace-preview/index.js","webpack:///./node_modules/bpmn-js/lib/features/snapping/BpmnConnectSnapping.js","webpack:///./node_modules/diagram-js/lib/features/snapping/SnapContext.js","webpack:///./node_modules/diagram-js/lib/features/snapping/CreateMoveSnapping.js","webpack:///./node_modules/bpmn-js/lib/features/snapping/BpmnCreateMoveSnapping.js","webpack:///./node_modules/diagram-js/lib/features/snapping/ResizeSnapping.js","webpack:///./node_modules/diagram-js/lib/features/snapping/Snapping.js","webpack:///./node_modules/diagram-js/lib/features/snapping/index.js","webpack:///./node_modules/bpmn-js/lib/features/snapping/index.js","webpack:///./node_modules/diagram-js/lib/features/search-pad/SearchPad.js","webpack:///./node_modules/diagram-js/lib/features/search-pad/index.js","webpack:///./node_modules/bpmn-js/lib/features/search/BpmnSearchProvider.js","webpack:///./node_modules/bpmn-js/lib/features/search/index.js","webpack:///./node_modules/bpmn-js/lib/Modeler.js","webpack:///./node_modules/bpmn-js-bpmnlint/node_modules/diagram-js/lib/util/EscapeUtil.js","webpack:///./node_modules/bpmn-js-bpmnlint/dist/index.esm.js","webpack:///./src/bpmn/lint/.bpmnlintrc","webpack:///src/views/Editor.vue","webpack:///./src/views/Editor.vue?4f20","webpack:///./src/views/Editor.vue","webpack:///./node_modules/lodash/_hashClear.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/cmd/ChangeElementTemplateHandler.js","webpack:///./node_modules/lodash/toInteger.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/MultiInstanceLoopProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/TextBoxEntryFactory.js","webpack:///./node_modules/core-js/internals/array-from.js","webpack:///./node_modules/lodash/_setWrapToString.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/AsyncCapableHelper.js","webpack:///./node_modules/lodash/_createAggregator.js","webpack:///./node_modules/lodash/transform.js","webpack:///./node_modules/lodash/_baseTimes.js","webpack:///./node_modules/lodash/findIndex.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/SignalEventDefinition.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/UpdateBusinessObjectListHandler.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/InputOutputHelper.js","webpack:///./node_modules/lodash/_stackHas.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ErrorEventDefinition.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/TableEntryFactory.js","webpack:///./node_modules/lodash/_nativeKeys.js","webpack:///./node_modules/lodash/_getHolder.js","webpack:///./node_modules/lodash/_freeGlobal.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/FieldInjectionProps.js","webpack:///./node_modules/lodash/_baseFlatten.js","webpack:///./node_modules/lodash/_createFind.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ScriptTaskProps.js","webpack:///./node_modules/lodash/_ListCache.js","webpack:///./node_modules/lodash/_arrayIncludesWith.js","webpack:///./node_modules/core-js/internals/string-punycode-to-ascii.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/LabelFactory.js","webpack:///./node_modules/lodash/_nativeCreate.js","webpack:///./node_modules/lodash/_LazyWrapper.js","webpack:///(webpack)/buildin/module.js","webpack:///./node_modules/lodash/toFinite.js","webpack:///./node_modules/lodash/_baseMatches.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ConditionalProps.js","webpack:///./node_modules/core-js/internals/string-multibyte.js","webpack:///./node_modules/lodash/_baseGet.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/JobPriority.js","webpack:///./node_modules/lodash/isArray.js","webpack:///./node_modules/lodash/_listCacheSet.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/index.js","webpack:///./node_modules/bpmnlint/rules/no-duplicate-sequence-flows.js","webpack:///./node_modules/bpmnlint/rules/event-sub-process-typed-start-event.js","webpack:///./node_modules/lodash/_listCacheDelete.js","webpack:///./node_modules/lodash/_createHybrid.js","webpack:///./node_modules/lodash/_metaMap.js","webpack:///./node_modules/lodash/forEach.js","webpack:///./node_modules/bpmnlint/lib/traverse.js","webpack:///./node_modules/lodash/_arrayLikeKeys.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/TasklistProps.js","webpack:///./node_modules/lodash/_baseFor.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/LinkProps.js","webpack:///./node_modules/lodash/constant.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/ElementTemplatesLoader.js","webpack:///./node_modules/lodash/isTypedArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/ComboEntryFactory.js","webpack:///./node_modules/lodash/_baseIsTypedArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ExternalTaskConfigurationProps.js","webpack:///./node_modules/lodash/_createSet.js","webpack:///./node_modules/lodash/_baseCreate.js","webpack:///./node_modules/lodash/toString.js","webpack:///./node_modules/lodash/_arrayMap.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ExtensionElements.js","webpack:///./node_modules/lodash/_Map.js","webpack:///./node_modules/lodash/_hashHas.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Listener.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/cmd/index.js","webpack:///./node_modules/lodash/_MapCache.js","webpack:///./node_modules/bpmnlint-utils/dist/index.esm.js","webpack:///./node_modules/lodash/_baseIsEqualDeep.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/InputOutputProps.js","webpack:///./node_modules/lodash/_mapCacheClear.js","webpack:///./node_modules/selection-update/index.js","webpack:///./node_modules/lodash/_baseGetAllKeys.js","webpack:///./node_modules/lodash/_Stack.js","webpack:///./node_modules/lodash/_setCacheAdd.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/index.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/CamundaPropertiesProvider.js","webpack:///./node_modules/lodash/_stackGet.js","webpack:///./node_modules/lodash/_arrayEach.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/index.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/EntryFieldDescription.js","webpack:///./node_modules/core-js/internals/create-property.js","webpack:///./node_modules/lodash/_apply.js","webpack:///./node_modules/lodash/hasIn.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/MultiInstanceLoopCharacteristics.js","webpack:///./node_modules/lodash/_baseAssignValue.js","webpack:///./node_modules/lodash/_createBind.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/ErrorEventDefinition.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/CheckboxEntryFactory.js","webpack:///./node_modules/bpmnlint/rules/no-gateway-join-fork.js","webpack:///./node_modules/lodash/_arrayIncludes.js","webpack:///./node_modules/lodash/_copyObject.js","webpack:///./node_modules/lodash/_overArg.js","webpack:///./node_modules/lodash/filter.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/AsynchronousContinuationProps.js","webpack:///./node_modules/lodash/_mapCacheDelete.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/CategoryHelper.js","webpack:///./node_modules/lodash/_createBaseEach.js","webpack:///./node_modules/lodash/isFunction.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ImplementationType.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/ProcessProps.js","webpack:///./node_modules/lodash/eq.js","webpack:///./node_modules/lodash/_baseIsMatch.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/FormHelper.js","webpack:///./node_modules/lodash/_baseMap.js","webpack:///./node_modules/core-js/modules/web.url-search-params.js","webpack:///./node_modules/lodash/flattenDeep.js","webpack:///./node_modules/lodash/_createBaseFor.js","webpack:///./node_modules/lodash/_nodeUtil.js","webpack:///./node_modules/core-js/internals/get-iterator.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/parts/CustomProps.js","webpack:///./node_modules/lodash/_isIterateeCall.js","webpack:///./node_modules/lodash/get.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/JobRetryTimeCycle.js","webpack:///./node_modules/lodash/_Symbol.js","webpack:///./node_modules/lodash/_baseFilter.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Script.js","webpack:///./node_modules/lodash/_arrayAggregator.js","webpack:///./node_modules/bpmnlint/lib/test-rule.js","webpack:///./node_modules/lodash/_equalArrays.js","webpack:///./node_modules/lodash/_baseSetToString.js","webpack:///./node_modules/lodash/_mapCacheHas.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/CompensateEventDefinition.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Delegate.js","webpack:///./node_modules/lodash/_reorder.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/ElementReferenceProperty.js","webpack:///./node_modules/lodash/_getAllKeys.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/InputOutputParameter.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/InputOutputParameterProps.js","webpack:///./node_modules/lodash/_mergeData.js","webpack:///./node_modules/lodash/_setToArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ResultVariable.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/StartEventInitiator.js","webpack:///./node_modules/lodash/_baseUnary.js","webpack:///./node_modules/lodash/debounce.js","webpack:///./node_modules/lodash/_equalObjects.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ErrorEventProps.js","webpack:///./node_modules/lodash/isLength.js","webpack:///./node_modules/lodash/_baseSetData.js","webpack:///./node_modules/bpmnlint/rules/no-implicit-split.js","webpack:///./node_modules/lodash/toNumber.js","webpack:///./node_modules/lodash/_listCacheGet.js","webpack:///./node_modules/lodash/_DataView.js","webpack:///./node_modules/lodash/_countHolders.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/VersionTagProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/PropertiesActivator.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/PropertiesProps.js","webpack:///./node_modules/lodash/_getWrapDetails.js","webpack:///./node_modules/lodash/_baseIteratee.js","webpack:///./node_modules/lodash/_hashGet.js","webpack:///./node_modules/lodash/noop.js","webpack:///./node_modules/bpmnlint/rules/no-complex-gateway.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ExternalTaskPriority.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/TextInputEntryFactory.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/DocumentationProps.js","webpack:///./node_modules/lodash/_baseIsEqual.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/ConditionalEventDefinition.js","webpack:///./node_modules/lodash/_isIndex.js","webpack:///./node_modules/bpmnlint/rules/helper.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/CreateAndReferenceHandler.js","webpack:///./node_modules/bpmnlint/rules/single-blank-start-event.js","webpack:///./node_modules/lodash/_setToString.js","webpack:///./src/views/Editor.vue?eeb7","webpack:///./node_modules/lodash/_wrapperClone.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/VariableMappingProps.js","webpack:///./node_modules/bpmnlint/rules/no-disconnected.js","webpack:///./node_modules/lodash/_cacheHas.js","webpack:///./node_modules/lodash/_Set.js","webpack:///./node_modules/hammerjs/hammer.js","webpack:///./node_modules/bpmnlint/rules/label-required.js","webpack:///./node_modules/lodash/_assocIndexOf.js","webpack:///./node_modules/lodash/_composeArgs.js","webpack:///./node_modules/lodash/identity.js","webpack:///./node_modules/lodash/_baseToString.js","webpack:///./node_modules/lodash/_createPartial.js","webpack:///./node_modules/lodash/_stackSet.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/PropertiesPanel.js","webpack:///./node_modules/lodash/stubArray.js","webpack:///./node_modules/lodash/isArguments.js","webpack:///./node_modules/bpmnlint/rules/no-inclusive-gateway.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/MultiCommandHandler.js","webpack:///./node_modules/bpmnlint/rules/start-event-required.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/EventDefinitionHelper.js","webpack:///./node_modules/lodash/_SetCache.js","webpack:///./node_modules/lodash/_baseIsNaN.js","webpack:///./node_modules/lodash/_coreJsData.js","webpack:///./node_modules/lodash/_insertWrapDetails.js","webpack:///./node_modules/lodash/_setCacheHas.js","webpack:///./node_modules/lodash/_toSource.js","webpack:///./node_modules/lodash/isArrayLikeObject.js","webpack:///./node_modules/lodash/assign.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/ParticipantHelper.js","webpack:///./node_modules/lodash/map.js","webpack:///./node_modules/core-js/modules/web.dom-collections.iterator.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/SelectEntryFactory.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/UpdateBusinessObjectHandler.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/ImplementationTypeHelper.js","webpack:///./node_modules/lodash/_Hash.js","webpack:///./node_modules/lodash/_hasPath.js","webpack:///./node_modules/lodash/_castPath.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/AsyncContinuation.js","webpack:///./node_modules/bpmnlint/lib/index.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/Helper.js","webpack:///./node_modules/lodash/memoize.js","webpack:///./node_modules/lodash/_basePropertyDeep.js","webpack:///./node_modules/lodash/_createRecurry.js","webpack:///./node_modules/css.escape/css.escape.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/EntryFactory.js","webpack:///./node_modules/lodash/_replaceHolders.js","webpack:///./node_modules/lodash/_createWrap.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ConnectorInputOutputParameterProps.js","webpack:///./node_modules/lodash/_LodashWrapper.js","webpack:///./node_modules/lodash/_isPrototype.js","webpack:///./node_modules/lodash/keys.js","webpack:///./node_modules/lodash/_baseXor.js","webpack:///./node_modules/lodash/_mapToArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/CandidateStarterProps.js","webpack:///./node_modules/lodash/_baseProperty.js","webpack:///./node_modules/lodash/_stackClear.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/FormProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Tasklist.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/ExecutableProps.js","webpack:///./node_modules/lodash/_shortOut.js","webpack:///./node_modules/lodash/_toKey.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/EscalationEventDefinition.js","webpack:///./node_modules/lodash/_isKey.js","webpack:///./node_modules/lodash/_setData.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/EventDefinitionReference.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/MessageEventDefinition.js","webpack:///./node_modules/lodash/property.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/JobConfigurationProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/FieldInjection.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/ValidationAwareTextInput.js","webpack:///./node_modules/lodash/_listCacheHas.js","webpack:///./node_modules/core-js/internals/dom-iterables.js","webpack:///./node_modules/lodash/_updateWrapDetails.js","webpack:///./node_modules/bpmnlint/rules/fake-join.js","webpack:///./node_modules/mitt/dist/mitt.es.js","webpack:///./node_modules/scroll-tabs/index.js","webpack:///./node_modules/lodash/isSymbol.js"],"names":["is","find","entryFactory","cmdHelper","ImplementationTypeHelper","scriptImplementation","timerImplementation","isTimeoutTaskListener","listener","eventType","event","getTimerEventDefinition","bo","eventDefinitions","module","exports","group","element","bpmnFactory","options","translate","LISTENER_TYPE_LABEL","class","expression","delegateExpression","script","getSelectedListener","classProp","expressionProp","delegateExpressionProp","scriptProp","executionListenerEventTypeOptions","isSequenceFlow","name","value","taskListenerEventTypeOptions","isSelected","node","entries","push","selectBox","id","label","modelProperty","emptyParameter","get","set","values","updateBusinessObject","selectOptions","eventTypeOptions","selectedListener","isTaskListener","isExecutionListener","hidden","textField","listenerId","undefined","update","validate","listenerType","getImplementationType","create","dataValueLabel","listenerValueLabel","listenerValue","html","template","isScript","timerEventDefinitionHandler","timerEventDefinition","createTimerEventDefinition","timerOptions","idPrefix","Symbol","objectProto","Object","prototype","hasOwnProperty","nativeObjectToString","toString","symToStringTag","toStringTag","getRawTag","isOwn","call","tag","unmasked","e","result","getBusinessObject","callable","flattenDeep","assign","getCallableType","boCalledElement","boCaseRef","callActivityType","DEFAULT_PROPS","calledElement","type","props","updateProperties","isPrototype","nativeKeys","baseKeys","object","key","__depends__","default","__init__","propertiesProvider","inputOutput","inputOutputEntry","insideConnector","concat","getSelectedParameter","InputOutputHelper","getServiceTaskLikeBusinessObject","getConnector","isConnector","connector","connectorId","isArguments","isArray","spreadableSymbol","isConcatSpreadable","isFlattenable","stubFalse","factory","elementHelper","extensionElementsHelper","utils","forEach","generatePropertyId","nextId","getPropertyValues","parent","properties","getPropertiesElement","isExtensionElements","getPropertiesElementInsideExtensionElements","extensionElements","elem","getParent","modelProperties","createParent","addLabel","getElements","addElement","commands","cmd","createElement","addAndRemoveElementsFromList","propertyProps","prop","indexOf","property","addElementsTolist","updateElement","idx","validationError","isIdValid","removeElement","propertyValues","currentProperty","removeElementsFromList","length","removeEntry","table","arrayPush","array","index","offset","isObject","isStrictComparable","strictIndexOf","fromIndex","createInputParameter","binding","parameterValue","parameterDefinition","scriptFormat","definition","createOutputParameter","source","createCamundaProperty","createCamundaIn","createCamundaInOutAttrs","createCamundaInWithBusinessKey","businessKey","createCamundaOut","createCamundaExecutionListenerScript","createCamundaFieldInjection","string","target","sourceExpression","variables","local","k","baseIsNative","getValue","getNative","freeExports","nodeType","freeModule","moduleExports","Buffer","root","nativeIsBuffer","isBuffer","fails","wellKnownSymbol","IS_PURE","ITERATOR","url","URL","searchParams","pathname","toJSON","sort","href","String","URLSearchParams","username","host","hash","identity","overRest","setToString","baseRest","func","start","isAny","eventDefinitionHelper","message","signal","error","escalation","timer","compensation","condition","elementRegistry","events","messageEventDefinition","getMessageEventDefinition","signalEventDefinition","getSignalEventDefinition","errorEvents","errorEventDefinition","getErrorEventDefinition","escalationEvents","showEscalationCodeVariable","escalationEventDefinition","getEscalationEventDefinition","timerEvents","compensationEvents","compensateEventDefinition","getCompensateEventDefinition","conditionalEvents","conditionalEventDefinition","getConditionalEventDefinition","realNames","getFuncName","data","otherFunc","ElementHelper","elementType","$parent","isConditionalForking","defaultFlow","outgoing","hasCondition","flow","conditionExpression","isDefaultFlow","check","reporter","missingCondition","report","baseCreate","createCtor","Ctor","args","arguments","thisBinding","apply","historyTimeToLive","businessObject","isKeyable","castFunction","isObjectLike","coreJsData","maskSrcKey","uid","exec","keys","IE_PROTO","isMasked","getTag","isArrayLike","isTypedArray","mapTag","setTag","isEmpty","splice","size","types","t","anyType","candidateStarterGroupsEntry","description","candidateStarterGroups","candidateStarterUsersEntry","candidateStarterUsers","baseIsEqual","hasIn","isKey","matchesStrictComparable","toKey","COMPARE_PARTIAL_FLAG","COMPARE_UNORDERED_FLAG","baseMatchesProperty","path","srcValue","objValue","escapeHTML","entryFieldDescription","bind","link","showLink","handleClick","Error","resource","cssClasses","resultVariable","attributeInfo","bpmn","version","versionTag","tenantId","cmmn","dmn","mapDecisionResultOptions","delegateVariableMappingOptions","getCamundaInWithBusinessKey","camundaIn","camundaInParams","getExtensionElements","param","setBusinessKey","text","camundaInWithBusinessKey","deleteBusinessKey","camundaInExtensions","isSupportedCallableType","bindingOptions","getAttribute","getCallActivityBindingValue","attr","getDelegateVariableMappingType","boVariableMappingClass","boVariableMappingDelegateExpression","delegateVariableMappingType","callableElementRef","callableElementLabel","newCallableElementRef","elementRef","filter","bindingOption","callableBinding","attrVer","attrVerTag","callableVersion","checkbox","callableBusinessKey","hideResultVariable","mapDecisionResult","delegateVariableMapping","delegateVariableMappingLabel","memoizeCapped","rePropName","reEscapeChar","stringToPath","charCodeAt","replace","match","number","quote","subString","Uint8Array","eq","equalArrays","mapToArray","setToArray","boolTag","dateTag","errorTag","numberTag","regexpTag","stringTag","symbolTag","arrayBufferTag","dataViewTag","symbolProto","symbolValueOf","valueOf","equalByTag","other","bitmask","customizer","equalFunc","stack","byteLength","byteOffset","buffer","convert","isPartial","stacked","Promise","CreateBusinessObjectListHandler","this","_elementRegistry","_bpmnFactory","ensureNotNull","ensureList","$inject","execute","context","currentObject","propertyName","newObjects","changed","childObjects","self","obj","childObject","previousChilds","revert","getTimerDefinitionType","timeDate","timeCycle","timeDuration","getTimerDefinition","timerOrFunction","createFormalExpression","body","TimerEventDefinition","prefix","timerDefinition","timerDefinitionType","newType","oldType","hashDelete","has","__data__","getMapData","mapCacheSet","isExternal","topicEntry","externalTopic","nativeMax","Math","max","transform","Array","otherArgs","memoize","MAX_MEMOIZE_SIZE","cache","clear","inherits","getTemplate","PropertiesActivator","HIGHER_PRIORITY","CustomElementsPropertiesActivator","eventBus","elementTemplates","isEntryVisible","entry","isPropertyEditable","isEntryEditable","CUSTOM_PROPERTIES_PATTERN","DEFAULT_ENTRIES_VISIBLE","_all","isCustomEntry","test","entryId","entriesVisible","defaultVisible","entryVisible","getProperty","editable","indexes","split","scopeName","parseInt","isNaN","scopes","baseFor","baseForOwn","iteratee","baseEach","baseAggregator","collection","setter","accumulator","mapCacheGet","nativeCreate","HASH_UNDEFINED","hashSet","baseGetTag","argsTag","baseIsArguments","fieldInjection","insideListener","fieldInjectionEntry","nameEntryFactory","createCategoryValue","canvas","initializeCategory","semantic","rootElement","getRootElement","definitions","categoryValue","categoryValueRef","setGroupName","newLabel","getGroupName","arrayMap","baseValues","createWrap","getHolder","replaceHolders","WRAP_BIND_FLAG","WRAP_PARTIAL_FLAG","thisArg","partials","holders","placeholder","baseHasIn","createFind","findIndex","metaMap","noop","getData","listCacheClear","nameEntry","textBox","objectToString","LazyWrapper","LodashWrapper","baseLodash","wrapperClone","lodash","constructor","ElementTemplates","_templates","descriptors","templates","descriptor","getAll","testRule","categoryMap","0","1","2","Linter","config","resolver","cachedRules","cachedConfigs","prefixPackage","pkg","startsWith","unprefixPackage","substring","applyRule","moddleRoot","ruleDefinition","rule","category","reports","map","console","resolveRule","ruleName","parseRuleName","resolve","then","ruleFactory","resolveConfig","configName","parseConfigName","actualConfig","normalizeConfig","resolveRules","resolveConfiguredRules","rulesConfig","parsedRules","parseRuleValue","enabledRules","loaders","all","parents","extends","inheritedRules","overrideRules","rules","reduce","currentRules","lint","ruleDefinitions","allReports","toLowerCase","localPackage","_","ns","packageName","getSimplePackageName","validatedRules","normalizedRules","normalizedName","CmdHelper","newProperties","listPropertyName","objectsToAdd","referencePropertyName","objectsToRemove","setList","updatedObjectList","ExtensionElementsHelper","extensionValues","elements","addEntry","baseFindIndex","predicate","fromRight","EOF","$","DESCRIPTORS","USE_NATIVE_URL","global","defineProperties","redefine","anInstance","arrayFrom","codeAt","toASCII","setToStringTag","URLSearchParamsModule","InternalStateModule","NativeURL","getInternalSearchParamsState","getState","setInternalState","getInternalURLState","getterFor","floor","pow","INVALID_AUTHORITY","INVALID_SCHEME","INVALID_HOST","INVALID_PORT","ALPHA","ALPHANUMERIC","DIGIT","HEX_START","OCT","DEC","HEX","FORBIDDEN_HOST_CODE_POINT","FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT","LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE","TAB_AND_NEW_LINE","parseHost","input","codePoints","charAt","parseIPv6","slice","isSpecial","parseIPv4","percentEncode","C0ControlPercentEncodeSet","partsLength","numbers","part","radix","ipv4","parts","pop","numbersSeen","ipv4Piece","swaps","swap","address","pieceIndex","compress","pointer","char","findLongestZeroSequence","ipv6","maxIndex","maxLength","currStart","currLength","serializeHost","ignore0","unshift","join","fragmentPercentEncodeSet","pathPercentEncodeSet","userinfoPercentEncodeSet","code","encodeURIComponent","specialSchemes","ftp","file","http","https","ws","wss","scheme","includesCredentials","password","cannotHaveUsernamePasswordPort","cannotBeABaseURL","isWindowsDriveLetter","normalized","second","startsWithWindowsDriveLetter","third","shortenURLsPath","pathSize","isSingleDot","segment","isDoubleDot","SCHEME_START","SCHEME","NO_SCHEME","SPECIAL_RELATIVE_OR_AUTHORITY","PATH_OR_AUTHORITY","RELATIVE","RELATIVE_SLASH","SPECIAL_AUTHORITY_SLASHES","SPECIAL_AUTHORITY_IGNORE_SLASHES","AUTHORITY","HOST","HOSTNAME","PORT","FILE","FILE_SLASH","FILE_HOST","PATH_START","PATH","CANNOT_BE_A_BASE_URL_PATH","QUERY","FRAGMENT","parseURL","stateOverride","base","bufferCodePoints","failure","state","seenAt","seenBracket","seenPasswordToken","port","query","fragment","i","codePoint","encodedCodePoints","shift","URLConstructor","baseState","that","urlString","TypeError","searchParamsState","updateSearchParams","updateURL","serializeURL","origin","getOrigin","protocol","getProtocol","getUsername","getPassword","getHost","hostname","getHostname","getPort","getPathname","search","getSearch","getSearchParams","getHash","URLPrototype","output","accessorDescriptor","getter","configurable","enumerable","nativeCreateObjectURL","createObjectURL","nativeRevokeObjectURL","revokeObjectURL","blob","forced","sham","freeGlobal","freeSelf","Function","SetCache","arrayIncludes","arrayIncludesWith","cacheHas","createSet","LARGE_ARRAY_SIZE","baseUniq","comparator","includes","isCommon","seen","outer","computed","seenIndex","arrayFilter","resIndex","overArg","getPrototype","getPrototypeOf","baseUnary","baseDifference","valuesLength","valuesIndex","isIterateeCall","createAssigner","assigner","sources","guard","listenerEntry","stackDelete","validationAwareTextField","setProperty","labelTarget","idValue","idError","domQuery","domClear","domify","Ids","SPACE_REGEX","QNAME_REGEX","ID_REGEX","HTML_ESCAPE_MAP","'","selectedOption","selectedIndex","selectedType","elementSyntax","inputNode","typeSelect","getRoot","filterElementsByType","objectList","list","findRootElementsByType","referencedType","rootElements","removeAllChildren","domElement","firstChild","removeChild","addEmptyParameter","refreshOptionsModel","model","referableObjects","updateOptionsDropDown","domSelector","entryNode","option","optionEntry","appendChild","assigned","$model","ids","idExists","validateId","containsSpace","nextPrefixed","triggerClickEvent","evt","document","createEvent","MouseEvent","view","window","bubbles","cancelable","initEvent","dispatchEvent","createEventObject","fireEvent","str","composeArgsRight","isCurried","argsIndex","argsLength","holdersIndex","holdersLength","rightIndex","rightLength","rangeLength","isUncurried","isFunction","isLength","baseAssignValue","assignValue","stubArray","propertyIsEnumerable","nativeGetSymbols","getOwnPropertySymbols","getSymbols","symbol","toSource","reRegExpChar","reIsHostCtor","funcProto","funcToString","reIsNative","RegExp","pattern","DROPDOWN_TYPE","VALID_TYPES","PROPERTY_TYPE","CAMUNDA_PROPERTY_TYPE","CAMUNDA_INPUT_PARAMETER_TYPE","CAMUNDA_OUTPUT_PARAMETER_TYPE","CAMUNDA_IN_TYPE","CAMUNDA_OUT_TYPE","CAMUNDA_IN_BUSINESS_KEY_TYPE","CAMUNDA_EXECUTION_LISTENER","CAMUNDA_FIELD","VALID_BINDING_TYPES","Validator","_templatesById","_validTemplates","_errors","addAll","add","_logError","err","_validateTemplate","appliesTo","_validateProperties","_validateScopes","scope","validProperties","_validateProperty","bindingType","choices","every","isDropdownChoiceValid","getErrors","getValidTemplates","c","nullTag","undefinedTag","inputOutputHelper","extensionElementsEntry","getInputOutput","getInputParameters","getOutputParameters","getInputParameter","getOutputParameter","createInputOutput","createParameter","ensureInputOutputSupported","isInputOutputSupported","ensureOutparameterSupported","areOutputParametersSupported","TYPE_LABEL","getSelected","selection","inputEntry","parameter","outputEntry","newElement","inputParameters","outputParameters","newElem","otherProp","firstLength","secondLength","setOptionLabelValue","suffix","$type","resizable","createExtensionElement","removeExtensionElement","onSelectionChange","deselect","isLaziable","funcName","hasEndEvent","flowElements","some","WeakMap","defineProperty","getMatchData","historyTimeToLiveEntry","defineIterator","STRING_ITERATOR","getInternalState","iterated","point","done","now","Date","triggeredByEvent","flowElement","createAggregator","keyBy","baseXor","isArrayLikeObject","xor","arrays","arraySome","DataView","Map","Set","objectTag","promiseTag","weakMapTag","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","ArrayBuffer","ctorString","copyArray","implementationType","delegate","external","domClosest","closest","domClasses","classes","isDmnCapable","isExternalCapable","isServiceTaskLike","getTabNode","el","containerEl","hasDmnSupport","hasExternalSupport","hasServiceTaskLikeSupport","connectorTabEl","textContent","remove","innerHTML","getTemplateId","TEMPLATE_ATTR","applyTemplate","newTemplateId","oldTemplate","newTemplate","getTemplateOptions","currentTemplateId","emptyOption","allOptions","isDefault","defaultOption","isDefaultTemplate","currentOption","unknownTemplate","templateId","elementTemplate","disabled","createHybrid","createRecurry","createCurry","arity","wrapper","fn","baseIsNaN","baseIndexOf","createBaseEach","render","_vm","_h","$createElement","_c","_self","attrs","staticClass","on","handleImportButton","_v","loadBpmnFromFile","slot","downloadBpmnToFile","downloadBpmnToSVG","textTransform","resetBPMN","checkBPMN","saveBPMN","ref","staticRenderFns","BaseModeler","BaseViewer","_collectIds","_createModdle","moddle","elementsById","claim","MIN_ZOOM","MAX_ZOOM","mouseEvents","log","service","injector","stopEvent","preventDefault","stopPropagation","stopImmediatePropagation","createTouchRecognizer","stopMouse","allowMouse","setTimeout","unbind","recognizer","Manager","inputClass","TouchInput","recognizers","tap","Tap","pan","Pan","threshold","press","Press","pinch","Pinch","doubleTap","taps","requireFailure","reset","force","session","stopped","stop","r","curRecognizer","srcEvent","defaultPrevented","TouchInteractionEvents","interactionEvents","dragging","move","contextPad","palette","handler","fire","getGfx","initEvents","svg","startGrabCanvas","lx","ly","dx","deltaX","dy","deltaY","scroll","end","off","startGrab","gfx","startZoom","zoom","mid","center","ratio","scale","newZoom","min","originalEvent","position","elementFromPoint","x","y","hover","out","hoverGfx","pad","padRecognizer","trigger","container","TouchFix","addBBoxMarker","markerStyle","fill","rect1","width","height","rect2","touchInteractionEvents","touchFix","last","arr","sortTopOrMiddle","sortLeftOrCenter","ALIGNMENT_SORTING","left","right","top","middle","bottom","AlignElements","modeling","_modeling","_getOrientationDetails","vertical","axis","dimension","_isType","_alignmentPosition","sortedElements","centeredElements","firstElement","lastElement","orientation","alignment","centers","hasSharedCenters","getMiddleOrTop","first","round","filteredElements","waypoints","sortFn","alignElements","DEFAULT_HORIZONTAL_DISTANCE","MAX_HORIZONTAL_DISTANCE","PLACEMENT_DETECTION_PAD","getNewShapePosition","getTextAnnotationPosition","getDataElementPosition","getFlowNodePosition","getDefaultPosition","sourceTrbl","sourceMid","horizontalDistance","getFlowNodeDistance","rowSize","margin","getVerticalDistance","orient","escapeDirection","deconflictPosition","isReference","toTargetNode","weight","shape","distanceTo","shapeTrbl","toSourceNode","nodes","getTargets","getSources","distancesGrouped","currentDistance","currentDistanceCount","currentDistanceEntry","fav","count","getAutoPlaceClosure","allConnected","getConnected","attachers","shapes","attacher","getConnectedAtPosition","bounds","closure","escapeDelta","nextPosition","existingElement","newPosition","axisDelta","existingTarget","noneFilter","connectionFilter","incoming","AutoPlace","emit","payload","append","newShape","appendShape","AutoPlaceSelectionBehavior","select","autoPlace","autoPlaceSelectionBehavior","DEFAULT_PRIORITY","CommandInterceptor","_eventBus","unwrapEvent","command","hook","priority","handlerFn","unwrap","fullEvent","hooks","AutoResize","_rules","postExecuted","hints","newParent","autoResize","_expand","topLevel","expandings","parentId","collapsed","children","boundsChanged","newBounds","oldBounds","getResizeDirections","directions","BpmnAutoResize","invoke","RuleProvider","init","AutoResizeProvider","addRule","canResize","BpmnAutoResizeProvider","_getOptimalBounds","getOffset","padding","getPadding","elementsTrbl","targetTrbl","newTrbl","allowed","resizeDirections","resize","resizeShape","resizeLane","actions","action","canExecute","bpmnAutoResize","bpmnAutoResizeProvider","DRAG_ACTIVE_CLS","isTouchEvent","TouchEvent","getLength","sqrt","Dragging","defaultOptions","trapClick","toLocalPoint","globalPosition","viewbox","clientRect","_container","getBoundingClientRect","dragContext","isTouch","restoreSelection","previousSelection","existingSelection","activate","displacement","globalStart","globalCurrent","globalDelta","localStart","localCurrent","localDelta","active","cancel","keepSelection","cursor","addMarker","previousContext","returnValue","cleanup","checkCancel","which","trapClickAndEnd","untrap","trapTouch","restore","wasActive","endDrag","removeMarker","relativeTo","manual","autoActivate","setOptions","HIGH_PRIORITY","HoverFix","ensureHover","_findTargetGfx","once","setDragHover","unsetHover","ensureOut","hoverFix","AutoScroll","_canvas","_opts","scrollThresholdIn","scrollThresholdOut","scrollRepeatTimeout","scrollStep","_toBorderPoint","startScroll","stopScroll","between","val","opts","getContainer","diff","_scrolling","clearTimeout","autoScroll","Rules","_commandStack","commandStack","circlePath","linePath","points","segments","p","INTERSECTION_THRESHOLD","getBendpointIntersection","reference","w","bendpoint","getPathIntersection","intersections","a","b","segment2","getApproxIntersection","BENDPOINT_CLS","SEGMENT_DRAGGER_CLS","toCanvasCoordinates","getConnectionIntersection","localPosition","intersection","addBendpoint","parentGfx","cls","groupGfx","visual","cx","cy","hit","createParallelDragger","segmentStart","segmentEnd","draggerGfx","hitWidth","calculateHitWidth","hitHeight","addSegmentDragger","calculateSegmentMoveRegion","segmentLength","abs","segmentLengthXAxis","segmentLengthYAxis","Bendpoints","bendpointMove","connectionSegmentMove","isIntersectionMiddle","treshold","p0","p1","aligned","xDelta","yDelta","calculateIntersectionThreshold","connection","relevantSegment","activateBendpointMove","bindInteractionEvents","eventName","triggerMouseEvent","getBendpointsContainer","layer","getLayer","getSegmentDragger","createBendpoints","createSegmentDraggers","segmentDraggerGfx","clearBendpoints","clearSegmentDraggers","addHandles","updateHandles","updateFloatingBendpointPosition","floating","updateSegmentDraggerPosition","draggerVisual","relativePosition","getDraggerVisual","bendpointsGfx","marker","newSelection","primary","registerEvent","unregisterEvent","newId","bendpointContainer","RECONNECT_START","RECONNECT_END","UPDATE_WAYPOINTS","BendpointMove","_injector","bendpointIndex","insert","getGraphics","connectionGfx","newWaypoints","docking","cropWaypoints","updateWaypoints","isReverse","reverse","reconnect","connectionDocking","getCroppedWaypoints","MARKER_OK","MARKER_NOT_OK","MARKER_CONNECT_HOVER","MARKER_CONNECT_UPDATING","MARKER_ELEMENT_HIDDEN","BendpointMovePreview","connectionPreview","connectionEnd","connectionStart","noCropping","noLayout","drawPreview","cleanUp","axisAdd","delta","axisSet","axisFenced","maxValue","minValue","fencedValue","flipAxis","getDocking","referenceElement","moveAxis","referenceMid","inverseAxis","original","ConnectionSegmentMove","graphicsFactory","cropConnection","croppedWaypoints","oldWaypoints","redrawConnection","updateDragger","segmentOffset","segmentStartIndex","segmentEndIndex","draggerPosition","filterRedundantWaypoints","filteredWaypoints","direction","dragPosition","originalWaypoints","sourceToSegmentOrientation","targetToSegmentOrientation","newSegmentStart","newSegmentEnd","waypointCount","newSegmentStartIndex","filtered","segmentMove","tolerance","snapValue","topLeft","bottomRight","defaultValue","isSnapped","snapped","setSnapped","previousValue","getChildren","TOLERANCE","BendpointSnapping","snapTo","rem","getConnectionSegmentSnaps","snapPoints","referenceWaypoints","horizontal","getBendpointSnaps","sx","sy","hoverMid","bendpoints","bendpointMovePreview","bendpointSnapping","Connect","canConnect","canConnectReverse","connect","LOW_PRIORITY","ConnectPreview","startPosition","connectPreview","MARKER_CONNECTION_PREVIEW","ConnectionPreview","elementFactory","_graphicsFactory","_elementFactory","_connectionDocking","_layouter","cacheReturnValues","returnValues","firstArgument","JSON","stringify","ensureConnectionAttrs","connectionPreviewGfx","getConnection","noNoop","createConnectionPreviewGfx","layoutConnection","drawConnection","drawNoopPreview","createNoopConnection","sourcePath","getShapePath","targetPath","connectionPath","getConnectionPath","createConnection","pointerEvents","getDefaultLayer","isTextNode","Node","TEXT_NODE","toArray","nodeList","TextBox","content","keyHandler","resizeHandler","handlePaste","DirectEditing","_providers","_textbox","_handleKey","_handleResize","style","parentStyle","maxWidth","maxHeight","minWidth","minHeight","backgroundColor","overflow","border","boxSizing","wordWrap","textAlign","outline","contentStyle","centerVertically","innerText","setSelection","lastChild","clipboardData","insertText","hasResized","success","execCommand","_insertTextIE","range","getSelection","startContainer","endContainer","startOffset","endOffset","commonAncestorContainer","childNodesArray","childNodes","containerTextContent","textNode","createTextNode","insertBefore","startContainerChildIndex","endContainerChildIndex","childNode","fontSize","scrollHeight","offsetHeight","resizeHandle","Infinity","startX","startY","startWidth","startHeight","onMouseDown","clientX","clientY","onMouseMove","onMouseUp","newWidth","newHeight","borderTop","borderRight","borderBottom","borderLeft","destroy","removeAttribute","trim","getRangeAt","createRange","selectNodeContents","setStart","setEnd","removeAllRanges","addRange","registerProvider","provider","isActive","_active","_fire","close","complete","containerBounds","previousBounds","$textbox","newText","previousText","keyCode","charCode","shiftKey","directEditing","entrySelector","ContextPad","overlays","_overlays","_overlaysConfig","_current","_init","addClasses","classNames","actualClassNames","open","isOpen","current","providers","getEntries","_getProviders","entriesOrUpdater","getContextPadEntries","button","delegateTarget","_updateAndOpen","getPad","grouping","control","className","title","imageUrl","overlaysConfig","_overlayId","MARKER_TYPES","NODES_CAN_HAVE_MARKER","PreviewSupport","styles","_styles","_clonedMarkers","clonedMarker","getMarker","markerType","parentNode","referenceToId","idToReference","canHaveMarker","nodeName","addDragger","dragger","bbox","_cloneMarkers","addFrame","frame","_cloneMarker","markerId","clonedMarkerId","defs","_svg","previewSupport","MARKER_ATTACH","MARKER_NEW_PARENT","PREFIX","Create","canCreate","isLabel","isConnection","attach","isSingleShape","targetParent","targetAttach","setMarker","m","ensureConstraints","createElements","waypoint","createConstraints","CreatePreview","createDragGroup","dragGroup","childrenGfx","_createContainer","drawShape","defaultLayer","createPreview","DATA_REF","CLOSE_EVENTS","PopupMenu","_config","setTransform","providerId","_getEntries","headerEntries","_getHeaderEntries","hasEntries","hasHeaderEntries","_emit","_createEntries","_attachContainer","_bindAutoClose","_unbindAutoClose","_getEntry","getPopupMenuEntries","getPopupMenuHeaderEntries","getHeaderEntries","visibility","_updateScale","_assureIsInbounds","minScale","maxScale","scaleConfig","containerX","offsetLeft","containerY","offsetTop","containerWidth","scrollWidth","containerHeight","overAxis","cursorPosition","entriesContainer","entryContainer","_createEntry","entryClasses","popupMenu","Clipboard","_data","clipboard","Mouse","setLastMoveEvent","mousemoveEvent","_lastMoveEvent","addEventListener","_lastMouseEvent","removeEventListener","createMoveEvent","screenX","screenY","initMouseEvent","getLastMoveEvent","mouse","CopyPaste","_create","_clipboard","_mouse","parentCopied","isAttacher","copyWaypoints","createElementsBehavior","copyWaypoint","copy","tree","createTree","paste","_createElements","_paste","branch","depth","createLabel","createShape","hasRelations","elementsData","canCopy","addElementData","foundElementData","removeElementData","elementData","_index","labels","addRelatedElements","copyPaste","copyProperties","removeProperties","BpmnCopyPaste","moddleCopy","references","resolveReferences","attachedToRef","oldBusinessObject","di","bpmnProcess","copyElement","newBusinessObject","DISALLOWED_PROPERTIES","ModdleCopy","_moddle","propertyNames","parentDescriptor","$descriptor","getPropertyNames","keepDefaultProperties","$instanceOf","sourceElement","targetElement","canCopyProperties","sourceProperty","copiedProperty","copyProperty","canSetProperty","propertyDescriptor","getPropertyDescriptor","isId","childProperties","childProperty","getElementDescriptor","isGeneric","bpmnCopyPaste","Replace","replaceElement","oldElement","newElementData","centerX","centerY","replaceShape","CUSTOM_PROPERTIES","toggeling","targetCollapsed","oldCollapsed","isExpanded","BpmnReplace","isSubProcess","toggleCollapse","elementProps","newElementProps","copyProps","hasEventDefinition","eventDefinitionType","moveChildren","processRef","_getDefaultSize","a1","a2","bpmnReplace","isDifferentType","eventDefinition","isTypeEqual","isEventDefinitionEqual","isTriggeredByEventEqual","isExpandedEqual","START_EVENT","actionName","INTERMEDIATE_EVENT","END_EVENT","GATEWAY","instantiate","eventGatewayType","SUBPROCESS_EXPANDED","TRANSACTION","EVENT_SUB_PROCESS","TASK","BOUNDARY_EVENT","cancelActivity","EVENT_SUB_PROCESS_START_EVENT","isInterrupting","SEQUENCE_FLOW","PARTICIPANT","ReplaceMenuProvider","_popupMenu","_bpmnReplace","_translate","register","differentType","isInterruptingEqual","isCancelActivityEqual","isTargetSubProcess","isTargetExpanded","_createSequenceFlowEntries","_getLoopEntries","_getAdHocEntry","replaceOptions","menuEntries","_createMenuEntry","sourceRef","replaceAction","menuEntry","toggleLoopEntry","loopCharacteristics","isSequential","isLoop","isParallel","loopEntries","isAdHoc","adHocEntry","replaceMenuProvider","DEFAULT_CHILD_BOX_PADDING","substractTRBL","trblA","trblB","resizeBounds","resizeTRBL","applyConstraints","trbl","resizeConstraints","currentBounds","currentTrbl","getMinResizeBounds","minDimensions","childrenBounds","currentBox","minBox","childrenBox","combinedBox","asPadding","mayBePadding","addPadding","isBBoxChild","computeChildrenBBox","shapeOrChildren","getTRBLResize","LANE_PARENTS","LANE_INDENTATION","collectLanes","collectedShapes","s","getChildLanes","getLanesRoot","computeLanesResize","initialShapes","allLanes","shapeNewTrbl","trblResize","resizeNeeded","topResize","rightResize","bottomResize","leftResize","otherTrbl","ContextPadProvider","_contextPad","_connect","_autoPlace","click","isEventType","eventBo","isType","isDefinition","def","startConnect","removeElements","getReplaceMenuPosition","Y_OFFSET","diagramContainer","diagramRect","padRect","pos","appendAction","appendStart","dragstart","splitLaneHandler","splitLane","childLanes","addLane","isForCompensation","deleteAllowed","contextPadProvider","AXIS_DIMENSIONS","THRESHOLD","DistributeElements","_filters","registerFilter","avgDimension","elementsSize","numOfShapes","filterFn","groups","distributableElements","_setOrientation","_filterElements","_createGroups","distributeElements","_axis","_dimension","filters","rangeGroups","elementRange","_findRange","previous","_hasIntersection","rangeA","rangeB","BpmnDistributeElements","cannotDistribute","bpmnDistributeElements","NOT_REGISTERED_ERROR","IS_REGISTERED_ERROR","EditorActions","_actions","_registerDefaultActions","editorActions","zoomScroll","keyboardMove","keyboardMoveSelection","undo","redo","selectedElements","stepZoom","removableElements","moveCanvas","moveSelection","accelerated","_registerAction","isRegistered","unregister","getActions","BpmnEditorActions","spaceTool","lassoTool","handTool","globalConnect","searchPad","toggle","currentSelection","aligneableElements","setColor","boundingBox","moveElements","BpmnGridSnapping","gridSnappingContext","snapLocation","SPACING","quantize","quantum","LOWER_PRIORITY","GridSnapping","setActive","snapOffset","getSnapOffset","snapConstraints","getSnapConstraints","snapEvent","isHorizontal","minResizeConstraints","maxResizeConstraints","isWest","isNorth","ResizeBehavior","gridSnapping","_gridSnapping","preExecute","snapComplex","snapSimple","snappedValue","getGridSpacing","toggleActive","snapHorizontally","snapVertically","west","east","snappedNewBounds","north","south","SpaceToolBehavior","initialized","gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior","AutoPlaceBehavior","CreateParticipantBehavior","LayoutConnectionBehavior","hasMiddleSegments","snapMiddleSegments","horizontallyAligned","verticallyAligned","snapSegment","gridSnappingAutoPlaceBehavior","gridSnappingCreateParticipantBehavior","gridSnappingLayoutConnectionBehavior","bpmnGridSnapping","LABEL_WIDTH","LABEL_HEIGHT","BpmnInteractionEvents","_interactionEvents","createParticipantHit","createDefaultHit","createSubProcessHit","removeHits","createBoxHit","bpmnInteractionEvents","BpmnKeyboardBindings","KeyboardBindings","registerBindings","keyboard","addListener","keyEvent","isCmd","hasModifier","keyboardBindings","DEFAULT_CONFIG","moveSpeed","moveSpeedAccelerated","LEFT","UP","RIGHT","DOWN","KEY_TO_DIRECTION","ArrowLeft","Left","ArrowUp","Up","ArrowRight","Right","ArrowDown","Down","DIRECTIONS_DELTA","speed","up","down","KeyboardMoveSelection","isShift","canMove","ChangeSupport","updateContainments","changeSupport","DEFAULT_MIN_WIDTH","Resize","_dragging","handleMove","handleStart","minBounds","computeMinResizeBox","handleEnd","getReferencePoint","referencePoint","getCursor","ctx","contextOrDirection","childrenBoxPadding","MARKER_RESIZING","MARKER_RESIZE_NOT_OK","ResizePreview","updateFrame","removeFrame","HANDLE_OFFSET","HANDLE_SIZE","HANDLE_HIT_SIZE","CLS_RESIZER","ResizeHandles","_resize","removeResizers","addResizer","getHandleOffset","makeDraggable","startResize","_createResizer","resizersParent","_getResizersParent","createResizer","resizer","resizePreview","resizeHandles","LabelEditingProvider","textRenderer","activateDirectEdit","isCollapsedSubProcess","_textRenderer","isExpandedSubProcess","isCollapsedPool","isExpandedPool","isEmptyText","getEditingBBox","getAbsoluteBBox","defaultStyle","getDefaultStyle","externalStyle","getExternalStyle","externalFontSize","externalLineHeight","lineHeight","defaultFontSize","defaultLineHeight","fontFamily","fontWeight","paddingTop","paddingBottom","paddingLeft","paddingRight","externalLabelMid","absoluteBBox","activeContextText","updateLabel","MARKER_HIDDEN","MARKER_LABEL_HIDDEN","LabelEditingPreview","pathMap","absoluteElementBBox","activeProvider","textPathData","getScaledPath","xScaleFactor","yScaleFactor","mx","my","d","strokeWidth","stroke","getStrokeColor","newElementHeight","defaultColor","labelEditingProvider","labelEditingPreview","ALIGNMENTS","ELEMENT_LABEL_DISTANCE","AdaptiveLabelPositioningBehavior","checkLabelAdjustment","optimalPosition","getOptimalPosition","adjustLabelPosition","elementMid","labelMid","newLabelMid","elementTrbl","moveShape","getTakenHostAlignments","freeAlignments","hostElement","hostOrientation","takenAlignments","getTakenConnectionAlignments","getApproximateOrientation","labelOrientation","isAligned","takenHostAlignments","AppendBehavior","bpmnRules","AssociationBehavior","postExecute","associations","association","moveConnection","AttachEventBehavior","shouldReplace","newHost","getEventDefinition","BoundaryEventBehavior","getBoundaryEvents","boundaryEvents","oldSource","newSource","attachedboundaryEvents","boundaryEvent","RootElementReferenceBehavior","bpmnjs","canHaveRootElementReference","hasAnyEventDefinition","hasRootElement","getDefinitions","getRootElementReferencePropertyName","setRootElement","executed","addedRootElement","reverted","referencedRootElement","CreateBehavior","HIGHEST_PRIORITY","FixHoverBehavior","CreateDataObjectBehavior","dataObject","dataObjectRef","HORIZONTAL_PARTICIPANT_PADDING","VERTICAL_PARTICIPANT_PADDING","PARTICIPANT_BORDER_WIDTH","ensureCollaboration","collaboration","makeCollaboration","process","childrenBBox","participantBounds","getParticipantBounds","getParticipantCreateConstraints","rootElementGfx","ensureHoveringProcess","oldProcessRef","processChildren","participant","hasParticipants","findParticipant","TARGET_REF_PLACEHOLDER_NAME","DataInputAssociationBehavior","usesTargetRef","targetRef","removedConnection","inputAssociations","getTargetRef","targetRefProp","cleanupTargetRef","fixTargetRef","connectionBo","targetBo","newTarget","newTargetBo","oldTarget","oldTargetBo","dataAssociation","ifDataInputAssociation","UpdateSemanticParentHandler","bpmnUpdater","_bpmnUpdater","DataStoreBehavior","getFirstParticipant","getDataStores","child","updateDataStoreParent","dataStore","newDataStoreParent","dataStoreBo","newDataStoreParentBo","newSemanticParent","newDiParent","registerHandler","dataStoreReferences","oldParent","getAncestor","isDescendant","oldRoot","newRoot","dataStores","descendant","ancestor","descendantBo","ancestorBo","oldSemanticParent","oldDiParent","updateSemanticParent","updateDiParent","DeleteLaneBehavior","compensateLaneDelete","topAdjustments","bottomAdjustments","siblings","topAffected","bottomAffected","calculateAdjustments","makeSpace","movingShapes","resizingShapes","nested","DetachEventBehavior","item","DropOnFlowBehavior","insertShape","targetFlow","positionOrBounds","waypointsBefore","waypointsAfter","dockingPoint","incomingConnection","outgoingConnection","oldOutgoing","oldIncoming","isPointInsideBBox","reconnectEnd","reconnectStart","duplicateConnections","shapeMid","newShapeMid","canInsert","EventBasedGatewayBehavior","preExecuted","existingIncomingConnections","sequenceFlow","removeConnection","newShapeTargets","newShapeTargetsIncomingSequenceFlows","sequenceFlows","incomingSequenceFlows","intermediateEvent","GroupBehavior","removeReferencedCategoryValue","removeCategory","getGroupElements","isReferenced","groupElements","lineIntersect","l1s","l1e","l2s","l2e","denominator","numerator","ImportDockingFix","adjustDocking","startPoint","nextPoint","centerIntersect","elementTop","elementLeft","verticalIntersect","horizontalIntersect","getDistance","fixDockings","p2","IsHorizontalFix","elementTypesToUpdate","vectorLength","v","getAngle","line","atan","rotateVector","vector","angle","cos","sin","solveLambaSystem","system","n","lambda","l","perpendicularFoot","bd","getDistancePointLine","pfPoint","connectionVector","getDistancePointPoint","point1","point2","sq","getAttachment","segmentStartDistance","segmentEndDistance","attachmentPosition","minDistance","attachment","attachmentDistance","closestAttachmentDistance","closestAttachment","pointsEqual","getCircleSegmentIntersections","segmentIndex","relativeLocation","s1","s2","cc","cr","baX","baY","caX","caY","bBy2","pBy2","q","disc","tmpSqrt","abScalingFactor1","abScalingFactor2","i1","i2","isPointInSegment","fenced","rangeStart","rangeEnd","EQUAL_THRESHOLD","findNewLabelLineStartIndex","oldSegmentStartIndex","newIndex","rel","relativePositionMidWaypoint","getLabelAdjustment","labelPosition","getLabelMid","oldLabelLineIndex","newLabelLineIndex","oldLabelLine","getLine","newLabelLine","oldFoot","relativeFootPosition","getRelativeFootPosition","angleDelta","getAngleDelta","oldBendpointIndex","oldBendpoint","newBendpoint","newFoot","newLabelVector","distanceSegment1","distanceSegment2","l1","l2","foot","lengthToFoot","getNewAttachPoint","oldCenter","newCenter","oldDelta","newDelta","getNewAttachShapeDelta","shapeCenter","shapeDelta","oldCenterDelta","newCenterDelta","newShapeCenter","DEFAULT_LABEL_DIMENSIONS","NAME_PROPERTY","TEXT_PROPERTY","LabelBehavior","getVisibleLabelAdjustment","startChanged","endChanged","getTextAnnotationBounds","labelCenter","labelDimensions","getExternalLabelBounds","unsetLabel","removeShape","labelBehavior","labelAdjustment","oldShape","edges","asEdges","getReferencePointDelta","newReferencePoint","lines","nearestLine","getNearestLine","distances","distance","sorted","COLLAB_ERR_MSG","PROCESS_ERR_MSG","ModelingFeedback","tooltips","showError","timeout","ReplaceConnectionBehavior","fixConnection","replacementType","canConnectSequenceFlow","canConnectMessageFlow","canConnectAssociation","replaceReconnectedConnection","replacement","cleanDraggingSelection","oldConnection","newConnection","allConnections","RemoveParticipantBehavior","collaborationRoot","participants","makeProcess","ReplaceElementBehaviour","_selection","topLevelElements","canReplace","replaceElements","replacements","unclaimId","newElements","newElementType","oldElementId","addToTrbl","choice","addMin","addMax","LANE_MIN_HEIGHT","LANE_MIN_WIDTH","LANE_RIGHT_PADDING","LANE_LEFT_PADDING","LANE_TOP_PADDING","LANE_BOTTOM_PADDING","getParticipantResizeConstraints","laneShape","resizeDirection","balanced","lanesRoot","isFirst","isLast","laneTrbl","maxTrbl","minTrbl","flowElementTrbl","PARTICIPANT_MIN_DIMENSIONS","SUB_PROCESS_MIN_DIMENSIONS","TEXT_ANNOTATION_MIN_DIMENSIONS","SLIGHTLY_HIGHER_PRIORITY","ResizeLaneBehavior","RemoveElementBehavior","inConnection","outConnection","getNewWaypoints","inWaypoints","outWaypoints","SubProcessStartEventBehavior","getStartEventPosition","ToggleElementCollapseBehaviour","hideEmptyLabels","expandedBounds","defaultSize","visibleElements","visibleBBox","filterVisible","collapsedBounds","UnclaimIdBehavior","shapeBo","unclaim","rootElementBo","UpdateFlowNodeRefsBehavior","initContext","UpdateContext","enter","getContext","releaseContext","triggerUpdate","leave","updateLaneRefs","flowNodes","lanes","laneRefUpdateEvents","updateContext","addFlowNode","counter","lane","flowNode","DeleteSequenceFlowBehavior","sourceBo","adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","rootElementReferenceBehavior","createBehavior","fixHoverBehavior","createDataObjectBehavior","createParticipantBehavior","dataInputAssociationBehavior","dataStoreBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","groupBehavior","importDockingFix","isHorizontalFix","modelingFeedback","replaceConnectionBehavior","removeParticipantBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","removeElementBehavior","toggleElementCollapseBehaviour","spaceToolBehavior","subProcessStartEventBehavior","unclaimIdBehavior","updateFlowNodeRefsBehavior","unsetDefaultFlowBehavior","getBoundaryAttachment","targetBounds","BpmnRules","canStartConnection","nonExistingOrLabel","isSame","getOrganizationalParent","isTextAnnotation","isGroup","isCompensationBoundary","isSameOrganization","parentA","parentB","isMessageFlowSource","hasEventDefinitionOrNone","isMessageFlowTarget","getScopeParent","isSameScope","scopeParentA","scopeParentB","isSequenceFlowSource","isSequenceFlowTarget","isEventBasedTarget","getParents","isParent","possibleParent","allParents","connectDataAssociation","canConnectDataAssociation","associationDirection","canDrop","isDroppableBoundaryEvent","hasNoEventDefinition","hasCommonBoundaryIntermediateEventDefinition","isBoundaryEvent","isLane","isBoundaryCandidate","hasOneOfEventDefinitions","isReceiveTaskAfterEventBasedGateway","isOneTextAnnotation","sourceTextAnnotation","targetTextAnnotation","areOutgoingEventBasedGatewayConnections","isOutgoingEventBasedGatewayConnection","connections","canAttach","OrderingProvider","ordering","getOrdering","parentIndex","newParentIndex","BpmnOrderingProvider","orders","order","level","containers","computeOrder","o","getOrder","findActualParent","actualParent","elementOrder","currentIndex","insertIndex","bpmnOrderingProvider","CommandStack","_handlerMap","_stack","_stackIdx","_currentExecution","dirty","_uid","_pushAction","_internalExecute","_popAction","_getHandler","next","_getUndoAction","_internalUndo","_getRedoAction","_setHandler","handlerCls","canUndo","canRedo","_atomicDo","_markDirty","_revertedAction","qualifier","names","cancelBubble","_createId","execution","atomic","_executedAction","baseAction","stackIdx","createRoot","setPosition","setVisible","visible","display","tooltipClass","tooltipSelector","Tooltips","_ids","_tooltipDefaults","show","minZoom","maxZoom","_tooltips","_tooltipRoot","tooltip","_addTooltip","removeTimer","htmlContainer","hide","_updateRoot","matrix","tooltipRoot","jquery","_updateTooltip","_updateTooltipVisibilty","updateViewbox","saveClear","removeFn","LabelSupport","movePreview","validatedShapes","removeLabels","enclosedElements","enclosedLabels","labelTargetIndex","labelSupport","AttachSupport","addAttached","removeAttached","getAttachers","updateAttachment","attachSupport","ToolManager","_tools","registerTool","tools","bindEvents","tool","eventsToRegister","reactivate","toolManager","getDirection","getWaypointsUpdatingConnections","waypointsUpdatingConnections","AXIS_TO_DIMENSION","CURSOR_CROSSHAIR","DIRECTION_TO_TRBL","DIRECTION_TO_OPPOSITE","PADDING","SpaceTool","_toolManager","activateMakeSpace","activateSelection","spaceToolConstraints","getSpaceToolConstraints","resizingShape","minOrMax","nonMovingResizingChildrenBBox","movingChildrenBBox","resizingShapeBBox","nonMovingResizingChildren","movingChildren","resizingShapeMinDimensions","createSpace","shapeStart","shapeEnd","MARKER_DRAGGING","SpaceToolPreview","addPreviewGfx","space","crosshairGroup","pathX","pathY","spaceLayer","movingConnections","sourceIsMoving","targetIsMoving","sourceIsResizing","targetIsResizing","frameGroup","frames","initialBounds","getBBox","opposite","spaceToolPreview","BpmnFactory","_model","_needsId","_ensureId","createDiLabel","createDiBounds","createDiShape","bpmnElement","createDiWaypoints","createDiWaypoint","createDiEdge","createDiPlane","BpmnUpdater","cropped","updateParent","reverseUpdateParent","updateRoot","updateBounds","updateConnection","updateConnectionWaypoints","ifBpmn","oldSourceBo","newSourceBo","oldConditionExpression","oldDefault","parentShape","parentBusinessObject","parentDi","updateFlowNodeRefs","_getLabel","newContainment","oldContainment","oldRefs","newRefs","updateDiConnection","planeElements","getLaneSet","laneSet","laneSets","childLaneSet","visualParent","containment","ioSpecification","diChildren","inverseSet","applyAttributes","attributeNames","applyAttribute","attributeName","AppendShapeHandler","existsConnection","CreateConnectionHandler","layouter","createBpmnElement","newEventDefinition","isFrame","isMarkerVisible","createParticipantShape","connectionParent","addConnection","CreateElementsHandler","createShapeHints","CreateShapeHandler","CreateLabelHandler","addShape","originalExecute","ensureValidDimensions","originalRevert","DeleteConnectionHandler","DeleteElementsHandler","DeleteShapeHandler","oldParentIndex","OFF_AXIS","LayoutConnectionHandler","MoveConnectionHandler","getResizedSourceAnchor","safeGetWaypoints","oldAnchor","getResizedTargetAnchor","getMovedSourceAnchor","moveDelta","substractPosition","getMovedTargetAnchor","MoveClosure","allShapes","enclosedConnections","MoveHelper","MoveElementsHandler","_helper","MoveShapeHandler","ReconnectConnectionHandler","ReplaceShapeHandler","ResizeShapeHandler","SpaceToolHandler","getAxisFromDirection","ToggleShapeCollapseHandler","getElementsVisibilityRecursive","setHiddenRecursive","newHidden","restoreVisibilityRecursive","lastState","UpdateAttachmentHandler","removeAttacher","addAttacher","UpdateWaypointsHandler","Modeling","registerHandlers","updateRange","lastIdx","rangeDiff","centerElement","refCenter","spaceInBetween","firstGroup","lastGroupIdx","lastGroup","groupsSize","refElem","groupIdx","prevGroup","isTopLevel","newClosure","moveRecursive","moveClosure","getClosure","primaryShape","keepParent","recurse","layout","sourceMoved","targetMoved","getNewParent","dockingOrPoints","layoutConnectionHints","newData","canReconnect","moveShapes","resizeShapes","isFirstWaypoint","isLastWaypoint","oldChildrenVisibility","oldHost","attacherIdx","getHandlers","DEFAULT_FLOW","ID","DI","NULL_DIMENSIONS","UpdatePropertiesHandler","isIdChange","getProperties","getDiProperties","setProperties","setDiProperties","unwrapBusinessObjects","oldProperties","updateId","newLabelBounds","referencePropertyNames","unwrappedProps","UpdateCanvasRootHandler","AddLaneHandler","_spaceTool","SplitLaneHandler","ResizeLaneHandler","newRootBusinessObject","oldRootBusinessObject","bpmnDefinitions","diPlane","location","isRoot","laneParent","existingChildLanes","allAffected","lanePosition","spacePos","adjustments","newLane","newLanesCount","existingLanesCount","laneY","laneHeight","laneBounds","newLaneAttrs","newLanesHeight","resizeBalanced","resizeSpace","change","trblDiff","FLOW_NODE_REFS_ATTR","LANES_ATTR","UpdateFlowNodeRefsHandler","IdClaimHandler","computeUpdates","flowNodeShapes","laneShapes","handledNodes","updates","participantCache","allFlowNodeShapes","isInLaneShape","addFlowNodeShape","flowNodeShape","getAllLaneShapes","getNewLanes","allLaneShapes","oldLane","claiming","DEFAULT_COLORS","SetColorHandler","colors","UpdateLabelHandler","setText","oldLabel","_bpmnRules","BaseLayouter","handlers","targetLaneShape","targetLane","collaborationElement","processElement","claimId","moddleElement","MIN_SEGMENT_LENGTH","POINT_ORIENTATION_PADDING","ORIENTATION_THRESHOLD","needsTurn","startDirection","h","canLayoutStraight","targetOrientation","getSegmentBendpoints","segmentDirections","xmid","ymid","layoutStraight","layoutHorizontal","layoutTurn","turnNextDirections","getBendpoints","getStartSegment","getEndSegment","invertedSegment","invertDirections","getMidSegment","startSegment","endSegment","endDirection","getSimpleBendpoints","isValidDirections","isExplicitDirections","midSegment","connectPoints","withoutRedundantPoints","connectRectangles","preferredLayouts","preferredLayout","getDirections","directionSplit","startDocking","getDockingPoint","invertOrientation","endDocking","repairConnection","repairedWaypoints","preferStraight","tryLayoutStraight","tryRepairConnectionEnd","tryRepairConnectionStart","inRange","isInRange","primaryAxis","preserveDocking","moved","newDocking","_tryRepairConnectionSide","needsRelayout","repairBendpoint","candidate","oldPeer","newPeer","removeOverlapping","slicedPoints","oldDocking","newPoints","defaultLayout","rectangle","dockingDirection","ATTACH_ORIENTATION_PADDING","BOUNDARY_TO_HOST_THRESHOLD","oppositeOrientationMapping","orientationDirectionMapping","BpmnLayouter","getAttachOrientation","attachedElement","getMessageFlowManhattanOptions","getMessageFlowPreserveDocking","getConnectionDocking","isCompensationAssociation","isAnyOrientation","orientations","getHorizontalOrientation","matches","getVerticalOrientation","isOppositeOrientation","isOppositeHorizontalOrientation","horizontalOrientation","oppositeHorizontalOrientation","isOppositeVerticalOrientation","verticalOrientation","oppositeVerticalOrientation","isHorizontalOrientation","getLoopPreferredLayout","getBoundaryEventPreferredLayouts","sourceLayout","targetLayout","targetMid","attachOrientation","attachedToSide","getBoundaryEventLoopLayout","getBoundaryEventSourceLayout","getBoundaryEventTargetLayout","shouldConnectToSameSide","areCloseOnAxis","dockingToPoint","actual","CroppingConnectionDocking","manhattanOptions","updatedWaypoints","sourceDocking","targetDocking","dockStart","dockingIdx","croppedPoint","_getIntersection","takeFirst","shapePath","_getShapePath","_getConnectionPath","_getGfx","MEDIUM_PRIORITY","MoveEvents","removeNested","isAttach","MovePreview","getVisualDragShapes","getAllDraggedElements","removeEdges","allDraggedElements","dragShapes","visuallyDraggedShapes","differentParents","haveDifferentParents","TOGGLE_SELECTOR","ENTRY_SELECTOR","ELEMENT_SELECTOR","PALETTE_OPEN_CLS","PALETTE_TWO_COLUMN_CLS","Palette","updateToolHighlight","_update","_diagramInitialized","_rebuild","addPaletteEntries","getPaletteEntries","parentContainer","_getParentContainer","HTML_MARKUP","_layoutChanged","_toggleState","twoColumn","_needsCollapse","clientHeight","_entries","separator","availableHeight","entriesHeight","isActiveTool","_activeTool","toolsContainer","_toolsContainer","toolClasses","contains","LASSO_TOOL_CURSOR","LassoTool","visuals","SVGElement","activateLasso","toBBox","HAND_CURSOR","HandTool","activateMove","deactivateMove","isSpace","removeListener","activateHand","GlobalConnect","startTarget","canStartConnect","PaletteProvider","_palette","_lassoTool","_handTool","_globalConnect","createAction","createListener","shortType","createSubprocess","subProcess","startEvent","autoSelect","createParticipant","paletteProvider","BpmnReplacePreview","replaceVisual","visualReplacements","tempShape","restoreVisual","originalGfx","bpmnReplacePreview","TARGET_BOUNDS_PADDING","TASK_BOUNDS_PADDING","TARGET_CENTER_PADDING","AXES","BpmnConnectSnapping","initialConnectionStart","snapToShape","getTargetBoundsPadding","isAnyType","snapToPosition","snapToTargetMid","snapBoundaryEventLoop","dimensionForAxis","getDimensionForAxis","isMid","axes","newCoordinate","coordinate","SnapContext","_targets","_snapOrigins","_snapLocations","_defaultSnaps","SnapPoints","defaultSnaps","_snapValues","getSnapOrigin","setSnapOrigin","initialValue","addDefaultSnap","snapValues","getSnapLocations","setSnapLocations","snapLocations","pointsForTarget","targetId","initDefaults","snap","snappingValues","CreateMoveSnapping","snapping","initSnap","snapContext","addSnapTargetPoints","isHidden","shapeTopLeft","shapeBottomRight","snapTargets","getSnapTargets","snapTarget","BpmnCreateMoveSnapping","setSnappedIfConstrained","snapBoundaryEvent","targetTRBL","areAll","isContainer","getDockingSnapOrigin","isMove","ResizeSnapping","isVertical","snapOrigin","isAttached","SNAP_TOLERANCE","SNAP_LINE_HIDE_DELAY","Snapping","_asyncHide","snapCurrent","locationSnapping","originValue","showSnapLine","axisSnapping","_createLine","_createSnapLines","_snapLines","getSnapLine","snapLine","createMoveSnapping","resizeSnapping","connectSnapping","SearchPad","_open","_results","_eventMaps","BOX_HTML","_searchInput","INPUT_SELECTOR","_resultsContainer","RESULTS_CONTAINER_SELECTOR","constructOverlay","box","OVERLAY_CLASS","createInnerTextNode","tokens","createHtmlText","htmlText","matched","RESULT_HIGHLIGHT_CLASS","normal","_bindEvents","listen","selector","focus","RESULT_SELECTOR","_scrollToNode","_preselect","_select","selected","_getCurrentResult","_scrollToDirection","_search","_unbindEvents","_clearResults","searchResults","_searchProvider","_createResultNode","previousElementSibling","nextElementSibling","nodeOffset","containerScroll","scrollTop","bottomScroll","_resetOverlay","RESULT_SELECTED_SELECTOR","RESULT_HTML","primaryTokens","RESULT_PRIMARY_HTML","secondaryTokens","RESULT_SECONDARY_HTML","RESULT_ID_ATTRIBUTE","blur","selectedNode","RESULT_SELECTED_CLASS","_centerViewbox","newViewbox","overlay","CONTAINER_SELECTOR","BpmnSearchProvider","hasMatched","matchAndSplit","originalText","substr","bpmnSearch","initialDiagram","Modeler","Viewer","NavigatedViewer","createDiagram","importXML","_interactionModules","_modelingModules","_modules","linting","toggleLinting","ErrorSvg","WarningSvg","SuccessSvg","OFFSET_TOP","OFFSET_RIGHT","emptyConfig","stateToIcon","warning","inactive","Linting","_bpmnjs","_issues","_linterConfig","_overlayIds","_clearIssues","_updateButton","linterConfig","bpmnlint","getLinterConfig","setLinterConfig","_createButton","_formatIssues","issues","ruleReports","newActive","_setActive","lintStart","_lintStart","random","newIssues","id1","id2","_clearOverlays","_createIssues","_fireComplete","_createElementIssues","elementId","elementIssues","menuPosition","issuesByType","elementIssue","errors","warnings","warn","$html","$icon","$dropdown","$dropdownContent","$issues","$issueList","_addErrors","_addWarnings","$ul","_addEntry","icon","$entry","_setButtonState","_button","classList","issue","linter","lintingEditorActions","Resolver","bundle","xmlStr","$store","BpmnXml","isCollapse","bpmnModeler","components","fileLoader","methods","initBpmn","propertiesPanel","additionalModules","bpmnFile","saveXML","saveSVG","download","setAttribute","filename","bjslButton","$msgbox","showInput","inputType","confirmButtonText","beforeClose","instance","confirmButtonLoading","_param","axios","method","mounted","activated","component","hashClear","findExtension","findExtensions","CAMUNDA_SERVICE_TASK_LIKE","ChangeElementTemplateHandler","getOrCreateExtensionElements","updateModelerTemplate","updateIoMappings","oldMappings","newMappings","createInputOutputMappings","updateCamundaField","createCamundaFieldInjections","field","updateCamundaProperties","createCamundaProperties","createBpmnPropertyUpdates","newPropertiesCount","updateInOut","oldInOut","newInOut","createCamundaInOut","inout","updateExecutionListener","oldExecutionsListeners","newExecutionListeners","createCamundaExecutionListeners","executionListener","updateScopeElements","scopeDefinition","scopeElement","oldScope","propertyUpdates","propertyValue","bindingTarget","language","injections","inOuts","toFinite","toInteger","remainder","multiInstanceLoopCharacteristics","jobRetryTimeCycle","asyncContinuation","getLoopCharacteristics","ensureMultiInstanceSupported","labelPrefix","defaultParameters","canBeShown","isShown","toObject","callWithSafeIterationClosing","isArrayIteratorMethod","toLength","createProperty","getIteratorMethod","arrayLike","step","iterator","O","C","argumentsLength","mapfn","mapping","iteratorMethod","getWrapDetails","insertWrapDetails","updateWrapDetails","setWrapToString","isAsyncBefore","isAsyncAfter","isExclusive","getFailedJobRetryTimeCycle","removeFailedJobRetryTimeCycle","retryTimeCycles","cycle","arrayAggregator","baseIteratee","initializer","arrayEach","isArr","isArrLike","baseTimes","eventDefinitionReference","elementReferenceProperty","elementName","referenceProperty","newElementIdPrefix","shouldValidate","UpdateBusinessObjectListHandler","previousList","listCopy","parentObject","ModelUtil","implementationTypeHelper","elems","getParameters","stackHas","showErrorCodeVariable","showErrorMessageVariable","modelPropertyValue","setValue","domAttr","updateSelection","TABLE_ROW_DIV_SNIPPET","DELETE_ROW_BUTTON_SNIPPET","createInputRowTemplate","canRemove","createInputTemplate","columns","createLabelRowTemplate","createLabelTemplate","pick","oldValues","valueEqual","oldValue","allKeys","getEntryNode","selectionStart","selectionEnd","labelRow","canAdd","canUpdate","setControlValue","boElements","__invalidValues","invalidValues","__action","valuesToValidate","createListEntryTemplate","scopeNode","deleteElement","rowToDelete","rowNode","showTable","validateListItem","isReadOnly","activeElement","baseFlatten","isStrict","findIndexFunc","iterable","containerElement","boResultVariable","scriptResultVariable","listCacheDelete","listCacheGet","listCacheHas","listCacheSet","ListCache","maxInt","tMin","tMax","skew","damp","initialBias","initialN","delimiter","regexNonASCII","regexSeparators","OVERFLOW_ERROR","baseMinusTMin","stringFromCharCode","fromCharCode","ucs2decode","extra","digitToBasic","digit","adapt","numPoints","firstTime","encode","currentValue","inputLength","bias","basicLength","handledCPCount","handledCPCountPlusOne","RangeError","qMinusT","baseMinusT","encoded","divider","labelText","showLabel","MAX_ARRAY_LENGTH","__wrapped__","__actions__","__dir__","__filtered__","__iteratees__","__takeCount__","__views__","webpackPolyfill","deprecate","paths","toNumber","INFINITY","MAX_INTEGER","sign","baseIsMatch","baseMatches","matchData","isConditionalSource","conditionType","conditionLanguage","conditionOrConditionExpression","conditionProps","validationResult","isExpression","canClear","CONDITIONAL_SOURCES","requireObjectCoercible","createMethod","CONVERT_TO_STRING","$this","S","castPath","baseGet","jobPriorityEntry","jobPriority","assocIndexOf","customElementsPropertiesActivator","elementTemplatesLoader","flowKey","keyed","outgoingReported","incomingReported","sourceId","arrayProto","lastIndex","composeArgs","countHolders","reorder","WRAP_BIND_KEY_FLAG","WRAP_CURRY_FLAG","WRAP_CURRY_RIGHT_FLAG","WRAP_ARY_FLAG","WRAP_FLIP_FLAG","partialsRight","holdersRight","argPos","ary","isAry","isBind","isBindKey","isFlip","holdersCount","newHolders","traverse","containedProperties","isAttr","isMany","isIndex","arrayLikeKeys","inherited","isArg","isBuff","skipIndexes","tasklist","createBaseFor","getLinkEventDefinition","linkEventDefinition","linkEvents","constant","ElementTemplatesLoader","loadTemplates","_loadTemplates","_elementTemplates","reload","templateErrors","setTemplates","validator","validTemplates","templatesChanged","baseIsTypedArray","nodeUtil","nodeIsTypedArray","selectEntryFactory","comboBox","customValue","customName","isCustomValue","isCustom","comboOptions","showCustomInput","modifiedValues","comboBoxEntry","arrayTag","funcTag","float32Tag","float64Tag","int8Tag","int16Tag","int32Tag","uint8Tag","uint8ClampedTag","uint16Tag","uint32Tag","typedArrayTags","externalTaskPriority","objectCreate","proto","baseToString","getSelectBox","currentTab","generateElementId","CREATE_EXTENSION_ELEMENT_ACTION","REMOVE_EXTENSION_ELEMENT_ACTION","idGeneration","hideElements","hideExtensionElements","canBeHidden","selectionChanged","createOption","initSelectionSize","optionsLength","extensionElementValue","generatedId","disableRemove","selectElement","hashHas","getListeners","CAMUNDA_EXECUTION_LISTENER_ELEMENT","CAMUNDA_TASK_LISTENER_ELEMENT","executionListenerEntry","taskListenerEntry","listeners","initialEvent","getDefaultTemplate","applyDefaultTemplate","commandContext","mapCacheClear","mapCacheDelete","mapCacheHas","MapCache","Stack","equalObjects","baseIsEqualDeep","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","Hash","calculateUpdate","newValue","currentCursor","newCursor","currentTail","lastIndexOf","createDiff","newStart","newEnd","l_str","l_char","s_str","s_char","l_idx","s_idx","l_start","s_start","l_end","s_end","baseGetAllKeys","keysFunc","symbolsFunc","stackClear","stackGet","stackSet","setCacheAdd","asyncCapableHelper","processProps","eventProps","linkProps","documentationProps","idProps","nameProps","executableProps","serviceTaskDelegateProps","userTaskProps","asynchronousContinuationProps","callActivityProps","multiInstanceProps","conditionalProps","scriptProps","errorProps","formProps","startEventInitiator","variableMapping","listenerProps","listenerDetails","listenerFields","elementTemplateChooserProps","elementTemplateCustomProps","inputOutputParameter","connectorDetails","connectorInputOutput","connectorInputOutputParameter","jobConfiguration","candidateStarter","externalTaskConfiguration","fieldInjections","isExternalTaskPriorityEnabled","externalBo","isExternalTask","isJobConfigEnabled","getInputOutputParameterLabel","getListenerLabel","PROCESS_KEY_HINT","TASK_KEY_HINT","createGeneralTabGroups","idOptions","processOptions","generalGroup","processIdDescription","customFieldsGroups","detailsGroup","multiInstanceGroup","asyncGroup","jobConfigurationGroup","enabled","externalTaskGroup","candidateStarterGroup","historyTimeToLiveGroup","tasklistGroup","documentationGroup","createVariablesTabGroups","variablesGroup","createFormsTabGroups","formGroup","createListenersTabGroups","listenersGroup","listenerDetailsGroup","listenerFieldsGroup","createInputOutputTabGroups","inputOutputGroup","inputOutputParameterGroup","createConnectorTabGroups","connectorDetailsGroup","connectorInputOutputGroup","connectorInputOutputParameterGroup","createFieldInjectionsTabGroups","fieldGroup","createExtensionElementsGroups","propertiesGroup","CamundaPropertiesProvider","getTabs","generalTab","variablesTab","formsTab","listenersTab","inputOutputTab","connectorTab","fieldInjectionsTab","extensionsTab","HANDLERS","CommandInitializer","escapeText","escaped","encodeURI","toPrimitive","definePropertyModule","createPropertyDescriptor","propertyKey","f","hasPath","getBody","getLoopCardinality","getLoopCardinalityValue","loopCardinality","getCompletionCondition","getCompletionConditionValue","completionCondition","getCollection","getElementVariable","updateFormalExpression","expressionProps","existingExpression","isValid","notification","elementVariable","createBind","canBeDisabled","res","isDisabled","copyObject","isNew","arg","baseFilter","collectionAdd","CategoryHelper","eachFunc","asyncTag","genTag","proxyTag","DEFAULT_DELEGATE_PROPS","DELEGATE_PROPS","DMN_CAPABLE_PROPS","EXTERNAL_CAPABLE_PROPS","DEFAULT_OPTIONS","DMN_OPTION","EXTERNAL_OPTION","CONNECTOR_OPTION","SCRIPT_OPTION","getType","hasScriptSupport","implType","connectors","participantHelper","idEntry","getProcessBusinessObject","processId","modifyProcessBusinessObject","processIdError","processNameEntry","noCustomizer","FormHelper","getFormData","formData","getFormFields","fields","getFormField","formFields","getConstraints","formField","validation","constraints","getEnumValues","baseMap","getBuiltIn","redefineAll","createIteratorConstructor","hasOwn","classof","anObject","getIterator","$fetch","Headers","URL_SEARCH_PARAMS","URL_SEARCH_PARAMS_ITERATOR","getInternalParamsState","getInternalIteratorState","plus","sequences","percentSequence","bytes","percentDecode","sequence","decodeURIComponent","deserialize","it","replacer","serialize","parseSearchParams","attribute","attributes","validateArgumentsLength","passed","required","URLSearchParamsIterator","params","kind","URLSearchParamsConstructor","entryIterator","entryNext","URLSearchParamsPrototype","found","entriesIndex","sliceIndex","callback","boundFunction","fetch","headers","freeProcess","require","findInputParameter","findOutputParameter","findCamundaProperty","findCamundaInOut","CAMUNDA_EXECUTION_LISTENER_TYPE","BASIC_MODDLE_TYPES","EXTENSION_BINDING_TYPES","IO_BINDING_TYPES","IN_OUT_BINDING_TYPES","propertyGetter","getPropertyValue","objectWithKey","propertySetter","setPropertyValue","propertyValidator","validateValue","camundaProperties","camundaProperty","ioParameter","ioElement","bindingName","unknownPropertyBinding","existingCamundaProperty","newCamundaProperty","existingIoParameter","newIoParameter","existingInOut","moddlePropertyDescriptor","propertiesByName","moddleType","existingFieldInjections","newFieldInjections","notEmpty","minLength","matchesPattern","propertyWithScope","regexp","renderCustomField","propertyType","entryOptions","customFieldsGroup","idScopeName","customScopeFieldsGroup","propertyId","scopedProperty","createExtensionElements","createFailedJobRetryTimeCycle","retryTimeCycleEntry","retryTimeCycle","newCycle","getScriptType","parentElement","scriptLanguagePropName","scriptValuePropName","isFormatRequired","boScriptResource","boScript","boScriptFormat","scriptResourceValue","scriptType","scriptValue","clearScriptFormat","btnNode","canClearScriptFormat","clearScriptResource","canClearScriptResource","clearScript","canClearScript","isScriptResource","Reporter","messages","arrLength","othLength","arrValue","othValue","compared","othIndex","baseSetToString","getContainedActivities","getFlowElements","getContainedBoundaryEvents","isCompensationEventAttachedToActivity","activity","activityId","canActivityBeCompensated","getActivitiesForCompensation","getActivitiesForActivityRef","activitiesForActivityRef","createActivityRefOptions","activities","waitForCompletion","activityRef","DELEGATE_TYPES","PROPERTIES","isDelegate","getDelegationLabel","delegateEntry","delegationLabel","nativeMin","oldArray","validationErrors","getAllKeys","isList","isMap","typeInfo","nameValue","parameterType","createParameterTypeElem","items","newEntry","PLACEHOLDER","WRAP_CURRY_BOUND_FLAG","WRAP_REARG_FLAG","mergeData","srcBitmask","newBitmask","isCombo","resultVariableEntry","FUNC_ERROR_TEXT","debounce","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","invokeFunc","time","leadingEdge","timerExpired","remainingWait","timeSinceLastCall","timeSinceLastInvoke","timeWaiting","shouldInvoke","trailingEdge","flush","debounced","isInvoking","objProps","objLength","othProps","skipCtor","objCtor","othCtor","isCatchingErrorEvent","MAX_SAFE_INTEGER","baseSetData","outgoingWithoutCondition","isSymbol","NAN","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","isBinary","versionTagEntry","processBo","propertiesEntry","reWrapDetails","reSplitDetails","hashGet","disallowNodeType","externalTaskPriorityEntry","taskPriority","defaultButtonAction","defaultButtonShow","buttonLabel","buttonAction","actionMethod","showName","buttonShow","showMethod","documentations","documentation","newObjectList","elementDocuEntry","processDocuEntry","isEventSubProcess","isConditionalStartEvent","reIsUint","CreateAndReferenceElementHandler","referencingObject","newObject","newObjectContainer","newObjectParent","referencedObject","previousReference","blankStartEvents","shortOut","clone","__chain__","__index__","__values__","getCamundaInOutMappings","getVariableMappings","camundaMappings","getInOutType","inOutType","CAMUNDA_IN_EXTENSION_ELEMENT","CAMUNDA_OUT_EXTENSION_ELEMENT","WHITESPACE_REGEX","inOutTypeOptions","inEntry","outEntry","variableMappings","mappingValue","mappingType","variablesMappings","sourceLabel","selectedMapping","exportName","VENDOR_PREFIXES","TEST_ELEMENT","TYPE_FUNCTION","setTimeoutContext","bindFn","invokeArrayArg","each","deprecationMessage","nextKey","extend","dest","src","merge","inherit","childP","baseP","_super","boolOrFn","ifUndefined","val1","val2","addEventListeners","splitStr","removeEventListeners","hasParent","inStr","inArray","findByKey","uniqueArray","results","prefixed","camelProp","toUpperCase","_uniqueId","uniqueId","getWindowForElement","doc","ownerDocument","defaultView","parentWindow","MOBILE_REGEX","SUPPORT_TOUCH","SUPPORT_POINTER_EVENTS","SUPPORT_ONLY_TOUCH","navigator","userAgent","INPUT_TYPE_TOUCH","INPUT_TYPE_PEN","INPUT_TYPE_MOUSE","INPUT_TYPE_KINECT","COMPUTE_INTERVAL","INPUT_START","INPUT_MOVE","INPUT_END","INPUT_CANCEL","DIRECTION_NONE","DIRECTION_LEFT","DIRECTION_RIGHT","DIRECTION_UP","DIRECTION_DOWN","DIRECTION_HORIZONTAL","DIRECTION_VERTICAL","DIRECTION_ALL","PROPS_XY","PROPS_CLIENT_XY","Input","manager","inputTarget","domHandler","ev","enable","createInputInstance","Type","PointerEventInput","TouchMouseInput","MouseInput","inputHandler","pointersLen","pointers","changedPointersLen","changedPointers","isFinal","computeInputData","recognize","prevInput","pointersLength","firstInput","simpleCloneInputData","firstMultiple","offsetCenter","getCenter","timeStamp","deltaTime","computeDeltaXY","offsetDirection","overallVelocity","getVelocity","overallVelocityX","overallVelocityY","getScale","rotation","getRotation","maxPointers","computeIntervalInputData","offsetDelta","prevDelta","velocity","velocityX","velocityY","lastInterval","atan2","PI","evEl","evTarget","evWin","MOUSE_INPUT_MAP","mousedown","mousemove","mouseup","MOUSE_ELEMENT_EVENTS","MOUSE_WINDOW_EVENTS","pressed","pointerType","POINTER_INPUT_MAP","pointerdown","pointermove","pointerup","pointercancel","pointerout","IE10_POINTER_TYPE_ENUM","3","4","5","POINTER_ELEMENT_EVENTS","POINTER_WINDOW_EVENTS","store","MSPointerEvent","PointerEvent","removePointer","eventTypeNormalized","storeIndex","pointerId","SINGLE_TOUCH_INPUT_MAP","touchstart","touchmove","touchend","touchcancel","SINGLE_TOUCH_TARGET_EVENTS","SINGLE_TOUCH_WINDOW_EVENTS","SingleTouchInput","started","normalizeSingleTouches","touches","changedTouches","TOUCH_INPUT_MAP","TOUCH_TARGET_EVENTS","targetIds","getTouches","allTouches","identifier","targetTouches","changedTargetTouches","touch","DEDUP_TIMEOUT","DEDUP_DISTANCE","primaryTouch","lastTouches","recordTouches","eventData","setLastTouch","lastTouch","lts","removeLastTouch","isSyntheticEvent","inputEvent","inputData","isMouse","sourceCapabilities","firesTouchEvents","PREFIXED_TOUCH_ACTION","NATIVE_TOUCH_ACTION","TOUCH_ACTION_COMPUTE","TOUCH_ACTION_AUTO","TOUCH_ACTION_MANIPULATION","TOUCH_ACTION_NONE","TOUCH_ACTION_PAN_X","TOUCH_ACTION_PAN_Y","TOUCH_ACTION_MAP","getTouchActionProps","TouchAction","cleanTouchActions","hasPanX","hasPanY","touchMap","cssSupports","CSS","supports","compute","touchAction","getTouchAction","preventDefaults","prevented","hasNone","isTapPointer","isTapMovement","isTapTouchTime","preventSrc","STATE_POSSIBLE","STATE_BEGAN","STATE_CHANGED","STATE_ENDED","STATE_RECOGNIZED","STATE_CANCELLED","STATE_FAILED","Recognizer","defaults","simultaneous","requireFail","stateStr","directionStr","getRecognizerByNameIfManager","otherRecognizer","AttrRecognizer","PanRecognizer","pX","pY","PinchRecognizer","PressRecognizer","_timer","_input","RotateRecognizer","SwipeRecognizer","TapRecognizer","pTime","pCenter","Hammer","preset","recognizeWith","dropRecognizeWith","dropRequireFailure","hasRequireFailures","canRecognizeWith","additionalEvent","tryEmit","canEmit","inputDataClone","attrTest","optionPointers","isRecognized","directionTest","hasMoved","inOut","validPointers","validMovement","validTime","interval","posThreshold","validTouchTime","failTimeout","validInterval","validMultiTap","tapCount","VERSION","domEvents","cssProps","userSelect","touchSelect","touchCallout","contentZooming","userDrag","tapHighlightColor","STOP","FORCED_STOP","oldCssProps","toggleCssProps","triggerDomEvent","gestureEvent","gesture","existing","Swipe","Rotate","isForking","leftIndex","leftLength","symbolToString","createPartial","pairs","domQueryAll","queryAll","domRemove","domDelegate","domMatches","scrollTabs","HIDE_CLASS","DEBOUNCE_DELAY","isToggle","isSelect","isContentEditable","getPropertyPlaceholders","placeholders","getFormControls","controls","getFormControlValuesInScope","controlNodes","controlNode","checked","getFormControlValues","listContainer","listNodes","listNode","valuesEqual","extractEntries","tabs","extractGroups","PropertiesPanel","_propertiesProvider","isImplicitRoot","tabBarNode","scroller","selectors","tabsContainer","tab","ignore","newActiveNode","oldActiveNode","linkNode","tabId","activateTab","detach","_bindListeners","attachTo","panelNode","panel","allTabNodes","allTabLinkNodes","tabNode","currentTabId","tabLinkNode","tabLink","needsCreate","newTabs","_entriesChanged","activeTabId","activeTabNode","_updateActivation","oldEntryIds","newEntryIds","handleChange","getEntry","onChangeAction","isEntryDirty","executeAction","applyChanges","updateState","handleInput","eventHandlerId","actionId","updateShow","updateDisable","showNodes","showNode","expr","shouldShow","currentNode","shouldDisable","commandToExecute","applyValidationErrors","valid","errorMessageNode","nextSibling","listEntryNodes","listValue","listEntryNode","setInputValue","contentEditable","setSelectValue","setToggleValue","nodeValue","setTextValue","getContentEditableSelection","focusNode","focusOffset","anchorOffset","setContentEditableSelection","domRange","domSelection","containerNode","_createPanel","_bindTemplate","inputNodes","isGroupVisible","groupNode","isTabVisible","toggleVisible","checkActiveTabVisibility","labelNode","tabVisible","groupVisible","listEntryContainer","existingElements","listItemNode","entriesToRemove","j","headerNode","tabLinksNode","tabContainerNode","tabIndex","querySelector","cssClass","MultiCommandHandler","hasStartEvent","EventDefinitionHelper","setCacheHas","reWrapComment","details","ParticipantHelper","DOMIterables","ArrayIteratorMethods","createNonEnumerableProperty","TO_STRING_TAG","ArrayValues","COLLECTION_NAME","Collection","CollectionPrototype","METHOD_NAME","selectbox","inputName","UpdateBusinessObjectHandler","referenceType","extensionsElementHelper","isListener","decisionRef","hasFunc","canRemoveFailedJobRetryTimeCycle","asyncBeforeEntry","asyncBefore","asyncAfterEntry","asyncAfter","exclusiveEntry","exclusive","matcher","isInOut","parameters","memoized","Cache","basePropertyDeep","setData","WRAP_PARTIAL_RIGHT_FLAG","wrapFunc","isCurry","newHoldersRight","newPartials","newPartialsRight","escape","cssEscape","codeUnit","firstCodeUnit","textInputField","checkboxField","selectBoxField","comboBoxField","textBoxField","validationAwareTextInputField","tableField","labelEntry","setDefaultParameters","defaultGet","defaultSet","defaultValidate","EntryFactory","chainAll","baseProperty","formHelper","generateValueId","formFieldTextField","getSelectedFormField","selectedFormField","ensureFormKeyAndDataSupported","formKey","formFieldsEntry","formBusinessKeyFormFieldEntry","formDataExtension","storedValue","isStartEvent","existingFormField","enumValue","newConstraint","constraint","currentConstraint","isStartableInTasklistEntry","isStartableInTasklist","executableEntry","HOT_COUNT","HOT_SPAN","nativeNow","lastCalled","stamp","remaining","codeVariable","escalationCodeVariable","reIsDeepProp","reIsPlainProp","findElementById","selectedElement","optionTemplate","CAMUNDA_FIELD_EXTENSION_ELEMENT","getSelectedField","fieldEntry","getCamundaFields","getCamundaListenerFields","getFieldType","fieldType","expressionValue","stringValue","camundaFields","newFieldElem","selectedField","fieldName","fieldTypeOptions","fieldValue","__lastInvalidValue","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DOMTokenList","DataTransferItemList","FileList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList","wrapFlags","pair","mitt","scrollSymbolLeft","scrollSymbolRight","ScrollTabs","$el","_createScrollButtons","__scrollTabs","getActiveTabNode","getTabsContainerNode","getAllTabNodes","getVisibleTabs","allTabs","getAdjacentTab","referenceTabNode","visibleTabs","_bindWheelEvent","_bindTabClickEvents","_bindScrollButtonEvents","scrollToTabNode","oldActiveTab","newActiveTab","oldActiveTabNode","newActiveTabNode","tabsContainerNode","tabWidth","offsetWidth","tabOffsetLeft","tabOffsetRight","containerScrollLeft","scrollLeft","overflowClass"],"mappings":"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","file":"js/chunk-bd933b0a.e338e74c.js","sourcesContent":["'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar find = require('min-dash').find;\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../helper/CmdHelper'),\n    ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper'),\n    scriptImplementation = require('./implementation/Script'),\n    timerImplementation = require('../../bpmn/parts/implementation/TimerEventDefinition');\n\nmodule.exports = function(group, element, bpmnFactory, options, translate) {\n\n  var LISTENER_TYPE_LABEL = {\n    class: translate('Java Class'),\n    expression: translate('Expression'),\n    delegateExpression: translate('Delegate Expression'),\n    script: translate('Script')\n  };\n\n  options = options || {};\n\n  var getSelectedListener = options.getSelectedListener;\n\n  var classProp = 'class',\n      expressionProp = 'expression',\n      delegateExpressionProp = 'delegateExpression',\n      scriptProp = 'script';\n\n  var executionListenerEventTypeOptions = ImplementationTypeHelper.isSequenceFlow(element) ? [\n    { name: translate('take'), value: 'take' }\n  ] : [\n    { name: translate('start'), value: 'start' },\n    { name: translate('end'), value: 'end' }\n  ];\n\n  var taskListenerEventTypeOptions = [\n    { name: translate('create'), value: 'create' },\n    { name: translate('assignment'), value: 'assignment' },\n    { name: translate('complete'), value: 'complete' },\n    { name: translate('delete'), value: 'delete' },\n    { name: translate('update'), value: 'update' },\n    { name: translate('timeout'), value: 'timeout' }\n  ];\n\n  var isSelected = function(element, node) {\n    return getSelectedListener(element, node);\n  };\n\n\n  // eventType ////////////////\n  group.entries.push(entryFactory.selectBox({\n    id: 'listener-event-type',\n    label: translate('Event Type'),\n    modelProperty: 'eventType',\n    emptyParameter: false,\n\n    get: function(element, node) {\n\n      var listener = getSelectedListener(element, node);\n\n      var eventType = listener && listener.get('event');\n\n      return {\n        eventType: eventType\n      };\n    },\n\n    set: function(element, values, node) {\n      var eventType = values.eventType,\n          listener = getSelectedListener(element, node),\n          eventDefinitions = listener && listener.eventDefinitions;\n\n      // ensure only timeout events can have timer event definitions\n      if (eventDefinitions && eventType !== 'timeout') {\n        eventDefinitions = [];\n      }\n\n      return cmdHelper.updateBusinessObject(element, listener,\n        {\n          event: eventType,\n          eventDefinitions: eventDefinitions\n        }\n      );\n    },\n\n    selectOptions: function(element, node) {\n      var eventTypeOptions;\n\n      var selectedListener = getSelectedListener(element, node);\n      if (ImplementationTypeHelper.isTaskListener(selectedListener)) {\n        eventTypeOptions = taskListenerEventTypeOptions;\n      } else if (ImplementationTypeHelper.isExecutionListener(selectedListener)) {\n        eventTypeOptions = executionListenerEventTypeOptions;\n      }\n\n      return eventTypeOptions;\n\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  // listenerId ///////////////\n  group.entries.push(entryFactory.textField({\n    id: 'listener-id',\n    label: translate('Listener Id'),\n    modelProperty: 'listenerId',\n\n    get: function(element, node) {\n      var value = {},\n          listener = getSelectedListener(element, node);\n\n      value.listenerId = (listener && listener.get('id')) || undefined;\n\n      return value;\n    },\n\n    set: function(element, values, node) {\n      var update = {},\n          listener = getSelectedListener(element, node);\n\n      update['id'] = values.listenerId || '';\n\n      return cmdHelper.updateBusinessObject(element, listener, update);\n    },\n\n    hidden: function(element, node) {\n      var listener = getSelectedListener(element, node);\n\n      return !ImplementationTypeHelper.isTaskListener(listener);\n    },\n\n    validate: function(element, values, node) {\n      var value = values.listenerId,\n          listener = getSelectedListener(element, node),\n          validate = {};\n\n      if (!value && isTimeoutTaskListener(listener)) {\n        validate.listenerId = translate('Must provide a value for timeout task listener');\n      }\n\n      return validate;\n    }\n\n  }));\n\n\n  // listenerType ///////////////\n  group.entries.push(entryFactory.selectBox({\n    id: 'listener-type',\n    label: translate('Listener Type'),\n    selectOptions: [\n      { value: classProp, name: translate('Java Class') },\n      { value: expressionProp, name: translate('Expression') },\n      { value: delegateExpressionProp, name: translate('Delegate Expression') },\n      { value: scriptProp, name: translate('Script') }\n    ],\n    modelProperty: 'listenerType',\n    emptyParameter: false,\n\n    get: function(element, node) {\n      var listener = getSelectedListener(element, node);\n      return {\n        listenerType: ImplementationTypeHelper.getImplementationType(listener)\n      };\n    },\n\n    set: function(element, values, node) {\n      var listener = getSelectedListener(element, node),\n          listenerType = values.listenerType || undefined,\n          update = {};\n\n      update[classProp] = listenerType === classProp ? '' : undefined;\n      update[expressionProp] = listenerType === expressionProp ? '' : undefined;\n      update[delegateExpressionProp] = listenerType === delegateExpressionProp ? '' : undefined;\n      update[scriptProp] = listenerType === scriptProp ? bpmnFactory.create('camunda:Script') : undefined;\n\n      return cmdHelper.updateBusinessObject(element, listener, update);\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  // listenerValue //////////////\n  group.entries.push(entryFactory.textField({\n    id: 'listener-value',\n    dataValueLabel: 'listenerValueLabel',\n    modelProperty: 'listenerValue',\n\n    get: function(element, node) {\n      var value = {},\n          listener = getSelectedListener(element, node),\n          listenerType = ImplementationTypeHelper.getImplementationType(listener);\n\n      value.listenerValueLabel = LISTENER_TYPE_LABEL[listenerType] || '';\n      value.listenerValue = (listener && listener.get(listenerType)) || undefined;\n\n      return value;\n    },\n\n    set: function(element, values, node) {\n      var update = {},\n          listener = getSelectedListener(element, node),\n          listenerType = ImplementationTypeHelper.getImplementationType(listener);\n\n      update[listenerType] = values.listenerValue || '';\n\n      return cmdHelper.updateBusinessObject(element, listener, update);\n    },\n\n    hidden: function(element, node) {\n      var listener = getSelectedListener(element, node);\n      return !listener || listener.script;\n    },\n\n    validate: function(element, values) {\n      var value = values.listenerValue,\n          validate = {};\n\n      if (!value) {\n        validate.listenerValue = translate('Must provide a value');\n      }\n\n      return validate;\n    }\n\n  }));\n\n\n  // script ////////////////////\n  var script = scriptImplementation('scriptFormat', 'value', true, translate);\n\n  group.entries.push({\n    id: 'listener-script-value',\n    html: '<div data-show=\"isScript\">' +\n            script.template +\n          '</div>',\n\n    get: function(element, node) {\n      var listener = getSelectedListener(element, node);\n      return listener && listener.script ? script.get(element, listener.script) : {};\n    },\n\n    set: function(element, values, node) {\n      var listener = getSelectedListener(element, node);\n      var update = script.set(element, values, listener);\n      return cmdHelper.updateBusinessObject(element, listener.script, update);\n    },\n\n    validate: function(element, values, node) {\n      var listener = getSelectedListener(element, node);\n      return listener && listener.script ? script.validate(element, values) : {};\n    },\n\n    isScript: function(element, node) {\n      var listener = getSelectedListener(element, node);\n      return listener && listener.script;\n    },\n\n    script: script\n\n  });\n\n\n  // timerEventDefinition //////\n  var timerEventDefinitionHandler = function(element, node) {\n    var listener = getSelectedListener(element, node);\n\n    if (!listener || !isTimeoutTaskListener(listener)) {\n      return;\n    }\n\n    var timerEventDefinition = getTimerEventDefinition(listener);\n\n    if (!timerEventDefinition) {\n      return false;\n    }\n\n    return timerEventDefinition;\n  };\n\n  function createTimerEventDefinition(element, node) {\n\n    var listener = getSelectedListener(element, node);\n\n    if (!listener || !isTimeoutTaskListener(listener)) {\n      return;\n    }\n\n    var eventDefinitions = listener.get('eventDefinitions') || [],\n        timerEventDefinition = bpmnFactory.create('bpmn:TimerEventDefinition');\n\n    eventDefinitions.push(timerEventDefinition);\n\n    listener.eventDefinitions = eventDefinitions;\n\n    return timerEventDefinition;\n  }\n\n  var timerOptions = {\n    idPrefix: 'listener-',\n    createTimerEventDefinition: createTimerEventDefinition\n  };\n\n  timerImplementation(group, element, bpmnFactory, timerEventDefinitionHandler, translate, timerOptions);\n\n};\n\n\n// helpers //////////////\n\nfunction isTimeoutTaskListener(listener) {\n  var eventType = listener && listener.event;\n  return eventType === 'timeout';\n}\n\nfunction getTimerEventDefinition(bo) {\n  var eventDefinitions = bo.eventDefinitions || [];\n\n  return find(eventDefinitions, function(event) {\n    return is(event, 'bpmn:TimerEventDefinition');\n  });\n\n}\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\nvar callable = require('./implementation/Callable');\n\nvar cmdHelper = require('../../../helper/CmdHelper');\n\nvar flattenDeep = require('lodash/flattenDeep');\nvar assign = require('lodash/assign');\n\nfunction getCallableType(element) {\n  var bo = getBusinessObject(element);\n\n  var boCalledElement = bo.get('calledElement'),\n      boCaseRef = bo.get('camunda:caseRef');\n\n  var callActivityType = '';\n  if (typeof boCalledElement !== 'undefined') {\n    callActivityType = 'bpmn';\n  } else\n\n  if (typeof boCaseRef !== 'undefined') {\n    callActivityType = 'cmmn';\n  }\n\n  return callActivityType;\n}\n\nvar DEFAULT_PROPS = {\n  calledElement: undefined,\n  'camunda:calledElementBinding': 'latest',\n  'camunda:calledElementVersion': undefined,\n  'camunda:calledElementTenantId': undefined,\n  'camunda:variableMappingClass' : undefined,\n  'camunda:variableMappingDelegateExpression' : undefined,\n  'camunda:caseRef': undefined,\n  'camunda:caseBinding': 'latest',\n  'camunda:caseVersion': undefined,\n  'camunda:caseTenantId': undefined\n};\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (!is(element, 'camunda:CallActivity')) {\n    return;\n  }\n\n  group.entries.push(entryFactory.selectBox({\n    id : 'callActivity',\n    label: translate('CallActivity Type'),\n    selectOptions: [\n      { name: 'BPMN', value: 'bpmn' },\n      { name: 'CMMN', value: 'cmmn' }\n    ],\n    emptyParameter: true,\n    modelProperty: 'callActivityType',\n\n    get: function(element, node) {\n      return {\n        callActivityType: getCallableType(element)\n      };\n    },\n\n    set: function(element, values, node) {\n      var type = values.callActivityType;\n\n      var props = assign({}, DEFAULT_PROPS);\n\n      if (type === 'bpmn') {\n        props.calledElement = '';\n      }\n      else if (type === 'cmmn') {\n        props['camunda:caseRef'] = '';\n      }\n\n      return cmdHelper.updateProperties(element, props);\n    }\n\n  }));\n\n  group.entries.push(callable(element, bpmnFactory, {\n    getCallableType: getCallableType\n  }, translate));\n\n  group.entries = flattenDeep(group.entries);\n};\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","module.exports = {\n  __depends__: [\n    require('./element-templates'),\n    require('diagram-js/lib/i18n/translate').default\n  ],\n  __init__: [ 'propertiesProvider' ],\n  propertiesProvider: [ 'type', require('./CamundaPropertiesProvider') ]\n};\n","'use strict';\n\nvar inputOutput = require('./implementation/InputOutput');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var inputOutputEntry = inputOutput(element, bpmnFactory, {\n    idPrefix: 'connector-',\n    insideConnector: true\n  }, translate);\n\n  group.entries = group.entries.concat(inputOutputEntry.entries);\n\n  return {\n    getSelectedParameter: inputOutputEntry.getSelectedParameter\n  };\n\n};\n","'use strict';\n\nvar ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper'),\n    InputOutputHelper = require('../../../helper/InputOutputHelper');\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\nfunction getImplementationType(element) {\n  return ImplementationTypeHelper.getImplementationType(element);\n}\n\nfunction getBusinessObject(element) {\n  return ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n}\n\nfunction getConnector(bo) {\n  return InputOutputHelper.getConnector(bo);\n}\n\nfunction isConnector(element) {\n  return getImplementationType(element) === 'connector';\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  group.entries.push(entryFactory.textField({\n    id: 'connectorId',\n    label: translate('Connector Id'),\n    modelProperty: 'connectorId',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var connector = bo && getConnector(bo);\n      var value = connector && connector.get('connectorId');\n      return { connectorId: value };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n      var connector = getConnector(bo);\n      return cmdHelper.updateBusinessObject(element, connector, {\n        connectorId: values.connectorId || undefined\n      });\n    },\n\n    validate: function(element, values, node) {\n      return isConnector(element) && !values.connectorId ? { connectorId: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !isConnector(element);\n    }\n\n  }));\n\n};\n","var Symbol = require('./_Symbol'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray');\n\n/** Built-in value references. */\nvar spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\nmodule.exports = isFlattenable;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar factory = require('../../../../factory/EntryFactory');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    utils = require('../../../../Utils');\n\nvar assign = require('lodash/assign'),\n    forEach = require('lodash/forEach'),\n    find = require('lodash/find');\n\nfunction generatePropertyId() {\n  return utils.nextId('Property_');\n}\n\n/**\n * Get all camunda:property objects for a specific business object\n *\n * @param  {ModdleElement} parent\n *\n * @return {Array<ModdleElement>} a list of camunda:property objects\n */\nfunction getPropertyValues(parent) {\n  var properties = parent && getPropertiesElement(parent);\n  if (properties && properties.values) {\n    return properties.values;\n  }\n  return [];\n}\n\n/**\n * Get all camunda:Properties object for a specific business object\n *\n * @param  {ModdleElement} parent\n *\n * @return {ModdleElement} a camunda:Properties object\n */\nfunction getPropertiesElement(element) {\n  if (!isExtensionElements(element)) {\n    return element.properties;\n  } else {\n    return getPropertiesElementInsideExtensionElements(element);\n  }\n}\n\n/**\n * Get first camunda:Properties object for a specific bpmn:ExtensionElements\n * business object.\n *\n * @param {ModdleElement} extensionElements\n *\n * @return {ModdleElement} a camunda:Properties object\n */\nfunction getPropertiesElementInsideExtensionElements(extensionElements) {\n  return find(extensionElements.values, function(elem) {\n    return is(elem, 'camunda:Properties');\n  });\n}\n\n/**\n * Returns true, if the given business object is a bpmn:ExtensionElements.\n *\n * @param {ModdleElement} element\n *\n * @return {boolean} a boolean value\n */\nfunction isExtensionElements(element) {\n  return is(element, 'bpmn:ExtensionElements');\n}\n\n/**\n * Create a camunda:property entry using tableEntryFactory\n *\n * @param  {djs.model.Base} element\n * @param  {BpmnFactory} bpmnFactory\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {Array<string>} options.modelProperties\n * @param  {Array<string>} options.labels\n * @param  {function} options.getParent Gets the parent business object\n * @param  {function} options.show Indicate when the entry will be shown, should return boolean\n */\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getParent = options.getParent;\n\n  var modelProperties = options.modelProperties,\n      createParent = options.createParent;\n\n  var bo = getBusinessObject(element);\n  if (is(element, 'bpmn:Participant')) {\n    bo = bo.get('processRef');\n  }\n\n  // build properties group only when the participant have a processRef\n  if (!bo) {\n    return;\n  }\n\n  assign(options, {\n    addLabel: translate('Add Property'),\n    getElements: function(element, node) {\n      var parent = getParent(element, node, bo);\n      return getPropertyValues(parent);\n    },\n    addElement: function(element, node) {\n      var commands = [],\n          parent = getParent(element, node, bo);\n\n      if (!parent && typeof createParent === 'function') {\n        var result = createParent(element, bo);\n        parent = result.parent;\n        commands.push(result.cmd);\n      }\n\n      var properties = getPropertiesElement(parent);\n      if (!properties) {\n        properties = elementHelper.createElement('camunda:Properties', {}, parent, bpmnFactory);\n\n        if (!isExtensionElements(parent)) {\n          commands.push(cmdHelper.updateBusinessObject(element, parent, { 'properties': properties }));\n        } else {\n          commands.push(cmdHelper.addAndRemoveElementsFromList(\n            element,\n            parent,\n            'values',\n            'extensionElements',\n            [ properties ],\n            []\n          ));\n        }\n      }\n\n      var propertyProps = {};\n      forEach(modelProperties, function(prop) {\n        propertyProps[prop] = undefined;\n      });\n\n      // create id if necessary\n      if (modelProperties.indexOf('id') >= 0) {\n        propertyProps.id = generatePropertyId();\n      }\n\n      var property = elementHelper.createElement('camunda:Property', propertyProps, properties, bpmnFactory);\n      commands.push(cmdHelper.addElementsTolist(element, properties, 'values', [ property ]));\n\n      return commands;\n    },\n    updateElement: function(element, value, node, idx) {\n      var parent = getParent(element, node, bo),\n          property = getPropertyValues(parent)[idx];\n\n      forEach(modelProperties, function(prop) {\n        value[prop] = value[prop] || undefined;\n      });\n\n      return cmdHelper.updateBusinessObject(element, property, value);\n    },\n    validate: function(element, value, node, idx) {\n      // validate id if necessary\n      if (modelProperties.indexOf('id') >= 0) {\n\n        var parent = getParent(element, node, bo),\n            properties = getPropertyValues(parent),\n            property = properties[idx];\n\n        if (property) {\n          // check if id is valid\n          var validationError = utils.isIdValid(property, value.id, translate);\n\n          if (validationError) {\n            return { id: validationError };\n          }\n        }\n      }\n    },\n    removeElement: function(element, node, idx) {\n      var commands = [],\n          parent = getParent(element, node, bo),\n          properties = getPropertiesElement(parent),\n          propertyValues = getPropertyValues(parent),\n          currentProperty = propertyValues[idx];\n\n      commands.push(cmdHelper.removeElementsFromList(element, properties, 'values', null, [ currentProperty ]));\n\n      if (propertyValues.length === 1) {\n        // remove camunda:properties if the last existing property has been removed\n        if (!isExtensionElements(parent)) {\n          commands.push(cmdHelper.updateBusinessObject(element, parent, { properties: undefined }));\n        } else {\n          forEach(parent.values, function(value) {\n            if (is(value, 'camunda:Properties')) {\n              commands.push(extensionElementsHelper.removeEntry(bo, element, value));\n            }\n          });\n        }\n      }\n\n      return commands;\n    }\n  });\n\n  return factory.table(options);\n};\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nmodule.exports = arrayPush;\n","var isObject = require('./isObject');\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nmodule.exports = isStrictComparable;\n","/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = strictIndexOf;\n","'use strict';\n\nvar assign = require('lodash/assign');\n\n/**\n * Create an input parameter representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createInputParameter(binding, value, bpmnFactory) {\n  var scriptFormat = binding.scriptFormat,\n      parameterValue,\n      parameterDefinition;\n\n  if (scriptFormat) {\n    parameterDefinition = bpmnFactory.create('camunda:Script', {\n      scriptFormat: scriptFormat,\n      value: value\n    });\n  } else {\n    parameterValue = value;\n  }\n\n  return bpmnFactory.create('camunda:InputParameter', {\n    name: binding.name,\n    value: parameterValue,\n    definition: parameterDefinition\n  });\n}\n\nmodule.exports.createInputParameter = createInputParameter;\n\n\n/**\n * Create an output parameter representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createOutputParameter(binding, value, bpmnFactory) {\n  var scriptFormat = binding.scriptFormat,\n      parameterValue,\n      parameterDefinition;\n\n  if (scriptFormat) {\n    parameterDefinition = bpmnFactory.create('camunda:Script', {\n      scriptFormat: scriptFormat,\n      value: binding.source\n    });\n  } else {\n    parameterValue = binding.source;\n  }\n\n  return bpmnFactory.create('camunda:OutputParameter', {\n    name: value,\n    value: parameterValue,\n    definition: parameterDefinition\n  });\n}\n\nmodule.exports.createOutputParameter = createOutputParameter;\n\n\n/**\n * Create camunda property from the given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaProperty(binding, value, bpmnFactory) {\n  return bpmnFactory.create('camunda:Property', {\n    name: binding.name,\n    value: value || ''\n  });\n}\n\nmodule.exports.createCamundaProperty = createCamundaProperty;\n\n\n/**\n * Create camunda:in element from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaIn(binding, value, bpmnFactory) {\n\n  var properties = createCamundaInOutAttrs(binding, value);\n\n  return bpmnFactory.create('camunda:In', properties);\n}\n\nmodule.exports.createCamundaIn = createCamundaIn;\n\n\n/**\n * Create camunda:in with businessKey element from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaInWithBusinessKey(binding, value, bpmnFactory) {\n  return bpmnFactory.create('camunda:In', {\n    businessKey: value\n  });\n}\n\nmodule.exports.createCamundaInWithBusinessKey = createCamundaInWithBusinessKey;\n\n\n/**\n * Create camunda:out element from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaOut(binding, value, bpmnFactory) {\n  var properties = createCamundaInOutAttrs(binding, value);\n\n  return bpmnFactory.create('camunda:Out', properties);\n}\n\nmodule.exports.createCamundaOut = createCamundaOut;\n\n\n/**\n * Create camunda:executionListener element containing an inline script from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaExecutionListenerScript(binding, value, bpmnFactory) {\n  var scriptFormat = binding.scriptFormat,\n      parameterValue,\n      parameterDefinition;\n\n  if (scriptFormat) {\n    parameterDefinition = bpmnFactory.create('camunda:Script', {\n      scriptFormat: scriptFormat,\n      value: value\n    });\n  } else {\n    parameterValue = value;\n  }\n\n  return bpmnFactory.create('camunda:ExecutionListener', {\n    event: binding.event,\n    value: parameterValue,\n    script: parameterDefinition\n  });\n}\n\nmodule.exports.createCamundaExecutionListenerScript = createCamundaExecutionListenerScript;\n\n/**\n * Create camunda:field element containing string or expression from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaFieldInjection(binding, value, bpmnFactory) {\n  var DEFAULT_PROPS = {\n    'string': undefined,\n    'expression': undefined,\n    'name': undefined\n  };\n\n  var props = assign({}, DEFAULT_PROPS);\n\n  if (!binding.expression) {\n    props.string = value;\n  } else {\n    props.expression = value;\n  }\n  props.name = binding.name;\n\n  return bpmnFactory.create('camunda:Field', props);\n}\nmodule.exports.createCamundaFieldInjection = createCamundaFieldInjection;\n\n\n// helpers ////////////////////////////\n\n/**\n * Create properties for camunda:in and camunda:out types.\n */\nfunction createCamundaInOutAttrs(binding, value) {\n\n  var properties = {};\n\n  // camunda:in source(Expression) target\n  if (binding.target) {\n\n    properties.target = binding.target;\n\n    if (binding.expression) {\n      properties.sourceExpression = value;\n    } else {\n      properties.source = value;\n    }\n  } else\n\n  // camunda:(in|out) variables local\n  if (binding.variables) {\n    properties.variables = 'all';\n\n    if (binding.variables === 'local') {\n      properties.local = true;\n    }\n  }\n\n  // camunda:out source(Expression) target\n  else {\n    properties.target = value;\n\n    [ 'source', 'sourceExpression' ].forEach(function(k) {\n      if (binding[k]) {\n        properties[k] = binding[k];\n      }\n    });\n  }\n\n  return properties;\n}\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar ITERATOR = wellKnownSymbol('iterator');\n\nmodule.exports = !fails(function () {\n  var url = new URL('b?a=1&b=2&c=3', 'http://a');\n  var searchParams = url.searchParams;\n  var result = '';\n  url.pathname = 'c%20d';\n  searchParams.forEach(function (value, key) {\n    searchParams['delete']('b');\n    result += key + value;\n  });\n  return (IS_PURE && !url.toJSON)\n    || !searchParams.sort\n    || url.href !== 'http://a/c%20d?a=1&c=3'\n    || searchParams.get('c') !== '3'\n    || String(new URLSearchParams('?a=1')) !== 'a=1'\n    || !searchParams[ITERATOR]\n    // throws in Edge\n    || new URL('https://a@b').username !== 'a'\n    || new URLSearchParams(new URLSearchParams('a=b')).get('a') !== 'b'\n    // not punycoded in Edge\n    || new URL('http://тест').host !== 'xn--e1aybc'\n    // not escaped in Chrome 62-\n    || new URL('http://a#б').hash !== '#%D0%B1'\n    // fails in Chrome 66-\n    || result !== 'a1c3'\n    // throws in Safari\n    || new URL('http://x', undefined).host !== 'x';\n});\n","var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isAny = require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    eventDefinitionHelper = require('../../../helper/EventDefinitionHelper');\n\nvar forEach = require('lodash/forEach');\n\nvar message = require('./implementation/MessageEventDefinition'),\n    signal = require('./implementation/SignalEventDefinition'),\n    error = require('./implementation/ErrorEventDefinition'),\n    escalation = require('./implementation/EscalationEventDefinition'),\n    timer = require('./implementation/TimerEventDefinition'),\n    compensation = require('./implementation/CompensateEventDefinition'),\n    condition = require('./implementation/ConditionalEventDefinition');\n\n\nmodule.exports = function(group, element, bpmnFactory, elementRegistry, translate) {\n  var events = [\n    'bpmn:StartEvent',\n    'bpmn:EndEvent',\n    'bpmn:IntermediateThrowEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:IntermediateCatchEvent'\n  ];\n\n  // Message and Signal Event Definition\n  forEach(events, function(event) {\n    if (is(element, event)) {\n\n      var messageEventDefinition = eventDefinitionHelper.getMessageEventDefinition(element),\n          signalEventDefinition = eventDefinitionHelper.getSignalEventDefinition(element);\n\n      if (messageEventDefinition) {\n        message(group, element, bpmnFactory, messageEventDefinition, translate);\n      }\n\n      if (signalEventDefinition) {\n        signal(group, element, bpmnFactory, signalEventDefinition, translate);\n      }\n\n    }\n  });\n\n  // Special Case: Receive Task\n  if (is(element, 'bpmn:ReceiveTask')) {\n    message(group, element, bpmnFactory, getBusinessObject(element), translate);\n  }\n\n  // Error Event Definition\n  var errorEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:EndEvent'\n  ];\n\n  forEach(errorEvents, function(event) {\n    if (is(element, event)) {\n\n      var errorEventDefinition = eventDefinitionHelper.getErrorEventDefinition(element);\n\n      if (errorEventDefinition) {\n\n        error(group, element, bpmnFactory, errorEventDefinition, translate);\n      }\n    }\n  });\n\n  // Escalation Event Definition\n  var escalationEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:IntermediateThrowEvent',\n    'bpmn:EndEvent'\n  ];\n\n  forEach(escalationEvents, function(event) {\n    if (is(element, event)) {\n\n      var showEscalationCodeVariable = is(element, 'bpmn:StartEvent') || is(element, 'bpmn:BoundaryEvent');\n\n      // get business object\n      var escalationEventDefinition = eventDefinitionHelper.getEscalationEventDefinition(element);\n\n      if (escalationEventDefinition) {\n        escalation(group, element, bpmnFactory, escalationEventDefinition, showEscalationCodeVariable,\n          translate);\n      }\n    }\n\n  });\n\n  // Timer Event Definition\n  var timerEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:IntermediateCatchEvent'\n  ];\n\n  forEach(timerEvents, function(event) {\n    if (is(element, event)) {\n\n      // get business object\n      var timerEventDefinition = eventDefinitionHelper.getTimerEventDefinition(element);\n\n      if (timerEventDefinition) {\n        timer(group, element, bpmnFactory, timerEventDefinition, translate);\n      }\n    }\n  });\n\n  // Compensate Event Definition\n  var compensationEvents = [\n    'bpmn:EndEvent',\n    'bpmn:IntermediateThrowEvent'\n  ];\n\n  forEach(compensationEvents, function(event) {\n    if (is(element, event)) {\n\n      // get business object\n      var compensateEventDefinition = eventDefinitionHelper.getCompensateEventDefinition(element);\n\n      if (compensateEventDefinition) {\n        compensation(group, element, bpmnFactory, compensateEventDefinition, elementRegistry, translate);\n      }\n    }\n  });\n\n\n  // Conditional Event Definition\n  var conditionalEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:IntermediateThrowEvent',\n    'bpmn:IntermediateCatchEvent'\n  ];\n\n  if (isAny(element, conditionalEvents)) {\n\n    // get business object\n    var conditionalEventDefinition = eventDefinitionHelper.getConditionalEventDefinition(element);\n\n    if (conditionalEventDefinition) {\n      condition(group, element, bpmnFactory, conditionalEventDefinition, elementRegistry, translate);\n    }\n  }\n\n};\n","var realNames = require('./_realNames');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the name of `func`.\n *\n * @private\n * @param {Function} func The function to query.\n * @returns {string} Returns the function name.\n */\nfunction getFuncName(func) {\n  var result = (func.name + ''),\n      array = realNames[result],\n      length = hasOwnProperty.call(realNames, result) ? array.length : 0;\n\n  while (length--) {\n    var data = array[length],\n        otherFunc = data.func;\n    if (otherFunc == null || otherFunc == func) {\n      return data.name;\n    }\n  }\n  return result;\n}\n\nmodule.exports = getFuncName;\n","'use strict';\n\nvar ElementHelper = {};\nmodule.exports = ElementHelper;\n\n/**\n * Creates a new element and set the parent to it\n *\n * @method ElementHelper#createElement\n *\n * @param {String} elementType of the new element\n * @param {Object} properties of the new element in key-value pairs\n * @param {moddle.object} parent of the new element\n * @param {BpmnFactory} factory which creates the new element\n *\n * @returns {djs.model.Base} element which is created\n */\nElementHelper.createElement = function(elementType, properties, parent, factory) {\n  var element = factory.create(elementType, properties);\n  element.$parent = parent;\n\n  return element;\n};\n","/**\n * A rule that checks that sequence flows outgoing from a\n * conditional forking gateway or activity are\n * either default flows _or_ have a condition attached\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!isConditionalForking(node)) {\n      return;\n    }\n\n    const outgoing = node.outgoing || [];\n\n    outgoing.forEach((flow) => {\n      const missingCondition = (\n        !hasCondition(flow) &&\n        !isDefaultFlow(node, flow)\n      );\n\n      if (missingCondition) {\n        reporter.report(flow.id, 'Sequence flow is missing condition');\n      }\n    });\n  }\n\n  return {\n    check\n  };\n\n};\n\n\n// helpers /////////////////////////////\n\nfunction isConditionalForking(node) {\n\n  const defaultFlow = node['default'];\n  const outgoing = node.outgoing || [];\n\n  return defaultFlow || outgoing.find(hasCondition);\n}\n\nfunction hasCondition(flow) {\n  return !!flow.conditionExpression;\n}\n\nfunction isDefaultFlow(node, flow) {\n  return node['default'] === flow;\n}","var baseCreate = require('./_baseCreate'),\n    isObject = require('./isObject');\n\n/**\n * Creates a function that produces an instance of `Ctor` regardless of\n * whether it was invoked as part of a `new` expression or by `call` or `apply`.\n *\n * @private\n * @param {Function} Ctor The constructor to wrap.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createCtor(Ctor) {\n  return function() {\n    // Use a `switch` statement to work with class constructors. See\n    // http://ecma-international.org/ecma-262/7.0/#sec-ecmascript-function-objects-call-thisargument-argumentslist\n    // for more details.\n    var args = arguments;\n    switch (args.length) {\n      case 0: return new Ctor;\n      case 1: return new Ctor(args[0]);\n      case 2: return new Ctor(args[0], args[1]);\n      case 3: return new Ctor(args[0], args[1], args[2]);\n      case 4: return new Ctor(args[0], args[1], args[2], args[3]);\n      case 5: return new Ctor(args[0], args[1], args[2], args[3], args[4]);\n      case 6: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5]);\n      case 7: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5], args[6]);\n    }\n    var thisBinding = baseCreate(Ctor.prototype),\n        result = Ctor.apply(thisBinding, args);\n\n    // Mimic the constructor's `return` behavior.\n    // See https://es5.github.io/#x13.2.2 for more details.\n    return isObject(result) ? result : thisBinding;\n  };\n}\n\nmodule.exports = createCtor;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar historyTimeToLive = require('./implementation/HistoryTimeToLive');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var businessObject = getBusinessObject(element);\n\n  if (is(element, 'camunda:Process') ||\n      is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n\n    group.entries = group.entries.concat(historyTimeToLive(element, bpmnFactory, {\n      getBusinessObject: function(element) {\n        var bo = getBusinessObject(element);\n\n        if (!is(bo, 'bpmn:Participant')) {\n          return bo;\n        }\n\n        return bo.get('processRef');\n      }\n    }, translate));\n\n  }\n};\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nmodule.exports = isKeyable;\n","var identity = require('./identity');\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nmodule.exports = castFunction;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","var baseKeys = require('./_baseKeys'),\n    getTag = require('./_getTag'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isArrayLike = require('./isArrayLike'),\n    isBuffer = require('./isBuffer'),\n    isPrototype = require('./_isPrototype'),\n    isTypedArray = require('./isTypedArray');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    setTag = '[object Set]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if `value` is an empty object, collection, map, or set.\n *\n * Objects are considered empty if they have no own enumerable string keyed\n * properties.\n *\n * Array-like values such as `arguments` objects, arrays, buffers, strings, or\n * jQuery-like collections are considered empty if they have a `length` of `0`.\n * Similarly, maps and sets are considered empty if they have a `size` of `0`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is empty, else `false`.\n * @example\n *\n * _.isEmpty(null);\n * // => true\n *\n * _.isEmpty(true);\n * // => true\n *\n * _.isEmpty(1);\n * // => true\n *\n * _.isEmpty([1, 2, 3]);\n * // => false\n *\n * _.isEmpty({ 'a': 1 });\n * // => false\n */\nfunction isEmpty(value) {\n  if (value == null) {\n    return true;\n  }\n  if (isArrayLike(value) &&\n      (isArray(value) || typeof value == 'string' || typeof value.splice == 'function' ||\n        isBuffer(value) || isTypedArray(value) || isArguments(value))) {\n    return !value.length;\n  }\n  var tag = getTag(value);\n  if (tag == mapTag || tag == setTag) {\n    return !value.size;\n  }\n  if (isPrototype(value)) {\n    return !baseKeys(value).length;\n  }\n  for (var key in value) {\n    if (hasOwnProperty.call(value, key)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nmodule.exports = isEmpty;\n","import {\n  some\n} from 'min-dash';\n\nimport { is } from '../../../util/ModelUtil';\n\n\n/**\n * Return true if element has any of the given types.\n *\n * @param {djs.model.Base} element\n * @param {Array<String>} types\n *\n * @return {Boolean}\n */\nexport function isAny(element, types) {\n  return some(types, function(t) {\n    return is(element, t);\n  });\n}\n\n\n/**\n * Return the parent of the element with any of the given types.\n *\n * @param {djs.model.Base} element\n * @param {String|Array<String>} anyType\n *\n * @return {djs.model.Base}\n */\nexport function getParent(element, anyType) {\n\n  if (typeof anyType === 'string') {\n    anyType = [ anyType ];\n  }\n\n  while ((element = element.parent)) {\n    if (isAny(element, anyType)) {\n      return element;\n    }\n  }\n\n  return null;\n}","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var candidateStarterGroupsEntry = entryFactory.textField({\n    id: 'candidateStarterGroups',\n    label: translate('Candidate Starter Groups'),\n    modelProperty: 'candidateStarterGroups',\n    description: translate('Specify more than one group as a comma separated list.'),\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var candidateStarterGroups = bo.get('camunda:candidateStarterGroups');\n\n      return {\n        candidateStarterGroups: candidateStarterGroups ? candidateStarterGroups : ''\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:candidateStarterGroups': values.candidateStarterGroups || undefined\n      });\n    }\n\n  });\n\n  var candidateStarterUsersEntry = entryFactory.textField({\n    id: 'candidateStarterUsers',\n    label: translate('Candidate Starter Users'),\n    modelProperty: 'candidateStarterUsers',\n    description: translate('Specify more than one user as a comma separated list.'),\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var candidateStarterUsers = bo.get('camunda:candidateStarterUsers');\n\n      return {\n        candidateStarterUsers: candidateStarterUsers ? candidateStarterUsers : ''\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:candidateStarterUsers': values.candidateStarterUsers || undefined\n      });\n    }\n\n  });\n\n  return [\n    candidateStarterGroupsEntry,\n    candidateStarterUsersEntry\n  ];\n};\n","var baseIsEqual = require('./_baseIsEqual'),\n    get = require('./get'),\n    hasIn = require('./hasIn'),\n    isKey = require('./_isKey'),\n    isStrictComparable = require('./_isStrictComparable'),\n    matchesStrictComparable = require('./_matchesStrictComparable'),\n    toKey = require('./_toKey');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nmodule.exports = baseMatchesProperty;\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\nvar bind = require('lodash/bind');\n\n/**\n * An entry that renders a clickable link.\n *\n * A passed {@link options#handleClick} handler is responsible\n * to process the click.\n *\n * The link may be conditionally shown or hidden. This can be\n * controlled via the {@link options.showLink}.\n *\n * @param {Object} options\n * @param {String} options.id\n * @param {String} [options.label]\n * @param {Function} options.handleClick\n * @param {Function} [options.showLink] returning false to hide link\n * @param {String} [options.description]\n *\n * @example\n *\n * var linkEntry = link({\n *   id: 'foo',\n *   description: 'Some Description',\n *   handleClick: function(element, node, event) { ... },\n *   showLink: function(element, node) { ... }\n * });\n *\n * @return {Entry} the newly created entry\n */\nfunction link(options) {\n\n  var id = options.id,\n      label = options.label || id,\n      showLink = options.showLink,\n      handleClick = options.handleClick,\n      description = options.description;\n\n  if (showLink && typeof showLink !== 'function') {\n    throw new Error('options.showLink must be a function');\n  }\n\n  if (typeof handleClick !== 'function') {\n    throw new Error('options.handleClick must be a function');\n  }\n\n  var resource = {\n    id: id\n  };\n\n  resource.html =\n    '<a data-action=\"handleClick\" ' +\n    (showLink ? 'data-show=\"showLink\" ' : '') +\n    'class=\"bpp-entry-link' + (options.cssClasses ? ' ' + escapeHTML(options.cssClasses) : '') +\n    '\">' + escapeHTML(label) + '</a>';\n\n  // add description below link entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  resource.handleClick = bind(handleClick, resource);\n\n  if (typeof showLink === 'function') {\n    resource.showLink = function() {\n      return showLink.apply(resource, arguments);\n    };\n  }\n\n  return resource;\n}\n\nmodule.exports = link;\n","'use strict';\n\nvar cmdHelper = require('../../../../helper/CmdHelper'),\n    entryFactory = require('../../../../factory/EntryFactory'),\n    elementHelper = require('../../../../helper/ElementHelper'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper');\n\n\nvar resultVariable = require('./ResultVariable');\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar forEach = require('lodash/forEach');\n\nvar attributeInfo = {\n  bpmn: {\n    element: 'calledElement',\n    binding: 'camunda:calledElementBinding',\n    version: 'camunda:calledElementVersion',\n    versionTag: 'camunda:calledElementVersionTag',\n    tenantId: 'camunda:calledElementTenantId'\n  },\n\n  cmmn: {\n    element: 'camunda:caseRef',\n    binding: 'camunda:caseBinding',\n    version: 'camunda:caseVersion',\n    tenantId: 'camunda:caseTenantId'\n  },\n\n  dmn: {\n    element: 'camunda:decisionRef',\n    binding: 'camunda:decisionRefBinding',\n    version: 'camunda:decisionRefVersion',\n    versionTag: 'camunda:decisionRefVersionTag',\n    tenantId: 'camunda:decisionRefTenantId'\n  }\n};\n\nvar mapDecisionResultOptions = [\n  {\n    name: 'singleEntry (TypedValue)',\n    value: 'singleEntry'\n  },\n  {\n    name:'singleResult (Map<String, Object>)',\n    value:'singleResult'\n  },\n  {\n    name:'collectEntries (List<Object>)',\n    value:'collectEntries'\n  },\n  {\n    name:'resultList (List<Map<String, Object>>)',\n    value:'resultList'\n  }\n];\n\nvar delegateVariableMappingOptions = [\n  {\n    name: 'variableMappingClass',\n    value: 'variableMappingClass'\n  },\n  {\n    name: 'variableMappingDelegateExpression',\n    value: 'variableMappingDelegateExpression'\n  }\n];\n\nfunction getCamundaInWithBusinessKey(element) {\n  var camundaIn = [],\n      bo = getBusinessObject(element);\n\n  var camundaInParams = extensionElementsHelper.getExtensionElements(bo, 'camunda:In');\n  if (camundaInParams) {\n    forEach(camundaInParams, function(param) {\n      if (param.businessKey !== undefined) {\n        camundaIn.push(param);\n      }\n    });\n  }\n  return camundaIn;\n}\n\nfunction setBusinessKey(element, text, bpmnFactory) {\n  var commands = [];\n\n  var camundaInWithBusinessKey = getCamundaInWithBusinessKey(element);\n\n  if (camundaInWithBusinessKey.length) {\n    commands.push(cmdHelper.updateBusinessObject(element, camundaInWithBusinessKey[0], {\n      businessKey: text\n    }));\n  } else {\n    var bo = getBusinessObject(element),\n        extensionElements = bo.extensionElements;\n\n    if (!extensionElements) {\n      extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n      commands.push(cmdHelper.updateProperties(element, { extensionElements: extensionElements }));\n    }\n\n    var camundaIn = elementHelper.createElement(\n      'camunda:In',\n      { 'businessKey': text },\n      extensionElements,\n      bpmnFactory\n    );\n\n    commands.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      extensionElements,\n      'values',\n      'extensionElements',\n      [ camundaIn ],[]\n    ));\n  }\n\n  return commands;\n}\n\nfunction deleteBusinessKey(element) {\n  var camundaInExtensions = getCamundaInWithBusinessKey(element);\n  var commands = [];\n  forEach(camundaInExtensions, function(elem) {\n    commands.push(extensionElementsHelper.removeEntry(getBusinessObject(element), element, elem));\n  });\n  return commands;\n}\n\nfunction isSupportedCallableType(type) {\n  return [ 'bpmn', 'cmmn', 'dmn' ].indexOf(type) !== -1;\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var bindingOptions = [\n    {\n      name: translate('latest'),\n      value: 'latest'\n    },\n    {\n      name: translate('deployment'),\n      value: 'deployment'\n    },\n    {\n      name: translate('version'),\n      value: 'version'\n    },\n    {\n      name: translate('versionTag'),\n      value: 'versionTag'\n    }\n  ];\n\n  var getCallableType = options.getCallableType;\n\n  var entries = [];\n\n  function getAttribute(element, prop) {\n    var type = getCallableType(element);\n    return (attributeInfo[type] || {})[prop];\n  }\n\n  function getCallActivityBindingValue(element) {\n    var type = getCallableType(element);\n    var bo = getBusinessObject(element);\n    var attr = (attributeInfo[type] || {}).binding;\n    return bo.get(attr);\n  }\n\n  function getDelegateVariableMappingType(element) {\n    var bo = getBusinessObject(element);\n\n    var boVariableMappingClass = bo.get('camunda:variableMappingClass'),\n        boVariableMappingDelegateExpression = bo.get('camunda:variableMappingDelegateExpression');\n\n    var delegateVariableMappingType = '';\n    if (typeof boVariableMappingClass !== 'undefined') {\n      delegateVariableMappingType = 'variableMappingClass';\n    } else\n\n    if (typeof boVariableMappingDelegateExpression !== 'undefined') {\n      delegateVariableMappingType = 'variableMappingDelegateExpression';\n    }\n\n    return delegateVariableMappingType;\n  }\n\n\n  entries.push(entryFactory.textField({\n    id: 'callable-element-ref',\n    dataValueLabel: 'callableElementLabel',\n    modelProperty: 'callableElementRef',\n\n    get: function(element, node) {\n      var callableElementRef;\n\n      var attr = getAttribute(element, 'element');\n      if (attr) {\n        var bo = getBusinessObject(element);\n        callableElementRef = bo.get(attr);\n      }\n\n      var label = '';\n      var type = getCallableType(element);\n      if (type === 'bpmn') {\n        label = translate('Called Element');\n      }\n      else if (type === 'cmmn') {\n        label = translate('Case Ref');\n      }\n      else if (type === 'dmn') {\n        label = translate('Decision Ref');\n      }\n\n      return {\n        callableElementRef: callableElementRef,\n        callableElementLabel: label\n      };\n    },\n\n    set: function(element, values, node) {\n      var newCallableElementRef = values.callableElementRef;\n      var attr = getAttribute(element, 'element');\n\n      var props = {};\n      props[attr] = newCallableElementRef || '';\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    validate: function(element, values, node) {\n      var elementRef = values.callableElementRef;\n      var type = getCallableType(element);\n      return isSupportedCallableType(type) && !elementRef ? { callableElementRef: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !isSupportedCallableType(getCallableType(element));\n    }\n\n  }));\n\n  entries.push(entryFactory.selectBox({\n    id: 'callable-binding',\n    label: translate('Binding'),\n    selectOptions: function(element) {\n      var type = getCallableType(element);\n      var options;\n\n      if (type === 'cmmn') {\n        options = bindingOptions.filter(function(bindingOption) {\n          return bindingOption.value !== 'versionTag';\n        });\n      } else {\n        options = bindingOptions;\n      }\n      return options;\n    },\n    modelProperty: 'callableBinding',\n\n    get: function(element, node) {\n      var callableBinding;\n\n      var attr = getAttribute(element, 'binding');\n      if (attr) {\n        var bo = getBusinessObject(element);\n        callableBinding = bo.get(attr) || 'latest';\n      }\n\n      return {\n        callableBinding: callableBinding\n      };\n    },\n\n    set: function(element, values, node) {\n      var binding = values.callableBinding;\n      var attr = getAttribute(element, 'binding'),\n          attrVer = getAttribute(element, 'version'),\n          attrVerTag = getAttribute(element, 'versionTag');\n\n      var props = {};\n      props[attr] = binding;\n\n      // set version and versionTag values always to undefined to delete the existing value\n      props[attrVer] = undefined;\n      props[attrVerTag] = undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    hidden: function(element, node) {\n      return !isSupportedCallableType(getCallableType(element));\n    }\n\n  }));\n\n  entries.push(entryFactory.textField({\n    id: 'callable-version',\n    label: translate('Version'),\n    modelProperty: 'callableVersion',\n\n    get: function(element, node) {\n      var callableVersion;\n\n      var attr = getAttribute(element, 'version');\n      if (attr) {\n        var bo = getBusinessObject(element);\n        callableVersion = bo.get(attr);\n      }\n\n      return {\n        callableVersion: callableVersion\n      };\n    },\n\n    set: function(element, values, node) {\n      var version = values.callableVersion;\n      var attr = getAttribute(element, 'version');\n\n      var props = {};\n      props[attr] = version || undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    validate: function(element, values, node) {\n      var version = values.callableVersion;\n\n      var type = getCallableType(element);\n      return (\n        isSupportedCallableType(type) &&\n        getCallActivityBindingValue(element) === 'version' && (\n          !version ? { callableVersion: translate('Must provide a value') } : {}\n        )\n      );\n    },\n\n    hidden: function(element, node) {\n      var type = getCallableType(element);\n      return !isSupportedCallableType(type) || getCallActivityBindingValue(element) !== 'version';\n    }\n\n  }));\n\n  entries.push(entryFactory.textField({\n    id: 'callable-version-tag',\n    label: translate('Version Tag'),\n    modelProperty: 'versionTag',\n\n    get: function(element, node) {\n      var versionTag;\n\n      var attr = getAttribute(element, 'versionTag');\n\n      if (attr) {\n        var bo = getBusinessObject(element);\n\n        versionTag = bo.get(attr);\n      }\n\n      return {\n        versionTag: versionTag\n      };\n    },\n\n    set: function(element, values, node) {\n      var versionTag = values.versionTag;\n\n      var attr = getAttribute(element, 'versionTag');\n\n      var props = {};\n\n      props[attr] = versionTag || undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    validate: function(element, values, node) {\n      var versionTag = values.versionTag;\n\n      var type = getCallableType(element);\n\n      return (\n        isSupportedCallableType(type) &&\n        getCallActivityBindingValue(element) === 'versionTag' && (\n          !versionTag ? { versionTag: translate('Must provide a value') } : {}\n        )\n      );\n    },\n\n    hidden: function(element, node) {\n      var type = getCallableType(element);\n\n      return !isSupportedCallableType(type) || getCallActivityBindingValue(element) !== 'versionTag';\n    }\n\n  }));\n\n  entries.push(entryFactory.textField({\n    id: 'tenant-id',\n    label: translate('Tenant Id'),\n    modelProperty: 'tenantId',\n\n    get: function(element, node) {\n      var tenantId;\n\n      var attr = getAttribute(element, 'tenantId');\n      if (attr) {\n        var bo = getBusinessObject(element);\n        tenantId = bo.get(attr);\n      }\n\n      return {\n        tenantId: tenantId\n      };\n    },\n\n    set: function(element, values, node) {\n      var tenantId = values.tenantId;\n      var attr = getAttribute(element, 'tenantId');\n\n      var props = {};\n      props[attr] = tenantId || undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    hidden: function(element, node) {\n      var type = getCallableType(element);\n      return !isSupportedCallableType(type);\n    }\n\n  }));\n\n  if (is(getBusinessObject(element), 'bpmn:CallActivity')) {\n    entries.push(entryFactory.checkbox({\n      id: 'callable-business-key',\n      label: translate('Business Key'),\n      modelProperty: 'callableBusinessKey',\n\n      get: function(element, node) {\n        var camundaIn = getCamundaInWithBusinessKey(element);\n\n        return {\n          callableBusinessKey: !!(camundaIn && camundaIn.length > 0)\n        };\n      },\n\n      set: function(element, values, node) {\n        if (values.callableBusinessKey) {\n          return setBusinessKey(element, '#{execution.processBusinessKey}', bpmnFactory);\n        } else {\n          return deleteBusinessKey(element);\n        }\n      }\n    }));\n  }\n\n  entries.push(entryFactory.textField({\n    id: 'business-key-expression',\n    label: translate('Business Key Expression'),\n    modelProperty: 'businessKey',\n\n    get: function(element, node) {\n      var camundaInWithBusinessKey = getCamundaInWithBusinessKey(element);\n\n      return {\n        businessKey: (\n          camundaInWithBusinessKey.length ?\n            camundaInWithBusinessKey[0].get('camunda:businessKey') :\n            undefined\n        )\n      };\n    },\n\n    set: function(element, values, node) {\n      var businessKey = values.businessKey;\n\n      return setBusinessKey(element, businessKey, bpmnFactory);\n    },\n\n    validate: function(element, values, node) {\n      var businessKey = values.businessKey;\n\n      return businessKey === '' ? { businessKey: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !getCamundaInWithBusinessKey(element).length;\n    }\n\n  }));\n\n  entries = entries.concat(resultVariable(element, bpmnFactory, {\n    id: 'dmn-resultVariable',\n    getBusinessObject: getBusinessObject,\n    getImplementationType: getCallableType,\n    hideResultVariable: function(element, node) {\n      return getCallableType(element) !== 'dmn';\n    }\n  }, translate));\n\n  entries.push(entryFactory.selectBox({\n    id: 'dmn-map-decision-result',\n    label: translate('Map Decision Result'),\n    selectOptions: mapDecisionResultOptions,\n    modelProperty: 'mapDecisionResult',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        mapDecisionResult: bo.get('camunda:mapDecisionResult') || 'resultList'\n      };\n    },\n\n    set: function(element, values, node) {\n      return cmdHelper.updateProperties(element, {\n        'camunda:mapDecisionResult': values.mapDecisionResult || 'resultList'\n      });\n    },\n\n    hidden: function(element, node) {\n      var bo = getBusinessObject(element);\n      var resultVariable = bo.get('camunda:resultVariable');\n      return !(getCallableType(element) === 'dmn' && typeof resultVariable !== 'undefined');\n    }\n\n  }));\n\n\n  entries.push(entryFactory.selectBox({\n    id: 'delegateVariableMappingType',\n    label: translate('Delegate Variable Mapping'),\n    selectOptions: delegateVariableMappingOptions,\n    emptyParameter: true,\n    modelProperty: 'delegateVariableMappingType',\n\n    get: function(element, node) {\n      return {\n        delegateVariableMappingType : getDelegateVariableMappingType(element)\n      };\n    },\n\n    set: function(element, values, node) {\n      var delegateVariableMappingType = values.delegateVariableMappingType;\n\n      var props = {\n        'camunda:variableMappingClass' : undefined,\n        'camunda:variableMappingDelegateExpression' : undefined\n      };\n\n      if (delegateVariableMappingType === 'variableMappingClass') {\n        props['camunda:variableMappingClass'] = '';\n      }\n      else if (delegateVariableMappingType === 'variableMappingDelegateExpression') {\n        props['camunda:variableMappingDelegateExpression'] = '';\n      }\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    hidden: function(element, node) {\n      return (getCallableType(element) !== 'bpmn');\n    }\n\n  }));\n\n  entries.push(entryFactory.textField({\n    id: 'delegateVariableMapping',\n    dataValueLabel: 'delegateVariableMappingLabel',\n    modelProperty: 'delegateVariableMapping',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n\n      var label = '';\n      var delegateVariableMapping = undefined;\n      var type = getDelegateVariableMappingType(element);\n\n      if (type === 'variableMappingClass') {\n        label = translate('Class');\n        delegateVariableMapping = bo.get('camunda:variableMappingClass');\n      }\n      else if (type === 'variableMappingDelegateExpression') {\n        label = translate('Delegate Expression');\n        delegateVariableMapping = bo.get('camunda:variableMappingDelegateExpression');\n      }\n\n      return {\n        delegateVariableMapping: delegateVariableMapping,\n        delegateVariableMappingLabel: label\n      };\n    },\n\n    set: function(element, values, node) {\n      var delegateVariableMapping = values.delegateVariableMapping;\n\n      var attr = 'camunda:' + getDelegateVariableMappingType(element);\n\n      var props = {};\n      props[attr] = delegateVariableMapping || undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    validate: function(element, values, node) {\n      var delegateVariableMapping = values.delegateVariableMapping;\n      return (\n        getCallableType(element) === 'bpmn' && (\n          !delegateVariableMapping ? { delegateVariableMapping: translate('Must provide a value') } : {}\n        )\n      );\n    },\n\n    hidden: function(element, node) {\n      return !(getCallableType(element) === 'bpmn' && getDelegateVariableMappingType(element) !== '');\n    }\n\n  }));\n\n  return entries;\n};\n","var memoizeCapped = require('./_memoizeCapped');\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nmodule.exports = stringToPath;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","var Symbol = require('./_Symbol'),\n    Uint8Array = require('./_Uint8Array'),\n    eq = require('./eq'),\n    equalArrays = require('./_equalArrays'),\n    mapToArray = require('./_mapToArray'),\n    setToArray = require('./_setToArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nmodule.exports = equalByTag;\n","module.exports = require('./lib');\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nmodule.exports = Promise;\n","'use strict';\n\nvar forEach = require('lodash/forEach');\n\nvar elementHelper = require('../helper/ElementHelper');\n\n/**\n * A handler that implements a BPMN 2.0 property update\n * for business objects which are not represented in the\n * diagram.\n *\n * This is useful in the context of the properties panel in\n * order to update child elements of elements visible in\n * the diagram.\n *\n * Example: perform an update of a specific event definition\n * of an intermediate event.\n *\n * @class\n * @constructor\n */\nfunction CreateBusinessObjectListHandler(elementRegistry, bpmnFactory) {\n  this._elementRegistry = elementRegistry;\n  this._bpmnFactory = bpmnFactory;\n}\n\nCreateBusinessObjectListHandler.$inject = [ 'elementRegistry', 'bpmnFactory' ];\n\nmodule.exports = CreateBusinessObjectListHandler;\n\nfunction ensureNotNull(prop, name) {\n  if (!prop) {\n    throw new Error(name + ' required');\n  }\n  return prop;\n\n}\nfunction ensureList(prop, name) {\n  if (!prop || Object.prototype.toString.call(prop) !== '[object Array]') {\n    throw new Error(name + ' needs to be a list');\n  }\n  return prop;\n}\n\n// api /////////////////////////////////////////////\n\n/**\n * Creates a new element under a provided parent and updates / creates a reference to it in\n * one atomic action.\n *\n * @method  CreateBusinessObjectListHandler#execute\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element which is the context for the reference\n * @param {moddle.referencingObject} context.referencingObject the object which creates the reference\n * @param {String} context.referenceProperty the property of the referencingObject which makes the reference\n * @param {moddle.newObject} context.newObject the new object to add\n * @param {moddle.newObjectContainer} context.newObjectContainer the container for the new object\n *\n * @return {Array<djs.mode.Base>} the updated element\n */\nCreateBusinessObjectListHandler.prototype.execute = function(context) {\n\n  var currentObject = ensureNotNull(context.currentObject, 'currentObject'),\n      propertyName = ensureNotNull(context.propertyName, 'propertyName'),\n      newObjects = ensureList(context.newObjects, 'newObjects'),\n      changed = [ context.element ]; // this will not change any diagram-js elements\n\n\n  var childObjects = [];\n  var self = this;\n\n  // create new array of business objects\n  forEach(newObjects, function(obj) {\n    var element = elementHelper.createElement(obj.type, obj.properties, currentObject, self._bpmnFactory);\n\n    childObjects.push(element);\n  });\n  context.childObject = childObjects;\n\n  // adjust array reference in the parent business object\n  context.previousChilds = currentObject[propertyName];\n  currentObject[propertyName] = childObjects;\n\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update\n *\n * @method  CreateBusinessObjectListHandler#revert\n *\n * @param {Object} context\n *\n * @return {djs.mode.Base} the updated element\n */\nCreateBusinessObjectListHandler.prototype.revert = function(context) {\n\n  var currentObject = context.currentObject,\n      propertyName = context.propertyName,\n      previousChilds = context.previousChilds;\n\n  // remove new element\n  currentObject.set(propertyName, previousChilds);\n\n  return context.changed;\n};\n","'use strict';\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\n/**\n * Get the timer definition type for a given timer event definition.\n *\n * @param {ModdleElement<bpmn:TimerEventDefinition>} timer\n *\n * @return {string|undefined} the timer definition type\n */\nfunction getTimerDefinitionType(timer) {\n\n  if (!timer) {\n    return;\n  }\n\n  var timeDate = timer.get('timeDate');\n  if (typeof timeDate !== 'undefined') {\n    return 'timeDate';\n  }\n\n  var timeCycle = timer.get('timeCycle');\n  if (typeof timeCycle !== 'undefined') {\n    return 'timeCycle';\n  }\n\n  var timeDuration = timer.get('timeDuration');\n  if (typeof timeDuration !== 'undefined') {\n    return 'timeDuration';\n  }\n}\n\n/**\n * Get the actual timer event definition based on option, whether it's a getter\n * to fetch the timer event definition or the exact event definition itself\n *\n * @param {ModdleElement<bpmn:TimerEventDefinition>|Function} timerOrFunction\n * @param {Shape} element\n * @param {HTMLElement} node\n *\n * @return ModdleElement<bpmn:TimerEventDefinition>\n */\nfunction getTimerDefinition(timerOrFunction, element, node) {\n  if (typeof timerOrFunction === 'function') {\n    return timerOrFunction(element, node);\n  }\n\n  return timerOrFunction;\n}\n\n/**\n * Creates 'bpmn:FormalExpression' element.\n *\n * @param {ModdleElement} parent\n * @param {string} body\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement<bpmn:FormalExpression>} a formal expression\n */\nfunction createFormalExpression(parent, body, bpmnFactory) {\n  body = body || undefined;\n  return elementHelper.createElement('bpmn:FormalExpression', { body: body }, parent, bpmnFactory);\n}\n\nfunction TimerEventDefinition(group, element, bpmnFactory, timerEventDefinition, translate, options) {\n\n  var selectOptions = [\n    { value: 'timeDate', name: translate('Date') },\n    { value: 'timeDuration', name: translate('Duration') },\n    { value: 'timeCycle', name: translate('Cycle') }\n  ];\n\n  var prefix = options && options.idPrefix,\n      createTimerEventDefinition = options && options.createTimerEventDefinition;\n\n\n  group.entries.push(entryFactory.selectBox({\n    id: prefix + 'timer-event-definition-type',\n    label: translate('Timer Definition Type'),\n    selectOptions: selectOptions,\n    emptyParameter: true,\n    modelProperty: 'timerDefinitionType',\n\n    get: function(element, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node);\n\n      return {\n        timerDefinitionType: getTimerDefinitionType(timerDefinition) || ''\n      };\n    },\n\n    set: function(element, values, node) {\n      var props = {\n        timeDuration: undefined,\n        timeDate: undefined,\n        timeCycle: undefined\n      };\n\n\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node),\n          newType = values.timerDefinitionType;\n\n      if (!timerDefinition && typeof createTimerEventDefinition === 'function') {\n        timerDefinition = createTimerEventDefinition(element, node);\n      }\n\n      if (values.timerDefinitionType) {\n        var oldType = getTimerDefinitionType(timerDefinition);\n\n        var value;\n        if (oldType) {\n          var definition = timerDefinition.get(oldType);\n          value = definition.get('body');\n        }\n\n        props[newType] = createFormalExpression(timerDefinition, value, bpmnFactory);\n      }\n\n      return cmdHelper.updateBusinessObject(element, timerDefinition, props);\n    },\n\n    hidden: function(element, node) {\n      return getTimerDefinition(timerEventDefinition, element, node) === undefined;\n    }\n\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n    id: prefix + 'timer-event-definition',\n    label: translate('Timer Definition'),\n    modelProperty: 'timerDefinition',\n\n    get: function(element, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node),\n          type = getTimerDefinitionType(timerDefinition),\n          definition = type && timerDefinition.get(type),\n          value = definition && definition.get('body');\n\n      return {\n        timerDefinition: value\n      };\n    },\n\n    set: function(element, values, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node),\n          type = getTimerDefinitionType(timerDefinition),\n          definition = type && timerDefinition.get(type);\n\n      if (definition) {\n        return cmdHelper.updateBusinessObject(element, definition, {\n          body: values.timerDefinition || undefined\n        });\n      }\n    },\n\n    validate: function(element, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node),\n          type = getTimerDefinitionType(timerDefinition),\n          definition = type && timerDefinition.get(type);\n\n      if (definition) {\n        var value = definition.get('body');\n        if (!value) {\n          return {\n            timerDefinition: translate('Must provide a value')\n          };\n        }\n      }\n    },\n\n    hidden: function(element, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node);\n\n      return !getTimerDefinitionType(timerDefinition);\n    }\n\n  }));\n\n}\n\nmodule.exports = TimerEventDefinition;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = hashDelete;\n","var getMapData = require('./_getMapData');\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nmodule.exports = mapCacheSet;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getImplementationType = options.getImplementationType,\n      getBusinessObject = options.getBusinessObject;\n\n  function isExternal(element) {\n    return getImplementationType(element) === 'external';\n  }\n\n  var topicEntry = entryFactory.textField({\n    id: 'externalTopic',\n    label: translate('Topic'),\n    modelProperty: 'externalTopic',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return { externalTopic: bo.get('camunda:topic') };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:topic': values.externalTopic\n      });\n    },\n\n    validate: function(element, values, node) {\n      return isExternal(element) && !values.externalTopic ? { externalTopic: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !isExternal(element);\n    }\n\n  });\n\n  return [ topicEntry ];\n\n};\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nmodule.exports = matchesStrictComparable;\n","var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n","var memoize = require('./memoize');\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nmodule.exports = memoizeCapped;\n","'use strict';\n\nvar inherits = require('inherits');\n\nvar getTemplate = require('./Helper').getTemplate;\n\nvar PropertiesActivator = require('../../../PropertiesActivator');\n\nvar HIGHER_PRIORITY = 1100;\n\n/**\n * Applies template visibility settings.\n *\n * Controlled using `entriesVisible` on template config object:\n *\n * ```json\n *     \"entriesVisible\": {\n *       \"_all\": true|false,\n *       \"entryName\": true|false,\n *       ...\n *     }\n * ```\n *\n * @param {EventBus} eventBus\n * @param {ElementTemplates} elementTemplates\n */\nfunction CustomElementsPropertiesActivator(eventBus, elementTemplates) {\n  PropertiesActivator.call(this, eventBus, HIGHER_PRIORITY);\n\n  this.isEntryVisible = function(entry, element) {\n\n    var template = getTemplate(element, elementTemplates);\n\n    if (template && !isEntryVisible(entry, template)) {\n      return false;\n    }\n  };\n\n  this.isPropertyEditable = function(entry, propertyName, element) {\n\n    var template = getTemplate(element, elementTemplates);\n\n    if (template && !isEntryEditable(entry, template)) {\n      return false;\n    }\n  };\n}\n\nCustomElementsPropertiesActivator.$inject = [ 'eventBus', 'elementTemplates' ];\n\ninherits(CustomElementsPropertiesActivator, PropertiesActivator);\n\nmodule.exports = CustomElementsPropertiesActivator;\n\n\n\n// helpers ////////////////////////////////////\n\n\nvar CUSTOM_PROPERTIES_PATTERN = /^custom-/;\n\nvar DEFAULT_ENTRIES_VISIBLE = {\n  _all: false,\n  id: true,\n  name: true\n};\n\nfunction isCustomEntry(entry) {\n  return CUSTOM_PROPERTIES_PATTERN.test(entry.id);\n}\n\nfunction isEntryVisible(entry, template) {\n\n  var entryId = entry.id;\n\n  if (entryId === 'elementTemplate-chooser' || isCustomEntry(entry)) {\n    return true;\n  }\n\n  var entriesVisible = template.entriesVisible || DEFAULT_ENTRIES_VISIBLE;\n\n  if (typeof entriesVisible === 'boolean') {\n    return entriesVisible;\n  }\n\n  var defaultVisible = entriesVisible._all || false,\n      entryVisible = entriesVisible[entryId];\n\n  // d = true, e = false => false\n  // d = false, e = true => true\n  // d = false, e = false\n  return (\n    (defaultVisible === true && entryVisible !== false) ||\n    (defaultVisible === false && entryVisible === true)\n  );\n}\n\nfunction isEntryEditable(entry, template) {\n\n  var property;\n\n  if (isCustomEntry(entry)) {\n    property = getProperty(template, entry);\n\n    return property && property.editable !== false;\n  }\n\n  return true;\n}\n\nfunction getProperty(template, entry) {\n\n  var index;\n  var idx = entry.id.replace('custom-' + template.id + '-', '');\n  if (idx.indexOf('-') !== -1) {\n    var indexes = idx.split('-');\n    if (indexes.length == 2) {\n      var scopeName = indexes[0].replace(/_/g, ':');\n      index = parseInt(indexes[1], 10);\n      if (scopeName && !isNaN(index)) {\n        return template.scopes[scopeName].properties[index];\n      }\n    }\n  } else {\n    index = parseInt(idx, 10);\n    if (!isNaN(index)) {\n      return template.properties[index];\n    }\n  }\n\n  throw new Error('cannot extract property index for entry <' + entry.id + '>');\n}\n","var baseFor = require('./_baseFor'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nmodule.exports = baseForOwn;\n","var baseEach = require('./_baseEach');\n\n/**\n * Aggregates elements of `collection` on `accumulator` with keys transformed\n * by `iteratee` and values set by `setter`.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} setter The function to set `accumulator` values.\n * @param {Function} iteratee The iteratee to transform keys.\n * @param {Object} accumulator The initial aggregated object.\n * @returns {Function} Returns `accumulator`.\n */\nfunction baseAggregator(collection, setter, iteratee, accumulator) {\n  baseEach(collection, function(value, key, collection) {\n    setter(accumulator, value, iteratee(value), collection);\n  });\n  return accumulator;\n}\n\nmodule.exports = baseAggregator;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nmodule.exports = Uint8Array;\n","var getMapData = require('./_getMapData');\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nmodule.exports = mapCacheGet;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nmodule.exports = hashSet;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","'use strict';\n\nvar assign = require('lodash/assign');\n\nvar fieldInjection = require('./implementation/FieldInjection');\n\nmodule.exports = function(group, element, bpmnFactory, options, translate) {\n\n  options = assign({\n    idPrefix: 'listener-',\n    insideListener: true\n  }, options);\n\n  var fieldInjectionEntry = fieldInjection(element, bpmnFactory, translate, options);\n\n  if (fieldInjectionEntry && fieldInjectionEntry.length > 0) {\n    group.entries = group.entries.concat(fieldInjectionEntry);\n  }\n\n};\n","/** Used to lookup unminified function names. */\nvar realNames = {};\n\nmodule.exports = realNames;\n","'use strict';\n\nvar nameEntryFactory = require('./implementation/Name'),\n    createCategoryValue = require('../../../helper/CategoryHelper').createCategoryValue,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nmodule.exports = function(group, element, bpmnFactory, canvas, translate) {\n\n  function initializeCategory(semantic) {\n    var rootElement = canvas.getRootElement(),\n        definitions = getBusinessObject(rootElement).$parent,\n        categoryValue = createCategoryValue(definitions, bpmnFactory);\n\n    semantic.categoryValueRef = categoryValue;\n\n  }\n\n  function setGroupName(element, values) {\n    var bo = getBusinessObject(element),\n        categoryValueRef = bo.categoryValueRef;\n\n    if (!categoryValueRef) {\n      initializeCategory(bo);\n    }\n\n    // needs direct call to update categoryValue properly\n    return {\n      cmd: 'element.updateLabel',\n      context: {\n        element: element,\n        newLabel: values.categoryValue\n      }\n    };\n  }\n\n  function getGroupName(element) {\n    var bo = getBusinessObject(element),\n        value = (bo.categoryValueRef || {}).value;\n\n    return { categoryValue: value };\n  }\n\n  if (!is(element, 'bpmn:Collaboration')) {\n\n    var options;\n    if (is(element, 'bpmn:TextAnnotation')) {\n      options = { modelProperty: 'text', label: translate('Text') };\n    } else if (is(element, 'bpmn:Group')) {\n      options = {\n        modelProperty: 'categoryValue',\n        label: translate('Category Value'),\n        get: getGroupName,\n        set: setGroupName\n      };\n    }\n\n    // name\n    group.entries = group.entries.concat(nameEntryFactory(element, options, translate));\n\n  }\n\n};\n","var arrayMap = require('./_arrayMap');\n\n/**\n * The base implementation of `_.values` and `_.valuesIn` which creates an\n * array of `object` property values corresponding to the property names\n * of `props`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array} props The property names to get values for.\n * @returns {Object} Returns the array of property values.\n */\nfunction baseValues(object, props) {\n  return arrayMap(props, function(key) {\n    return object[key];\n  });\n}\n\nmodule.exports = baseValues;\n","var baseRest = require('./_baseRest'),\n    createWrap = require('./_createWrap'),\n    getHolder = require('./_getHolder'),\n    replaceHolders = require('./_replaceHolders');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_PARTIAL_FLAG = 32;\n\n/**\n * Creates a function that invokes `func` with the `this` binding of `thisArg`\n * and `partials` prepended to the arguments it receives.\n *\n * The `_.bind.placeholder` value, which defaults to `_` in monolithic builds,\n * may be used as a placeholder for partially applied arguments.\n *\n * **Note:** Unlike native `Function#bind`, this method doesn't set the \"length\"\n * property of bound functions.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to bind.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {...*} [partials] The arguments to be partially applied.\n * @returns {Function} Returns the new bound function.\n * @example\n *\n * function greet(greeting, punctuation) {\n *   return greeting + ' ' + this.user + punctuation;\n * }\n *\n * var object = { 'user': 'fred' };\n *\n * var bound = _.bind(greet, object, 'hi');\n * bound('!');\n * // => 'hi fred!'\n *\n * // Bound with placeholders.\n * var bound = _.bind(greet, object, _, '!');\n * bound('hi');\n * // => 'hi fred!'\n */\nvar bind = baseRest(function(func, thisArg, partials) {\n  var bitmask = WRAP_BIND_FLAG;\n  if (partials.length) {\n    var holders = replaceHolders(partials, getHolder(bind));\n    bitmask |= WRAP_PARTIAL_FLAG;\n  }\n  return createWrap(func, bitmask, thisArg, partials, holders);\n});\n\n// Assign default placeholders.\nbind.placeholder = {};\n\nmodule.exports = bind;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nmodule.exports = baseHasIn;\n","var createFind = require('./_createFind'),\n    findIndex = require('./findIndex');\n\n/**\n * Iterates over elements of `collection`, returning the first element\n * `predicate` returns truthy for. The predicate is invoked with three\n * arguments: (value, index|key, collection).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to inspect.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @param {number} [fromIndex=0] The index to search from.\n * @returns {*} Returns the matched element, else `undefined`.\n * @example\n *\n * var users = [\n *   { 'user': 'barney',  'age': 36, 'active': true },\n *   { 'user': 'fred',    'age': 40, 'active': false },\n *   { 'user': 'pebbles', 'age': 1,  'active': true }\n * ];\n *\n * _.find(users, function(o) { return o.age < 40; });\n * // => object for 'barney'\n *\n * // The `_.matches` iteratee shorthand.\n * _.find(users, { 'age': 1, 'active': true });\n * // => object for 'pebbles'\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.find(users, ['active', false]);\n * // => object for 'fred'\n *\n * // The `_.property` iteratee shorthand.\n * _.find(users, 'active');\n * // => object for 'barney'\n */\nvar find = createFind(findIndex);\n\nmodule.exports = find;\n","var metaMap = require('./_metaMap'),\n    noop = require('./noop');\n\n/**\n * Gets metadata for `func`.\n *\n * @private\n * @param {Function} func The function to query.\n * @returns {*} Returns the metadata for `func`.\n */\nvar getData = !metaMap ? noop : function(func) {\n  return metaMap.get(func);\n};\n\nmodule.exports = getData;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nmodule.exports = listCacheClear;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\n/**\n * Create an entry to modify the name of an an element.\n *\n * @param  {djs.model.Base} element\n * @param  {Object} options\n * @param  {string} options.id the id of the entry\n * @param  {string} options.label the label of the entry\n *\n * @return {Array<Object>} return an array containing\n *                         the entry to modify the name\n */\nmodule.exports = function(element, options, translate) {\n\n  options = options || {};\n  var id = options.id || 'name',\n      label = options.label || translate('Name'),\n      modelProperty = options.modelProperty || 'name';\n\n  var nameEntry = entryFactory.textBox({\n    id: id,\n    label: label,\n    modelProperty: modelProperty,\n    get: options.get,\n    set: options.set\n  });\n\n  return [ nameEntry ];\n\n};\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var LazyWrapper = require('./_LazyWrapper'),\n    LodashWrapper = require('./_LodashWrapper'),\n    baseLodash = require('./_baseLodash'),\n    isArray = require('./isArray'),\n    isObjectLike = require('./isObjectLike'),\n    wrapperClone = require('./_wrapperClone');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates a `lodash` object which wraps `value` to enable implicit method\n * chain sequences. Methods that operate on and return arrays, collections,\n * and functions can be chained together. Methods that retrieve a single value\n * or may return a primitive value will automatically end the chain sequence\n * and return the unwrapped value. Otherwise, the value must be unwrapped\n * with `_#value`.\n *\n * Explicit chain sequences, which must be unwrapped with `_#value`, may be\n * enabled using `_.chain`.\n *\n * The execution of chained methods is lazy, that is, it's deferred until\n * `_#value` is implicitly or explicitly called.\n *\n * Lazy evaluation allows several methods to support shortcut fusion.\n * Shortcut fusion is an optimization to merge iteratee calls; this avoids\n * the creation of intermediate arrays and can greatly reduce the number of\n * iteratee executions. Sections of a chain sequence qualify for shortcut\n * fusion if the section is applied to an array and iteratees accept only\n * one argument. The heuristic for whether a section qualifies for shortcut\n * fusion is subject to change.\n *\n * Chaining is supported in custom builds as long as the `_#value` method is\n * directly or indirectly included in the build.\n *\n * In addition to lodash methods, wrappers have `Array` and `String` methods.\n *\n * The wrapper `Array` methods are:\n * `concat`, `join`, `pop`, `push`, `shift`, `sort`, `splice`, and `unshift`\n *\n * The wrapper `String` methods are:\n * `replace` and `split`\n *\n * The wrapper methods that support shortcut fusion are:\n * `at`, `compact`, `drop`, `dropRight`, `dropWhile`, `filter`, `find`,\n * `findLast`, `head`, `initial`, `last`, `map`, `reject`, `reverse`, `slice`,\n * `tail`, `take`, `takeRight`, `takeRightWhile`, `takeWhile`, and `toArray`\n *\n * The chainable wrapper methods are:\n * `after`, `ary`, `assign`, `assignIn`, `assignInWith`, `assignWith`, `at`,\n * `before`, `bind`, `bindAll`, `bindKey`, `castArray`, `chain`, `chunk`,\n * `commit`, `compact`, `concat`, `conforms`, `constant`, `countBy`, `create`,\n * `curry`, `debounce`, `defaults`, `defaultsDeep`, `defer`, `delay`,\n * `difference`, `differenceBy`, `differenceWith`, `drop`, `dropRight`,\n * `dropRightWhile`, `dropWhile`, `extend`, `extendWith`, `fill`, `filter`,\n * `flatMap`, `flatMapDeep`, `flatMapDepth`, `flatten`, `flattenDeep`,\n * `flattenDepth`, `flip`, `flow`, `flowRight`, `fromPairs`, `functions`,\n * `functionsIn`, `groupBy`, `initial`, `intersection`, `intersectionBy`,\n * `intersectionWith`, `invert`, `invertBy`, `invokeMap`, `iteratee`, `keyBy`,\n * `keys`, `keysIn`, `map`, `mapKeys`, `mapValues`, `matches`, `matchesProperty`,\n * `memoize`, `merge`, `mergeWith`, `method`, `methodOf`, `mixin`, `negate`,\n * `nthArg`, `omit`, `omitBy`, `once`, `orderBy`, `over`, `overArgs`,\n * `overEvery`, `overSome`, `partial`, `partialRight`, `partition`, `pick`,\n * `pickBy`, `plant`, `property`, `propertyOf`, `pull`, `pullAll`, `pullAllBy`,\n * `pullAllWith`, `pullAt`, `push`, `range`, `rangeRight`, `rearg`, `reject`,\n * `remove`, `rest`, `reverse`, `sampleSize`, `set`, `setWith`, `shuffle`,\n * `slice`, `sort`, `sortBy`, `splice`, `spread`, `tail`, `take`, `takeRight`,\n * `takeRightWhile`, `takeWhile`, `tap`, `throttle`, `thru`, `toArray`,\n * `toPairs`, `toPairsIn`, `toPath`, `toPlainObject`, `transform`, `unary`,\n * `union`, `unionBy`, `unionWith`, `uniq`, `uniqBy`, `uniqWith`, `unset`,\n * `unshift`, `unzip`, `unzipWith`, `update`, `updateWith`, `values`,\n * `valuesIn`, `without`, `wrap`, `xor`, `xorBy`, `xorWith`, `zip`,\n * `zipObject`, `zipObjectDeep`, and `zipWith`\n *\n * The wrapper methods that are **not** chainable by default are:\n * `add`, `attempt`, `camelCase`, `capitalize`, `ceil`, `clamp`, `clone`,\n * `cloneDeep`, `cloneDeepWith`, `cloneWith`, `conformsTo`, `deburr`,\n * `defaultTo`, `divide`, `each`, `eachRight`, `endsWith`, `eq`, `escape`,\n * `escapeRegExp`, `every`, `find`, `findIndex`, `findKey`, `findLast`,\n * `findLastIndex`, `findLastKey`, `first`, `floor`, `forEach`, `forEachRight`,\n * `forIn`, `forInRight`, `forOwn`, `forOwnRight`, `get`, `gt`, `gte`, `has`,\n * `hasIn`, `head`, `identity`, `includes`, `indexOf`, `inRange`, `invoke`,\n * `isArguments`, `isArray`, `isArrayBuffer`, `isArrayLike`, `isArrayLikeObject`,\n * `isBoolean`, `isBuffer`, `isDate`, `isElement`, `isEmpty`, `isEqual`,\n * `isEqualWith`, `isError`, `isFinite`, `isFunction`, `isInteger`, `isLength`,\n * `isMap`, `isMatch`, `isMatchWith`, `isNaN`, `isNative`, `isNil`, `isNull`,\n * `isNumber`, `isObject`, `isObjectLike`, `isPlainObject`, `isRegExp`,\n * `isSafeInteger`, `isSet`, `isString`, `isUndefined`, `isTypedArray`,\n * `isWeakMap`, `isWeakSet`, `join`, `kebabCase`, `last`, `lastIndexOf`,\n * `lowerCase`, `lowerFirst`, `lt`, `lte`, `max`, `maxBy`, `mean`, `meanBy`,\n * `min`, `minBy`, `multiply`, `noConflict`, `noop`, `now`, `nth`, `pad`,\n * `padEnd`, `padStart`, `parseInt`, `pop`, `random`, `reduce`, `reduceRight`,\n * `repeat`, `result`, `round`, `runInContext`, `sample`, `shift`, `size`,\n * `snakeCase`, `some`, `sortedIndex`, `sortedIndexBy`, `sortedLastIndex`,\n * `sortedLastIndexBy`, `startCase`, `startsWith`, `stubArray`, `stubFalse`,\n * `stubObject`, `stubString`, `stubTrue`, `subtract`, `sum`, `sumBy`,\n * `template`, `times`, `toFinite`, `toInteger`, `toJSON`, `toLength`,\n * `toLower`, `toNumber`, `toSafeInteger`, `toString`, `toUpper`, `trim`,\n * `trimEnd`, `trimStart`, `truncate`, `unescape`, `uniqueId`, `upperCase`,\n * `upperFirst`, `value`, and `words`\n *\n * @name _\n * @constructor\n * @category Seq\n * @param {*} value The value to wrap in a `lodash` instance.\n * @returns {Object} Returns the new `lodash` wrapper instance.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * var wrapped = _([1, 2, 3]);\n *\n * // Returns an unwrapped value.\n * wrapped.reduce(_.add);\n * // => 6\n *\n * // Returns a wrapped value.\n * var squares = wrapped.map(square);\n *\n * _.isArray(squares);\n * // => false\n *\n * _.isArray(squares.value());\n * // => true\n */\nfunction lodash(value) {\n  if (isObjectLike(value) && !isArray(value) && !(value instanceof LazyWrapper)) {\n    if (value instanceof LodashWrapper) {\n      return value;\n    }\n    if (hasOwnProperty.call(value, '__wrapped__')) {\n      return wrapperClone(value);\n    }\n  }\n  return new LodashWrapper(value);\n}\n\n// Ensure wrappers are instances of `baseLodash`.\nlodash.prototype = baseLodash.prototype;\nlodash.prototype.constructor = lodash;\n\nmodule.exports = lodash;\n","'use strict';\n\nvar values = require('lodash/values');\n\n/**\n * The guy knowing all configured element templates.\n *\n * This registry won't validate. Use the {@link Validator}\n * to verify a template is valid prior to adding it to\n * this registry.\n */\nfunction ElementTemplates() {\n\n  this._templates = {};\n\n  /**\n   * Sets the known element templates.\n   *\n   * @param {Array<TemplateDescriptor>} descriptors\n   *\n   * @return {ElementTemplates}\n   */\n  this.set = function(descriptors) {\n\n    var templates = this._templates = {};\n\n    descriptors.forEach(function(descriptor) {\n      templates[descriptor.id] = descriptor;\n    });\n\n    return this;\n  };\n\n  /**\n   * Get template descriptor with given id.\n   *\n   * @param {String} id\n   *\n   * @return {TemplateDescriptor}\n   */\n  this.get = function(id) {\n    return this._templates[id];\n  };\n\n  /**\n   * Return all known template descriptors.\n   *\n   * @return {Array<TemplateDescriptor>}\n   */\n  this.getAll = function() {\n    return values(this._templates);\n  };\n\n}\n\nmodule.exports = ElementTemplates;","const testRule = require('./test-rule');\n\nconst categoryMap = {\n  0: 'off',\n  1: 'warn',\n  2: 'error'\n};\n\n\nfunction Linter(options = {}) {\n\n  const {\n    config,\n    resolver\n  } = options;\n\n  if (typeof resolver === 'undefined') {\n    throw new Error('must provide <options.resolver>');\n  }\n\n  this.config = config;\n  this.resolver = resolver;\n\n  this.cachedRules = {};\n  this.cachedConfigs = {};\n}\n\n\nmodule.exports = Linter;\n\n/**\n * Applies a rule on the moddleRoot and adds reports to the finalReport\n *\n * @param {ModdleElement} moddleRoot\n *\n * @param {Object} ruleDefinition.name\n * @param {Object} ruleDefinition.config\n * @param {Object} ruleDefinition.category\n * @param {Rule} ruleDefinition.rule\n *\n * @return {Array<ValidationErrors>} rule reports\n */\nLinter.prototype.applyRule = function applyRule(moddleRoot, ruleDefinition) {\n\n  const {\n    config,\n    rule,\n    category,\n    name\n  } = ruleDefinition;\n\n  try {\n\n    const reports = testRule({\n      moddleRoot,\n      rule,\n      config\n    });\n\n    return reports.map(function(report) {\n      return {\n        ...report,\n        category\n      };\n    });\n  } catch (e) {\n    console.error('rule <' + name + '> failed with error: ', e);\n\n    return [\n      {\n        message: 'Rule error: ' + e.message,\n        category: 'error'\n      }\n    ];\n  }\n\n};\n\n\nLinter.prototype.resolveRule = function(name) {\n\n  const {\n    pkg,\n    ruleName\n  } = this.parseRuleName(name);\n\n  const id = `${pkg}-${ruleName}`;\n\n  const rule = this.cachedRules[id];\n\n  if (rule) {\n    return Promise.resolve(rule);\n  }\n\n  return Promise.resolve(this.resolver.resolveRule(pkg, ruleName)).then((ruleFactory) => {\n\n    if (!ruleFactory) {\n      throw new Error(`unknown rule <${name}>`);\n    }\n\n    const rule = this.cachedRules[id] = ruleFactory();\n\n    return rule;\n  });\n};\n\nLinter.prototype.resolveConfig = function(name) {\n\n  const {\n    pkg,\n    configName\n  } = this.parseConfigName(name);\n\n  const id = `${pkg}-${configName}`;\n\n  const config = this.cachedConfigs[id];\n\n  if (config) {\n    return Promise.resolve(config);\n  }\n\n  return Promise.resolve(this.resolver.resolveConfig(pkg, configName)).then((config) => {\n\n    if (!config) {\n      throw new Error(`unknown config <${name}>`);\n    }\n\n    const actualConfig = this.cachedConfigs[id] = this.normalizeConfig(config, pkg);\n\n    return actualConfig;\n  });\n};\n\n/**\n * Take a linter config and return list of resolved rules.\n *\n * @param {Object} config\n *\n * @return {Array<RuleDefinition>}\n */\nLinter.prototype.resolveRules = function(config) {\n\n  return this.resolveConfiguredRules(config).then((rulesConfig) => {\n\n    // parse rule values\n    const parsedRules = Object.entries(rulesConfig).map(([ name, value ]) => {\n      const {\n        category,\n        config\n      } = this.parseRuleValue(value);\n\n      return {\n        name,\n        category,\n        config\n      };\n    });\n\n    // filter only for enabled rules\n    const enabledRules = parsedRules.filter(definition => definition.category !== 'off');\n\n    // load enabled rules\n    const loaders = enabledRules.map((definition) => {\n\n      const {\n        name\n      } = definition;\n\n      return this.resolveRule(name).then(function(rule) {\n        return {\n          ...definition,\n          rule\n        };\n      });\n    });\n\n    return Promise.all(loaders);\n  });\n};\n\n\nLinter.prototype.resolveConfiguredRules = function(config) {\n\n  let parents = config.extends;\n\n  if (typeof parents === 'string') {\n    parents = [ parents ];\n  }\n\n  if (typeof parents === 'undefined') {\n    parents = [];\n  }\n\n  return Promise.all(\n    parents.map((configName) => {\n      return this.resolveConfig(configName).then((config) => {\n        return this.resolveConfiguredRules(config);\n      });\n    })\n  ).then((inheritedRules) => {\n\n    const overrideRules = this.normalizeConfig(config, 'bpmnlint').rules;\n\n    const rules = [ ...inheritedRules, overrideRules ].reduce((rules, currentRules) => {\n      return {\n        ...rules,\n        ...currentRules\n      };\n    }, {});\n\n    return rules;\n  });\n};\n\n\n/**\n * Lint the given model root, using the specified linter config.\n *\n * @param {ModdleElement} moddleRoot\n * @param {Object} [config] the bpmnlint configuration to use\n *\n * @return {Object} lint results, keyed by category names\n */\nLinter.prototype.lint = function(moddleRoot, config) {\n\n  config = config || this.config;\n\n  // load rules\n  return this.resolveRules(config).then((ruleDefinitions) => {\n\n    const allReports = {};\n\n    ruleDefinitions.forEach((ruleDefinition) => {\n\n      const {\n        name\n      } = ruleDefinition;\n\n      const reports = this.applyRule(moddleRoot, ruleDefinition);\n\n      if (reports.length) {\n        allReports[name] = reports;\n      }\n    });\n\n    return allReports;\n  });\n};\n\n\nLinter.prototype.parseRuleValue = function(value) {\n\n  let category;\n  let config;\n\n  if (Array.isArray(value)) {\n    category = value[0];\n    config = value[1];\n  } else {\n    category = value;\n    config = {};\n  }\n\n  // normalize rule flag to <error> and <warn> which\n  // may be upper case or a number at this point\n  if (typeof category === 'string') {\n    category = category.toLowerCase();\n  }\n\n  category = categoryMap[category] || category;\n\n  return {\n    config,\n    category\n  };\n};\n\nLinter.prototype.parseRuleName = function(name, localPackage = 'bpmnlint') {\n\n  /**\n   * We recognize the following rule name patterns:\n   *\n   * {RULE_NAME} => PKG = 'bpmnlint'\n   * bpmnlint/{RULE_NAME} => PKG = 'bpmnlint'\n   * {PACKAGE_SHORTCUT}/{RULE_NAME} => PKG = 'bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * bpmnlint-plugin-{PACKAGE_SHORTCUT}/{RULE_NAME} => PKG = 'bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * @scope/{PACKAGE_SHORTCUT}/{RULE_NAME} => PKG = '@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * @scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}/{RULE_NAME} => PKG = '@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   */\n\n  const match = /^(?:(?:(@[^/]+)\\/)?([^@]{1}[^/]*)\\/)?([^/]+)$/.exec(name);\n\n  if (!match) {\n    throw new Error(`unparseable rule name <${name}>`);\n  }\n\n  const [\n    _,\n    ns,\n    packageName,\n    ruleName\n  ] = match;\n\n  if (!packageName) {\n    return {\n      pkg: localPackage,\n      ruleName\n    };\n  }\n\n  const pkg = `${ns ? ns + '/' : '' }${prefixPackage(packageName)}`;\n\n  return {\n    pkg,\n    ruleName\n  };\n};\n\n\nLinter.prototype.parseConfigName = function(name) {\n\n  /**\n   * We recognize the following config name patterns:\n   *\n   * bpmnlint:{CONFIG_NAME} => PKG = 'bpmnlint'\n   * plugin:{PACKAGE_SHORTCUT}/{CONFIG_NAME} => PKG = 'bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * plugin:bpmnlint-plugin-{PACKAGE_SHORTCUT}/{CONFIG_NAME} => PKG = 'bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * plugin:@scope/{PACKAGE_SHORTCUT}/{CONFIG_NAME} => PKG = '@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * plugin:@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}/{CONFIG_NAME} => PKG = '@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   */\n\n  const match = /^(?:(?:plugin:(?:(@[^/]+)\\/)?([^@]{1}[^/]*)\\/)|bpmnlint:)([^/]+)$/.exec(name);\n\n  if (!match) {\n    throw new Error(`unparseable config name <${name}>`);\n  }\n\n  const [\n    _,\n    ns,\n    packageName,\n    configName\n  ] = match;\n\n  if (!packageName) {\n    return {\n      pkg: 'bpmnlint',\n      configName\n    };\n  }\n\n  const pkg = `${ns ? ns + '/' : '' }${prefixPackage(packageName)}`;\n\n  return {\n    pkg,\n    configName\n  };\n};\n\n\nLinter.prototype.getSimplePackageName = function(name) {\n\n  /**\n   * We recognize the following package name patterns:\n   *\n   * bpmnlint => PKG = 'bpmnlint'\n   * {PACKAGE_SHORTCUT} => PKG = PACKAGE_SHORTCUT\n   * bpmnlint-plugin-{PACKAGE_SHORTCUT}' => PKG = PACKAGE_SHORTCUT\n   * @scope/{PACKAGE_SHORTCUT} => PKG = '@scope/{PACKAGE_SHORTCUT}'\n   * @scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}' => PKG = '@scope/PACKAGE_SHORTCUT'\n   */\n\n  const match = /^(?:(@[^/]+)\\/)?([^/]+)$/.exec(name);\n\n  if (!match) {\n    throw new Error(`unparseable package name <${name}>`);\n  }\n\n  const [\n    _,\n    ns,\n    packageName\n  ] = match;\n\n  return `${ns ? ns + '/' : '' }${unprefixPackage(packageName)}`;\n};\n\n\n/**\n * Validate and return validated config.\n *\n * @param  {Object} config\n * @param  {String} localPackage\n *\n * @return {Object} validated config\n */\nLinter.prototype.normalizeConfig = function(config, localPackage) {\n\n  const rules = config.rules || {};\n\n  const validatedRules = Object.keys(rules).reduce((normalizedRules, name) => {\n\n    const value = rules[name];\n\n    const {\n      pkg,\n      ruleName\n    } = this.parseRuleName(name, localPackage);\n\n    const normalizedName = (\n      pkg === 'bpmnlint'\n        ? ruleName\n        : `${this.getSimplePackageName(pkg)}/${ruleName}`\n    );\n\n    normalizedRules[normalizedName] = value;\n\n    return normalizedRules;\n  }, {});\n\n  return {\n    ...config,\n    rules: validatedRules\n  };\n};\n\n\n// helpers ///////////////////////////\n\nfunction prefixPackage(pkg) {\n\n  if (pkg === 'bpmnlint') {\n    return 'bpmnlint';\n  }\n\n  if (pkg.startsWith('bpmnlint-plugin-')) {\n    return pkg;\n  }\n\n  return `bpmnlint-plugin-${pkg}`;\n}\n\n\nfunction unprefixPackage(pkg) {\n\n  if (pkg.startsWith('bpmnlint-plugin-')) {\n    return pkg.substring('bpmnlint-plugin-'.length);\n  }\n\n  return pkg;\n}","'use strict';\n\nvar CmdHelper = {};\nmodule.exports = CmdHelper;\n\nCmdHelper.updateProperties = function(element, properties) {\n  return {\n    cmd: 'element.updateProperties',\n    context: { element: element, properties: properties }\n  };\n};\n\nCmdHelper.updateBusinessObject = function(element, businessObject, newProperties) {\n  return {\n    cmd: 'properties-panel.update-businessobject',\n    context: {\n      element: element,\n      businessObject: businessObject,\n      properties: newProperties\n    }\n  };\n};\n\nCmdHelper.addElementsTolist = function(element, businessObject, listPropertyName, objectsToAdd) {\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      objectsToAdd: objectsToAdd\n    }\n  };\n};\n\nCmdHelper.removeElementsFromList = function(element, businessObject, listPropertyName, referencePropertyName, objectsToRemove) {\n\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      referencePropertyName: referencePropertyName,\n      objectsToRemove: objectsToRemove\n    }\n  };\n};\n\n\nCmdHelper.addAndRemoveElementsFromList = function(element, businessObject, listPropertyName, referencePropertyName, objectsToAdd, objectsToRemove) {\n\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      referencePropertyName: referencePropertyName,\n      objectsToAdd: objectsToAdd,\n      objectsToRemove: objectsToRemove\n    }\n  };\n};\n\n\nCmdHelper.setList = function(element, businessObject, listPropertyName, updatedObjectList) {\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      updatedObjectList: updatedObjectList\n    }\n  };\n};\n","'use strict';\n\nvar cmdHelper = require('./CmdHelper'),\n    elementHelper = require('./ElementHelper');\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar ExtensionElementsHelper = {};\n\nvar getExtensionElements = function(bo) {\n  return bo.get('extensionElements');\n};\n\nExtensionElementsHelper.getExtensionElements = function(bo, type) {\n  var extensionElements = getExtensionElements(bo);\n  if (typeof extensionElements !== 'undefined') {\n    var extensionValues = extensionElements.get('values');\n    if (typeof extensionValues !== 'undefined') {\n      var elements = extensionValues.filter(function(value) {\n        return is(value, type);\n      });\n      if (elements.length) {\n        return elements;\n      }\n    }\n  }\n};\n\nExtensionElementsHelper.addEntry = function(bo, element, entry, bpmnFactory) {\n  var extensionElements = bo.get('extensionElements');\n\n  // if there is no extensionElements list, create one\n  if (!extensionElements) {\n    // TODO: Ask Daniel which operation costs more\n    extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [entry] }, bo, bpmnFactory);\n    return { extensionElements : extensionElements };\n  } else {\n    // add new failedJobRetryExtensionElement to existing extensionElements list\n    return cmdHelper.addElementsTolist(element, extensionElements, 'values', [entry]);\n  }\n};\n\nExtensionElementsHelper.removeEntry = function(bo, element, entry) {\n  var extensionElements = bo.get('extensionElements');\n\n  if (!extensionElements) {\n\n    // return an empty command when there is no extensionElements list\n    return {};\n  }\n\n  return cmdHelper.removeElementsFromList(element, extensionElements, 'values', 'extensionElements', [entry]);\n};\n\nmodule.exports = ExtensionElementsHelper;\n","/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = baseFindIndex;\n","'use strict';\n// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.string.iterator');\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar USE_NATIVE_URL = require('../internals/native-url');\nvar global = require('../internals/global');\nvar defineProperties = require('../internals/object-define-properties');\nvar redefine = require('../internals/redefine');\nvar anInstance = require('../internals/an-instance');\nvar has = require('../internals/has');\nvar assign = require('../internals/object-assign');\nvar arrayFrom = require('../internals/array-from');\nvar codeAt = require('../internals/string-multibyte').codeAt;\nvar toASCII = require('../internals/string-punycode-to-ascii');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar URLSearchParamsModule = require('../modules/web.url-search-params');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar NativeURL = global.URL;\nvar URLSearchParams = URLSearchParamsModule.URLSearchParams;\nvar getInternalSearchParamsState = URLSearchParamsModule.getState;\nvar setInternalState = InternalStateModule.set;\nvar getInternalURLState = InternalStateModule.getterFor('URL');\nvar floor = Math.floor;\nvar pow = Math.pow;\n\nvar INVALID_AUTHORITY = 'Invalid authority';\nvar INVALID_SCHEME = 'Invalid scheme';\nvar INVALID_HOST = 'Invalid host';\nvar INVALID_PORT = 'Invalid port';\n\nvar ALPHA = /[A-Za-z]/;\nvar ALPHANUMERIC = /[\\d+\\-.A-Za-z]/;\nvar DIGIT = /\\d/;\nvar HEX_START = /^(0x|0X)/;\nvar OCT = /^[0-7]+$/;\nvar DEC = /^\\d+$/;\nvar HEX = /^[\\dA-Fa-f]+$/;\n// eslint-disable-next-line no-control-regex\nvar FORBIDDEN_HOST_CODE_POINT = /[\\u0000\\u0009\\u000A\\u000D #%/:?@[\\\\]]/;\n// eslint-disable-next-line no-control-regex\nvar FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT = /[\\u0000\\u0009\\u000A\\u000D #/:?@[\\\\]]/;\n// eslint-disable-next-line no-control-regex\nvar LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE = /^[\\u0000-\\u001F ]+|[\\u0000-\\u001F ]+$/g;\n// eslint-disable-next-line no-control-regex\nvar TAB_AND_NEW_LINE = /[\\u0009\\u000A\\u000D]/g;\nvar EOF;\n\nvar parseHost = function (url, input) {\n  var result, codePoints, index;\n  if (input.charAt(0) == '[') {\n    if (input.charAt(input.length - 1) != ']') return INVALID_HOST;\n    result = parseIPv6(input.slice(1, -1));\n    if (!result) return INVALID_HOST;\n    url.host = result;\n  // opaque host\n  } else if (!isSpecial(url)) {\n    if (FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT.test(input)) return INVALID_HOST;\n    result = '';\n    codePoints = arrayFrom(input);\n    for (index = 0; index < codePoints.length; index++) {\n      result += percentEncode(codePoints[index], C0ControlPercentEncodeSet);\n    }\n    url.host = result;\n  } else {\n    input = toASCII(input);\n    if (FORBIDDEN_HOST_CODE_POINT.test(input)) return INVALID_HOST;\n    result = parseIPv4(input);\n    if (result === null) return INVALID_HOST;\n    url.host = result;\n  }\n};\n\nvar parseIPv4 = function (input) {\n  var parts = input.split('.');\n  var partsLength, numbers, index, part, radix, number, ipv4;\n  if (parts.length && parts[parts.length - 1] == '') {\n    parts.pop();\n  }\n  partsLength = parts.length;\n  if (partsLength > 4) return input;\n  numbers = [];\n  for (index = 0; index < partsLength; index++) {\n    part = parts[index];\n    if (part == '') return input;\n    radix = 10;\n    if (part.length > 1 && part.charAt(0) == '0') {\n      radix = HEX_START.test(part) ? 16 : 8;\n      part = part.slice(radix == 8 ? 1 : 2);\n    }\n    if (part === '') {\n      number = 0;\n    } else {\n      if (!(radix == 10 ? DEC : radix == 8 ? OCT : HEX).test(part)) return input;\n      number = parseInt(part, radix);\n    }\n    numbers.push(number);\n  }\n  for (index = 0; index < partsLength; index++) {\n    number = numbers[index];\n    if (index == partsLength - 1) {\n      if (number >= pow(256, 5 - partsLength)) return null;\n    } else if (number > 255) return null;\n  }\n  ipv4 = numbers.pop();\n  for (index = 0; index < numbers.length; index++) {\n    ipv4 += numbers[index] * pow(256, 3 - index);\n  }\n  return ipv4;\n};\n\n// eslint-disable-next-line max-statements\nvar parseIPv6 = function (input) {\n  var address = [0, 0, 0, 0, 0, 0, 0, 0];\n  var pieceIndex = 0;\n  var compress = null;\n  var pointer = 0;\n  var value, length, numbersSeen, ipv4Piece, number, swaps, swap;\n\n  var char = function () {\n    return input.charAt(pointer);\n  };\n\n  if (char() == ':') {\n    if (input.charAt(1) != ':') return;\n    pointer += 2;\n    pieceIndex++;\n    compress = pieceIndex;\n  }\n  while (char()) {\n    if (pieceIndex == 8) return;\n    if (char() == ':') {\n      if (compress !== null) return;\n      pointer++;\n      pieceIndex++;\n      compress = pieceIndex;\n      continue;\n    }\n    value = length = 0;\n    while (length < 4 && HEX.test(char())) {\n      value = value * 16 + parseInt(char(), 16);\n      pointer++;\n      length++;\n    }\n    if (char() == '.') {\n      if (length == 0) return;\n      pointer -= length;\n      if (pieceIndex > 6) return;\n      numbersSeen = 0;\n      while (char()) {\n        ipv4Piece = null;\n        if (numbersSeen > 0) {\n          if (char() == '.' && numbersSeen < 4) pointer++;\n          else return;\n        }\n        if (!DIGIT.test(char())) return;\n        while (DIGIT.test(char())) {\n          number = parseInt(char(), 10);\n          if (ipv4Piece === null) ipv4Piece = number;\n          else if (ipv4Piece == 0) return;\n          else ipv4Piece = ipv4Piece * 10 + number;\n          if (ipv4Piece > 255) return;\n          pointer++;\n        }\n        address[pieceIndex] = address[pieceIndex] * 256 + ipv4Piece;\n        numbersSeen++;\n        if (numbersSeen == 2 || numbersSeen == 4) pieceIndex++;\n      }\n      if (numbersSeen != 4) return;\n      break;\n    } else if (char() == ':') {\n      pointer++;\n      if (!char()) return;\n    } else if (char()) return;\n    address[pieceIndex++] = value;\n  }\n  if (compress !== null) {\n    swaps = pieceIndex - compress;\n    pieceIndex = 7;\n    while (pieceIndex != 0 && swaps > 0) {\n      swap = address[pieceIndex];\n      address[pieceIndex--] = address[compress + swaps - 1];\n      address[compress + --swaps] = swap;\n    }\n  } else if (pieceIndex != 8) return;\n  return address;\n};\n\nvar findLongestZeroSequence = function (ipv6) {\n  var maxIndex = null;\n  var maxLength = 1;\n  var currStart = null;\n  var currLength = 0;\n  var index = 0;\n  for (; index < 8; index++) {\n    if (ipv6[index] !== 0) {\n      if (currLength > maxLength) {\n        maxIndex = currStart;\n        maxLength = currLength;\n      }\n      currStart = null;\n      currLength = 0;\n    } else {\n      if (currStart === null) currStart = index;\n      ++currLength;\n    }\n  }\n  if (currLength > maxLength) {\n    maxIndex = currStart;\n    maxLength = currLength;\n  }\n  return maxIndex;\n};\n\nvar serializeHost = function (host) {\n  var result, index, compress, ignore0;\n  // ipv4\n  if (typeof host == 'number') {\n    result = [];\n    for (index = 0; index < 4; index++) {\n      result.unshift(host % 256);\n      host = floor(host / 256);\n    } return result.join('.');\n  // ipv6\n  } else if (typeof host == 'object') {\n    result = '';\n    compress = findLongestZeroSequence(host);\n    for (index = 0; index < 8; index++) {\n      if (ignore0 && host[index] === 0) continue;\n      if (ignore0) ignore0 = false;\n      if (compress === index) {\n        result += index ? ':' : '::';\n        ignore0 = true;\n      } else {\n        result += host[index].toString(16);\n        if (index < 7) result += ':';\n      }\n    }\n    return '[' + result + ']';\n  } return host;\n};\n\nvar C0ControlPercentEncodeSet = {};\nvar fragmentPercentEncodeSet = assign({}, C0ControlPercentEncodeSet, {\n  ' ': 1, '\"': 1, '<': 1, '>': 1, '`': 1\n});\nvar pathPercentEncodeSet = assign({}, fragmentPercentEncodeSet, {\n  '#': 1, '?': 1, '{': 1, '}': 1\n});\nvar userinfoPercentEncodeSet = assign({}, pathPercentEncodeSet, {\n  '/': 1, ':': 1, ';': 1, '=': 1, '@': 1, '[': 1, '\\\\': 1, ']': 1, '^': 1, '|': 1\n});\n\nvar percentEncode = function (char, set) {\n  var code = codeAt(char, 0);\n  return code > 0x20 && code < 0x7F && !has(set, char) ? char : encodeURIComponent(char);\n};\n\nvar specialSchemes = {\n  ftp: 21,\n  file: null,\n  http: 80,\n  https: 443,\n  ws: 80,\n  wss: 443\n};\n\nvar isSpecial = function (url) {\n  return has(specialSchemes, url.scheme);\n};\n\nvar includesCredentials = function (url) {\n  return url.username != '' || url.password != '';\n};\n\nvar cannotHaveUsernamePasswordPort = function (url) {\n  return !url.host || url.cannotBeABaseURL || url.scheme == 'file';\n};\n\nvar isWindowsDriveLetter = function (string, normalized) {\n  var second;\n  return string.length == 2 && ALPHA.test(string.charAt(0))\n    && ((second = string.charAt(1)) == ':' || (!normalized && second == '|'));\n};\n\nvar startsWithWindowsDriveLetter = function (string) {\n  var third;\n  return string.length > 1 && isWindowsDriveLetter(string.slice(0, 2)) && (\n    string.length == 2 ||\n    ((third = string.charAt(2)) === '/' || third === '\\\\' || third === '?' || third === '#')\n  );\n};\n\nvar shortenURLsPath = function (url) {\n  var path = url.path;\n  var pathSize = path.length;\n  if (pathSize && (url.scheme != 'file' || pathSize != 1 || !isWindowsDriveLetter(path[0], true))) {\n    path.pop();\n  }\n};\n\nvar isSingleDot = function (segment) {\n  return segment === '.' || segment.toLowerCase() === '%2e';\n};\n\nvar isDoubleDot = function (segment) {\n  segment = segment.toLowerCase();\n  return segment === '..' || segment === '%2e.' || segment === '.%2e' || segment === '%2e%2e';\n};\n\n// States:\nvar SCHEME_START = {};\nvar SCHEME = {};\nvar NO_SCHEME = {};\nvar SPECIAL_RELATIVE_OR_AUTHORITY = {};\nvar PATH_OR_AUTHORITY = {};\nvar RELATIVE = {};\nvar RELATIVE_SLASH = {};\nvar SPECIAL_AUTHORITY_SLASHES = {};\nvar SPECIAL_AUTHORITY_IGNORE_SLASHES = {};\nvar AUTHORITY = {};\nvar HOST = {};\nvar HOSTNAME = {};\nvar PORT = {};\nvar FILE = {};\nvar FILE_SLASH = {};\nvar FILE_HOST = {};\nvar PATH_START = {};\nvar PATH = {};\nvar CANNOT_BE_A_BASE_URL_PATH = {};\nvar QUERY = {};\nvar FRAGMENT = {};\n\n// eslint-disable-next-line max-statements\nvar parseURL = function (url, input, stateOverride, base) {\n  var state = stateOverride || SCHEME_START;\n  var pointer = 0;\n  var buffer = '';\n  var seenAt = false;\n  var seenBracket = false;\n  var seenPasswordToken = false;\n  var codePoints, char, bufferCodePoints, failure;\n\n  if (!stateOverride) {\n    url.scheme = '';\n    url.username = '';\n    url.password = '';\n    url.host = null;\n    url.port = null;\n    url.path = [];\n    url.query = null;\n    url.fragment = null;\n    url.cannotBeABaseURL = false;\n    input = input.replace(LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE, '');\n  }\n\n  input = input.replace(TAB_AND_NEW_LINE, '');\n\n  codePoints = arrayFrom(input);\n\n  while (pointer <= codePoints.length) {\n    char = codePoints[pointer];\n    switch (state) {\n      case SCHEME_START:\n        if (char && ALPHA.test(char)) {\n          buffer += char.toLowerCase();\n          state = SCHEME;\n        } else if (!stateOverride) {\n          state = NO_SCHEME;\n          continue;\n        } else return INVALID_SCHEME;\n        break;\n\n      case SCHEME:\n        if (char && (ALPHANUMERIC.test(char) || char == '+' || char == '-' || char == '.')) {\n          buffer += char.toLowerCase();\n        } else if (char == ':') {\n          if (stateOverride && (\n            (isSpecial(url) != has(specialSchemes, buffer)) ||\n            (buffer == 'file' && (includesCredentials(url) || url.port !== null)) ||\n            (url.scheme == 'file' && !url.host)\n          )) return;\n          url.scheme = buffer;\n          if (stateOverride) {\n            if (isSpecial(url) && specialSchemes[url.scheme] == url.port) url.port = null;\n            return;\n          }\n          buffer = '';\n          if (url.scheme == 'file') {\n            state = FILE;\n          } else if (isSpecial(url) && base && base.scheme == url.scheme) {\n            state = SPECIAL_RELATIVE_OR_AUTHORITY;\n          } else if (isSpecial(url)) {\n            state = SPECIAL_AUTHORITY_SLASHES;\n          } else if (codePoints[pointer + 1] == '/') {\n            state = PATH_OR_AUTHORITY;\n            pointer++;\n          } else {\n            url.cannotBeABaseURL = true;\n            url.path.push('');\n            state = CANNOT_BE_A_BASE_URL_PATH;\n          }\n        } else if (!stateOverride) {\n          buffer = '';\n          state = NO_SCHEME;\n          pointer = 0;\n          continue;\n        } else return INVALID_SCHEME;\n        break;\n\n      case NO_SCHEME:\n        if (!base || (base.cannotBeABaseURL && char != '#')) return INVALID_SCHEME;\n        if (base.cannotBeABaseURL && char == '#') {\n          url.scheme = base.scheme;\n          url.path = base.path.slice();\n          url.query = base.query;\n          url.fragment = '';\n          url.cannotBeABaseURL = true;\n          state = FRAGMENT;\n          break;\n        }\n        state = base.scheme == 'file' ? FILE : RELATIVE;\n        continue;\n\n      case SPECIAL_RELATIVE_OR_AUTHORITY:\n        if (char == '/' && codePoints[pointer + 1] == '/') {\n          state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n          pointer++;\n        } else {\n          state = RELATIVE;\n          continue;\n        } break;\n\n      case PATH_OR_AUTHORITY:\n        if (char == '/') {\n          state = AUTHORITY;\n          break;\n        } else {\n          state = PATH;\n          continue;\n        }\n\n      case RELATIVE:\n        url.scheme = base.scheme;\n        if (char == EOF) {\n          url.username = base.username;\n          url.password = base.password;\n          url.host = base.host;\n          url.port = base.port;\n          url.path = base.path.slice();\n          url.query = base.query;\n        } else if (char == '/' || (char == '\\\\' && isSpecial(url))) {\n          state = RELATIVE_SLASH;\n        } else if (char == '?') {\n          url.username = base.username;\n          url.password = base.password;\n          url.host = base.host;\n          url.port = base.port;\n          url.path = base.path.slice();\n          url.query = '';\n          state = QUERY;\n        } else if (char == '#') {\n          url.username = base.username;\n          url.password = base.password;\n          url.host = base.host;\n          url.port = base.port;\n          url.path = base.path.slice();\n          url.query = base.query;\n          url.fragment = '';\n          state = FRAGMENT;\n        } else {\n          url.username = base.username;\n          url.password = base.password;\n          url.host = base.host;\n          url.port = base.port;\n          url.path = base.path.slice();\n          url.path.pop();\n          state = PATH;\n          continue;\n        } break;\n\n      case RELATIVE_SLASH:\n        if (isSpecial(url) && (char == '/' || char == '\\\\')) {\n          state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n        } else if (char == '/') {\n          state = AUTHORITY;\n        } else {\n          url.username = base.username;\n          url.password = base.password;\n          url.host = base.host;\n          url.port = base.port;\n          state = PATH;\n          continue;\n        } break;\n\n      case SPECIAL_AUTHORITY_SLASHES:\n        state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n        if (char != '/' || buffer.charAt(pointer + 1) != '/') continue;\n        pointer++;\n        break;\n\n      case SPECIAL_AUTHORITY_IGNORE_SLASHES:\n        if (char != '/' && char != '\\\\') {\n          state = AUTHORITY;\n          continue;\n        } break;\n\n      case AUTHORITY:\n        if (char == '@') {\n          if (seenAt) buffer = '%40' + buffer;\n          seenAt = true;\n          bufferCodePoints = arrayFrom(buffer);\n          for (var i = 0; i < bufferCodePoints.length; i++) {\n            var codePoint = bufferCodePoints[i];\n            if (codePoint == ':' && !seenPasswordToken) {\n              seenPasswordToken = true;\n              continue;\n            }\n            var encodedCodePoints = percentEncode(codePoint, userinfoPercentEncodeSet);\n            if (seenPasswordToken) url.password += encodedCodePoints;\n            else url.username += encodedCodePoints;\n          }\n          buffer = '';\n        } else if (\n          char == EOF || char == '/' || char == '?' || char == '#' ||\n          (char == '\\\\' && isSpecial(url))\n        ) {\n          if (seenAt && buffer == '') return INVALID_AUTHORITY;\n          pointer -= arrayFrom(buffer).length + 1;\n          buffer = '';\n          state = HOST;\n        } else buffer += char;\n        break;\n\n      case HOST:\n      case HOSTNAME:\n        if (stateOverride && url.scheme == 'file') {\n          state = FILE_HOST;\n          continue;\n        } else if (char == ':' && !seenBracket) {\n          if (buffer == '') return INVALID_HOST;\n          failure = parseHost(url, buffer);\n          if (failure) return failure;\n          buffer = '';\n          state = PORT;\n          if (stateOverride == HOSTNAME) return;\n        } else if (\n          char == EOF || char == '/' || char == '?' || char == '#' ||\n          (char == '\\\\' && isSpecial(url))\n        ) {\n          if (isSpecial(url) && buffer == '') return INVALID_HOST;\n          if (stateOverride && buffer == '' && (includesCredentials(url) || url.port !== null)) return;\n          failure = parseHost(url, buffer);\n          if (failure) return failure;\n          buffer = '';\n          state = PATH_START;\n          if (stateOverride) return;\n          continue;\n        } else {\n          if (char == '[') seenBracket = true;\n          else if (char == ']') seenBracket = false;\n          buffer += char;\n        } break;\n\n      case PORT:\n        if (DIGIT.test(char)) {\n          buffer += char;\n        } else if (\n          char == EOF || char == '/' || char == '?' || char == '#' ||\n          (char == '\\\\' && isSpecial(url)) ||\n          stateOverride\n        ) {\n          if (buffer != '') {\n            var port = parseInt(buffer, 10);\n            if (port > 0xFFFF) return INVALID_PORT;\n            url.port = (isSpecial(url) && port === specialSchemes[url.scheme]) ? null : port;\n            buffer = '';\n          }\n          if (stateOverride) return;\n          state = PATH_START;\n          continue;\n        } else return INVALID_PORT;\n        break;\n\n      case FILE:\n        url.scheme = 'file';\n        if (char == '/' || char == '\\\\') state = FILE_SLASH;\n        else if (base && base.scheme == 'file') {\n          if (char == EOF) {\n            url.host = base.host;\n            url.path = base.path.slice();\n            url.query = base.query;\n          } else if (char == '?') {\n            url.host = base.host;\n            url.path = base.path.slice();\n            url.query = '';\n            state = QUERY;\n          } else if (char == '#') {\n            url.host = base.host;\n            url.path = base.path.slice();\n            url.query = base.query;\n            url.fragment = '';\n            state = FRAGMENT;\n          } else {\n            if (!startsWithWindowsDriveLetter(codePoints.slice(pointer).join(''))) {\n              url.host = base.host;\n              url.path = base.path.slice();\n              shortenURLsPath(url);\n            }\n            state = PATH;\n            continue;\n          }\n        } else {\n          state = PATH;\n          continue;\n        } break;\n\n      case FILE_SLASH:\n        if (char == '/' || char == '\\\\') {\n          state = FILE_HOST;\n          break;\n        }\n        if (base && base.scheme == 'file' && !startsWithWindowsDriveLetter(codePoints.slice(pointer).join(''))) {\n          if (isWindowsDriveLetter(base.path[0], true)) url.path.push(base.path[0]);\n          else url.host = base.host;\n        }\n        state = PATH;\n        continue;\n\n      case FILE_HOST:\n        if (char == EOF || char == '/' || char == '\\\\' || char == '?' || char == '#') {\n          if (!stateOverride && isWindowsDriveLetter(buffer)) {\n            state = PATH;\n          } else if (buffer == '') {\n            url.host = '';\n            if (stateOverride) return;\n            state = PATH_START;\n          } else {\n            failure = parseHost(url, buffer);\n            if (failure) return failure;\n            if (url.host == 'localhost') url.host = '';\n            if (stateOverride) return;\n            buffer = '';\n            state = PATH_START;\n          } continue;\n        } else buffer += char;\n        break;\n\n      case PATH_START:\n        if (isSpecial(url)) {\n          state = PATH;\n          if (char != '/' && char != '\\\\') continue;\n        } else if (!stateOverride && char == '?') {\n          url.query = '';\n          state = QUERY;\n        } else if (!stateOverride && char == '#') {\n          url.fragment = '';\n          state = FRAGMENT;\n        } else if (char != EOF) {\n          state = PATH;\n          if (char != '/') continue;\n        } break;\n\n      case PATH:\n        if (\n          char == EOF || char == '/' ||\n          (char == '\\\\' && isSpecial(url)) ||\n          (!stateOverride && (char == '?' || char == '#'))\n        ) {\n          if (isDoubleDot(buffer)) {\n            shortenURLsPath(url);\n            if (char != '/' && !(char == '\\\\' && isSpecial(url))) {\n              url.path.push('');\n            }\n          } else if (isSingleDot(buffer)) {\n            if (char != '/' && !(char == '\\\\' && isSpecial(url))) {\n              url.path.push('');\n            }\n          } else {\n            if (url.scheme == 'file' && !url.path.length && isWindowsDriveLetter(buffer)) {\n              if (url.host) url.host = '';\n              buffer = buffer.charAt(0) + ':'; // normalize windows drive letter\n            }\n            url.path.push(buffer);\n          }\n          buffer = '';\n          if (url.scheme == 'file' && (char == EOF || char == '?' || char == '#')) {\n            while (url.path.length > 1 && url.path[0] === '') {\n              url.path.shift();\n            }\n          }\n          if (char == '?') {\n            url.query = '';\n            state = QUERY;\n          } else if (char == '#') {\n            url.fragment = '';\n            state = FRAGMENT;\n          }\n        } else {\n          buffer += percentEncode(char, pathPercentEncodeSet);\n        } break;\n\n      case CANNOT_BE_A_BASE_URL_PATH:\n        if (char == '?') {\n          url.query = '';\n          state = QUERY;\n        } else if (char == '#') {\n          url.fragment = '';\n          state = FRAGMENT;\n        } else if (char != EOF) {\n          url.path[0] += percentEncode(char, C0ControlPercentEncodeSet);\n        } break;\n\n      case QUERY:\n        if (!stateOverride && char == '#') {\n          url.fragment = '';\n          state = FRAGMENT;\n        } else if (char != EOF) {\n          if (char == \"'\" && isSpecial(url)) url.query += '%27';\n          else if (char == '#') url.query += '%23';\n          else url.query += percentEncode(char, C0ControlPercentEncodeSet);\n        } break;\n\n      case FRAGMENT:\n        if (char != EOF) url.fragment += percentEncode(char, fragmentPercentEncodeSet);\n        break;\n    }\n\n    pointer++;\n  }\n};\n\n// `URL` constructor\n// https://url.spec.whatwg.org/#url-class\nvar URLConstructor = function URL(url /* , base */) {\n  var that = anInstance(this, URLConstructor, 'URL');\n  var base = arguments.length > 1 ? arguments[1] : undefined;\n  var urlString = String(url);\n  var state = setInternalState(that, { type: 'URL' });\n  var baseState, failure;\n  if (base !== undefined) {\n    if (base instanceof URLConstructor) baseState = getInternalURLState(base);\n    else {\n      failure = parseURL(baseState = {}, String(base));\n      if (failure) throw TypeError(failure);\n    }\n  }\n  failure = parseURL(state, urlString, null, baseState);\n  if (failure) throw TypeError(failure);\n  var searchParams = state.searchParams = new URLSearchParams();\n  var searchParamsState = getInternalSearchParamsState(searchParams);\n  searchParamsState.updateSearchParams(state.query);\n  searchParamsState.updateURL = function () {\n    state.query = String(searchParams) || null;\n  };\n  if (!DESCRIPTORS) {\n    that.href = serializeURL.call(that);\n    that.origin = getOrigin.call(that);\n    that.protocol = getProtocol.call(that);\n    that.username = getUsername.call(that);\n    that.password = getPassword.call(that);\n    that.host = getHost.call(that);\n    that.hostname = getHostname.call(that);\n    that.port = getPort.call(that);\n    that.pathname = getPathname.call(that);\n    that.search = getSearch.call(that);\n    that.searchParams = getSearchParams.call(that);\n    that.hash = getHash.call(that);\n  }\n};\n\nvar URLPrototype = URLConstructor.prototype;\n\nvar serializeURL = function () {\n  var url = getInternalURLState(this);\n  var scheme = url.scheme;\n  var username = url.username;\n  var password = url.password;\n  var host = url.host;\n  var port = url.port;\n  var path = url.path;\n  var query = url.query;\n  var fragment = url.fragment;\n  var output = scheme + ':';\n  if (host !== null) {\n    output += '//';\n    if (includesCredentials(url)) {\n      output += username + (password ? ':' + password : '') + '@';\n    }\n    output += serializeHost(host);\n    if (port !== null) output += ':' + port;\n  } else if (scheme == 'file') output += '//';\n  output += url.cannotBeABaseURL ? path[0] : path.length ? '/' + path.join('/') : '';\n  if (query !== null) output += '?' + query;\n  if (fragment !== null) output += '#' + fragment;\n  return output;\n};\n\nvar getOrigin = function () {\n  var url = getInternalURLState(this);\n  var scheme = url.scheme;\n  var port = url.port;\n  if (scheme == 'blob') try {\n    return new URL(scheme.path[0]).origin;\n  } catch (error) {\n    return 'null';\n  }\n  if (scheme == 'file' || !isSpecial(url)) return 'null';\n  return scheme + '://' + serializeHost(url.host) + (port !== null ? ':' + port : '');\n};\n\nvar getProtocol = function () {\n  return getInternalURLState(this).scheme + ':';\n};\n\nvar getUsername = function () {\n  return getInternalURLState(this).username;\n};\n\nvar getPassword = function () {\n  return getInternalURLState(this).password;\n};\n\nvar getHost = function () {\n  var url = getInternalURLState(this);\n  var host = url.host;\n  var port = url.port;\n  return host === null ? ''\n    : port === null ? serializeHost(host)\n    : serializeHost(host) + ':' + port;\n};\n\nvar getHostname = function () {\n  var host = getInternalURLState(this).host;\n  return host === null ? '' : serializeHost(host);\n};\n\nvar getPort = function () {\n  var port = getInternalURLState(this).port;\n  return port === null ? '' : String(port);\n};\n\nvar getPathname = function () {\n  var url = getInternalURLState(this);\n  var path = url.path;\n  return url.cannotBeABaseURL ? path[0] : path.length ? '/' + path.join('/') : '';\n};\n\nvar getSearch = function () {\n  var query = getInternalURLState(this).query;\n  return query ? '?' + query : '';\n};\n\nvar getSearchParams = function () {\n  return getInternalURLState(this).searchParams;\n};\n\nvar getHash = function () {\n  var fragment = getInternalURLState(this).fragment;\n  return fragment ? '#' + fragment : '';\n};\n\nvar accessorDescriptor = function (getter, setter) {\n  return { get: getter, set: setter, configurable: true, enumerable: true };\n};\n\nif (DESCRIPTORS) {\n  defineProperties(URLPrototype, {\n    // `URL.prototype.href` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-href\n    href: accessorDescriptor(serializeURL, function (href) {\n      var url = getInternalURLState(this);\n      var urlString = String(href);\n      var failure = parseURL(url, urlString);\n      if (failure) throw TypeError(failure);\n      getInternalSearchParamsState(url.searchParams).updateSearchParams(url.query);\n    }),\n    // `URL.prototype.origin` getter\n    // https://url.spec.whatwg.org/#dom-url-origin\n    origin: accessorDescriptor(getOrigin),\n    // `URL.prototype.protocol` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-protocol\n    protocol: accessorDescriptor(getProtocol, function (protocol) {\n      var url = getInternalURLState(this);\n      parseURL(url, String(protocol) + ':', SCHEME_START);\n    }),\n    // `URL.prototype.username` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-username\n    username: accessorDescriptor(getUsername, function (username) {\n      var url = getInternalURLState(this);\n      var codePoints = arrayFrom(String(username));\n      if (cannotHaveUsernamePasswordPort(url)) return;\n      url.username = '';\n      for (var i = 0; i < codePoints.length; i++) {\n        url.username += percentEncode(codePoints[i], userinfoPercentEncodeSet);\n      }\n    }),\n    // `URL.prototype.password` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-password\n    password: accessorDescriptor(getPassword, function (password) {\n      var url = getInternalURLState(this);\n      var codePoints = arrayFrom(String(password));\n      if (cannotHaveUsernamePasswordPort(url)) return;\n      url.password = '';\n      for (var i = 0; i < codePoints.length; i++) {\n        url.password += percentEncode(codePoints[i], userinfoPercentEncodeSet);\n      }\n    }),\n    // `URL.prototype.host` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-host\n    host: accessorDescriptor(getHost, function (host) {\n      var url = getInternalURLState(this);\n      if (url.cannotBeABaseURL) return;\n      parseURL(url, String(host), HOST);\n    }),\n    // `URL.prototype.hostname` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-hostname\n    hostname: accessorDescriptor(getHostname, function (hostname) {\n      var url = getInternalURLState(this);\n      if (url.cannotBeABaseURL) return;\n      parseURL(url, String(hostname), HOSTNAME);\n    }),\n    // `URL.prototype.port` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-port\n    port: accessorDescriptor(getPort, function (port) {\n      var url = getInternalURLState(this);\n      if (cannotHaveUsernamePasswordPort(url)) return;\n      port = String(port);\n      if (port == '') url.port = null;\n      else parseURL(url, port, PORT);\n    }),\n    // `URL.prototype.pathname` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-pathname\n    pathname: accessorDescriptor(getPathname, function (pathname) {\n      var url = getInternalURLState(this);\n      if (url.cannotBeABaseURL) return;\n      url.path = [];\n      parseURL(url, pathname + '', PATH_START);\n    }),\n    // `URL.prototype.search` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-search\n    search: accessorDescriptor(getSearch, function (search) {\n      var url = getInternalURLState(this);\n      search = String(search);\n      if (search == '') {\n        url.query = null;\n      } else {\n        if ('?' == search.charAt(0)) search = search.slice(1);\n        url.query = '';\n        parseURL(url, search, QUERY);\n      }\n      getInternalSearchParamsState(url.searchParams).updateSearchParams(url.query);\n    }),\n    // `URL.prototype.searchParams` getter\n    // https://url.spec.whatwg.org/#dom-url-searchparams\n    searchParams: accessorDescriptor(getSearchParams),\n    // `URL.prototype.hash` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-hash\n    hash: accessorDescriptor(getHash, function (hash) {\n      var url = getInternalURLState(this);\n      hash = String(hash);\n      if (hash == '') {\n        url.fragment = null;\n        return;\n      }\n      if ('#' == hash.charAt(0)) hash = hash.slice(1);\n      url.fragment = '';\n      parseURL(url, hash, FRAGMENT);\n    })\n  });\n}\n\n// `URL.prototype.toJSON` method\n// https://url.spec.whatwg.org/#dom-url-tojson\nredefine(URLPrototype, 'toJSON', function toJSON() {\n  return serializeURL.call(this);\n}, { enumerable: true });\n\n// `URL.prototype.toString` method\n// https://url.spec.whatwg.org/#URL-stringification-behavior\nredefine(URLPrototype, 'toString', function toString() {\n  return serializeURL.call(this);\n}, { enumerable: true });\n\nif (NativeURL) {\n  var nativeCreateObjectURL = NativeURL.createObjectURL;\n  var nativeRevokeObjectURL = NativeURL.revokeObjectURL;\n  // `URL.createObjectURL` method\n  // https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL\n  // eslint-disable-next-line no-unused-vars\n  if (nativeCreateObjectURL) redefine(URLConstructor, 'createObjectURL', function createObjectURL(blob) {\n    return nativeCreateObjectURL.apply(NativeURL, arguments);\n  });\n  // `URL.revokeObjectURL` method\n  // https://developer.mozilla.org/en-US/docs/Web/API/URL/revokeObjectURL\n  // eslint-disable-next-line no-unused-vars\n  if (nativeRevokeObjectURL) redefine(URLConstructor, 'revokeObjectURL', function revokeObjectURL(url) {\n    return nativeRevokeObjectURL.apply(NativeURL, arguments);\n  });\n}\n\nsetToStringTag(URLConstructor, 'URL');\n\n$({ global: true, forced: !USE_NATIVE_URL, sham: !DESCRIPTORS }, {\n  URL: URLConstructor\n});\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    cacheHas = require('./_cacheHas'),\n    createSet = require('./_createSet'),\n    setToArray = require('./_setToArray');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : createSet(array);\n    if (set) {\n      return setToArray(set);\n    }\n    isCommon = false;\n    includes = cacheHas;\n    seen = new SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseUniq;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayFilter;\n","var overArg = require('./_overArg');\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nmodule.exports = getPrototype;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    entryFactory = require('../../../factory/EntryFactory');\n\n\nmodule.exports = function(group, element, translate) {\n  if (is(element, 'camunda:Assignable')) {\n\n    // Assignee\n    group.entries.push(entryFactory.textField({\n      id : 'assignee',\n      label : translate('Assignee'),\n      modelProperty : 'assignee'\n    }));\n\n    // Candidate Users\n    group.entries.push(entryFactory.textField({\n      id : 'candidateUsers',\n      label : translate('Candidate Users'),\n      modelProperty : 'candidateUsers'\n    }));\n\n    // Candidate Groups\n    group.entries.push(entryFactory.textField({\n      id : 'candidateGroups',\n      label : translate('Candidate Groups'),\n      modelProperty : 'candidateGroups'\n    }));\n\n    // Due Date\n    group.entries.push(entryFactory.textField({\n      id : 'dueDate',\n      description : translate('The due date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)'),\n      label : translate('Due Date'),\n      modelProperty : 'dueDate'\n    }));\n\n    // FollowUp Date\n    group.entries.push(entryFactory.textField({\n      id : 'followUpDate',\n      description : translate('The follow up date as an EL expression (e.g. ${someDate} or an ' +\n                    'ISO date (e.g. 2015-06-26T09:54:00)'),\n      label : translate('Follow Up Date'),\n      modelProperty : 'followUpDate'\n    }));\n\n    // priority\n    group.entries.push(entryFactory.textField({\n      id : 'priority',\n      label : translate('Priority'),\n      modelProperty : 'priority'\n    }));\n  }\n};\n","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    arrayMap = require('./_arrayMap'),\n    baseUnary = require('./_baseUnary'),\n    cacheHas = require('./_cacheHas');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee == null ? value : iteratee(value);\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseDifference;\n","var baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nmodule.exports = createAssigner;\n","'use strict';\n\nvar listener = require('./implementation/Listener');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var listenerEntry = listener(element, bpmnFactory, {}, translate);\n\n  group.entries = group.entries.concat(listenerEntry.entries);\n\n  return {\n    getSelectedListener: listenerEntry.getSelectedListener\n  };\n\n};\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nmodule.exports = stackDelete;\n","'use strict';\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    utils = require('../../../Utils'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\nmodule.exports = function(group, element, translate, options) {\n\n  var description = options && options.description;\n\n  // Id\n  group.entries.push(entryFactory.validationAwareTextField({\n    id: 'id',\n    label: translate('Id'),\n    description: description && translate(description),\n    modelProperty: 'id',\n    getProperty: function(element) {\n      return getBusinessObject(element).id;\n    },\n    setProperty: function(element, properties) {\n\n      element = element.labelTarget || element;\n\n      return cmdHelper.updateProperties(element, properties);\n    },\n    validate: function(element, values) {\n      var idValue = values.id;\n\n      var bo = getBusinessObject(element);\n\n      var idError = utils.isIdValid(bo, idValue, translate);\n\n      return idError ? { id: idError } : {};\n    }\n  }));\n\n};\n","'use strict';\n\nvar domQuery = require('min-dom').query,\n    domClear = require('min-dom').clear,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    forEach = require('lodash/forEach'),\n    domify = require('min-dom').domify,\n    Ids = require('ids').default;\n\nvar SPACE_REGEX = /\\s/;\n\n// for QName validation as per http://www.w3.org/TR/REC-xml/#NT-NameChar\nvar QNAME_REGEX = /^([a-z][\\w-.]*:)?[a-z_][\\w-.]*$/i;\n\n// for ID validation as per BPMN Schema (QName - Namespace)\nvar ID_REGEX = /^[a-z_][\\w-.]*$/i;\n\nvar HTML_ESCAPE_MAP = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  '\\'': '&#39;'\n};\n\nfunction selectedOption(selectBox) {\n  if (selectBox.selectedIndex >= 0) {\n    return selectBox.options[selectBox.selectedIndex].value;\n  }\n}\n\nmodule.exports.selectedOption = selectedOption;\n\n\nfunction selectedType(elementSyntax, inputNode) {\n  var typeSelect = domQuery(elementSyntax, inputNode);\n  return selectedOption(typeSelect);\n}\n\nmodule.exports.selectedType = selectedType;\n\n\n/**\n * Retrieve the root element the document this\n * business object is contained in.\n *\n * @return {ModdleElement}\n */\nfunction getRoot(businessObject) {\n  var parent = businessObject;\n  while (parent.$parent) {\n    parent = parent.$parent;\n  }\n  return parent;\n}\n\nmodule.exports.getRoot = getRoot;\n\n\n/**\n * filters all elements in the list which have a given type.\n * removes a new list\n */\nfunction filterElementsByType(objectList, type) {\n  var list = objectList || [];\n  var result = [];\n  forEach(list, function(obj) {\n    if (is(obj, type)) {\n      result.push(obj);\n    }\n  });\n  return result;\n}\n\nmodule.exports.filterElementsByType = filterElementsByType;\n\n\nfunction findRootElementsByType(businessObject, referencedType) {\n  var root = getRoot(businessObject);\n\n  return filterElementsByType(root.rootElements, referencedType);\n}\n\nmodule.exports.findRootElementsByType = findRootElementsByType;\n\n\nfunction removeAllChildren(domElement) {\n  while (domElement.firstChild) {\n    domElement.removeChild(domElement.firstChild);\n  }\n}\n\nmodule.exports.removeAllChildren = removeAllChildren;\n\n\n/**\n * adds an empty option to the list\n */\nfunction addEmptyParameter(list) {\n  return list.push({ 'label': '', 'value': '', 'name': '' });\n}\n\nmodule.exports.addEmptyParameter = addEmptyParameter;\n\n\n/**\n * returns a list with all root elements for the given parameter 'referencedType'\n */\nfunction refreshOptionsModel(businessObject, referencedType) {\n  var model = [];\n  var referableObjects = findRootElementsByType(businessObject, referencedType);\n  forEach(referableObjects, function(obj) {\n    model.push({\n      label: (obj.name || '') + ' (id='+obj.id+')',\n      value: obj.id,\n      name: obj.name\n    });\n  });\n  return model;\n}\n\nmodule.exports.refreshOptionsModel = refreshOptionsModel;\n\n\n/**\n * fills the drop down with options\n */\nfunction updateOptionsDropDown(domSelector, businessObject, referencedType, entryNode) {\n  var options = refreshOptionsModel(businessObject, referencedType);\n  addEmptyParameter(options);\n  var selectBox = domQuery(domSelector, entryNode);\n  domClear(selectBox);\n\n  forEach(options, function(option) {\n    var optionEntry = domify('<option value=\"' + escapeHTML(option.value) + '\">' + escapeHTML(option.label) + '</option>');\n    selectBox.appendChild(optionEntry);\n  });\n  return options;\n}\n\nmodule.exports.updateOptionsDropDown = updateOptionsDropDown;\n\n\n/**\n * checks whether the id value is valid\n *\n * @param {ModdleElement} bo\n * @param {String} idValue\n * @param {Function} translate\n *\n * @return {String} error message\n */\nfunction isIdValid(bo, idValue, translate) {\n  var assigned = bo.$model.ids.assigned(idValue);\n\n  var idExists = assigned && assigned !== bo;\n\n  if (!idValue || idExists) {\n    return translate('Element must have an unique id.');\n  }\n\n  return validateId(idValue, translate);\n}\n\nmodule.exports.isIdValid = isIdValid;\n\n\nfunction validateId(idValue, translate) {\n\n  if (containsSpace(idValue)) {\n    return translate('Id must not contain spaces.');\n  }\n\n  if (!ID_REGEX.test(idValue)) {\n\n    if (QNAME_REGEX.test(idValue)) {\n      return translate('Id must not contain prefix.');\n    }\n\n    return translate('Id must be a valid QName.');\n  }\n}\n\nmodule.exports.validateId = validateId;\n\n\nfunction containsSpace(value) {\n  return SPACE_REGEX.test(value);\n}\n\nmodule.exports.containsSpace = containsSpace;\n\n/**\n * generate a semantic id with given prefix\n */\nfunction nextId(prefix) {\n  var ids = new Ids([32,32,1]);\n\n  return ids.nextPrefixed(prefix);\n}\n\nmodule.exports.nextId = nextId;\n\n\nfunction triggerClickEvent(element) {\n  var evt;\n  var eventType = 'click';\n\n  if (document.createEvent) {\n    try {\n      // Chrome, Safari, Firefox\n      evt = new MouseEvent((eventType), { view: window, bubbles: true, cancelable: true });\n    } catch (e) {\n      // IE 11, PhantomJS (wat!)\n      evt = document.createEvent('MouseEvent');\n\n      evt.initEvent((eventType), true, true);\n    }\n    return element.dispatchEvent(evt);\n  } else {\n    // Welcome IE\n    evt = document.createEventObject();\n\n    return element.fireEvent('on' + eventType, evt);\n  }\n}\n\nmodule.exports.triggerClickEvent = triggerClickEvent;\n\n\nfunction escapeHTML(str) {\n  str = '' + str;\n\n  return str && str.replace(/[&<>\"']/g, function(match) {\n    return HTML_ESCAPE_MAP[match];\n  });\n}\n\nmodule.exports.escapeHTML = escapeHTML;\n","/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * This function is like `composeArgs` except that the arguments composition\n * is tailored for `_.partialRight`.\n *\n * @private\n * @param {Array} args The provided arguments.\n * @param {Array} partials The arguments to append to those provided.\n * @param {Array} holders The `partials` placeholder indexes.\n * @params {boolean} [isCurried] Specify composing for a curried function.\n * @returns {Array} Returns the new array of composed arguments.\n */\nfunction composeArgsRight(args, partials, holders, isCurried) {\n  var argsIndex = -1,\n      argsLength = args.length,\n      holdersIndex = -1,\n      holdersLength = holders.length,\n      rightIndex = -1,\n      rightLength = partials.length,\n      rangeLength = nativeMax(argsLength - holdersLength, 0),\n      result = Array(rangeLength + rightLength),\n      isUncurried = !isCurried;\n\n  while (++argsIndex < rangeLength) {\n    result[argsIndex] = args[argsIndex];\n  }\n  var offset = argsIndex;\n  while (++rightIndex < rightLength) {\n    result[offset + rightIndex] = partials[rightIndex];\n  }\n  while (++holdersIndex < holdersLength) {\n    if (isUncurried || argsIndex < argsLength) {\n      result[offset + holders[holdersIndex]] = args[argsIndex++];\n    }\n  }\n  return result;\n}\n\nmodule.exports = composeArgsRight;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","const {\n  is\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that verifies that an event contains maximum one event definition.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:Event')) {\n      return;\n    }\n\n    const eventDefinitions = node.eventDefinitions || [];\n\n    if (eventDefinitions.length > 1) {\n      reporter.report(node.id, 'Event has multiple event definitions');\n    }\n  }\n\n  return {\n    check\n  };\n\n};","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var arrayFilter = require('./_arrayFilter'),\n    stubArray = require('./stubArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nmodule.exports = getSymbols;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","'use strict';\n\nvar isArray = require('lodash/isArray');\nvar isObject = require('lodash/isObject');\n\nvar DROPDOWN_TYPE = 'Dropdown';\n\nvar VALID_TYPES = [ 'String', 'Text', 'Boolean', 'Hidden', DROPDOWN_TYPE ];\n\nvar PROPERTY_TYPE = 'property',\n    CAMUNDA_PROPERTY_TYPE = 'camunda:property',\n    CAMUNDA_INPUT_PARAMETER_TYPE = 'camunda:inputParameter',\n    CAMUNDA_OUTPUT_PARAMETER_TYPE = 'camunda:outputParameter',\n    CAMUNDA_IN_TYPE = 'camunda:in',\n    CAMUNDA_OUT_TYPE = 'camunda:out',\n    CAMUNDA_IN_BUSINESS_KEY_TYPE = 'camunda:in:businessKey',\n    CAMUNDA_EXECUTION_LISTENER = 'camunda:executionListener',\n    CAMUNDA_FIELD = 'camunda:field';\n\nvar VALID_BINDING_TYPES = [\n  PROPERTY_TYPE,\n  CAMUNDA_PROPERTY_TYPE,\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE,\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_OUT_TYPE,\n  CAMUNDA_IN_BUSINESS_KEY_TYPE,\n  CAMUNDA_EXECUTION_LISTENER,\n  CAMUNDA_FIELD\n];\n\n\n/**\n * A element template validator.\n */\nfunction Validator() {\n\n  this._templatesById = {};\n\n  this._validTemplates = [];\n  this._errors = [];\n\n\n  /**\n   * Adds the templates.\n   *\n   * @param {Array<TemplateDescriptor>} templates\n   *\n   * @return {Validator} self\n   */\n  this.addAll = function(templates) {\n\n    if (!isArray(templates)) {\n      this._logError('templates must be []');\n    } else {\n      templates.forEach(this.add, this);\n    }\n\n    return this;\n  };\n\n  /**\n   * Add the given element template, if it is valid.\n   *\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Validator} self\n   */\n  this.add = function(template) {\n\n    var err = this._validateTemplate(template);\n\n    if (!err) {\n      this._templatesById[template.id] = template;\n\n      this._validTemplates.push(template);\n    }\n\n    return this;\n  };\n\n  /**\n   * Validate given template and return error (if any).\n   *\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Error} validation error, if any\n   */\n  this._validateTemplate = function(template) {\n\n    var err,\n        id = template.id,\n        appliesTo = template.appliesTo,\n        properties = template.properties,\n        scopes = template.scopes;\n\n    if (!id) {\n      return this._logError('missing template id');\n    }\n\n    if (id in this._templatesById) {\n      return this._logError('template id <' + id + '> already used');\n    }\n\n    if (!isArray(appliesTo)) {\n      err = this._logError('missing appliesTo=[]', template);\n    }\n\n    if (!isArray(properties)) {\n      err = this._logError('missing properties=[]', template);\n    } else {\n      if (!this._validateProperties(properties)) {\n        err = new Error('invalid properties');\n      }\n    }\n\n    if (scopes) {\n      err = this._validateScopes(template, scopes);\n    }\n\n    return err;\n  };\n\n  this._validateScopes = function(template, scopes) {\n\n    var err,\n        scope,\n        scopeName;\n\n    if (!isObject(scopes) || isArray(scopes)) {\n      return this._logError('invalid scopes, should be scopes={}', template);\n    }\n\n    for (scopeName in scopes) {\n      scope = scopes[scopeName];\n\n      if (!isObject(scope) || isArray(scope)) {\n        err = this._logError('invalid scope, should be scope={}', template);\n      }\n\n      if (!isArray(scope.properties)) {\n        err = this._logError(\n          'missing properties=[] in scope <' + scopeName + '>', template\n        );\n      } else {\n        if (!this._validateProperties(scope.properties)) {\n          err = new Error('invalid properties in scope <' + scopeName + '>');\n        }\n      }\n    }\n\n    return err;\n  };\n\n  /**\n   * Validate properties and return false if any is invalid.\n   *\n   * @param {Array<PropertyDescriptor>} properties\n   *\n   * @return {Boolean} true if all properties are valid\n   */\n  this._validateProperties = function(properties) {\n    var validProperties = properties.filter(this._validateProperty, this);\n\n    return properties.length === validProperties.length;\n  };\n\n  /**\n   * Validate property and return false, if there was\n   * a validation error.\n   *\n   * @param {PropertyDescriptor} property\n   *\n   * @return {Boolean} true if property is valid\n   */\n  this._validateProperty = function(property) {\n\n    var type = property.type,\n        binding = property.binding;\n\n    var err;\n\n    var bindingType = binding.type;\n\n    if (VALID_TYPES.indexOf(type) === -1) {\n      err = this._logError(\n        'invalid property type <' + type + '>; ' +\n        'must be any of { ' + VALID_TYPES.join(', ') + ' }'\n      );\n    }\n\n    if (type === DROPDOWN_TYPE && bindingType !== CAMUNDA_EXECUTION_LISTENER) {\n      if (!isArray(property.choices)) {\n        err = this._logError(\n          'must provide choices=[] with ' + DROPDOWN_TYPE + ' type'\n        );\n      } else\n\n      if (!property.choices.every(isDropdownChoiceValid)) {\n        err = this._logError(\n          '{ name, value } must be specified for ' +\n          DROPDOWN_TYPE + ' choices'\n        );\n      }\n    }\n\n    if (!binding) {\n      return this._logError('property missing binding');\n    }\n\n    if (VALID_BINDING_TYPES.indexOf(bindingType) === -1) {\n      err = this._logError(\n        'invalid property.binding type <' + bindingType + '>; ' +\n        'must be any of { ' + VALID_BINDING_TYPES.join(', ') + ' }'\n      );\n    }\n\n    if (bindingType === PROPERTY_TYPE ||\n        bindingType === CAMUNDA_PROPERTY_TYPE ||\n        bindingType === CAMUNDA_INPUT_PARAMETER_TYPE ||\n        bindingType === CAMUNDA_FIELD) {\n\n      if (!binding.name) {\n        err = this._logError(\n          'property.binding <' + bindingType + '> requires name'\n        );\n      }\n    }\n\n    if (bindingType === CAMUNDA_OUTPUT_PARAMETER_TYPE) {\n      if (!binding.source) {\n        err = this._logError(\n          'property.binding <' + bindingType + '> requires source'\n        );\n      }\n    }\n\n    if (bindingType === CAMUNDA_IN_TYPE) {\n\n      if (!binding.variables && !binding.target) {\n        err = this._logError(\n          'property.binding <' + bindingType + '> requires ' +\n          'variables or target'\n        );\n      }\n    }\n\n    if (bindingType === CAMUNDA_OUT_TYPE) {\n\n      if (!binding.variables && !binding.source && !binding.sourceExpression) {\n        err = this._logError(\n          'property.binding <' + bindingType + '> requires ' +\n          'variables, sourceExpression or source'\n        );\n      }\n    }\n\n    if (bindingType === CAMUNDA_EXECUTION_LISTENER) {\n\n      if (type !== 'Hidden') {\n        err = this._logError(\n          'invalid property type <' + type + '> for ' + CAMUNDA_EXECUTION_LISTENER + '; ' +\n          'must be <Hidden>'\n        );\n      }\n    }\n\n    return !err;\n  };\n\n\n  this._logError = function(err, template) {\n\n    if (typeof err === 'string') {\n      if (template) {\n        err = 'template(id: ' + template.id + ') ' + err;\n      }\n\n      err = new Error(err);\n    }\n\n    this._errors.push(err);\n\n    return err;\n  };\n\n  this.getErrors = function() {\n    return this._errors;\n  };\n\n  this.getValidTemplates = function() {\n    return this._validTemplates;\n  };\n}\n\nmodule.exports = Validator;\n\n\n// helpers ///////////////////////////////////\n\nfunction isDropdownChoiceValid(c) {\n  return 'name' in c && 'value' in c;\n}\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    inputOutputHelper = require('../../../../helper/InputOutputHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar extensionElementsEntry = require('./ExtensionElements');\n\n\nfunction getInputOutput(element, insideConnector) {\n  return inputOutputHelper.getInputOutput(element, insideConnector);\n}\n\nfunction getConnector(element) {\n  return inputOutputHelper.getConnector(element);\n}\n\nfunction getInputParameters(element, insideConnector) {\n  return inputOutputHelper.getInputParameters(element, insideConnector);\n}\n\nfunction getOutputParameters(element, insideConnector) {\n  return inputOutputHelper.getOutputParameters(element, insideConnector);\n}\n\nfunction getInputParameter(element, insideConnector, idx) {\n  return inputOutputHelper.getInputParameter(element, insideConnector, idx);\n}\n\nfunction getOutputParameter(element, insideConnector, idx) {\n  return inputOutputHelper.getOutputParameter(element, insideConnector, idx);\n}\n\n\nfunction createElement(type, parent, factory, properties) {\n  return elementHelper.createElement(type, properties, parent, factory);\n}\n\nfunction createInputOutput(parent, bpmnFactory, properties) {\n  return createElement('camunda:InputOutput', parent, bpmnFactory, properties);\n}\n\nfunction createParameter(type, parent, bpmnFactory, properties) {\n  return createElement(type, parent, bpmnFactory, properties);\n}\n\n\nfunction ensureInputOutputSupported(element, insideConnector) {\n  return inputOutputHelper.isInputOutputSupported(element, insideConnector);\n}\n\nfunction ensureOutparameterSupported(element, insideConnector) {\n  return inputOutputHelper.areOutputParametersSupported(element, insideConnector);\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var TYPE_LABEL = {\n    'camunda:Map': translate('Map'),\n    'camunda:List': translate('List'),\n    'camunda:Script': translate('Script')\n  };\n\n  options = options || {};\n\n  var insideConnector = !!options.insideConnector,\n      idPrefix = options.idPrefix || '';\n\n  var getSelected = function(element, node) {\n    var selection = (inputEntry && inputEntry.getSelected(element, node)) || { idx: -1 };\n\n    var parameter = getInputParameter(element, insideConnector, selection.idx);\n    if (!parameter && outputEntry) {\n      selection = outputEntry.getSelected(element, node);\n      parameter = getOutputParameter(element, insideConnector, selection.idx);\n    }\n    return parameter;\n  };\n\n  var result = {\n    getSelectedParameter: getSelected\n  };\n\n  var entries = result.entries = [];\n\n  if (!ensureInputOutputSupported(element)) {\n    return result;\n  }\n\n  var newElement = function(type, prop, factory) {\n\n    return function(element, extensionElements, value) {\n      var commands = [];\n\n      var inputOutput = getInputOutput(element, insideConnector);\n      if (!inputOutput) {\n        var parent = !insideConnector ? extensionElements : getConnector(element);\n        inputOutput = createInputOutput(parent, bpmnFactory, {\n          inputParameters: [],\n          outputParameters: []\n        });\n\n        if (!insideConnector) {\n          commands.push(cmdHelper.addAndRemoveElementsFromList(\n            element,\n            extensionElements,\n            'values',\n            'extensionElements',\n            [ inputOutput ],\n            []\n          ));\n        } else {\n          commands.push(cmdHelper.updateBusinessObject(element, parent, { inputOutput: inputOutput }));\n        }\n      }\n\n      var newElem = createParameter(type, inputOutput, bpmnFactory, { name: value });\n      commands.push(cmdHelper.addElementsTolist(element, inputOutput, prop, [ newElem ]));\n\n      return commands;\n    };\n  };\n\n  var removeElement = function(getter, prop, otherProp) {\n    return function(element, extensionElements, value, idx) {\n      var inputOutput = getInputOutput(element, insideConnector);\n      var parameter = getter(element, insideConnector, idx);\n\n      var commands = [];\n      commands.push(cmdHelper.removeElementsFromList(element, inputOutput, prop, null, [ parameter ]));\n\n      var firstLength = inputOutput.get(prop).length-1;\n      var secondLength = (inputOutput.get(otherProp) || []).length;\n\n      if (!firstLength && !secondLength) {\n\n        if (!insideConnector) {\n          commands.push(extensionElementsHelper.removeEntry(getBusinessObject(element), element, inputOutput));\n        } else {\n          var connector = getConnector(element);\n          commands.push(cmdHelper.updateBusinessObject(element, connector, { inputOutput: undefined }));\n        }\n\n      }\n\n      return commands;\n    };\n  };\n\n  var setOptionLabelValue = function(getter) {\n    return function(element, node, option, property, value, idx) {\n      var parameter = getter(element, insideConnector, idx);\n\n      var suffix = 'Text';\n\n      var definition = parameter.get('definition');\n      if (typeof definition !== 'undefined') {\n        var type = definition.$type;\n        suffix = TYPE_LABEL[type];\n      }\n\n      option.text = (value || '') + ' : ' + suffix;\n    };\n  };\n\n\n  // input parameters ///////////////////////////////////////////////////////////////\n\n  var inputEntry = extensionElementsEntry(element, bpmnFactory, {\n    id: idPrefix + 'inputs',\n    label: translate('Input Parameters'),\n    modelProperty: 'name',\n    prefix: 'Input',\n    resizable: true,\n\n    createExtensionElement: newElement('camunda:InputParameter', 'inputParameters'),\n    removeExtensionElement: removeElement(getInputParameter, 'inputParameters', 'outputParameters'),\n\n    getExtensionElements: function(element) {\n      return getInputParameters(element, insideConnector);\n    },\n\n    onSelectionChange: function(element, node, event, scope) {\n      outputEntry && outputEntry.deselect(element, node);\n    },\n\n    setOptionLabelValue: setOptionLabelValue(getInputParameter)\n\n  });\n  entries.push(inputEntry);\n\n\n  // output parameters ///////////////////////////////////////////////////////\n\n  if (ensureOutparameterSupported(element, insideConnector)) {\n    var outputEntry = extensionElementsEntry(element, bpmnFactory, {\n      id: idPrefix + 'outputs',\n      label: translate('Output Parameters'),\n      modelProperty: 'name',\n      prefix: 'Output',\n      resizable: true,\n\n      createExtensionElement: newElement('camunda:OutputParameter', 'outputParameters'),\n      removeExtensionElement: removeElement(getOutputParameter, 'outputParameters', 'inputParameters'),\n\n      getExtensionElements: function(element) {\n        return getOutputParameters(element, insideConnector);\n      },\n\n      onSelectionChange: function(element, node, event, scope) {\n        inputEntry.deselect(element, node);\n      },\n\n      setOptionLabelValue: setOptionLabelValue(getOutputParameter)\n\n    });\n    entries.push(outputEntry);\n  }\n\n  return result;\n\n};\n","var LazyWrapper = require('./_LazyWrapper'),\n    getData = require('./_getData'),\n    getFuncName = require('./_getFuncName'),\n    lodash = require('./wrapperLodash');\n\n/**\n * Checks if `func` has a lazy counterpart.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` has a lazy counterpart,\n *  else `false`.\n */\nfunction isLaziable(func) {\n  var funcName = getFuncName(func),\n      other = lodash[funcName];\n\n  if (typeof other != 'function' || !(funcName in LazyWrapper.prototype)) {\n    return false;\n  }\n  if (func === other) {\n    return true;\n  }\n  var data = getData(other);\n  return !!data && func === data[0];\n}\n\nmodule.exports = isLaziable;\n","const {\n  is,\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks the presence of an end event per scope.\n */\nmodule.exports = function() {\n\n  function hasEndEvent(node) {\n    const flowElements = node.flowElements || [];\n\n    return (\n      flowElements.some(node => is(node, 'bpmn:EndEvent'))\n    );\n  }\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Process',\n      'bpmn:SubProcess'\n    ])) {\n      return;\n    }\n\n    if (!hasEndEvent(node)) {\n      const type = is(node, 'bpmn:SubProcess') ? 'Sub process' : 'Process';\n\n      reporter.report(node.id, type + ' is missing end event');\n    }\n  }\n\n  return { check };\n};\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nmodule.exports = WeakMap;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var isStrictComparable = require('./_isStrictComparable'),\n    keys = require('./keys');\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nmodule.exports = getMatchData;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var historyTimeToLiveEntry = entryFactory.textField({\n    id: 'historyTimeToLive',\n    label: translate('History Time To Live'),\n    modelProperty: 'historyTimeToLive',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var historyTimeToLive = bo.get('camunda:historyTimeToLive');\n\n      return {\n        historyTimeToLive: historyTimeToLive ? historyTimeToLive : ''\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:historyTimeToLive': values.historyTimeToLive || undefined\n      });\n    }\n\n  });\n\n  return [ historyTimeToLiveEntry ];\n};\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\nvar InternalStateModule = require('../internals/internal-state');\nvar defineIterator = require('../internals/define-iterator');\n\nvar STRING_ITERATOR = 'String Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(STRING_ITERATOR);\n\n// `String.prototype[@@iterator]` method\n// https://tc39.github.io/ecma262/#sec-string.prototype-@@iterator\ndefineIterator(String, 'String', function (iterated) {\n  setInternalState(this, {\n    type: STRING_ITERATOR,\n    string: String(iterated),\n    index: 0\n  });\n// `%StringIteratorPrototype%.next` method\n// https://tc39.github.io/ecma262/#sec-%stringiteratorprototype%.next\n}, function next() {\n  var state = getInternalState(this);\n  var string = state.string;\n  var index = state.index;\n  var point;\n  if (index >= string.length) return { value: undefined, done: true };\n  point = charAt(string, index);\n  state.index += point.length;\n  return { value: point, done: false };\n});\n","var baseValues = require('./_baseValues'),\n    keys = require('./keys');\n\n/**\n * Creates an array of the own enumerable string keyed property values of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property values.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.values(new Foo);\n * // => [1, 2] (iteration order is not guaranteed)\n *\n * _.values('hi');\n * // => ['h', 'i']\n */\nfunction values(object) {\n  return object == null ? [] : baseValues(object, keys(object));\n}\n\nmodule.exports = values;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","const {\n  is\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks that start events inside a normal sub-processes\n * are blank (do not have an event definition).\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:SubProcess') || node.triggeredByEvent) {\n      return;\n    }\n\n    const flowElements = node.flowElements || [];\n\n    flowElements.forEach(function(flowElement) {\n\n      if (!is(flowElement, 'bpmn:StartEvent')) {\n        return false;\n      }\n\n      const eventDefinitions = flowElement.eventDefinitions || [];\n\n      if (eventDefinitions.length > 0) {\n        reporter.report(flowElement.id, 'Start event must be blank');\n      }\n    });\n  }\n\n  return {\n    check\n  };\n\n};","var baseAssignValue = require('./_baseAssignValue'),\n    createAggregator = require('./_createAggregator');\n\n/**\n * Creates an object composed of keys generated from the results of running\n * each element of `collection` thru `iteratee`. The corresponding value of\n * each key is the last element responsible for generating the key. The\n * iteratee is invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n * @returns {Object} Returns the composed aggregate object.\n * @example\n *\n * var array = [\n *   { 'dir': 'left', 'code': 97 },\n *   { 'dir': 'right', 'code': 100 }\n * ];\n *\n * _.keyBy(array, function(o) {\n *   return String.fromCharCode(o.code);\n * });\n * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }\n *\n * _.keyBy(array, 'dir');\n * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }\n */\nvar keyBy = createAggregator(function(result, value, key) {\n  baseAssignValue(result, key, value);\n});\n\nmodule.exports = keyBy;\n","var arrayFilter = require('./_arrayFilter'),\n    baseRest = require('./_baseRest'),\n    baseXor = require('./_baseXor'),\n    isArrayLikeObject = require('./isArrayLikeObject');\n\n/**\n * Creates an array of unique values that is the\n * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)\n * of the given arrays. The order of result values is determined by the order\n * they occur in the arrays.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.difference, _.without\n * @example\n *\n * _.xor([2, 1], [2, 3]);\n * // => [1, 3]\n */\nvar xor = baseRest(function(arrays) {\n  return baseXor(arrayFilter(arrays, isArrayLikeObject));\n});\n\nmodule.exports = xor;\n","var isKeyable = require('./_isKeyable');\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nmodule.exports = getMapData;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arraySome;\n","var DataView = require('./_DataView'),\n    Map = require('./_Map'),\n    Promise = require('./_Promise'),\n    Set = require('./_Set'),\n    WeakMap = require('./_WeakMap'),\n    baseGetTag = require('./_baseGetTag'),\n    toSource = require('./_toSource');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nmodule.exports = getTag;\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nmodule.exports = copyArray;\n","'use strict';\n\nvar ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper'),\n    InputOutputHelper = require('../../../helper/InputOutputHelper');\n\nvar utils = require('../../../Utils'),\n    escapeHTML = utils.escapeHTML,\n    triggerClickEvent = utils.triggerClickEvent;\n\nvar implementationType = require('./implementation/ImplementationType'),\n    delegate = require('./implementation/Delegate'),\n    external = require('./implementation/External'),\n    callable = require('./implementation/Callable'),\n    resultVariable = require('./implementation/ResultVariable');\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\nvar domQuery = require('min-dom').query,\n    domClosest = require('min-dom').closest,\n    domClasses = require('min-dom').classes;\n\nfunction getImplementationType(element) {\n  return ImplementationTypeHelper.getImplementationType(element);\n}\n\nfunction getBusinessObject(element) {\n  return ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n}\n\nfunction isDmnCapable(element) {\n  return ImplementationTypeHelper.isDmnCapable(element);\n}\n\nfunction isExternalCapable(element) {\n  return ImplementationTypeHelper.isExternalCapable(element);\n}\n\nfunction isServiceTaskLike(element) {\n  return ImplementationTypeHelper.isServiceTaskLike(element);\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (!isServiceTaskLike(getBusinessObject(element))) {\n    return;\n  }\n\n  var hasDmnSupport = isDmnCapable(element);\n  var hasExternalSupport = isExternalCapable(getBusinessObject(element));\n\n  // implementation type ////////////////////////////////////\n\n  group.entries = group.entries.concat(implementationType(element, bpmnFactory, {\n    getBusinessObject: getBusinessObject,\n    getImplementationType: getImplementationType,\n    hasDmnSupport: hasDmnSupport,\n    hasExternalSupport: hasExternalSupport,\n    hasServiceTaskLikeSupport: true\n  }, translate));\n\n\n  // delegate (class, expression, delegateExpression) //////////\n\n  group.entries = group.entries.concat(delegate(element, bpmnFactory, {\n    getBusinessObject: getBusinessObject,\n    getImplementationType: getImplementationType\n  }, translate));\n\n\n  // result variable /////////////////////////////////////////\n\n  group.entries = group.entries.concat(resultVariable(element, bpmnFactory, {\n    getBusinessObject: getBusinessObject,\n    getImplementationType: getImplementationType,\n    hideResultVariable: function(element, node) {\n      return getImplementationType(element) !== 'expression';\n    }\n  }, translate));\n\n  // external //////////////////////////////////////////////////\n\n  if (hasExternalSupport) {\n    group.entries = group.entries.concat(external(element, bpmnFactory, {\n      getBusinessObject: getBusinessObject,\n      getImplementationType: getImplementationType\n    }, translate));\n  }\n\n\n  // dmn ////////////////////////////////////////////////////////\n\n  if (hasDmnSupport) {\n    group.entries = group.entries.concat(callable(element, bpmnFactory, {\n      getCallableType: getImplementationType\n    }, translate));\n  }\n\n\n  // connector ////////////////////////////////////////////////\n\n  var isConnector = function(element) {\n    return getImplementationType(element) === 'connector';\n  };\n\n  group.entries.push(entryFactory.link({\n    id: 'configureConnectorLink',\n    label: translate('Configure Connector'),\n    handleClick: function(element, node, event) {\n\n      var connectorTabEl = getTabNode(node, 'connector');\n\n      if (connectorTabEl) {\n        triggerClickEvent(connectorTabEl);\n      }\n\n      // suppress actual link click\n      return false;\n    },\n    showLink: function(element, node) {\n      var link = domQuery('a', node);\n      link.textContent = '';\n\n      domClasses(link).remove('bpp-error-message');\n\n      if (isConnector(element)) {\n        var connectorId = InputOutputHelper.getConnector(element).get('connectorId');\n        if (connectorId) {\n          link.textContent = translate('Configure Connector');\n        } else {\n          link.innerHTML = '<span class=\"bpp-icon-warning\"></span> ' + escapeHTML(translate('Must configure Connector'));\n          domClasses(link).add('bpp-error-message');\n        }\n\n        return true;\n      }\n\n      return false;\n    }\n  }));\n\n};\n\n\n\n// helpers ///////////////////////////\n\nfunction getTabNode(el, id) {\n  var containerEl = domClosest(el, '.bpp-properties-panel');\n\n  return domQuery('a[data-tab-target=\"' + id + '\"]', containerEl);\n}","/**\n * The function whose prototype chain sequence wrappers inherit from.\n *\n * @private\n */\nfunction baseLodash() {\n  // No operation performed.\n}\n\nmodule.exports = baseLodash;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    getTemplate = require('../Helper').getTemplate,\n    getTemplateId = require('../Helper').getTemplateId;\n\nvar find = require('lodash/find');\n\nvar TEMPLATE_ATTR = require('../Helper').TEMPLATE_ATTR;\n\nfunction isAny(element, types) {\n  return types.reduce(function(result, type) {\n    return result || is(element, type);\n  }, false);\n}\n\n\nmodule.exports = function(group, element, elementTemplates, translate) {\n\n  var options = getTemplateOptions(element, elementTemplates, translate);\n\n  if (options.length === 1 && !options[0].isDefault) {\n    return;\n  }\n\n  // select element template (via dropdown)\n  group.entries.push(entryFactory.selectBox({\n    id: 'elementTemplate-chooser',\n    label: translate('Element Template'),\n    modelProperty: 'camunda:modelerTemplate',\n    selectOptions: options,\n    set: function(element, properties) {\n      return applyTemplate(element, properties[TEMPLATE_ATTR], elementTemplates);\n    },\n    disabled: function() {\n      var template = getTemplate(element, elementTemplates);\n\n      return template && isDefaultTemplate(template);\n    }\n  }));\n\n};\n\n\n// helpers //////////////////////////////////////\n\nfunction applyTemplate(element, newTemplateId, elementTemplates) {\n\n  // cleanup\n  // clear input output mappings\n  // undo changes to properties defined in template\n\n  // re-establish\n  // set input output mappings\n  // apply changes to properties as defined in new template\n\n  var oldTemplate = getTemplate(element, elementTemplates),\n      newTemplate = elementTemplates.get(newTemplateId);\n\n  if (oldTemplate === newTemplate) {\n    return;\n  }\n\n  return {\n    cmd: 'propertiesPanel.camunda.changeTemplate',\n    context: {\n      element: element,\n      oldTemplate: oldTemplate,\n      newTemplate: newTemplate\n    }\n  };\n}\n\nfunction getTemplateOptions(element, elementTemplates, translate) {\n\n  var currentTemplateId = getTemplateId(element);\n\n  var emptyOption = {\n    name: '',\n    value: ''\n  };\n\n  var allOptions = elementTemplates.getAll().reduce(function(templates, t) {\n    if (!isAny(element, t.appliesTo)) {\n      return templates;\n    }\n\n    return templates.concat({\n      name: translate(t.name),\n      value: t.id,\n      isDefault: t.isDefault\n    });\n  }, [ emptyOption ]);\n\n\n  var defaultOption = find(allOptions, function(option) {\n    return isDefaultTemplate(option);\n  });\n\n  var currentOption = find(allOptions, function(option) {\n    return option.value === currentTemplateId;\n  });\n\n  if (currentTemplateId && !currentOption) {\n    currentOption = unknownTemplate(currentTemplateId, translate);\n\n    allOptions.push(currentOption);\n  }\n\n  if (!defaultOption) {\n\n    // return all options, including empty\n    // and optionally unknownTemplate option\n    return allOptions;\n  }\n\n  // special limited handling for\n  // default options\n\n  var options = [];\n\n  // current template not set\n  if (!currentTemplateId) {\n    options.push({\n      name: '',\n      value: ''\n    });\n  }\n\n  // current template not default\n  if (currentOption && currentOption !== defaultOption) {\n    options.push(currentOption);\n  }\n\n  options.push(defaultOption);\n\n  // [ (empty), (current), defaultOption ]\n  return options;\n}\n\nfunction unknownTemplate(templateId, translate) {\n  return {\n    name: translate('[unknown template: {templateId}]', { templateId: templateId }),\n    value: templateId\n  };\n}\n\nfunction isDefaultTemplate(elementTemplate) {\n  return elementTemplate.isDefault;\n}","var apply = require('./_apply'),\n    createCtor = require('./_createCtor'),\n    createHybrid = require('./_createHybrid'),\n    createRecurry = require('./_createRecurry'),\n    getHolder = require('./_getHolder'),\n    replaceHolders = require('./_replaceHolders'),\n    root = require('./_root');\n\n/**\n * Creates a function that wraps `func` to enable currying.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {number} arity The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createCurry(func, bitmask, arity) {\n  var Ctor = createCtor(func);\n\n  function wrapper() {\n    var length = arguments.length,\n        args = Array(length),\n        index = length,\n        placeholder = getHolder(wrapper);\n\n    while (index--) {\n      args[index] = arguments[index];\n    }\n    var holders = (length < 3 && args[0] !== placeholder && args[length - 1] !== placeholder)\n      ? []\n      : replaceHolders(args, placeholder);\n\n    length -= holders.length;\n    if (length < arity) {\n      return createRecurry(\n        func, bitmask, createHybrid, wrapper.placeholder, undefined,\n        args, holders, undefined, undefined, arity - length);\n    }\n    var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n    return apply(fn, this, args);\n  }\n  return wrapper;\n}\n\nmodule.exports = createCurry;\n","var baseFindIndex = require('./_baseFindIndex'),\n    baseIsNaN = require('./_baseIsNaN'),\n    strictIndexOf = require('./_strictIndexOf');\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? strictIndexOf(array, value, fromIndex)\n    : baseFindIndex(array, baseIsNaN, fromIndex);\n}\n\nmodule.exports = baseIndexOf;\n","var baseForOwn = require('./_baseForOwn'),\n    createBaseEach = require('./_createBaseEach');\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nmodule.exports = baseEach;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"editor\"}},[_c('el-container',[_c('el-header',{attrs:{\"height\":\"36px\"}},[_c('el-button-group',[_c('el-button',{staticClass:\"el-icon-top-left\",attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.handleImportButton}},[_vm._v(\" 导入 \"),_c('fileLoader',{attrs:{\"id\":\"fileLoader\"},on:{\"loadFile\":_vm.loadBpmnFromFile}})],1),_c('el-dropdown',[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"medium\"}},[_vm._v(\" 下载 \"),_c('i',{staticClass:\"el-icon-bottom-right\"})]),_c('el-dropdown-menu',{attrs:{\"slot\":\"dropdown\"},slot:\"dropdown\"},[_c('el-dropdown-item',[_c('a',{on:{\"click\":_vm.downloadBpmnToFile}},[_vm._v(\"下载.bpmn文件\")])]),_c('el-dropdown-item',[_c('a',{on:{\"click\":_vm.downloadBpmnToSVG}},[_vm._v(\"下载.svg文件\")])])],1)],1)],1),_c('el-button-group',[_c('el-button',{staticClass:\"el-icon-magic-stick\",attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.textTransform}},[_vm._v(\"NLP\")])],1),_c('el-button-group',[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.resetBPMN}},[_vm._v(\"重置\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.checkBPMN}},[_vm._v(\"检查\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.saveBPMN}},[_vm._v(\"保存\")])],1)],1),_c('el-main',[_c('div',{staticClass:\"bpmnContainer\"},[_c('div',{ref:\"canvas\",attrs:{\"id\":\"BpmnCanvas\"}}),_c('div',{ref:\"canvas\",attrs:{\"id\":\"BpmnProperties\"}})])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import inherits from 'inherits';\n\nimport Ids from 'ids';\n\nimport BaseViewer from './BaseViewer';\n\n\n/**\n * A base modeler for BPMN 2.0 diagrams.\n *\n * Have a look at {@link Modeler} for a bundle that includes actual features.\n *\n * @param {Object} [options] configuration options to pass to the viewer\n * @param {DOMElement} [options.container] the container to render the viewer in, defaults to body.\n * @param {String|Number} [options.width] the width of the viewer\n * @param {String|Number} [options.height] the height of the viewer\n * @param {Object} [options.moddleExtensions] extension packages to provide\n * @param {Array<didi.Module>} [options.modules] a list of modules to override the default modules\n * @param {Array<didi.Module>} [options.additionalModules] a list of modules to use with the default modules\n */\nexport default function BaseModeler(options) {\n  BaseViewer.call(this, options);\n\n  // hook ID collection into the modeler\n  this.on('import.parse.complete', function(event) {\n    if (!event.error) {\n      this._collectIds(event.definitions, event.context);\n    }\n  }, this);\n\n  this.on('diagram.destroy', function() {\n    this.get('moddle').ids.clear();\n  }, this);\n}\n\ninherits(BaseModeler, BaseViewer);\n\n\n/**\n * Create a moddle instance, attaching ids to it.\n *\n * @param {Object} options\n */\nBaseModeler.prototype._createModdle = function(options) {\n  var moddle = BaseViewer.prototype._createModdle.call(this, options);\n\n  // attach ids to moddle to be able to track\n  // and validated ids in the BPMN 2.0 XML document\n  // tree\n  moddle.ids = new Ids([ 32, 36, 1 ]);\n\n  return moddle;\n};\n\n/**\n * Collect ids processed during parsing of the\n * definitions object.\n *\n * @param {ModdleElement} definitions\n * @param {Context} context\n */\nBaseModeler.prototype._collectIds = function(definitions, context) {\n\n  var moddle = definitions.$model,\n      ids = moddle.ids,\n      id;\n\n  // remove references from previous import\n  ids.clear();\n\n  for (id in context.elementsById) {\n    ids.claim(id, context.elementsById[id]);\n  }\n};","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  event as domEvent,\n  closest as domClosest\n} from 'min-dom';\n\nimport Hammer from 'hammerjs';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\nvar MIN_ZOOM = 0.2,\n    MAX_ZOOM = 4;\n\nvar mouseEvents = [\n  'mousedown',\n  'mouseup',\n  'mouseover',\n  'mouseout',\n  'click',\n  'dblclick'\n];\n\nfunction log() {\n\n  // console.log.apply(console, arguments);\n}\n\nfunction get(service, injector) {\n  return injector.get(service, false);\n}\n\nfunction stopEvent(event) {\n\n  event.preventDefault();\n  event.stopPropagation();\n\n  if (typeof event.stopImmediatePropagation === 'function') {\n    event.stopImmediatePropagation();\n  }\n}\n\n\nfunction createTouchRecognizer(node) {\n\n  function stopMouse(event) {\n\n    forEach(mouseEvents, function(e) {\n      domEvent.bind(node, e, stopEvent, true);\n    });\n  }\n\n  function allowMouse(event) {\n    setTimeout(function() {\n      forEach(mouseEvents, function(e) {\n        domEvent.unbind(node, e, stopEvent, true);\n      });\n    }, 500);\n  }\n\n  domEvent.bind(node, 'touchstart', stopMouse, true);\n  domEvent.bind(node, 'touchend', allowMouse, true);\n  domEvent.bind(node, 'touchcancel', allowMouse, true);\n\n  // A touch event recognizer that handles\n  // touch events only (we know, we can already handle\n  // mouse events out of the box)\n\n  var recognizer = new Hammer.Manager(node, {\n    inputClass: Hammer.TouchInput,\n    recognizers: []\n  });\n\n\n  var tap = new Hammer.Tap();\n  var pan = new Hammer.Pan({ threshold: 10 });\n  var press = new Hammer.Press();\n  var pinch = new Hammer.Pinch();\n\n  var doubleTap = new Hammer.Tap({ event: 'doubletap', taps: 2 });\n\n  pinch.requireFailure(pan);\n  pinch.requireFailure(press);\n\n  recognizer.add([ pan, press, pinch, doubleTap, tap ]);\n\n  recognizer.reset = function(force) {\n    var recognizers = this.recognizers,\n        session = this.session;\n\n    if (session.stopped) {\n      return;\n    }\n\n    log('recognizer', 'stop');\n\n    recognizer.stop(force);\n\n    setTimeout(function() {\n      var i, r;\n\n      log('recognizer', 'reset');\n      for (i = 0; (r = recognizers[i]); i++) {\n        r.reset();\n        r.state = 8; // FAILED STATE\n      }\n\n      session.curRecognizer = null;\n    }, 0);\n  };\n\n  recognizer.on('hammer.input', function(event) {\n    if (event.srcEvent.defaultPrevented) {\n      recognizer.reset(true);\n    }\n  });\n\n  return recognizer;\n}\n\n/**\n * A plugin that provides touch events for elements.\n *\n * @param {EventBus} eventBus\n * @param {InteractionEvents} interactionEvents\n */\nexport default function TouchInteractionEvents(\n    injector, canvas, eventBus,\n    elementRegistry, interactionEvents) {\n\n  // optional integrations\n  var dragging = get('dragging', injector),\n      move = get('move', injector),\n      contextPad = get('contextPad', injector),\n      palette = get('palette', injector);\n\n  // the touch recognizer\n  var recognizer;\n\n  function handler(type) {\n\n    return function(event) {\n      log('element', type, event);\n\n      interactionEvents.fire(type, event);\n    };\n  }\n\n  function getGfx(target) {\n    var node = domClosest(target, 'svg, .djs-element', true);\n    return node;\n  }\n\n  function initEvents(svg) {\n\n    // touch recognizer\n    recognizer = createTouchRecognizer(svg);\n\n    recognizer.on('doubletap', handler('element.dblclick'));\n\n    recognizer.on('tap', handler('element.click'));\n\n    function startGrabCanvas(event) {\n\n      log('canvas', 'grab start');\n\n      var lx = 0, ly = 0;\n\n      function update(e) {\n\n        var dx = e.deltaX - lx,\n            dy = e.deltaY - ly;\n\n        canvas.scroll({ dx: dx, dy: dy });\n\n        lx = e.deltaX;\n        ly = e.deltaY;\n      }\n\n      function end(e) {\n        recognizer.off('panmove', update);\n        recognizer.off('panend', end);\n        recognizer.off('pancancel', end);\n\n        log('canvas', 'grab end');\n      }\n\n      recognizer.on('panmove', update);\n      recognizer.on('panend', end);\n      recognizer.on('pancancel', end);\n    }\n\n    function startGrab(event) {\n\n      var gfx = getGfx(event.target),\n          element = gfx && elementRegistry.get(gfx);\n\n      // recognizer\n      if (move && canvas.getRootElement() !== element) {\n        log('element', 'move start', element, event, true);\n        return move.start(event, element, true);\n      } else {\n        startGrabCanvas(event);\n      }\n    }\n\n    function startZoom(e) {\n\n      log('canvas', 'zoom start');\n\n      var zoom = canvas.zoom(),\n          mid = e.center;\n\n      function update(e) {\n\n        var ratio = 1 - (1 - e.scale) / 1.50,\n            newZoom = Math.max(MIN_ZOOM, Math.min(MAX_ZOOM, ratio * zoom));\n\n        canvas.zoom(newZoom, mid);\n\n        stopEvent(e);\n      }\n\n      function end(e) {\n        recognizer.off('pinchmove', update);\n        recognizer.off('pinchend', end);\n        recognizer.off('pinchcancel', end);\n\n        recognizer.reset(true);\n\n        log('canvas', 'zoom end');\n      }\n\n      recognizer.on('pinchmove', update);\n      recognizer.on('pinchend', end);\n      recognizer.on('pinchcancel', end);\n    }\n\n    recognizer.on('panstart', startGrab);\n    recognizer.on('press', startGrab);\n\n    recognizer.on('pinchstart', startZoom);\n  }\n\n  if (dragging) {\n\n    // simulate hover during dragging\n    eventBus.on('drag.move', function(event) {\n\n      var originalEvent = event.originalEvent;\n\n      if (!originalEvent || originalEvent instanceof MouseEvent) {\n        return;\n      }\n\n      var position = toPoint(originalEvent);\n\n      // this gets really expensive ...\n      var node = document.elementFromPoint(position.x, position.y),\n          gfx = getGfx(node),\n          element = gfx && elementRegistry.get(gfx);\n\n      if (element !== event.hover) {\n        if (event.hover) {\n          dragging.out(event);\n        }\n\n        if (element) {\n          dragging.hover({ element: element, gfx: gfx });\n\n          event.hover = element;\n          event.hoverGfx = gfx;\n        }\n      }\n    });\n  }\n\n  if (contextPad) {\n\n    eventBus.on('contextPad.create', function(event) {\n      var node = event.pad.html;\n\n      // touch recognizer\n      var padRecognizer = createTouchRecognizer(node);\n\n      padRecognizer.on('panstart', function(event) {\n        log('context-pad', 'panstart', event);\n        contextPad.trigger('dragstart', event, true);\n      });\n\n      padRecognizer.on('press', function(event) {\n        log('context-pad', 'press', event);\n        contextPad.trigger('dragstart', event, true);\n      });\n\n      padRecognizer.on('tap', function(event) {\n        log('context-pad', 'tap', event);\n        contextPad.trigger('click', event);\n      });\n    });\n  }\n\n  if (palette) {\n    eventBus.on('palette.create', function(event) {\n      var node = event.container;\n\n      // touch recognizer\n      var padRecognizer = createTouchRecognizer(node);\n\n      padRecognizer.on('panstart', function(event) {\n        log('palette', 'panstart', event);\n        palette.trigger('dragstart', event, true);\n      });\n\n      padRecognizer.on('press', function(event) {\n        log('palette', 'press', event);\n        palette.trigger('dragstart', event, true);\n      });\n\n      padRecognizer.on('tap', function(event) {\n        log('palette', 'tap', event);\n        palette.trigger('click', event);\n      });\n    });\n  }\n\n  eventBus.on('canvas.init', function(event) {\n    initEvents(event.svg);\n  });\n}\n\n\nTouchInteractionEvents.$inject = [\n  'injector',\n  'canvas',\n  'eventBus',\n  'elementRegistry',\n  'interactionEvents',\n  'touchFix'\n];\n","import {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate\n} from 'tiny-svg';\n\n\nexport default function TouchFix(canvas, eventBus) {\n\n  var self = this;\n\n  eventBus.on('canvas.init', function(e) {\n    self.addBBoxMarker(e.svg);\n  });\n}\n\nTouchFix.$inject = [ 'canvas', 'eventBus' ];\n\n\n/**\n * Safari mobile (iOS 7) does not fire touchstart event in <SVG> element\n * if there is no shape between 0,0 and viewport elements origin.\n *\n * So touchstart event is only fired when the <g class=\"viewport\"> element was hit.\n * Putting an element over and below the 'viewport' fixes that behavior.\n */\nTouchFix.prototype.addBBoxMarker = function(svg) {\n\n  var markerStyle = {\n    fill: 'none',\n    class: 'outer-bound-marker'\n  };\n\n  var rect1 = svgCreate('rect');\n  svgAttr(rect1, {\n    x: -10000,\n    y: 10000,\n    width: 10,\n    height: 10\n  });\n  svgAttr(rect1, markerStyle);\n\n  svgAppend(svg, rect1);\n\n  var rect2 = svgCreate('rect');\n  svgAttr(rect2, {\n    x: 10000,\n    y: 10000,\n    width: 10,\n    height: 10\n  });\n  svgAttr(rect2, markerStyle);\n\n  svgAppend(svg, rect2);\n};\n","import InteractionEventsModule from '../interaction-events';\n\nimport TouchInteractionEvents from './TouchInteractionEvents';\nimport TouchFix from './TouchFix';\n\nexport default {\n  __depends__: [ InteractionEventsModule ],\n  __init__: [ 'touchInteractionEvents' ],\n  touchInteractionEvents: [ 'type', TouchInteractionEvents ],\n  touchFix: [ 'type', TouchFix ]\n};","import TouchModule from '../../features/touch';\n\nexport default {\n  __depends__: [\n    TouchModule\n  ]\n};","import {\n  filter,\n  forEach,\n  sortBy\n} from 'min-dash';\n\nfunction last(arr) {\n  return arr && arr[arr.length - 1];\n}\n\nfunction sortTopOrMiddle(element) {\n  return element.y;\n}\n\nfunction sortLeftOrCenter(element) {\n  return element.x;\n}\n\n/**\n * Sorting functions for different types of alignment\n *\n * @type {Object}\n *\n * @return {Function}\n */\nvar ALIGNMENT_SORTING = {\n  left: sortLeftOrCenter,\n  center: sortLeftOrCenter,\n  right: function(element) {\n    return element.x + element.width;\n  },\n  top: sortTopOrMiddle,\n  middle: sortTopOrMiddle,\n  bottom: function(element) {\n    return element.y + element.height;\n  }\n};\n\n\nexport default function AlignElements(modeling) {\n  this._modeling = modeling;\n}\n\nAlignElements.$inject = [ 'modeling' ];\n\n\n/**\n * Get the relevant \"axis\" and \"dimension\" related to the current type of alignment\n *\n * @param  {String} type left|right|center|top|bottom|middle\n *\n * @return {Object} { axis, dimension }\n */\nAlignElements.prototype._getOrientationDetails = function(type) {\n  var vertical = [ 'top', 'bottom', 'middle' ],\n      axis = 'x',\n      dimension = 'width';\n\n  if (vertical.indexOf(type) !== -1) {\n    axis = 'y';\n    dimension = 'height';\n  }\n\n  return {\n    axis: axis,\n    dimension: dimension\n  };\n};\n\nAlignElements.prototype._isType = function(type, types) {\n  return types.indexOf(type) !== -1;\n};\n\n/**\n * Get a point on the relevant axis where elements should align to\n *\n * @param  {String} type left|right|center|top|bottom|middle\n * @param  {Array} sortedElements\n *\n * @return {Object}\n */\nAlignElements.prototype._alignmentPosition = function(type, sortedElements) {\n  var orientation = this._getOrientationDetails(type),\n      axis = orientation.axis,\n      dimension = orientation.dimension,\n      alignment = {},\n      centers = {},\n      hasSharedCenters = false,\n      centeredElements,\n      firstElement,\n      lastElement;\n\n  function getMiddleOrTop(first, last) {\n    return Math.round((first[axis] + last[axis] + last[dimension]) / 2);\n  }\n\n  if (this._isType(type, [ 'left', 'top' ])) {\n    alignment[type] = sortedElements[0][axis];\n\n  } else if (this._isType(type, [ 'right', 'bottom' ])) {\n    lastElement = last(sortedElements);\n\n    alignment[type] = lastElement[axis] + lastElement[dimension];\n\n  } else if (this._isType(type, [ 'center', 'middle' ])) {\n\n    // check if there is a center shared by more than one shape\n    // if not, just take the middle of the range\n    forEach(sortedElements, function(element) {\n      var center = element[axis] + Math.round(element[dimension] / 2);\n\n      if (centers[center]) {\n        centers[center].elements.push(element);\n      } else {\n        centers[center] = {\n          elements: [ element ],\n          center: center\n        };\n      }\n    });\n\n    centeredElements = sortBy(centers, function(center) {\n      if (center.elements.length > 1) {\n        hasSharedCenters = true;\n      }\n\n      return center.elements.length;\n    });\n\n    if (hasSharedCenters) {\n      alignment[type] = last(centeredElements).center;\n\n      return alignment;\n    }\n\n    firstElement = sortedElements[0];\n\n    sortedElements = sortBy(sortedElements, function(element) {\n      return element[axis] + element[dimension];\n    });\n\n    lastElement = last(sortedElements);\n\n    alignment[type] = getMiddleOrTop(firstElement, lastElement);\n  }\n\n  return alignment;\n};\n\n/**\n * Executes the alignment of a selection of elements\n *\n * @param  {Array} elements [description]\n * @param  {String} type left|right|center|top|bottom|middle\n */\nAlignElements.prototype.trigger = function(elements, type) {\n  var modeling = this._modeling;\n\n  var filteredElements = filter(elements, function(element) {\n    return !(element.waypoints || element.host || element.labelTarget);\n  });\n\n  var sortFn = ALIGNMENT_SORTING[type];\n\n  var sortedElements = sortBy(filteredElements, sortFn);\n\n  var alignment = this._alignmentPosition(type, sortedElements);\n\n  modeling.alignElements(sortedElements, alignment);\n};\n","import AlignElements from './AlignElements';\n\nexport default {\n  __init__: [ 'alignElements' ],\n  alignElements: [ 'type', AlignElements ]\n};\n","import { is } from '../../util/ModelUtil';\nimport { isAny } from '../modeling/util/ModelingUtil';\n\nimport {\n  getMid,\n  asTRBL,\n  getOrientation\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  find,\n  reduce\n} from 'min-dash';\n\nvar DEFAULT_HORIZONTAL_DISTANCE = 50;\n\nvar MAX_HORIZONTAL_DISTANCE = 250;\n\n// padding to detect element placement\nvar PLACEMENT_DETECTION_PAD = 10;\n\n/**\n * Find the new position for the target element to\n * connect to source.\n *\n * @param  {djs.model.Shape} source\n * @param  {djs.model.Shape} element\n *\n * @return {Point}\n */\nexport function getNewShapePosition(source, element) {\n\n  if (is(element, 'bpmn:TextAnnotation')) {\n    return getTextAnnotationPosition(source, element);\n  }\n\n  if (isAny(element, [ 'bpmn:DataObjectReference', 'bpmn:DataStoreReference' ])) {\n    return getDataElementPosition(source, element);\n  }\n\n  if (is(element, 'bpmn:FlowNode')) {\n    return getFlowNodePosition(source, element);\n  }\n\n  return getDefaultPosition(source, element);\n}\n\n/**\n * Always try to place element right of source;\n * compute actual distance from previous nodes in flow.\n */\nexport function getFlowNodePosition(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n  var sourceMid = getMid(source);\n\n  var horizontalDistance = getFlowNodeDistance(source, element);\n\n  var orientation = 'left',\n      rowSize = 80,\n      margin = 30;\n\n  if (is(source, 'bpmn:BoundaryEvent')) {\n    orientation = getOrientation(source, source.host, -25);\n\n    if (orientation.indexOf('top') !== -1) {\n      margin *= -1;\n    }\n  }\n\n  function getVerticalDistance(orient) {\n    if (orient.indexOf('top') != -1) {\n      return -1 * rowSize;\n    } else if (orient.indexOf('bottom') != -1) {\n      return rowSize;\n    } else {\n      return 0;\n    }\n  }\n\n  var position = {\n    x: sourceTrbl.right + horizontalDistance + element.width / 2,\n    y: sourceMid.y + getVerticalDistance(orientation)\n  };\n\n  var escapeDirection = {\n    y: {\n      margin: margin,\n      rowSize: rowSize\n    }\n  };\n\n  return deconflictPosition(source, element, position, escapeDirection);\n}\n\n\n/**\n * Compute best distance between source and target,\n * based on existing connections to and from source.\n *\n * @param {djs.model.Shape} source\n * @param {djs.model.Shape} element\n *\n * @return {Number} distance\n */\nexport function getFlowNodeDistance(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n\n  // is connection a reference to consider?\n  function isReference(c) {\n    return is(c, 'bpmn:SequenceFlow');\n  }\n\n  function toTargetNode(weight) {\n\n    return function(shape) {\n      return {\n        shape: shape,\n        weight: weight,\n        distanceTo: function(shape) {\n          var shapeTrbl = asTRBL(shape);\n\n          return shapeTrbl.left - sourceTrbl.right;\n        }\n      };\n    };\n  }\n\n  function toSourceNode(weight) {\n    return function(shape) {\n      return {\n        shape: shape,\n        weight: weight,\n        distanceTo: function(shape) {\n          var shapeTrbl = asTRBL(shape);\n\n          return sourceTrbl.left - shapeTrbl.right;\n        }\n      };\n    };\n  }\n\n  // we create a list of nodes to take into consideration\n  // for calculating the optimal flow node distance\n  //\n  //   * weight existing target nodes higher than source nodes\n  //   * only take into account individual nodes once\n  //\n  var nodes = reduce([].concat(\n    getTargets(source, isReference).map(toTargetNode(5)),\n    getSources(source, isReference).map(toSourceNode(1))\n  ), function(nodes, node) {\n\n    // filter out shapes connected twice via source or target\n    nodes[node.shape.id + '__weight_' + node.weight] = node;\n\n    return nodes;\n  }, {});\n\n  // compute distances between source and incoming nodes;\n  // group at the same time by distance and expose the\n  // favourite distance as { fav: { count, value } }.\n  var distancesGrouped = reduce(nodes, function(result, node) {\n\n    var shape = node.shape,\n        weight = node.weight,\n        distanceTo = node.distanceTo;\n\n    var fav = result.fav,\n        currentDistance,\n        currentDistanceCount,\n        currentDistanceEntry;\n\n    currentDistance = distanceTo(shape);\n\n    // ignore too far away peers\n    // or non-left to right modeled nodes\n    if (currentDistance < 0 || currentDistance > MAX_HORIZONTAL_DISTANCE) {\n      return result;\n    }\n\n    currentDistanceEntry = result[String(currentDistance)] =\n      result[String(currentDistance)] || {\n        value: currentDistance,\n        count: 0\n      };\n\n    // inc diff count\n    currentDistanceCount = currentDistanceEntry.count += 1 * weight;\n\n    if (!fav || fav.count < currentDistanceCount) {\n      result.fav = currentDistanceEntry;\n    }\n\n    return result;\n  }, { });\n\n\n  if (distancesGrouped.fav) {\n    return distancesGrouped.fav.value;\n  } else {\n    return DEFAULT_HORIZONTAL_DISTANCE;\n  }\n}\n\n\n/**\n * Always try to place text annotations top right of source.\n */\nexport function getTextAnnotationPosition(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n\n  var position = {\n    x: sourceTrbl.right + element.width / 2,\n    y: sourceTrbl.top - 50 - element.height / 2\n  };\n\n  var escapeDirection = {\n    y: {\n      margin: -30,\n      rowSize: 20\n    }\n  };\n\n  return deconflictPosition(source, element, position, escapeDirection);\n}\n\n\n/**\n * Always put element bottom right of source.\n */\nexport function getDataElementPosition(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n\n  var position = {\n    x: sourceTrbl.right - 10 + element.width / 2,\n    y: sourceTrbl.bottom + 40 + element.width / 2\n  };\n\n  var escapeDirection = {\n    x: {\n      margin: 30,\n      rowSize: 30\n    }\n  };\n\n  return deconflictPosition(source, element, position, escapeDirection);\n}\n\n\n/**\n * Always put element right of source per default.\n */\nexport function getDefaultPosition(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n\n  var sourceMid = getMid(source);\n\n  // simply put element right next to source\n  return {\n    x: sourceTrbl.right + DEFAULT_HORIZONTAL_DISTANCE + element.width / 2,\n    y: sourceMid.y\n  };\n}\n\n\n/**\n * Returns all connected elements around the given source.\n *\n * This includes:\n *\n *   - connected elements\n *   - host connected elements\n *   - attachers connected elements\n *\n * @param  {djs.model.Shape} source\n * @param  {djs.model.Shape} element\n *\n * @return {Array<djs.model.Shape>}\n */\nfunction getAutoPlaceClosure(source, element) {\n\n  var allConnected = getConnected(source);\n\n  if (source.host) {\n    allConnected = allConnected.concat(getConnected(source.host));\n  }\n\n  if (source.attachers) {\n    allConnected = allConnected.concat(source.attachers.reduce(function(shapes, attacher) {\n      return shapes.concat(getConnected(attacher));\n    }, []));\n  }\n\n  return allConnected;\n}\n\n/**\n * Return target at given position, if defined.\n *\n * This takes connected elements from host and attachers\n * into account, too.\n */\nexport function getConnectedAtPosition(source, position, element) {\n\n  var bounds = {\n    x: position.x - (element.width / 2),\n    y: position.y - (element.height / 2),\n    width: element.width,\n    height: element.height\n  };\n\n  var closure = getAutoPlaceClosure(source, element);\n\n  return find(closure, function(target) {\n\n    if (target === element) {\n      return false;\n    }\n\n    var orientation = getOrientation(target, bounds, PLACEMENT_DETECTION_PAD);\n\n    return orientation === 'intersect';\n  });\n}\n\n\n/**\n * Returns a new, position for the given element\n * based on the given element that is not occupied\n * by some element connected to source.\n *\n * Take into account the escapeDirection (where to move\n * on positioning clashes) in the computation.\n *\n * @param {djs.model.Shape} source\n * @param {djs.model.Shape} element\n * @param {Point} position\n * @param {Object} escapeDelta\n *\n * @return {Point}\n */\nexport function deconflictPosition(source, element, position, escapeDelta) {\n\n  function nextPosition(existingElement) {\n\n    var newPosition = {\n      x: position.x,\n      y: position.y\n    };\n\n    [ 'x', 'y' ].forEach(function(axis) {\n\n      var axisDelta = escapeDelta[axis];\n\n      if (!axisDelta) {\n        return;\n      }\n\n      var dimension = axis === 'x' ? 'width' : 'height';\n\n      var margin = axisDelta.margin,\n          rowSize = axisDelta.rowSize;\n\n      if (margin < 0) {\n        newPosition[axis] = Math.min(\n          existingElement[axis] + margin - element[dimension] / 2,\n          position[axis] - rowSize + margin\n        );\n      } else {\n        newPosition[axis] = Math.max(\n          existingTarget[axis] + existingTarget[dimension] + margin + element[dimension] / 2,\n          position[axis] + rowSize + margin\n        );\n      }\n    });\n\n    return newPosition;\n  }\n\n  var existingTarget;\n\n  // deconflict position until free slot is found\n  while ((existingTarget = getConnectedAtPosition(source, position, element))) {\n    position = nextPosition(existingTarget);\n  }\n\n  return position;\n}\n\n\n\n// helpers //////////////////////\n\nfunction noneFilter() {\n  return true;\n}\n\nfunction getConnected(element, connectionFilter) {\n  return [].concat(\n    getTargets(element, connectionFilter),\n    getSources(element, connectionFilter)\n  );\n}\n\nfunction getSources(shape, connectionFilter) {\n\n  if (!connectionFilter) {\n    connectionFilter = noneFilter;\n  }\n\n  return shape.incoming.filter(connectionFilter).map(function(c) {\n    return c.source;\n  });\n}\n\nfunction getTargets(shape, connectionFilter) {\n\n  if (!connectionFilter) {\n    connectionFilter = noneFilter;\n  }\n\n  return shape.outgoing.filter(connectionFilter).map(function(c) {\n    return c.target;\n  });\n}","import { getNewShapePosition } from './AutoPlaceUtil';\n\n\n/**\n * A service that places elements connected to existing ones\n * to an appropriate position in an _automated_ fashion.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function AutoPlace(eventBus, modeling) {\n\n  function emit(event, payload) {\n    return eventBus.fire(event, payload);\n  }\n\n\n  /**\n   * Append shape to source at appropriate position.\n   *\n   * @param {djs.model.Shape} source\n   * @param {djs.model.Shape} shape\n   *\n   * @return {djs.model.Shape} appended shape\n   */\n  this.append = function(source, shape) {\n\n    emit('autoPlace.start', {\n      source: source,\n      shape: shape\n    });\n\n    // allow others to provide the position\n    var position = emit('autoPlace', {\n      source: source,\n      shape: shape\n    });\n\n    if (!position) {\n      position = getNewShapePosition(source, shape);\n    }\n\n    var newShape = modeling.appendShape(source, shape, position, source.parent);\n\n    emit('autoPlace.end', {\n      source: source,\n      shape: newShape\n    });\n\n    return newShape;\n  };\n\n}\n\nAutoPlace.$inject = [\n  'eventBus',\n  'modeling'\n];","/**\n * Select element after auto placement.\n *\n * @param {EventBus} eventBus\n * @param {Selection} selection\n */\nexport default function AutoPlaceSelectionBehavior(eventBus, selection) {\n\n  eventBus.on('autoPlace.end', 500, function(e) {\n    selection.select(e.shape);\n  });\n\n}\n\nAutoPlaceSelectionBehavior.$inject = [\n  'eventBus',\n  'selection'\n];","import AutoPlace from './AutoPlace';\nimport AutoPlaceSelectionBehavior from './AutoPlaceSelectionBehavior';\n\nexport default {\n  __init__: [ 'autoPlaceSelectionBehavior' ],\n  autoPlace: [ 'type', AutoPlace ],\n  autoPlaceSelectionBehavior: [ 'type', AutoPlaceSelectionBehavior ]\n};","import {\n  forEach,\n  isFunction,\n  isArray,\n  isNumber,\n  isObject\n} from 'min-dash';\n\n\nvar DEFAULT_PRIORITY = 1000;\n\n/**\n * A utility that can be used to plug-in into the command execution for\n * extension and/or validation.\n *\n * @param {EventBus} eventBus\n *\n * @example\n *\n * import inherits from 'inherits';\n *\n * import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n *\n * function CommandLogger(eventBus) {\n *   CommandInterceptor.call(this, eventBus);\n *\n *   this.preExecute(function(event) {\n *     console.log('command pre-execute', event);\n *   });\n * }\n *\n * inherits(CommandLogger, CommandInterceptor);\n *\n */\nexport default function CommandInterceptor(eventBus) {\n  this._eventBus = eventBus;\n}\n\nCommandInterceptor.$inject = [ 'eventBus' ];\n\nfunction unwrapEvent(fn, that) {\n  return function(event) {\n    return fn.call(that || null, event.context, event.command, event);\n  };\n}\n\n/**\n * Register an interceptor for a command execution\n *\n * @param {String|Array<String>} [events] list of commands to register on\n * @param {String} [hook] command hook, i.e. preExecute, executed to listen on\n * @param {Number} [priority] the priority on which to hook into the execution\n * @param {Function} handlerFn interceptor to be invoked with (event)\n * @param {Boolean} unwrap if true, unwrap the event and pass (context, command, event) to the\n *                          listener instead\n * @param {Object} [that] Pass context (`this`) to the handler function\n */\nCommandInterceptor.prototype.on = function(events, hook, priority, handlerFn, unwrap, that) {\n\n  if (isFunction(hook) || isNumber(hook)) {\n    that = unwrap;\n    unwrap = handlerFn;\n    handlerFn = priority;\n    priority = hook;\n    hook = null;\n  }\n\n  if (isFunction(priority)) {\n    that = unwrap;\n    unwrap = handlerFn;\n    handlerFn = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  if (isObject(unwrap)) {\n    that = unwrap;\n    unwrap = false;\n  }\n\n  if (!isFunction(handlerFn)) {\n    throw new Error('handlerFn must be a function');\n  }\n\n  if (!isArray(events)) {\n    events = [ events ];\n  }\n\n  var eventBus = this._eventBus;\n\n  forEach(events, function(event) {\n\n    // concat commandStack(.event)?(.hook)?\n    var fullEvent = [ 'commandStack', event, hook ].filter(function(e) { return e; }).join('.');\n\n    eventBus.on(fullEvent, priority, unwrap ? unwrapEvent(handlerFn, that) : handlerFn, that);\n  });\n};\n\n\nvar hooks = [\n  'canExecute',\n  'preExecute',\n  'preExecuted',\n  'execute',\n  'executed',\n  'postExecute',\n  'postExecuted',\n  'revert',\n  'reverted'\n];\n\n/*\n * Install hook shortcuts\n *\n * This will generate the CommandInterceptor#(preExecute|...|reverted) methods\n * which will in term forward to CommandInterceptor#on.\n */\nforEach(hooks, function(hook) {\n\n  /**\n   * {canExecute|preExecute|preExecuted|execute|executed|postExecute|postExecuted|revert|reverted}\n   *\n   * A named hook for plugging into the command execution\n   *\n   * @param {String|Array<String>} [events] list of commands to register on\n   * @param {Number} [priority] the priority on which to hook into the execution\n   * @param {Function} handlerFn interceptor to be invoked with (event)\n   * @param {Boolean} [unwrap=false] if true, unwrap the event and pass (context, command, event) to the\n   *                          listener instead\n   * @param {Object} [that] Pass context (`this`) to the handler function\n   */\n  CommandInterceptor.prototype[hook] = function(events, priority, handlerFn, unwrap, that) {\n\n    if (isFunction(events) || isNumber(events)) {\n      that = unwrap;\n      unwrap = handlerFn;\n      handlerFn = priority;\n      priority = events;\n      events = null;\n    }\n\n    this.on(events, hook, priority, handlerFn, unwrap, that);\n  };\n});\n","import inherits from 'inherits';\n\nimport { getBBox as getBoundingBox } from '../../util/Elements';\n\nimport {\n  asTRBL,\n  asBounds\n} from '../../layout/LayoutUtil';\n\nimport {\n  assign,\n  flatten,\n  find,\n  forEach,\n  groupBy,\n  isArray,\n  matchPattern,\n  pick,\n  values\n} from 'min-dash';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n\n/**\n * An auto resize component that takes care of expanding a parent element\n * if child elements are created or moved close the parents edge.\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n * @param {Modeling} modeling\n * @param {Rules} rules\n */\nexport default function AutoResize(eventBus, elementRegistry, modeling, rules) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this._elementRegistry = elementRegistry;\n  this._modeling = modeling;\n  this._rules = rules;\n\n  var self = this;\n\n  this.postExecuted([ 'shape.create' ], function(event) {\n    var context = event.context,\n        hints = context.hints || {},\n        shape = context.shape,\n        parent = context.parent || context.newParent;\n\n    if (hints.autoResize === false) {\n      return;\n    }\n\n    self._expand([ shape ], parent);\n  });\n\n  this.postExecuted([ 'elements.move' ], function(event) {\n    var context = event.context,\n        elements = flatten(values(context.closure.topLevel)),\n        hints = context.hints;\n\n    var autoResize = hints ? hints.autoResize : true;\n\n    if (autoResize === false) {\n      return;\n    }\n\n    var expandings = groupBy(elements, function(element) {\n      return element.parent.id;\n    });\n\n    forEach(expandings, function(elements, parentId) {\n\n      // optionally filter elements to be considered when resizing\n      if (isArray(autoResize)) {\n        elements = elements.filter(function(element) {\n          return find(autoResize, matchPattern({ id: element.id }));\n        });\n      }\n\n      self._expand(elements, parentId);\n    });\n  });\n\n  this.postExecuted([ 'shape.toggleCollapse' ], function(event) {\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape;\n\n    if (hints && hints.autoResize === false) {\n      return;\n    }\n\n    if (shape.collapsed) {\n      return;\n    }\n\n    self._expand(shape.children || [], shape);\n  });\n\n  this.postExecuted([ 'shape.resize' ], function(event) {\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape,\n        parent = shape.parent;\n\n    if (hints && hints.autoResize === false) {\n      return;\n    }\n\n    if (parent) {\n      self._expand([ shape ], parent);\n    }\n  });\n\n}\n\nAutoResize.$inject = [\n  'eventBus',\n  'elementRegistry',\n  'modeling',\n  'rules'\n];\n\ninherits(AutoResize, CommandInterceptor);\n\n\n/**\n * Calculate the new bounds of the target shape, given\n * a number of elements have been moved or added into the parent.\n *\n * This method considers the current size, the added elements as well as\n * the provided padding for the new bounds.\n *\n * @param {Array<djs.model.Shape>} elements\n * @param {djs.model.Shape} target\n */\nAutoResize.prototype._getOptimalBounds = function(elements, target) {\n\n  var offset = this.getOffset(target),\n      padding = this.getPadding(target);\n\n  var elementsTrbl = asTRBL(getBoundingBox(elements)),\n      targetTrbl = asTRBL(target);\n\n  var newTrbl = {};\n\n  if (elementsTrbl.top - targetTrbl.top < padding.top) {\n    newTrbl.top = elementsTrbl.top - offset.top;\n  }\n\n  if (elementsTrbl.left - targetTrbl.left < padding.left) {\n    newTrbl.left = elementsTrbl.left - offset.left;\n  }\n\n  if (targetTrbl.right - elementsTrbl.right < padding.right) {\n    newTrbl.right = elementsTrbl.right + offset.right;\n  }\n\n  if (targetTrbl.bottom - elementsTrbl.bottom < padding.bottom) {\n    newTrbl.bottom = elementsTrbl.bottom + offset.bottom;\n  }\n\n  return asBounds(assign({}, targetTrbl, newTrbl));\n};\n\n\n/**\n * Expand the target shape respecting rules, offset and padding\n *\n * @param {Array<djs.model.Shape>} elements\n * @param {djs.model.Shape|String} target|targetId\n */\nAutoResize.prototype._expand = function(elements, target) {\n\n  if (typeof target === 'string') {\n    target = this._elementRegistry.get(target);\n  }\n\n  var allowed = this._rules.allowed('element.autoResize', {\n    elements: elements,\n    target: target\n  });\n\n  if (!allowed) {\n    return;\n  }\n\n  // calculate the new bounds\n  var newBounds = this._getOptimalBounds(elements, target);\n\n  if (!boundsChanged(newBounds, target)) {\n    return;\n  }\n\n  var resizeDirections = getResizeDirections(pick(target, [ 'x', 'y', 'width', 'height' ]), newBounds);\n\n  // resize the parent shape\n  this.resize(target, newBounds, {\n    autoResize: resizeDirections\n  });\n\n  var parent = target.parent;\n\n  // recursively expand parent elements\n  if (parent) {\n    this._expand([ target ], parent);\n  }\n};\n\n\n/**\n * Get the amount to expand the given shape in each direction.\n *\n * @param {djs.model.Shape} shape\n *\n * @return {TRBL}\n */\nAutoResize.prototype.getOffset = function(shape) {\n  return { top: 60, bottom: 60, left: 100, right: 100 };\n};\n\n\n/**\n * Get the activation threshold for each side for which\n * resize triggers.\n *\n * @param {djs.model.Shape} shape\n *\n * @return {TRBL}\n */\nAutoResize.prototype.getPadding = function(shape) {\n  return { top: 2, bottom: 2, left: 15, right: 15 };\n};\n\n\n/**\n * Perform the actual resize operation.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n * @param {Object} [hints]\n * @param {string} [hints.autoResize]\n */\nAutoResize.prototype.resize = function(shape, newBounds, hints) {\n  this._modeling.resizeShape(shape, newBounds, null, hints);\n};\n\n\nfunction boundsChanged(newBounds, oldBounds) {\n  return (\n    newBounds.x !== oldBounds.x ||\n    newBounds.y !== oldBounds.y ||\n    newBounds.width !== oldBounds.width ||\n    newBounds.height !== oldBounds.height\n  );\n}\n\n/**\n * Get directions of resize as {n|w|s|e} e.g. \"nw\".\n *\n * @param {Bounds} oldBounds\n * @param {Bounds} newBounds\n *\n * @returns {string} Resize directions as {n|w|s|e}.\n */\nfunction getResizeDirections(oldBounds, newBounds) {\n  var directions = '';\n\n  oldBounds = asTRBL(oldBounds);\n  newBounds = asTRBL(newBounds);\n\n  if (oldBounds.top > newBounds.top) {\n    directions = directions.concat('n');\n  }\n\n  if (oldBounds.right < newBounds.right) {\n    directions = directions.concat('w');\n  }\n\n  if (oldBounds.bottom < newBounds.bottom) {\n    directions = directions.concat('s');\n  }\n\n  if (oldBounds.left > newBounds.left) {\n    directions = directions.concat('e');\n  }\n\n  return directions;\n}","import AutoResize from 'diagram-js/lib/features/auto-resize/AutoResize';\n\nimport inherits from 'inherits';\n\nimport { is } from '../../util/ModelUtil';\n\n\n/**\n * Sub class of the AutoResize module which implements a BPMN\n * specific resize function.\n */\nexport default function BpmnAutoResize(injector) {\n\n  injector.invoke(AutoResize, this);\n}\n\nBpmnAutoResize.$inject = [\n  'injector'\n];\n\ninherits(BpmnAutoResize, AutoResize);\n\n\n/**\n * Resize shapes and lanes.\n *\n * @param {djs.model.Shape} target\n * @param {Bounds} newBounds\n * @param {Object} hints\n */\nBpmnAutoResize.prototype.resize = function(target, newBounds, hints) {\n\n  if (is(target, 'bpmn:Participant')) {\n    this._modeling.resizeLane(target, newBounds, null, hints);\n  } else {\n    this._modeling.resizeShape(target, newBounds, null, hints);\n  }\n};","import inherits from 'inherits';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n/**\n * A basic provider that may be extended to implement modeling rules.\n *\n * Extensions should implement the init method to actually add their custom\n * modeling checks. Checks may be added via the #addRule(action, fn) method.\n *\n * @param {EventBus} eventBus\n */\nexport default function RuleProvider(eventBus) {\n  CommandInterceptor.call(this, eventBus);\n\n  this.init();\n}\n\nRuleProvider.$inject = [ 'eventBus' ];\n\ninherits(RuleProvider, CommandInterceptor);\n\n\n/**\n * Adds a modeling rule for the given action, implemented through\n * a callback function.\n *\n * The function will receive the modeling specific action context\n * to perform its check. It must return `false` to disallow the\n * action from happening or `true` to allow the action.\n *\n * A rule provider may pass over the evaluation to lower priority\n * rules by returning return nothing (or <code>undefined</code>).\n *\n * @example\n *\n * ResizableRules.prototype.init = function() {\n *\n *   \\/**\n *    * Return `true`, `false` or nothing to denote\n *    * _allowed_, _not allowed_ and _continue evaluating_.\n *    *\\/\n *   this.addRule('shape.resize', function(context) {\n *\n *     var shape = context.shape;\n *\n *     if (!context.newBounds) {\n *       // check general resizability\n *       if (!shape.resizable) {\n *         return false;\n *       }\n *\n *       // not returning anything (read: undefined)\n *       // will continue the evaluation of other rules\n *       // (with lower priority)\n *       return;\n *     } else {\n *       // element must have minimum size of 10*10 points\n *       return context.newBounds.width > 10 && context.newBounds.height > 10;\n *     }\n *   });\n * };\n *\n * @param {String|Array<String>} actions the identifier for the modeling action to check\n * @param {Number} [priority] the priority at which this rule is being applied\n * @param {Function} fn the callback function that performs the actual check\n */\nRuleProvider.prototype.addRule = function(actions, priority, fn) {\n\n  var self = this;\n\n  if (typeof actions === 'string') {\n    actions = [ actions ];\n  }\n\n  actions.forEach(function(action) {\n\n    self.canExecute(action, priority, function(context, action, event) {\n      return fn(context);\n    }, true);\n  });\n};\n\n/**\n * Implement this method to add new rules during provider initialization.\n */\nRuleProvider.prototype.init = function() {};","import RuleProvider from '../rules/RuleProvider';\n\nimport inherits from 'inherits';\n\n/**\n * This is a base rule provider for the element.autoResize rule.\n */\nexport default function AutoResizeProvider(eventBus) {\n\n  RuleProvider.call(this, eventBus);\n\n  var self = this;\n\n  this.addRule('element.autoResize', function(context) {\n    return self.canResize(context.elements, context.target);\n  });\n}\n\nAutoResizeProvider.$inject = [ 'eventBus' ];\n\ninherits(AutoResizeProvider, RuleProvider);\n\n/**\n * Needs to be implemented by sub classes to allow actual auto resize\n *\n * @param  {Array<djs.model.Shape>} elements\n * @param  {djs.model.Shape} target\n *\n * @return {Boolean}\n */\nAutoResizeProvider.prototype.canResize = function(elements, target) {\n  return false;\n};","import { is } from '../../util/ModelUtil';\n\nimport inherits from 'inherits';\n\nimport { forEach } from 'min-dash';\n\nimport AutoResizeProvider from 'diagram-js/lib/features/auto-resize/AutoResizeProvider';\n\n\n/**\n * This module is a provider for automatically resizing parent BPMN elements\n */\nexport default function BpmnAutoResizeProvider(eventBus, modeling) {\n  AutoResizeProvider.call(this, eventBus);\n\n  this._modeling = modeling;\n}\n\ninherits(BpmnAutoResizeProvider, AutoResizeProvider);\n\nBpmnAutoResizeProvider.$inject = [\n  'eventBus',\n  'modeling'\n];\n\n\n/**\n * Check if the given target can be expanded\n *\n * @param  {djs.model.Shape} target\n *\n * @return {boolean}\n */\nBpmnAutoResizeProvider.prototype.canResize = function(elements, target) {\n\n  if (!is(target, 'bpmn:Participant') && !is(target, 'bpmn:Lane') && !(is(target, 'bpmn:SubProcess'))) {\n    return false;\n  }\n\n  var canResize = true;\n\n  forEach(elements, function(element) {\n\n    if (is(element, 'bpmn:Lane') || element.labelTarget) {\n      canResize = false;\n      return;\n    }\n  });\n\n  return canResize;\n};\n","import BpmnAutoResize from './BpmnAutoResize';\nimport BpmnAutoResizeProvider from './BpmnAutoResizeProvider';\n\n\nexport default {\n  __init__: [\n    'bpmnAutoResize',\n    'bpmnAutoResizeProvider'\n  ],\n  bpmnAutoResize: [ 'type', BpmnAutoResize ],\n  bpmnAutoResizeProvider: [ 'type', BpmnAutoResizeProvider ]\n};\n","/* global TouchEvent */\n\nvar round = Math.round;\n\nimport { assign } from 'min-dash';\n\nimport {\n  event as domEvent\n} from 'min-dom';\n\nimport {\n  getOriginal,\n  toPoint,\n  stopPropagation\n} from '../../util/Event';\n\nimport {\n  set as cursorSet,\n  unset as cursorUnset\n} from '../../util/Cursor';\n\nimport {\n  install as installClickTrap\n} from '../../util/ClickTrap';\n\nimport {\n  delta as deltaPos\n} from '../../util/PositionUtil';\n\nvar DRAG_ACTIVE_CLS = 'djs-drag-active';\n\n\nfunction preventDefault(event) {\n  event.preventDefault();\n}\n\nfunction isTouchEvent(event) {\n\n  // check for TouchEvent being available first\n  // (i.e. not available on desktop Firefox)\n  return typeof TouchEvent !== 'undefined' && event instanceof TouchEvent;\n}\n\nfunction getLength(point) {\n  return Math.sqrt(Math.pow(point.x, 2) + Math.pow(point.y, 2));\n}\n\n/**\n * A helper that fires canvas localized drag events and realizes\n * the general \"drag-and-drop\" look and feel.\n *\n * Calling {@link Dragging#activate} activates dragging on a canvas.\n *\n * It provides the following:\n *\n *   * emits life cycle events, namespaced with a prefix assigned\n *     during dragging activation\n *   * sets and restores the cursor\n *   * sets and restores the selection if elements still exist\n *   * ensures there can be only one drag operation active at a time\n *\n * Dragging may be canceled manually by calling {@link Dragging#cancel}\n * or by pressing ESC.\n *\n *\n * ## Life-cycle events\n *\n * Dragging can be in three different states, off, initialized\n * and active.\n *\n * (1) off: no dragging operation is in progress\n * (2) initialized: a new drag operation got initialized but not yet\n *                  started (i.e. because of no initial move)\n * (3) started: dragging is in progress\n *\n * Eventually dragging will be off again after a drag operation has\n * been ended or canceled via user click or ESC key press.\n *\n * To indicate transitions between these states dragging emits generic\n * life-cycle events with the `drag.` prefix _and_ events namespaced\n * to a prefix choosen by a user during drag initialization.\n *\n * The following events are emitted (appropriately prefixed) via\n * the {@link EventBus}.\n *\n * * `init`\n * * `start`\n * * `move`\n * * `end`\n * * `ended` (dragging already in off state)\n * * `cancel` (only if previously started)\n * * `canceled` (dragging already in off state, only if previously started)\n * * `cleanup`\n *\n *\n * @example\n *\n * function MyDragComponent(eventBus, dragging) {\n *\n *   eventBus.on('mydrag.start', function(event) {\n *     console.log('yes, we start dragging');\n *   });\n *\n *   eventBus.on('mydrag.move', function(event) {\n *     console.log('canvas local coordinates', event.x, event.y, event.dx, event.dy);\n *\n *     // local drag data is passed with the event\n *     event.context.foo; // \"BAR\"\n *\n *     // the original mouse event, too\n *     event.originalEvent; // MouseEvent(...)\n *   });\n *\n *   eventBus.on('element.click', function(event) {\n *     dragging.init(event, 'mydrag', {\n *       cursor: 'grabbing',\n *       data: {\n *         context: {\n *           foo: \"BAR\"\n *         }\n *       }\n *     });\n *   });\n * }\n */\nexport default function Dragging(eventBus, canvas, selection, elementRegistry) {\n\n  var defaultOptions = {\n    threshold: 5,\n    trapClick: true\n  };\n\n  // the currently active drag operation\n  // dragging is active as soon as this context exists.\n  //\n  // it is visually _active_ only when a context.active flag is set to true.\n  var context;\n\n  /* convert a global event into local coordinates */\n  function toLocalPoint(globalPosition) {\n\n    var viewbox = canvas.viewbox();\n\n    var clientRect = canvas._container.getBoundingClientRect();\n\n    return {\n      x: viewbox.x + (globalPosition.x - clientRect.left) / viewbox.scale,\n      y: viewbox.y + (globalPosition.y - clientRect.top) / viewbox.scale\n    };\n  }\n\n  // helpers\n\n  function fire(type, dragContext) {\n    dragContext = dragContext || context;\n\n    var event = eventBus.createEvent(\n      assign(\n        {},\n        dragContext.payload,\n        dragContext.data,\n        { isTouch: dragContext.isTouch }\n      )\n    );\n\n    // default integration\n    if (eventBus.fire('drag.' + type, event) === false) {\n      return false;\n    }\n\n    return eventBus.fire(dragContext.prefix + '.' + type, event);\n  }\n\n  function restoreSelection(previousSelection) {\n    var existingSelection = previousSelection.filter(function(element) {\n      return elementRegistry.get(element.id);\n    });\n\n    existingSelection.length && selection.select(existingSelection);\n  }\n\n  // event listeners\n\n  function move(event, activate) {\n    var payload = context.payload,\n        displacement = context.displacement;\n\n    var globalStart = context.globalStart,\n        globalCurrent = toPoint(event),\n        globalDelta = deltaPos(globalCurrent, globalStart);\n\n    var localStart = context.localStart,\n        localCurrent = toLocalPoint(globalCurrent),\n        localDelta = deltaPos(localCurrent, localStart);\n\n\n    // activate context explicitly or once threshold is reached\n    if (!context.active && (activate || getLength(globalDelta) > context.threshold)) {\n\n      // fire start event with original\n      // starting coordinates\n\n      assign(payload, {\n        x: round(localStart.x + displacement.x),\n        y: round(localStart.y + displacement.y),\n        dx: 0,\n        dy: 0\n      }, { originalEvent: event });\n\n      if (false === fire('start')) {\n        return cancel();\n      }\n\n      context.active = true;\n\n      // unset selection and remember old selection\n      // the previous (old) selection will always passed\n      // with the event via the event.previousSelection property\n      if (!context.keepSelection) {\n        payload.previousSelection = selection.get();\n        selection.select(null);\n      }\n\n      // allow custom cursor\n      if (context.cursor) {\n        cursorSet(context.cursor);\n      }\n\n      // indicate dragging via marker on root element\n      canvas.addMarker(canvas.getRootElement(), DRAG_ACTIVE_CLS);\n    }\n\n    stopPropagation(event);\n\n    if (context.active) {\n\n      // update payload with actual coordinates\n      assign(payload, {\n        x: round(localCurrent.x + displacement.x),\n        y: round(localCurrent.y + displacement.y),\n        dx: round(localDelta.x),\n        dy: round(localDelta.y)\n      }, { originalEvent: event });\n\n      // emit move event\n      fire('move');\n    }\n  }\n\n  function end(event) {\n    var previousContext,\n        returnValue = true;\n\n    if (context.active) {\n\n      if (event) {\n        context.payload.originalEvent = event;\n\n        // suppress original event (click, ...)\n        // because we just ended a drag operation\n        stopPropagation(event);\n      }\n\n      // implementations may stop restoring the\n      // original state (selections, ...) by preventing the\n      // end events default action\n      returnValue = fire('end');\n    }\n\n    if (returnValue === false) {\n      fire('rejected');\n    }\n\n    previousContext = cleanup(returnValue !== true);\n\n    // last event to be fired when all drag operations are done\n    // at this point in time no drag operation is in progress anymore\n    fire('ended', previousContext);\n  }\n\n\n  // cancel active drag operation if the user presses\n  // the ESC key on the keyboard\n\n  function checkCancel(event) {\n\n    if (event.which === 27) {\n      preventDefault(event);\n\n      cancel();\n    }\n  }\n\n\n  // prevent ghost click that might occur after a finished\n  // drag and drop session\n\n  function trapClickAndEnd(event) {\n\n    var untrap;\n\n    // trap the click in case we are part of an active\n    // drag operation. This will effectively prevent\n    // the ghost click that cannot be canceled otherwise.\n    if (context.active) {\n\n      untrap = installClickTrap(eventBus);\n\n      // remove trap after minimal delay\n      setTimeout(untrap, 400);\n\n      // prevent default action (click)\n      preventDefault(event);\n    }\n\n    end(event);\n  }\n\n  function trapTouch(event) {\n    move(event);\n  }\n\n  // update the drag events hover (djs.model.Base) and hoverGfx (Snap<SVGElement>)\n  // properties during hover and out and fire {prefix}.hover and {prefix}.out properties\n  // respectively\n\n  function hover(event) {\n    var payload = context.payload;\n\n    payload.hoverGfx = event.gfx;\n    payload.hover = event.element;\n\n    fire('hover');\n  }\n\n  function out(event) {\n    fire('out');\n\n    var payload = context.payload;\n\n    payload.hoverGfx = null;\n    payload.hover = null;\n  }\n\n\n  // life-cycle methods\n\n  function cancel(restore) {\n    var previousContext;\n\n    if (!context) {\n      return;\n    }\n\n    var wasActive = context.active;\n\n    if (wasActive) {\n      fire('cancel');\n    }\n\n    previousContext = cleanup(restore);\n\n    if (wasActive) {\n\n      // last event to be fired when all drag operations are done\n      // at this point in time no drag operation is in progress anymore\n      fire('canceled', previousContext);\n    }\n  }\n\n  function cleanup(restore) {\n    var previousContext,\n        endDrag;\n\n    fire('cleanup');\n\n    // reset cursor\n    cursorUnset();\n\n    if (context.trapClick) {\n      endDrag = trapClickAndEnd;\n    } else {\n      endDrag = end;\n    }\n\n    // reset dom listeners\n    domEvent.unbind(document, 'mousemove', move);\n\n    domEvent.unbind(document, 'dragstart', preventDefault);\n    domEvent.unbind(document, 'selectstart', preventDefault);\n\n    domEvent.unbind(document, 'mousedown', endDrag, true);\n    domEvent.unbind(document, 'mouseup', endDrag, true);\n\n    domEvent.unbind(document, 'keyup', checkCancel);\n\n    domEvent.unbind(document, 'touchstart', trapTouch, true);\n    domEvent.unbind(document, 'touchcancel', cancel, true);\n    domEvent.unbind(document, 'touchmove', move, true);\n    domEvent.unbind(document, 'touchend', end, true);\n\n    eventBus.off('element.hover', hover);\n    eventBus.off('element.out', out);\n\n    // remove drag marker on root element\n    canvas.removeMarker(canvas.getRootElement(), DRAG_ACTIVE_CLS);\n\n    // restore selection, unless it has changed\n    var previousSelection = context.payload.previousSelection;\n\n    if (restore !== false && previousSelection && !selection.get().length) {\n      restoreSelection(previousSelection);\n    }\n\n    previousContext = context;\n\n    context = null;\n\n    return previousContext;\n  }\n\n  /**\n   * Initialize a drag operation.\n   *\n   * If `localPosition` is given, drag events will be emitted\n   * relative to it.\n   *\n   * @param {MouseEvent|TouchEvent} [event]\n   * @param {Point} [localPosition] actual diagram local position this drag operation should start at\n   * @param {String} prefix\n   * @param {Object} [options]\n   */\n  function init(event, relativeTo, prefix, options) {\n\n    // only one drag operation may be active, at a time\n    if (context) {\n      cancel(false);\n    }\n\n    if (typeof relativeTo === 'string') {\n      options = prefix;\n      prefix = relativeTo;\n      relativeTo = null;\n    }\n\n    options = assign({}, defaultOptions, options || {});\n\n    var data = options.data || {},\n        originalEvent,\n        globalStart,\n        localStart,\n        endDrag,\n        isTouch;\n\n    if (options.trapClick) {\n      endDrag = trapClickAndEnd;\n    } else {\n      endDrag = end;\n    }\n\n    if (event) {\n      originalEvent = getOriginal(event) || event;\n      globalStart = toPoint(event);\n\n      stopPropagation(event);\n\n      // prevent default browser dragging behavior\n      if (originalEvent.type === 'dragstart') {\n        preventDefault(originalEvent);\n      }\n    } else {\n      originalEvent = null;\n      globalStart = { x: 0, y: 0 };\n    }\n\n    localStart = toLocalPoint(globalStart);\n\n    if (!relativeTo) {\n      relativeTo = localStart;\n    }\n\n    isTouch = isTouchEvent(originalEvent);\n\n    context = assign({\n      prefix: prefix,\n      data: data,\n      payload: {},\n      globalStart: globalStart,\n      displacement: deltaPos(relativeTo, localStart),\n      localStart: localStart,\n      isTouch: isTouch\n    }, options);\n\n    // skip dom registration if trigger\n    // is set to manual (during testing)\n    if (!options.manual) {\n\n      // add dom listeners\n\n      if (isTouch) {\n        domEvent.bind(document, 'touchstart', trapTouch, true);\n        domEvent.bind(document, 'touchcancel', cancel, true);\n        domEvent.bind(document, 'touchmove', move, true);\n        domEvent.bind(document, 'touchend', end, true);\n      } else {\n\n        // assume we use the mouse to interact per default\n        domEvent.bind(document, 'mousemove', move);\n\n        // prevent default browser drag and text selection behavior\n        domEvent.bind(document, 'dragstart', preventDefault);\n        domEvent.bind(document, 'selectstart', preventDefault);\n\n        domEvent.bind(document, 'mousedown', endDrag, true);\n        domEvent.bind(document, 'mouseup', endDrag, true);\n      }\n\n      domEvent.bind(document, 'keyup', checkCancel);\n\n      eventBus.on('element.hover', hover);\n      eventBus.on('element.out', out);\n    }\n\n    fire('init');\n\n    if (options.autoActivate) {\n      move(event, true);\n    }\n  }\n\n  // cancel on diagram destruction\n  eventBus.on('diagram.destroy', cancel);\n\n\n  // API\n\n  this.init = init;\n  this.move = move;\n  this.hover = hover;\n  this.out = out;\n  this.end = end;\n\n  this.cancel = cancel;\n\n  // for introspection\n\n  this.context = function() {\n    return context;\n  };\n\n  this.setOptions = function(options) {\n    assign(defaultOptions, options);\n  };\n}\n\nDragging.$inject = [\n  'eventBus',\n  'canvas',\n  'selection',\n  'elementRegistry'\n];\n","import {\n  closest as domClosest\n} from 'min-dom';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\nvar HIGH_PRIORITY = 1500;\n\n\n/**\n * Browsers may swallow certain events (hover, out ...) if users are to\n * fast with the mouse.\n *\n * @see http://stackoverflow.com/questions/7448468/why-cant-i-reliably-capture-a-mouseout-event\n *\n * The fix implemented in this component ensure that we\n *\n * 1) have a hover state after a successful drag.move event\n * 2) have an out event when dragging leaves an element\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {ElementRegistry} elementRegistry\n */\nexport default function HoverFix(eventBus, dragging, elementRegistry) {\n\n  var self = this;\n\n  /**\n   * Make sure we are god damn hovering!\n   *\n   * @param {Event} dragging event\n   */\n  function ensureHover(event) {\n\n    if (event.hover) {\n      return;\n    }\n\n    var originalEvent = event.originalEvent;\n\n    var gfx = self._findTargetGfx(originalEvent);\n\n    var element = gfx && elementRegistry.get(gfx);\n\n    if (gfx && element) {\n\n      // 1) cancel current mousemove\n      event.stopPropagation();\n\n      // 2) emit fake hover for new target\n      dragging.hover({ element: element, gfx: gfx });\n\n      // 3) re-trigger move event\n      dragging.move(originalEvent);\n    }\n  }\n\n  /**\n   * We wait for a specific sequence of events before\n   * emitting a fake drag.hover event.\n   *\n   * Event Sequence:\n   *\n   * drag.start\n   * drag.move >> ensure we are hovering\n   */\n  eventBus.on('drag.start', function(event) {\n\n    eventBus.once('drag.move', HIGH_PRIORITY, function(event) {\n\n      ensureHover(event);\n\n    });\n\n  });\n\n\n  /**\n   * We make sure that drag.out is always fired, even if the\n   * browser swallows an element.out event.\n   *\n   * Event sequence:\n   *\n   * drag.hover\n   * (element.out >> sometimes swallowed)\n   * element.hover >> ensure we fired drag.out\n   */\n  eventBus.on('drag.init', function() {\n\n    var hover, hoverGfx;\n\n    function setDragHover(event) {\n      hover = event.hover;\n      hoverGfx = event.hoverGfx;\n    }\n\n    function unsetHover() {\n      hover = null;\n      hoverGfx = null;\n    }\n\n    function ensureOut() {\n\n      if (!hover) {\n        return;\n      }\n\n      var element = hover,\n          gfx = hoverGfx;\n\n      hover = null;\n      hoverGfx = null;\n\n      // emit synthetic out event\n      dragging.out({\n        element: element,\n        gfx: gfx\n      });\n    }\n\n    eventBus.on('drag.hover', setDragHover);\n    eventBus.on('element.out', unsetHover);\n    eventBus.on('element.hover', HIGH_PRIORITY, ensureOut);\n\n    eventBus.once('drag.cleanup', function() {\n      eventBus.off('drag.hover', setDragHover);\n      eventBus.off('element.out', unsetHover);\n      eventBus.off('element.hover', ensureOut);\n    });\n\n  });\n\n  this._findTargetGfx = function(event) {\n    var position,\n        target;\n\n    if (!(event instanceof MouseEvent)) {\n      return;\n    }\n\n    position = toPoint(event);\n\n    // damn expensive operation, ouch!\n    target = document.elementFromPoint(position.x, position.y);\n\n    return getGfx(target);\n  };\n\n}\n\nHoverFix.$inject = [\n  'eventBus',\n  'dragging',\n  'elementRegistry'\n];\n\n\n// helpers /////////////////////\n\nfunction getGfx(target) {\n  return domClosest(target, 'svg, .djs-element', true);\n}","import SelectionModule from '../selection';\n\nimport Dragging from './Dragging';\nimport HoverFix from './HoverFix';\n\nexport default {\n  __init__: [\n    'hoverFix'\n  ],\n  __depends__: [\n    SelectionModule\n  ],\n  dragging: [ 'type', Dragging ],\n  hoverFix: [ 'type', HoverFix ]\n};","import { assign } from 'min-dash';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\n\n/**\n * Initiates canvas scrolling if current cursor point is close to a border.\n * Cancelled when current point moves back inside the scrolling borders\n * or cancelled manually.\n *\n * Default options :\n *   scrollThresholdIn: [ 20, 20, 20, 20 ],\n *   scrollThresholdOut: [ 0, 0, 0, 0 ],\n *   scrollRepeatTimeout: 15,\n *   scrollStep: 10\n *\n * Threshold order:\n *   [ left, top, right, bottom ]\n */\nexport default function AutoScroll(config, eventBus, canvas) {\n\n  this._canvas = canvas;\n\n  this._opts = assign({\n    scrollThresholdIn: [ 20, 20, 20, 20 ],\n    scrollThresholdOut: [ 0, 0, 0, 0 ],\n    scrollRepeatTimeout: 15,\n    scrollStep: 10\n  }, config);\n\n  var self = this;\n\n  eventBus.on('drag.move', function(e) {\n    var point = self._toBorderPoint(e);\n\n    self.startScroll(point);\n  });\n\n  eventBus.on([ 'drag.cleanup' ], function() {\n    self.stopScroll();\n  });\n}\n\nAutoScroll.$inject = [\n  'config.autoScroll',\n  'eventBus',\n  'canvas'\n];\n\n\n/**\n * Starts scrolling loop.\n * Point is given in global scale in canvas container box plane.\n *\n * @param  {Object} point { x: X, y: Y }\n */\nAutoScroll.prototype.startScroll = function(point) {\n\n  var canvas = this._canvas;\n  var opts = this._opts;\n  var self = this;\n\n  var clientRect = canvas.getContainer().getBoundingClientRect();\n\n  var diff = [\n    point.x,\n    point.y,\n    clientRect.width - point.x,\n    clientRect.height - point.y\n  ];\n\n  this.stopScroll();\n\n  var dx = 0,\n      dy = 0;\n\n  for (var i = 0; i < 4; i++) {\n    if (between(diff[i], opts.scrollThresholdOut[i], opts.scrollThresholdIn[i])) {\n      if (i === 0) {\n        dx = opts.scrollStep;\n      } else if (i == 1) {\n        dy = opts.scrollStep;\n      } else if (i == 2) {\n        dx = -opts.scrollStep;\n      } else if (i == 3) {\n        dy = -opts.scrollStep;\n      }\n    }\n  }\n\n  if (dx !== 0 || dy !== 0) {\n    canvas.scroll({ dx: dx, dy: dy });\n\n    this._scrolling = setTimeout(function() {\n      self.startScroll(point);\n    }, opts.scrollRepeatTimeout);\n  }\n};\n\nfunction between(val, start, end) {\n  if (start < val && val < end) {\n    return true;\n  }\n\n  return false;\n}\n\n\n/**\n * Stops scrolling loop.\n */\nAutoScroll.prototype.stopScroll = function() {\n  clearTimeout(this._scrolling);\n};\n\n\n/**\n * Overrides defaults options.\n *\n * @param  {Object} options\n */\nAutoScroll.prototype.setOptions = function(options) {\n  this._opts = assign({}, this._opts, options);\n};\n\n\n/**\n * Converts event to a point in canvas container plane in global scale.\n *\n * @param  {Event} event\n * @return {Point}\n */\nAutoScroll.prototype._toBorderPoint = function(event) {\n  var clientRect = this._canvas._container.getBoundingClientRect();\n\n  var globalPosition = toPoint(event.originalEvent);\n\n  return {\n    x: globalPosition.x - clientRect.left,\n    y: globalPosition.y - clientRect.top\n  };\n};","import DraggingModule from '../dragging';\n\nimport AutoScroll from './AutoScroll';\n\n\nexport default {\n  __depends__: [\n    DraggingModule,\n  ],\n  __init__: [ 'autoScroll' ],\n  autoScroll: [ 'type', AutoScroll ]\n};","/**\n * A service that provides rules for certain diagram actions.\n *\n * The default implementation will hook into the {@link CommandStack}\n * to perform the actual rule evaluation. Make sure to provide the\n * `commandStack` service with this module if you plan to use it.\n *\n * Together with this implementation you may use the {@link RuleProvider}\n * to implement your own rule checkers.\n *\n * This module is ment to be easily replaced, thus the tiny foot print.\n *\n * @param {Injector} injector\n */\nexport default function Rules(injector) {\n  this._commandStack = injector.get('commandStack', false);\n}\n\nRules.$inject = [ 'injector' ];\n\n\n/**\n * Returns whether or not a given modeling action can be executed\n * in the specified context.\n *\n * This implementation will respond with allow unless anyone\n * objects.\n *\n * @param {String} action the action to be checked\n * @param {Object} [context] the context to check the action in\n *\n * @return {Boolean} returns true, false or null depending on whether the\n *                   operation is allowed, not allowed or should be ignored.\n */\nRules.prototype.allowed = function(action, context) {\n  var allowed = true;\n\n  var commandStack = this._commandStack;\n\n  if (commandStack) {\n    allowed = commandStack.canExecute(action, context);\n  }\n\n  // map undefined to true, i.e. no rules\n  return allowed === undefined ? true : allowed;\n};","import Rules from './Rules';\n\nexport default {\n  __init__: [ 'rules' ],\n  rules: [ 'type', Rules ]\n};\n","import {\n  pointDistance\n} from './Geometry';\n\nimport intersectPaths from 'path-intersection';\n\nvar round = Math.round,\n    max = Math.max;\n\n\nfunction circlePath(center, r) {\n  var x = center.x,\n      y = center.y;\n\n  return [\n    ['M', x, y],\n    ['m', 0, -r],\n    ['a', r, r, 0, 1, 1, 0, 2 * r],\n    ['a', r, r, 0, 1, 1, 0, -2 * r],\n    ['z']\n  ];\n}\n\nfunction linePath(points) {\n  var segments = [];\n\n  points.forEach(function(p, idx) {\n    segments.push([ idx === 0 ? 'M' : 'L', p.x, p.y ]);\n  });\n\n  return segments;\n}\n\n\nvar INTERSECTION_THRESHOLD = 10;\n\nfunction getBendpointIntersection(waypoints, reference) {\n\n  var i, w;\n\n  for (i = 0; (w = waypoints[i]); i++) {\n\n    if (pointDistance(w, reference) <= INTERSECTION_THRESHOLD) {\n      return {\n        point: waypoints[i],\n        bendpoint: true,\n        index: i\n      };\n    }\n  }\n\n  return null;\n}\n\nfunction getPathIntersection(waypoints, reference) {\n\n  var intersections = intersectPaths(circlePath(reference, INTERSECTION_THRESHOLD), linePath(waypoints));\n\n  var a = intersections[0],\n      b = intersections[intersections.length - 1],\n      idx;\n\n  if (!a) {\n\n    // no intersection\n    return null;\n  }\n\n  if (a !== b) {\n\n    if (a.segment2 !== b.segment2) {\n\n      // we use the bendpoint in between both segments\n      // as the intersection point\n\n      idx = max(a.segment2, b.segment2) - 1;\n\n      return {\n        point: waypoints[idx],\n        bendpoint: true,\n        index: idx\n      };\n    }\n\n    return {\n      point: {\n        x: (round(a.x + b.x) / 2),\n        y: (round(a.y + b.y) / 2)\n      },\n      index: a.segment2\n    };\n  }\n\n  return {\n    point: {\n      x: round(a.x),\n      y: round(a.y)\n    },\n    index: a.segment2\n  };\n}\n\n/**\n * Returns the closest point on the connection towards a given reference point.\n *\n * @param  {Array<Point>} waypoints\n * @param  {Point} reference\n *\n * @return {Object} intersection data (segment, point)\n */\nexport function getApproxIntersection(waypoints, reference) {\n  return getBendpointIntersection(waypoints, reference) || getPathIntersection(waypoints, reference);\n}\n","import {\n  toPoint\n} from '../../util/Event';\n\nimport {\n  getMidPoint,\n  pointsAligned\n} from '../../util/Geometry';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  rotate,\n  translate\n} from '../../util/SvgTransformUtil';\n\nimport {\n  getApproxIntersection\n} from '../../util/LineIntersection';\n\nexport var BENDPOINT_CLS = 'djs-bendpoint';\nexport var SEGMENT_DRAGGER_CLS = 'djs-segment-dragger';\n\nexport function toCanvasCoordinates(canvas, event) {\n\n  var position = toPoint(event),\n      clientRect = canvas._container.getBoundingClientRect(),\n      offset;\n\n  // canvas relative position\n\n  offset = {\n    x: clientRect.left,\n    y: clientRect.top\n  };\n\n  // update actual event payload with canvas relative measures\n\n  var viewbox = canvas.viewbox();\n\n  return {\n    x: viewbox.x + (position.x - offset.x) / viewbox.scale,\n    y: viewbox.y + (position.y - offset.y) / viewbox.scale\n  };\n}\n\nexport function getConnectionIntersection(canvas, waypoints, event) {\n  var localPosition = toCanvasCoordinates(canvas, event),\n      intersection = getApproxIntersection(waypoints, localPosition);\n\n  return intersection;\n}\n\nexport function addBendpoint(parentGfx, cls) {\n  var groupGfx = svgCreate('g');\n  svgClasses(groupGfx).add(BENDPOINT_CLS);\n\n  svgAppend(parentGfx, groupGfx);\n\n  var visual = svgCreate('circle');\n  svgAttr(visual, {\n    cx: 0,\n    cy: 0,\n    r: 4\n  });\n  svgClasses(visual).add('djs-visual');\n\n  svgAppend(groupGfx, visual);\n\n  var hit = svgCreate('circle');\n  svgAttr(hit, {\n    cx: 0,\n    cy: 0,\n    r: 10\n  });\n  svgClasses(hit).add('djs-hit');\n\n  svgAppend(groupGfx, hit);\n\n  if (cls) {\n    svgClasses(groupGfx).add(cls);\n  }\n\n  return groupGfx;\n}\n\nfunction createParallelDragger(parentGfx, segmentStart, segmentEnd, alignment) {\n  var draggerGfx = svgCreate('g');\n\n  svgAppend(parentGfx, draggerGfx);\n\n  var width = 14,\n      height = 3,\n      padding = 6,\n      hitWidth = calculateHitWidth(segmentStart, segmentEnd, alignment),\n      hitHeight = height + padding;\n\n  var visual = svgCreate('rect');\n  svgAttr(visual, {\n    x: -width / 2,\n    y: -height / 2,\n    width: width,\n    height: height\n  });\n  svgClasses(visual).add('djs-visual');\n\n  svgAppend(draggerGfx, visual);\n\n  var hit = svgCreate('rect');\n  svgAttr(hit, {\n    x: -hitWidth / 2,\n    y: -hitHeight / 2,\n    width: hitWidth,\n    height: hitHeight\n  });\n  svgClasses(hit).add('djs-hit');\n\n  svgAppend(draggerGfx, hit);\n\n  rotate(draggerGfx, alignment === 'v' ? 90 : 0, 0, 0);\n\n  return draggerGfx;\n}\n\n\nexport function addSegmentDragger(parentGfx, segmentStart, segmentEnd) {\n\n  var groupGfx = svgCreate('g'),\n      mid = getMidPoint(segmentStart, segmentEnd),\n      alignment = pointsAligned(segmentStart, segmentEnd);\n\n  svgAppend(parentGfx, groupGfx);\n\n  createParallelDragger(groupGfx, segmentStart, segmentEnd, alignment);\n\n  svgClasses(groupGfx).add(SEGMENT_DRAGGER_CLS);\n  svgClasses(groupGfx).add(alignment === 'h' ? 'horizontal' : 'vertical');\n\n  translate(groupGfx, mid.x, mid.y);\n\n  return groupGfx;\n}\n\n/**\n * Calculates region for segment move which is 2/3 of the full segment length\n * @param {Number} segmentLength\n *\n * @return {Number}\n */\nexport function calculateSegmentMoveRegion(segmentLength) {\n  return Math.abs(Math.round(segmentLength * 2 / 3));\n}\n\n// helper //////////\n\nfunction calculateHitWidth(segmentStart, segmentEnd, alignment) {\n  var segmentLengthXAxis = segmentEnd.x - segmentStart.x,\n      segmentLengthYAxis = segmentEnd.y - segmentStart.y;\n\n  return alignment === 'h' ?\n    calculateSegmentMoveRegion(segmentLengthXAxis) :\n    calculateSegmentMoveRegion(segmentLengthYAxis);\n}\n","export {\n  default as escapeCSS\n} from 'css.escape';\n\nvar HTML_ESCAPE_MAP = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  '\\'': '&#39;'\n};\n\nexport function escapeHTML(str) {\n  str = '' + str;\n\n  return str && str.replace(/[&<>\"']/g, function(match) {\n    return HTML_ESCAPE_MAP[match];\n  });\n}\n","import { forEach } from 'min-dash';\n\nimport {\n  event as domEvent,\n  query as domQuery,\n  queryAll as domQueryAll\n} from 'min-dom';\n\nimport {\n  BENDPOINT_CLS,\n  SEGMENT_DRAGGER_CLS,\n  addBendpoint,\n  addSegmentDragger,\n  calculateSegmentMoveRegion,\n  getConnectionIntersection\n} from './BendpointUtil';\n\nimport {\n  escapeCSS\n} from '../../util/EscapeUtil';\n\nimport {\n  pointsAligned,\n  getMidPoint\n} from '../../util/Geometry';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\n\n/**\n * A service that adds editable bendpoints to connections.\n */\nexport default function Bendpoints(\n    eventBus, canvas, interactionEvents,\n    bendpointMove, connectionSegmentMove) {\n\n  /**\n   * Returns true if intersection point is inside middle region of segment, adjusted by\n   * optional threshold\n   */\n  function isIntersectionMiddle(intersection, waypoints, treshold) {\n    var idx = intersection.index,\n        p = intersection.point,\n        p0, p1, mid, aligned, xDelta, yDelta;\n\n    if (idx <= 0 || intersection.bendpoint) {\n      return false;\n    }\n\n    p0 = waypoints[idx - 1];\n    p1 = waypoints[idx];\n    mid = getMidPoint(p0, p1),\n    aligned = pointsAligned(p0, p1);\n    xDelta = Math.abs(p.x - mid.x);\n    yDelta = Math.abs(p.y - mid.y);\n\n    return aligned && xDelta <= treshold && yDelta <= treshold;\n  }\n\n  /**\n   * Calculates the threshold from a connection's middle which fits the two-third-region\n   */\n  function calculateIntersectionThreshold(connection, intersection) {\n    var waypoints = connection.waypoints,\n        relevantSegment, alignment, segmentLength, threshold;\n\n    if (intersection.index <= 0 || intersection.bendpoint) {\n      return null;\n    }\n\n    // segment relative to connection intersection\n    relevantSegment = {\n      start: waypoints[intersection.index - 1],\n      end: waypoints[intersection.index]\n    };\n\n    alignment = pointsAligned(relevantSegment.start, relevantSegment.end);\n\n    if (!alignment) {\n      return null;\n    }\n\n    if (alignment === 'h') {\n      segmentLength = relevantSegment.end.x - relevantSegment.start.x;\n    } else {\n      segmentLength = relevantSegment.end.y - relevantSegment.start.y;\n    }\n\n    // calculate threshold relative to 2/3 of segment length\n    threshold = calculateSegmentMoveRegion(segmentLength) / 2;\n\n    return threshold;\n  }\n\n  function activateBendpointMove(event, connection) {\n    var waypoints = connection.waypoints,\n        intersection = getConnectionIntersection(canvas, waypoints, event),\n        threshold;\n\n    if (!intersection) {\n      return;\n    }\n\n    threshold = calculateIntersectionThreshold(connection, intersection);\n\n    if (isIntersectionMiddle(intersection, waypoints, threshold)) {\n      connectionSegmentMove.start(event, connection, intersection.index);\n    } else {\n      bendpointMove.start(event, connection, intersection.index, !intersection.bendpoint);\n    }\n\n    // we've handled the event\n    return true;\n  }\n\n  function bindInteractionEvents(node, eventName, element) {\n\n    domEvent.bind(node, eventName, function(event) {\n      interactionEvents.triggerMouseEvent(eventName, event, element);\n      event.stopPropagation();\n    });\n  }\n\n  function getBendpointsContainer(element, create) {\n\n    var layer = canvas.getLayer('overlays'),\n        gfx = domQuery('.djs-bendpoints[data-element-id=\"' + escapeCSS(element.id) + '\"]', layer);\n\n    if (!gfx && create) {\n      gfx = svgCreate('g');\n      svgAttr(gfx, { 'data-element-id': element.id });\n      svgClasses(gfx).add('djs-bendpoints');\n\n      svgAppend(layer, gfx);\n\n      bindInteractionEvents(gfx, 'mousedown', element);\n      bindInteractionEvents(gfx, 'click', element);\n      bindInteractionEvents(gfx, 'dblclick', element);\n    }\n\n    return gfx;\n  }\n\n  function getSegmentDragger(idx, parentGfx) {\n    return domQuery(\n      '.djs-segment-dragger[data-segment-idx=\"' + idx + '\"]',\n      parentGfx\n    );\n  }\n\n  function createBendpoints(gfx, connection) {\n    connection.waypoints.forEach(function(p, idx) {\n      var bendpoint = addBendpoint(gfx);\n\n      svgAppend(gfx, bendpoint);\n\n      translate(bendpoint, p.x, p.y);\n    });\n\n    // add floating bendpoint\n    addBendpoint(gfx, 'floating');\n  }\n\n  function createSegmentDraggers(gfx, connection) {\n\n    var waypoints = connection.waypoints;\n\n    var segmentStart,\n        segmentEnd,\n        segmentDraggerGfx;\n\n    for (var i = 1; i < waypoints.length; i++) {\n\n      segmentStart = waypoints[i - 1];\n      segmentEnd = waypoints[i];\n\n      if (pointsAligned(segmentStart, segmentEnd)) {\n        segmentDraggerGfx = addSegmentDragger(gfx, segmentStart, segmentEnd);\n\n        svgAttr(segmentDraggerGfx, { 'data-segment-idx': i });\n\n        bindInteractionEvents(segmentDraggerGfx, 'mousemove', connection);\n      }\n    }\n  }\n\n  function clearBendpoints(gfx) {\n    forEach(domQueryAll('.' + BENDPOINT_CLS, gfx), function(node) {\n      svgRemove(node);\n    });\n  }\n\n  function clearSegmentDraggers(gfx) {\n    forEach(domQueryAll('.' + SEGMENT_DRAGGER_CLS, gfx), function(node) {\n      svgRemove(node);\n    });\n  }\n\n  function addHandles(connection) {\n\n    var gfx = getBendpointsContainer(connection);\n\n    if (!gfx) {\n      gfx = getBendpointsContainer(connection, true);\n\n      createBendpoints(gfx, connection);\n      createSegmentDraggers(gfx, connection);\n    }\n\n    return gfx;\n  }\n\n  function updateHandles(connection) {\n\n    var gfx = getBendpointsContainer(connection);\n\n    if (gfx) {\n      clearSegmentDraggers(gfx);\n      clearBendpoints(gfx);\n      createSegmentDraggers(gfx, connection);\n      createBendpoints(gfx, connection);\n    }\n  }\n\n  function updateFloatingBendpointPosition(parentGfx, intersection) {\n    var floating = domQuery('.floating', parentGfx),\n        point = intersection.point;\n\n    if (!floating) {\n      return;\n    }\n\n    translate(floating, point.x, point.y);\n\n  }\n\n  function updateSegmentDraggerPosition(parentGfx, intersection, waypoints) {\n\n    var draggerGfx = getSegmentDragger(intersection.index, parentGfx),\n        segmentStart = waypoints[intersection.index - 1],\n        segmentEnd = waypoints[intersection.index],\n        point = intersection.point,\n        mid = getMidPoint(segmentStart, segmentEnd),\n        alignment = pointsAligned(segmentStart, segmentEnd),\n        draggerVisual, relativePosition;\n\n    if (!draggerGfx) {\n      return;\n    }\n\n    draggerVisual = getDraggerVisual(draggerGfx);\n\n    relativePosition = {\n      x: point.x - mid.x,\n      y: point.y - mid.y\n    };\n\n    if (alignment === 'v') {\n\n      // rotate position\n      relativePosition = {\n        x: relativePosition.y,\n        y: relativePosition.x\n      };\n    }\n\n    translate(draggerVisual, relativePosition.x, relativePosition.y);\n  }\n\n  eventBus.on('connection.changed', function(event) {\n    updateHandles(event.element);\n  });\n\n  eventBus.on('connection.remove', function(event) {\n    var gfx = getBendpointsContainer(event.element);\n\n    if (gfx) {\n      svgRemove(gfx);\n    }\n  });\n\n  eventBus.on('element.marker.update', function(event) {\n\n    var element = event.element,\n        bendpointsGfx;\n\n    if (!element.waypoints) {\n      return;\n    }\n\n    bendpointsGfx = addHandles(element);\n\n    if (event.add) {\n      svgClasses(bendpointsGfx).add(event.marker);\n    } else {\n      svgClasses(bendpointsGfx).remove(event.marker);\n    }\n  });\n\n  eventBus.on('element.mousemove', function(event) {\n\n    var element = event.element,\n        waypoints = element.waypoints,\n        bendpointsGfx,\n        intersection;\n\n    if (waypoints) {\n      bendpointsGfx = getBendpointsContainer(element, true);\n\n      intersection = getConnectionIntersection(canvas, waypoints, event.originalEvent);\n\n      if (!intersection) {\n        return;\n      }\n\n      updateFloatingBendpointPosition(bendpointsGfx, intersection);\n\n      if (!intersection.bendpoint) {\n        updateSegmentDraggerPosition(bendpointsGfx, intersection, waypoints);\n      }\n\n    }\n  });\n\n  eventBus.on('element.mousedown', function(event) {\n\n    var originalEvent = event.originalEvent,\n        element = event.element;\n\n    if (!element.waypoints) {\n      return;\n    }\n\n    return activateBendpointMove(originalEvent, element);\n  });\n\n  eventBus.on('selection.changed', function(event) {\n    var newSelection = event.newSelection,\n        primary = newSelection[0];\n\n    if (primary && primary.waypoints) {\n      addHandles(primary);\n    }\n  });\n\n  eventBus.on('element.hover', function(event) {\n    var element = event.element;\n\n    if (element.waypoints) {\n      addHandles(element);\n      interactionEvents.registerEvent(event.gfx, 'mousemove', 'element.mousemove');\n    }\n  });\n\n  eventBus.on('element.out', function(event) {\n    interactionEvents.unregisterEvent(event.gfx, 'mousemove', 'element.mousemove');\n  });\n\n  // update bendpoint container data attribute on element ID change\n  eventBus.on('element.updateId', function(context) {\n    var element = context.element,\n        newId = context.newId;\n\n    if (element.waypoints) {\n      var bendpointContainer = getBendpointsContainer(element);\n\n      if (bendpointContainer) {\n        svgAttr(bendpointContainer, { 'data-element-id': newId });\n      }\n    }\n  });\n\n  // API\n\n  this.addHandles = addHandles;\n  this.updateHandles = updateHandles;\n  this.getBendpointsContainer = getBendpointsContainer;\n  this.getSegmentDragger = getSegmentDragger;\n}\n\nBendpoints.$inject = [\n  'eventBus',\n  'canvas',\n  'interactionEvents',\n  'bendpointMove',\n  'connectionSegmentMove'\n];\n\n\n\n// helper /////////////\n\nfunction getDraggerVisual(draggerGfx) {\n  return domQuery('.djs-visual', draggerGfx);\n}","import { filterRedundantWaypoints } from '../../layout/LayoutUtil';\n\nvar round = Math.round;\n\nvar RECONNECT_START = 'reconnectStart',\n    RECONNECT_END = 'reconnectEnd',\n    UPDATE_WAYPOINTS = 'updateWaypoints';\n\n\n/**\n * Move bendpoints through drag and drop to add/remove bendpoints or reconnect connection.\n */\nexport default function BendpointMove(injector, eventBus, canvas, dragging, rules, modeling) {\n  this._injector = injector;\n\n  this.start = function(event, connection, bendpointIndex, insert) {\n    var gfx = canvas.getGraphics(connection),\n        source = connection.source,\n        target = connection.target,\n        waypoints = connection.waypoints,\n        type;\n\n    if (!insert && bendpointIndex === 0) {\n      type = RECONNECT_START;\n    } else\n    if (!insert && bendpointIndex === waypoints.length - 1) {\n      type = RECONNECT_END;\n    } else {\n      type = UPDATE_WAYPOINTS;\n    }\n\n    var command = type === UPDATE_WAYPOINTS ? 'connection.updateWaypoints' : 'connection.reconnect';\n\n    var allowed = rules.allowed(command, {\n      connection: connection,\n      source: source,\n      target: target\n    });\n\n    if (allowed === false) {\n      allowed = rules.allowed(command, {\n        connection: connection,\n        source: target,\n        target: source\n      });\n    }\n\n    if (allowed === false) {\n      return;\n    }\n\n    dragging.init(event, 'bendpoint.move', {\n      data: {\n        connection: connection,\n        connectionGfx: gfx,\n        context: {\n          allowed: allowed,\n          bendpointIndex: bendpointIndex,\n          connection: connection,\n          source: source,\n          target: target,\n          insert: insert,\n          type: type\n        }\n      }\n    });\n  };\n\n  eventBus.on('bendpoint.move.hover', function(event) {\n    var context = event.context,\n        connection = context.connection,\n        source = connection.source,\n        target = connection.target,\n        hover = event.hover,\n        type = context.type;\n\n    // cache hover state\n    context.hover = hover;\n\n    var allowed;\n\n    if (!hover) {\n      return;\n    }\n\n    var command = type === UPDATE_WAYPOINTS ? 'connection.updateWaypoints' : 'connection.reconnect';\n\n    allowed = context.allowed = rules.allowed(command, {\n      connection: connection,\n      source: type === RECONNECT_START ? hover : source,\n      target: type === RECONNECT_END ? hover : target\n    });\n\n    if (allowed) {\n      context.source = type === RECONNECT_START ? hover : source;\n      context.target = type === RECONNECT_END ? hover : target;\n\n      return;\n    }\n\n    if (allowed === false) {\n      allowed = context.allowed = rules.allowed(command, {\n        connection: connection,\n        source: type === RECONNECT_END ? hover : target,\n        target: type === RECONNECT_START ? hover : source\n      });\n    }\n\n    if (allowed) {\n      context.source = type === RECONNECT_END ? hover : target;\n      context.target = type === RECONNECT_START ? hover : source;\n    }\n  });\n\n  eventBus.on([ 'bendpoint.move.out', 'bendpoint.move.cleanup' ], function(event) {\n    var context = event.context;\n\n    context.hover = null;\n    context.source = null;\n    context.target = null;\n\n    context.allowed = false;\n  });\n\n  eventBus.on('bendpoint.move.end', function(event) {\n    var context = event.context,\n        allowed = context.allowed,\n        bendpointIndex = context.bendpointIndex,\n        connection = context.connection,\n        insert = context.insert,\n        newWaypoints = connection.waypoints.slice(),\n        source = context.source,\n        target = context.target,\n        type = context.type,\n        hints = {};\n\n    // ensure integer values (important if zoom level was > 1 during move)\n    var docking = {\n      x: round(event.x),\n      y: round(event.y)\n    };\n\n    if (!allowed) {\n      return false;\n    }\n\n    if (type === UPDATE_WAYPOINTS) {\n      if (insert) {\n\n        // insert new bendpoint\n        newWaypoints.splice(bendpointIndex, 0, docking);\n      } else {\n\n        // swap previous waypoint with moved one\n        newWaypoints[bendpointIndex] = docking;\n      }\n\n      // pass hints about actual moved bendpoint\n      // useful for connection/label layout\n      hints = {\n        bendpointMove: {\n          insert: insert,\n          bendpointIndex: bendpointIndex\n        }\n      };\n\n      newWaypoints = this.cropWaypoints(connection, newWaypoints);\n\n      modeling.updateWaypoints(connection, filterRedundantWaypoints(newWaypoints), hints);\n    } else {\n      if (type === RECONNECT_START) {\n        hints.docking = 'source';\n\n        if (isReverse(context)) {\n          hints.docking = 'target';\n\n          hints.newWaypoints = newWaypoints.reverse();\n        }\n      } else if (type === RECONNECT_END) {\n        hints.docking = 'target';\n\n        if (isReverse(context)) {\n          hints.docking = 'source';\n\n          hints.newWaypoints = newWaypoints.reverse();\n        }\n      }\n\n      modeling.reconnect(connection, source, target, docking, hints);\n    }\n  }, this);\n}\n\nBendpointMove.$inject = [\n  'injector',\n  'eventBus',\n  'canvas',\n  'dragging',\n  'rules',\n  'modeling'\n];\n\nBendpointMove.prototype.cropWaypoints = function(connection, newWaypoints) {\n  var connectionDocking = this._injector.get('connectionDocking', false);\n\n  if (!connectionDocking) {\n    return newWaypoints;\n  }\n\n  var waypoints = connection.waypoints;\n\n  connection.waypoints = newWaypoints;\n\n  connection.waypoints = connectionDocking.getCroppedWaypoints(connection);\n\n  newWaypoints = connection.waypoints;\n\n  connection.waypoints = waypoints;\n\n  return newWaypoints;\n};\n\n\n// helpers //////////\n\nexport function isReverse(context) {\n  var hover = context.hover,\n      source = context.source,\n      target = context.target,\n      type = context.type;\n\n  if (type === RECONNECT_START) {\n    return hover && target && hover === target && source !== target;\n  }\n\n  if (type === RECONNECT_END) {\n    return hover && source && hover === source && source !== target;\n  }\n}","import {\n  classes as svgClasses,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport { addBendpoint } from './BendpointUtil';\n\nimport { translate } from '../../util/SvgTransformUtil';\n\nimport { isReverse } from './BendpointMove';\n\nvar RECONNECT_START = 'reconnectStart',\n    RECONNECT_END = 'reconnectEnd',\n    UPDATE_WAYPOINTS = 'updateWaypoints';\n\nvar MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok',\n    MARKER_CONNECT_HOVER = 'connect-hover',\n    MARKER_CONNECT_UPDATING = 'djs-updating',\n    MARKER_ELEMENT_HIDDEN = 'djs-element-hidden';\n\nvar HIGH_PRIORITY = 1100;\n\n/**\n * Preview connection while moving bendpoints.\n */\nexport default function BendpointMovePreview(bendpointMove, injector, eventBus, canvas) {\n  this._injector = injector;\n\n  var connectionPreview = injector.get('connectionPreview', false);\n\n  eventBus.on('bendpoint.move.start', function(event) {\n    var context = event.context,\n        bendpointIndex = context.bendpointIndex,\n        connection = context.connection,\n        insert = context.insert,\n        waypoints = connection.waypoints,\n        newWaypoints = waypoints.slice();\n\n    context.waypoints = waypoints;\n\n    if (insert) {\n\n      // insert placeholder for new bendpoint\n      newWaypoints.splice(bendpointIndex, 0, { x: event.x, y: event.y });\n    }\n\n    connection.waypoints = newWaypoints;\n\n    // add dragger gfx\n    var draggerGfx = context.draggerGfx = addBendpoint(canvas.getLayer('overlays'));\n\n    svgClasses(draggerGfx).add('djs-dragging');\n\n    canvas.addMarker(connection, MARKER_ELEMENT_HIDDEN);\n    canvas.addMarker(connection, MARKER_CONNECT_UPDATING);\n  });\n\n  eventBus.on('bendpoint.move.hover', function(event) {\n    var context = event.context,\n        allowed = context.allowed,\n        hover = context.hover,\n        type = context.type;\n\n    if (hover) {\n      canvas.addMarker(hover, MARKER_CONNECT_HOVER);\n\n      if (type === UPDATE_WAYPOINTS) {\n        return;\n      }\n\n      if (allowed) {\n        canvas.removeMarker(hover, MARKER_NOT_OK);\n        canvas.addMarker(hover, MARKER_OK);\n      } else if (allowed === false) {\n        canvas.removeMarker(hover, MARKER_OK);\n        canvas.addMarker(hover, MARKER_NOT_OK);\n      }\n    }\n  });\n\n  eventBus.on([\n    'bendpoint.move.out',\n    'bendpoint.move.cleanup'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        hover = context.hover,\n        target = context.target;\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_CONNECT_HOVER);\n      canvas.removeMarker(hover, target ? MARKER_OK : MARKER_NOT_OK);\n    }\n  });\n\n  eventBus.on('bendpoint.move.move', function(event) {\n    var context = event.context,\n        allowed = context.allowed,\n        bendpointIndex = context.bendpointIndex,\n        draggerGfx = context.draggerGfx,\n        hover = context.hover,\n        type = context.type,\n        connection = context.connection,\n        source = connection.source,\n        target = connection.target,\n        newWaypoints = connection.waypoints.slice(),\n        bendpoint = { x: event.x, y: event.y },\n        hints;\n\n    if (connectionPreview) {\n      hints = {\n        source: source,\n        target: target\n      };\n\n      if (type === RECONNECT_START) {\n        if (isReverse(context)) {\n          hints.connectionEnd = bendpoint;\n          hints.source = target;\n          hints.target = hover || source;\n\n          newWaypoints = newWaypoints.reverse();\n        } else {\n          hints.connectionStart = bendpoint;\n          hints.source = hover || source;\n        }\n      } else if (type === RECONNECT_END) {\n        if (isReverse(context)) {\n          hints.connectionStart = bendpoint;\n          hints.target = source;\n          hints.source = hover || target;\n\n          newWaypoints = newWaypoints.reverse();\n        } else {\n          hints.connectionEnd = bendpoint;\n          hints.target = hover || target;\n        }\n\n      } else {\n        hints.noCropping = true;\n        hints.noLayout = true;\n        newWaypoints[ bendpointIndex ] = bendpoint;\n      }\n\n      if (type === UPDATE_WAYPOINTS) {\n        newWaypoints = bendpointMove.cropWaypoints(connection, newWaypoints);\n      }\n\n      hints.waypoints = newWaypoints;\n\n      connectionPreview.drawPreview(context, allowed, hints);\n    }\n\n    translate(draggerGfx, event.x, event.y);\n  }, this);\n\n  eventBus.on([\n    'bendpoint.move.end',\n    'bendpoint.move.cancel'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        connection = context.connection,\n        draggerGfx = context.draggerGfx,\n        hover = context.hover,\n        target = context.target,\n        waypoints = context.waypoints;\n\n    connection.waypoints = waypoints;\n\n    // remove dragger gfx\n    svgRemove(draggerGfx);\n\n    canvas.removeMarker(connection, MARKER_CONNECT_UPDATING);\n    canvas.removeMarker(connection, MARKER_ELEMENT_HIDDEN);\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_OK);\n      canvas.removeMarker(hover, target ? MARKER_OK : MARKER_NOT_OK);\n    }\n\n    if (connectionPreview) {\n      connectionPreview.cleanUp(context);\n    }\n  });\n}\n\nBendpointMovePreview.$inject = [\n  'bendpointMove',\n  'injector',\n  'eventBus',\n  'canvas'\n];","import {\n  pointsAligned,\n  pointsOnLine\n} from '../../util/Geometry';\n\nimport {\n  addSegmentDragger,\n  getConnectionIntersection\n} from './BendpointUtil';\n\nimport {\n  getMid,\n  getOrientation\n} from '../../layout/LayoutUtil';\n\nvar MARKER_CONNECT_HOVER = 'connect-hover',\n    MARKER_CONNECT_UPDATING = 'djs-updating';\n\nimport {\n  classes as svgClasses,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\n\nfunction axisAdd(point, axis, delta) {\n  return axisSet(point, axis, point[axis] + delta);\n}\n\nfunction axisSet(point, axis, value) {\n  return {\n    x: (axis === 'x' ? value : point.x),\n    y: (axis === 'y' ? value : point.y)\n  };\n}\n\nfunction axisFenced(position, segmentStart, segmentEnd, axis) {\n\n  var maxValue = Math.max(segmentStart[axis], segmentEnd[axis]),\n      minValue = Math.min(segmentStart[axis], segmentEnd[axis]);\n\n  var padding = 20;\n\n  var fencedValue = Math.min(Math.max(minValue + padding, position[axis]), maxValue - padding);\n\n  return axisSet(segmentStart, axis, fencedValue);\n}\n\nfunction flipAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}\n\n/**\n * Get the docking point on the given element.\n *\n * Compute a reasonable docking, if non exists.\n *\n * @param  {Point} point\n * @param  {djs.model.Shape} referenceElement\n * @param  {String} moveAxis (x|y)\n *\n * @return {Point}\n */\nfunction getDocking(point, referenceElement, moveAxis) {\n\n  var referenceMid,\n      inverseAxis;\n\n  if (point.original) {\n    return point.original;\n  } else {\n    referenceMid = getMid(referenceElement);\n    inverseAxis = flipAxis(moveAxis);\n\n    return axisSet(point, inverseAxis, referenceMid[inverseAxis]);\n  }\n}\n\n/**\n * A component that implements moving of bendpoints\n */\nexport default function ConnectionSegmentMove(\n    injector, eventBus, canvas,\n    dragging, graphicsFactory, modeling) {\n\n  // optional connection docking integration\n  var connectionDocking = injector.get('connectionDocking', false);\n\n\n  // API\n\n  this.start = function(event, connection, idx) {\n\n    var context,\n        gfx = canvas.getGraphics(connection),\n        segmentStartIndex = idx - 1,\n        segmentEndIndex = idx,\n        waypoints = connection.waypoints,\n        segmentStart = waypoints[segmentStartIndex],\n        segmentEnd = waypoints[segmentEndIndex],\n        intersection = getConnectionIntersection(canvas, waypoints, event),\n        direction, axis, dragPosition;\n\n    direction = pointsAligned(segmentStart, segmentEnd);\n\n    // do not move diagonal connection\n    if (!direction) {\n      return;\n    }\n\n    // the axis where we are going to move things\n    axis = direction === 'v' ? 'x' : 'y';\n\n    if (segmentStartIndex === 0) {\n      segmentStart = getDocking(segmentStart, connection.source, axis);\n    }\n\n    if (segmentEndIndex === waypoints.length - 1) {\n      segmentEnd = getDocking(segmentEnd, connection.target, axis);\n    }\n\n    if (intersection) {\n      dragPosition = intersection.point;\n    } else {\n\n      // set to segment center as default\n      dragPosition = {\n        x: (segmentStart.x + segmentEnd.x) / 2,\n        y: (segmentStart.y + segmentEnd.y) / 2\n      };\n    }\n\n    context = {\n      connection: connection,\n      segmentStartIndex: segmentStartIndex,\n      segmentEndIndex: segmentEndIndex,\n      segmentStart: segmentStart,\n      segmentEnd: segmentEnd,\n      axis: axis,\n      dragPosition: dragPosition\n    };\n\n    dragging.init(event, dragPosition, 'connectionSegment.move', {\n      cursor: axis === 'x' ? 'resize-ew' : 'resize-ns',\n      data: {\n        connection: connection,\n        connectionGfx: gfx,\n        context: context\n      }\n    });\n  };\n\n  /**\n   * Crop connection if connection cropping is provided.\n   *\n   * @param {Connection} connection\n   * @param {Array<Point>} newWaypoints\n   *\n   * @return {Array<Point>} cropped connection waypoints\n   */\n  function cropConnection(connection, newWaypoints) {\n\n    // crop connection, if docking service is provided only\n    if (!connectionDocking) {\n      return newWaypoints;\n    }\n\n    var oldWaypoints = connection.waypoints,\n        croppedWaypoints;\n\n    // temporary set new waypoints\n    connection.waypoints = newWaypoints;\n\n    croppedWaypoints = connectionDocking.getCroppedWaypoints(connection);\n\n    // restore old waypoints\n    connection.waypoints = oldWaypoints;\n\n    return croppedWaypoints;\n  }\n\n  // DRAGGING IMPLEMENTATION\n\n  function redrawConnection(data) {\n    graphicsFactory.update('connection', data.connection, data.connectionGfx);\n  }\n\n  function updateDragger(context, segmentOffset, event) {\n\n    var newWaypoints = context.newWaypoints,\n        segmentStartIndex = context.segmentStartIndex + segmentOffset,\n        segmentStart = newWaypoints[segmentStartIndex],\n        segmentEndIndex = context.segmentEndIndex + segmentOffset,\n        segmentEnd = newWaypoints[segmentEndIndex],\n        axis = flipAxis(context.axis);\n\n    // make sure the dragger does not move\n    // outside the connection\n    var draggerPosition = axisFenced(event, segmentStart, segmentEnd, axis);\n\n    // update dragger\n    translate(context.draggerGfx, draggerPosition.x, draggerPosition.y);\n  }\n\n  /**\n   * Filter waypoints for redundant ones (i.e. on the same axis).\n   * Returns the filtered waypoints and the offset related to the segment move.\n   *\n   * @param {Array<Point>} waypoints\n   * @param {Integer} segmentStartIndex of moved segment start\n   *\n   * @return {Object} { filteredWaypoints, segmentOffset }\n   */\n  function filterRedundantWaypoints(waypoints, segmentStartIndex) {\n\n    var segmentOffset = 0;\n\n    var filteredWaypoints = waypoints.filter(function(r, idx) {\n      if (pointsOnLine(waypoints[idx - 1], waypoints[idx + 1], r)) {\n\n        // remove point and increment offset\n        segmentOffset = idx <= segmentStartIndex ? segmentOffset - 1 : segmentOffset;\n        return false;\n      }\n\n      // dont remove point\n      return true;\n    });\n\n    return {\n      waypoints: filteredWaypoints,\n      segmentOffset: segmentOffset\n    };\n  }\n\n  eventBus.on('connectionSegment.move.start', function(event) {\n\n    var context = event.context,\n        connection = event.connection,\n        layer = canvas.getLayer('overlays');\n\n    context.originalWaypoints = connection.waypoints.slice();\n\n    // add dragger gfx\n    context.draggerGfx = addSegmentDragger(layer, context.segmentStart, context.segmentEnd);\n    svgClasses(context.draggerGfx).add('djs-dragging');\n\n    canvas.addMarker(connection, MARKER_CONNECT_UPDATING);\n  });\n\n  eventBus.on('connectionSegment.move.move', function(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        segmentStartIndex = context.segmentStartIndex,\n        segmentEndIndex = context.segmentEndIndex,\n        segmentStart = context.segmentStart,\n        segmentEnd = context.segmentEnd,\n        axis = context.axis;\n\n    var newWaypoints = context.originalWaypoints.slice(),\n        newSegmentStart = axisAdd(segmentStart, axis, event['d' + axis]),\n        newSegmentEnd = axisAdd(segmentEnd, axis, event['d' + axis]);\n\n    // original waypoint count and added / removed\n    // from start waypoint delta. We use the later\n    // to retrieve the updated segmentStartIndex / segmentEndIndex\n    var waypointCount = newWaypoints.length,\n        segmentOffset = 0;\n\n    // move segment start / end by axis delta\n    newWaypoints[segmentStartIndex] = newSegmentStart;\n    newWaypoints[segmentEndIndex] = newSegmentEnd;\n\n    var sourceToSegmentOrientation,\n        targetToSegmentOrientation;\n\n    // handle first segment\n    if (segmentStartIndex < 2) {\n      sourceToSegmentOrientation = getOrientation(connection.source, newSegmentStart);\n\n      // first bendpoint, remove first segment if intersecting\n      if (segmentStartIndex === 1) {\n\n        if (sourceToSegmentOrientation === 'intersect') {\n          newWaypoints.shift();\n          newWaypoints[0] = newSegmentStart;\n          segmentOffset--;\n        }\n      }\n\n      // docking point, add segment if not intersecting anymore\n      else {\n        if (sourceToSegmentOrientation !== 'intersect') {\n          newWaypoints.unshift(segmentStart);\n          segmentOffset++;\n        }\n      }\n    }\n\n    // handle last segment\n    if (segmentEndIndex > waypointCount - 3) {\n      targetToSegmentOrientation = getOrientation(connection.target, newSegmentEnd);\n\n      // last bendpoint, remove last segment if intersecting\n      if (segmentEndIndex === waypointCount - 2) {\n\n        if (targetToSegmentOrientation === 'intersect') {\n          newWaypoints.pop();\n          newWaypoints[newWaypoints.length - 1] = newSegmentEnd;\n        }\n      }\n\n      // last bendpoint, remove last segment if intersecting\n      else {\n        if (targetToSegmentOrientation !== 'intersect') {\n          newWaypoints.push(segmentEnd);\n        }\n      }\n    }\n\n    // update connection waypoints\n    context.newWaypoints = connection.waypoints = cropConnection(connection, newWaypoints);\n\n    // update dragger position\n    updateDragger(context, segmentOffset, event);\n\n    // save segmentOffset in context\n    context.newSegmentStartIndex = segmentStartIndex + segmentOffset;\n\n    // redraw connection\n    redrawConnection(event);\n  });\n\n  eventBus.on('connectionSegment.move.hover', function(event) {\n\n    event.context.hover = event.hover;\n    canvas.addMarker(event.hover, MARKER_CONNECT_HOVER);\n  });\n\n  eventBus.on([\n    'connectionSegment.move.out',\n    'connectionSegment.move.cleanup'\n  ], function(event) {\n\n    // remove connect marker\n    // if it was added\n    var hover = event.context.hover;\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_CONNECT_HOVER);\n    }\n  });\n\n  eventBus.on('connectionSegment.move.cleanup', function(event) {\n\n    var context = event.context,\n        connection = context.connection;\n\n    // remove dragger gfx\n    if (context.draggerGfx) {\n      svgRemove(context.draggerGfx);\n    }\n\n    canvas.removeMarker(connection, MARKER_CONNECT_UPDATING);\n  });\n\n  eventBus.on([\n    'connectionSegment.move.cancel',\n    'connectionSegment.move.end'\n  ], function(event) {\n    var context = event.context,\n        connection = context.connection;\n\n    connection.waypoints = context.originalWaypoints;\n\n    redrawConnection(event);\n  });\n\n  eventBus.on('connectionSegment.move.end', function(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        newWaypoints = context.newWaypoints,\n        newSegmentStartIndex = context.newSegmentStartIndex;\n\n    // ensure we have actual pixel values bendpoint\n    // coordinates (important when zoom level was > 1 during move)\n    newWaypoints = newWaypoints.map(function(p) {\n      return {\n        original: p.original,\n        x: Math.round(p.x),\n        y: Math.round(p.y)\n      };\n    });\n\n    // apply filter redunant waypoints\n    var filtered = filterRedundantWaypoints(newWaypoints, newSegmentStartIndex);\n\n    // get filtered waypoints\n    var filteredWaypoints = filtered.waypoints,\n        croppedWaypoints = cropConnection(connection, filteredWaypoints),\n        segmentOffset = filtered.segmentOffset;\n\n    var hints = {\n      segmentMove: {\n        segmentStartIndex: context.segmentStartIndex,\n        newSegmentStartIndex: newSegmentStartIndex + segmentOffset\n      }\n    };\n\n    modeling.updateWaypoints(connection, croppedWaypoints, hints);\n  });\n}\n\nConnectionSegmentMove.$inject = [\n  'injector',\n  'eventBus',\n  'canvas',\n  'dragging',\n  'graphicsFactory',\n  'modeling'\n];\n","var abs = Math.abs,\n    round = Math.round;\n\n\n/**\n * Snap value to a collection of reference values.\n *\n * @param  {Number} value\n * @param  {Array<Number>} values\n * @param  {Number} [tolerance=10]\n *\n * @return {Number} the value we snapped to or null, if none snapped\n */\nexport function snapTo(value, values, tolerance) {\n  tolerance = tolerance === undefined ? 10 : tolerance;\n\n  var idx, snapValue;\n\n  for (idx = 0; idx < values.length; idx++) {\n    snapValue = values[idx];\n\n    if (abs(snapValue - value) <= tolerance) {\n      return snapValue;\n    }\n  }\n}\n\n\nexport function topLeft(bounds) {\n  return {\n    x: bounds.x,\n    y: bounds.y\n  };\n}\n\nexport function topRight(bounds) {\n  return {\n    x: bounds.x + bounds.width,\n    y: bounds.y\n  };\n}\n\nexport function bottomLeft(bounds) {\n  return {\n    x: bounds.x,\n    y: bounds.y + bounds.height\n  };\n}\n\nexport function bottomRight(bounds) {\n  return {\n    x: bounds.x + bounds.width,\n    y: bounds.y + bounds.height\n  };\n}\n\nexport function mid(bounds, defaultValue) {\n\n  if (!bounds || isNaN(bounds.x) || isNaN(bounds.y)) {\n    return defaultValue;\n  }\n\n  return {\n    x: round(bounds.x + bounds.width / 2),\n    y: round(bounds.y + bounds.height / 2)\n  };\n}\n\n\n/**\n * Retrieve the snap state of the given event.\n *\n * @param  {Event} event\n * @param  {String} axis\n *\n * @return {Boolean} the snapped state\n *\n */\nexport function isSnapped(event, axis) {\n  var snapped = event.snapped;\n\n  if (!snapped) {\n    return false;\n  }\n\n  if (typeof axis === 'string') {\n    return snapped[axis];\n  }\n\n  return snapped.x && snapped.y;\n}\n\n\n/**\n * Set the given event as snapped.\n *\n * This method may change the x and/or y position of the shape\n * from the given event!\n *\n * @param {Event} event\n * @param {String} axis\n * @param {Number|Boolean} value\n *\n * @return {Number} old value\n */\nexport function setSnapped(event, axis, value) {\n  if (typeof axis !== 'string') {\n    throw new Error('axis must be in [x, y]');\n  }\n\n  if (typeof value !== 'number' && value !== false) {\n    throw new Error('value must be Number or false');\n  }\n\n  var delta,\n      previousValue = event[axis];\n\n  var snapped = event.snapped = (event.snapped || {});\n\n\n  if (value === false) {\n    snapped[axis] = false;\n  } else {\n    snapped[axis] = true;\n\n    delta = value - previousValue;\n\n    event[axis] += delta;\n    event['d' + axis] += delta;\n  }\n\n  return previousValue;\n}\n\n/**\n * Get children of a shape.\n *\n * @param {djs.model.Shape} parent\n *\n * @returns {Array<djs.model.Shape|djs.model.Connection>}\n */\nexport function getChildren(parent) {\n  return parent.children || [];\n}","import {\n  assign,\n  forEach,\n  isArray\n} from 'min-dash';\n\nimport { setSnapped } from '../snapping/SnapUtil';\n\nvar abs= Math.abs,\n    round = Math.round;\n\nvar TOLERANCE = 10;\n\n\nexport default function BendpointSnapping(eventBus) {\n\n  function snapTo(values, value) {\n\n    if (isArray(values)) {\n      var i = values.length;\n\n      while (i--) if (abs(values[i] - value) <= TOLERANCE) {\n        return values[i];\n      }\n    } else {\n      values = +values;\n      var rem = value % values;\n\n      if (rem < TOLERANCE) {\n        return value - rem;\n      }\n\n      if (rem > values - TOLERANCE) {\n        return value - rem + values;\n      }\n    }\n\n    return value;\n  }\n\n  function mid(element) {\n    if (element.width) {\n      return {\n        x: round(element.width / 2 + element.x),\n        y: round(element.height / 2 + element.y)\n      };\n    }\n  }\n\n  // connection segment snapping //////////////////////\n\n  function getConnectionSegmentSnaps(context) {\n\n    var snapPoints = context.snapPoints,\n        connection = context.connection,\n        waypoints = connection.waypoints,\n        segmentStart = context.segmentStart,\n        segmentStartIndex = context.segmentStartIndex,\n        segmentEnd = context.segmentEnd,\n        segmentEndIndex = context.segmentEndIndex,\n        axis = context.axis;\n\n    if (snapPoints) {\n      return snapPoints;\n    }\n\n    var referenceWaypoints = [\n      waypoints[segmentStartIndex - 1],\n      segmentStart,\n      segmentEnd,\n      waypoints[segmentEndIndex + 1]\n    ];\n\n    if (segmentStartIndex < 2) {\n      referenceWaypoints.unshift(mid(connection.source));\n    }\n\n    if (segmentEndIndex > waypoints.length - 3) {\n      referenceWaypoints.unshift(mid(connection.target));\n    }\n\n    context.snapPoints = snapPoints = { horizontal: [] , vertical: [] };\n\n    forEach(referenceWaypoints, function(p) {\n\n      // we snap on existing bendpoints only,\n      // not placeholders that are inserted during add\n      if (p) {\n        p = p.original || p;\n\n        if (axis === 'y') {\n          snapPoints.horizontal.push(p.y);\n        }\n\n        if (axis === 'x') {\n          snapPoints.vertical.push(p.x);\n        }\n      }\n    });\n\n    return snapPoints;\n  }\n\n  eventBus.on('connectionSegment.move.move', 1500, function(event) {\n    var context = event.context,\n        snapPoints = getConnectionSegmentSnaps(context),\n        x = event.x,\n        y = event.y,\n        sx, sy;\n\n    if (!snapPoints) {\n      return;\n    }\n\n    // snap\n    sx = snapTo(snapPoints.vertical, x);\n    sy = snapTo(snapPoints.horizontal, y);\n\n\n    // correction x/y\n    var cx = (x - sx),\n        cy = (y - sy);\n\n    // update delta\n    assign(event, {\n      dx: event.dx - cx,\n      dy: event.dy - cy,\n      x: sx,\n      y: sy\n    });\n\n    // only set snapped if actually snapped\n    if (cx || snapPoints.vertical.indexOf(x) !== -1) {\n      setSnapped(event, 'x', sx);\n    }\n\n    if (cy || snapPoints.horizontal.indexOf(y) !== -1) {\n      setSnapped(event, 'y', sy);\n    }\n  });\n\n\n  // bendpoint snapping //////////////////////\n\n  function getBendpointSnaps(context) {\n\n    var snapPoints = context.snapPoints,\n        waypoints = context.connection.waypoints,\n        bendpointIndex = context.bendpointIndex;\n\n    if (snapPoints) {\n      return snapPoints;\n    }\n\n    var referenceWaypoints = [ waypoints[bendpointIndex - 1], waypoints[bendpointIndex + 1] ];\n\n    context.snapPoints = snapPoints = { horizontal: [] , vertical: [] };\n\n    forEach(referenceWaypoints, function(p) {\n\n      // we snap on existing bendpoints only,\n      // not placeholders that are inserted during add\n      if (p) {\n        p = p.original || p;\n\n        snapPoints.horizontal.push(p.y);\n        snapPoints.vertical.push(p.x);\n      }\n    });\n\n    return snapPoints;\n  }\n\n\n  eventBus.on([ 'bendpoint.move.move', 'bendpoint.move.end' ], 1500, function(event) {\n\n    var context = event.context,\n        snapPoints = getBendpointSnaps(context),\n        hover = context.hover,\n        hoverMid = hover && mid(hover),\n        x = event.x,\n        y = event.y,\n        sx, sy;\n\n    if (!snapPoints) {\n      return;\n    }\n\n    // snap to hover mid\n    sx = snapTo(hoverMid ? snapPoints.vertical.concat([ hoverMid.x ]) : snapPoints.vertical, x);\n    sy = snapTo(hoverMid ? snapPoints.horizontal.concat([ hoverMid.y ]) : snapPoints.horizontal, y);\n\n    // correction x/y\n    var cx = (x - sx),\n        cy = (y - sy);\n\n    // update delta\n    assign(event, {\n      dx: event.dx - cx,\n      dy: event.dy - cy,\n      x: event.x - cx,\n      y: event.y - cy\n    });\n\n    // only set snapped if actually snapped\n    if (cx || snapPoints.vertical.indexOf(x) !== -1) {\n      setSnapped(event, 'x', sx);\n    }\n\n    if (cy || snapPoints.horizontal.indexOf(y) !== -1) {\n      setSnapped(event, 'y', sy);\n    }\n  });\n}\n\n\nBendpointSnapping.$inject = [ 'eventBus' ];","import DraggingModule from '../dragging';\nimport RulesModule from '../rules';\n\nimport Bendpoints from './Bendpoints';\nimport BendpointMove from './BendpointMove';\nimport BendpointMovePreview from './BendpointMovePreview';\nimport ConnectionSegmentMove from './ConnectionSegmentMove';\nimport BendpointSnapping from './BendpointSnapping';\n\n\nexport default {\n  __depends__: [\n    DraggingModule,\n    RulesModule\n  ],\n  __init__: [ 'bendpoints', 'bendpointSnapping', 'bendpointMovePreview' ],\n  bendpoints: [ 'type', Bendpoints ],\n  bendpointMove: [ 'type', BendpointMove ],\n  bendpointMovePreview: [ 'type', BendpointMovePreview ],\n  connectionSegmentMove: [ 'type', ConnectionSegmentMove ],\n  bendpointSnapping: [ 'type', BendpointSnapping ]\n};\n","import {\n  getMid\n} from '../../layout/LayoutUtil';\n\nimport {\n  isNil,\n  isObject\n} from 'min-dash';\n\n\nexport default function Connect(eventBus, dragging, modeling, rules) {\n\n  // rules\n\n  function canConnect(source, target) {\n    return rules.allowed('connection.create', {\n      source: source,\n      target: target\n    });\n  }\n\n  function canConnectReverse(source, target) {\n    return canConnect(target, source);\n  }\n\n\n  // event handlers\n\n  eventBus.on('connect.hover', function(event) {\n    var context = event.context,\n        start = context.start,\n        hover = event.hover,\n        canExecute;\n\n    // cache hover state\n    context.hover = hover;\n\n    canExecute = context.canExecute = canConnect(start, hover);\n\n    // ignore hover\n    if (isNil(canExecute)) {\n      return;\n    }\n\n    if (canExecute !== false) {\n      context.source = start;\n      context.target = hover;\n\n      return;\n    }\n\n    canExecute = context.canExecute = canConnectReverse(start, hover);\n\n    // ignore hover\n    if (isNil(canExecute)) {\n      return;\n    }\n\n    if (canExecute !== false) {\n      context.source = hover;\n      context.target = start;\n    }\n  });\n\n  eventBus.on([ 'connect.out', 'connect.cleanup' ], function(event) {\n    var context = event.context;\n\n    context.hover = null;\n    context.source = null;\n    context.target = null;\n\n    context.canExecute = false;\n  });\n\n  eventBus.on('connect.end', function(event) {\n    var context = event.context,\n        canExecute = context.canExecute,\n        connectionStart = context.connectionStart,\n        connectionEnd = {\n          x: event.x,\n          y: event.y\n        },\n        source = context.source,\n        target = context.target;\n\n    if (!canExecute) {\n      return false;\n    }\n\n    var attrs = null,\n        hints = {\n          connectionStart: isReverse(context) ? connectionEnd : connectionStart,\n          connectionEnd: isReverse(context) ? connectionStart : connectionEnd\n        };\n\n    if (isObject(canExecute)) {\n      attrs = canExecute;\n    }\n\n    modeling.connect(source, target, attrs, hints);\n  });\n\n\n  // API\n\n  /**\n   * Start connect operation.\n   *\n   * @param {DOMEvent} event\n   * @param {djs.model.Base} start\n   * @param {Point} [connectionStart]\n   * @param {boolean} [autoActivate=false]\n   */\n  this.start = function(event, start, connectionStart, autoActivate) {\n    if (!isObject(connectionStart)) {\n      autoActivate = connectionStart;\n      connectionStart = getMid(start);\n    }\n\n    dragging.init(event, 'connect', {\n      autoActivate: autoActivate,\n      data: {\n        shape: start,\n        context: {\n          start: start,\n          connectionStart: connectionStart\n        }\n      }\n    });\n  };\n}\n\nConnect.$inject = [\n  'eventBus',\n  'dragging',\n  'modeling',\n  'rules'\n];\n\n\n// helpers //////////\n\nexport function isReverse(context) {\n  var hover = context.hover,\n      source = context.source,\n      target = context.target;\n\n  return hover && source && hover === source && source !== target;\n}","import { isReverse } from './Connect';\n\nvar HIGH_PRIORITY = 1100,\n    LOW_PRIORITY = 900;\n\nvar MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok';\n\n/**\n * Shows connection preview during connect.\n *\n * @param {didi.Injector} injector\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function ConnectPreview(injector, eventBus, canvas) {\n  var connectionPreview = injector.get('connectionPreview', false);\n\n  connectionPreview && eventBus.on('connect.move', function(event) {\n    var context = event.context,\n        canConnect = context.canExecute,\n        hover = context.hover,\n        source = context.source,\n        start = context.start,\n        startPosition = context.startPosition,\n        target = context.target;\n\n    var connectionStart = isReverse(context) ? {\n      x: event.x,\n      y: event.y\n    } : startPosition;\n\n    var connectionEnd = isReverse(context) ? startPosition : {\n      x: event.x,\n      y: event.y\n    };\n\n    connectionPreview.drawPreview(context, canConnect, {\n      source: source || start,\n      target: target || hover,\n      connectionStart: connectionStart,\n      connectionEnd: connectionEnd\n    });\n  });\n\n  eventBus.on('connect.hover', LOW_PRIORITY, function(event) {\n    var context = event.context,\n        hover = event.hover,\n        canExecute = context.canExecute;\n\n    // ignore hover\n    if (canExecute === null) {\n      return;\n    }\n\n    canvas.addMarker(hover, canExecute ? MARKER_OK : MARKER_NOT_OK);\n  });\n\n  eventBus.on([\n    'connect.out',\n    'connect.cleanup'\n  ], HIGH_PRIORITY, function(event) {\n    var hover = event.hover;\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_OK);\n      canvas.removeMarker(hover, MARKER_NOT_OK);\n    }\n  });\n\n  connectionPreview && eventBus.on('connect.cleanup', function(event) {\n    connectionPreview.cleanUp(event.context);\n  });\n}\n\nConnectPreview.$inject = [\n  'injector',\n  'eventBus',\n  'canvas'\n];\n","import SelectionModule from '../selection';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\n\nimport Connect from './Connect';\nimport ConnectPreview from './ConnectPreview';\n\nexport default {\n  __depends__: [\n    SelectionModule,\n    RulesModule,\n    DraggingModule\n  ],\n  __init__: [\n    'connectPreview'\n  ],\n  connect: [ 'type', Connect ],\n  connectPreview: [ 'type', ConnectPreview ]\n};\n","import {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove,\n  clear as svgClear\n} from 'tiny-svg';\n\nimport {\n  isObject\n} from 'min-dash';\n\nimport {\n  getElementLineIntersection,\n  getMid\n} from '../../layout/LayoutUtil';\n\n\nvar MARKER_CONNECTION_PREVIEW = 'djs-connection-preview';\n\n/**\n * Draws connection preview. Optionally, this can use layouter and connection docking to draw\n * better looking previews.\n *\n * @param {didi.Injector} injector\n * @param {Canvas} canvas\n * @param {GraphicsFactory} graphicsFactory\n * @param {ElementFactory} elementFactory\n */\nexport default function ConnectionPreview(\n    injector,\n    canvas,\n    graphicsFactory,\n    elementFactory\n) {\n  this._canvas = canvas;\n  this._graphicsFactory = graphicsFactory;\n  this._elementFactory = elementFactory;\n\n  // optional components\n  this._connectionDocking = injector.get('connectionDocking', false);\n  this._layouter = injector.get('layouter', false);\n}\n\nConnectionPreview.$inject = [\n  'injector',\n  'canvas',\n  'graphicsFactory',\n  'elementFactory'\n];\n\n/**\n * Draw connection preview.\n *\n * Provide at least one of <source, connectionStart> and <target, connectionEnd> to create a preview.\n * In the clean up stage, call `connectionPreview#cleanUp` with the context to remove preview.\n *\n * @param {Object} context\n * @param {Object|boolean} canConnect\n * @param {Object} hints\n * @param {djs.model.shape} [hints.source] source element\n * @param {djs.model.shape} [hints.target] target element\n * @param {Point} [hints.connectionStart] connection preview start\n * @param {Point} [hints.connectionEnd] connection preview end\n * @param {Array<Point>} [hints.waypoints] provided waypoints for preview\n * @param {boolean} [hints.noLayout] true if preview should not be laid out\n * @param {boolean} [hints.noCropping] true if preview should not be cropped\n * @param {boolean} [hints.noNoop] true if simple connection should not be drawn\n */\nConnectionPreview.prototype.drawPreview = function(context, canConnect, hints) {\n\n  hints = hints || {};\n\n  var connectionPreviewGfx = context.connectionPreviewGfx,\n      getConnection = context.getConnection,\n      source = hints.source,\n      target = hints.target,\n      waypoints = hints.waypoints,\n      connectionStart = hints.connectionStart,\n      connectionEnd = hints.connectionEnd,\n      noLayout = hints.noLayout,\n      noCropping = hints.noCropping,\n      noNoop = hints.noNoop,\n      connection;\n\n  var self = this;\n\n  if (!connectionPreviewGfx) {\n    connectionPreviewGfx = context.connectionPreviewGfx = this.createConnectionPreviewGfx();\n  }\n\n  svgClear(connectionPreviewGfx);\n\n  if (!getConnection) {\n    getConnection = context.getConnection = cacheReturnValues(function(canConnect, source, target) {\n      return self.getConnection(canConnect, source, target);\n    });\n  }\n\n  if (canConnect) {\n    connection = getConnection(canConnect, source, target);\n  }\n\n  if (!connection) {\n    !noNoop && this.drawNoopPreview(connectionPreviewGfx, hints);\n    return;\n  }\n\n  connection.waypoints = waypoints || [];\n\n  // optional layout\n  if (this._layouter && !noLayout) {\n    connection.waypoints = this._layouter.layoutConnection(connection, {\n      source: source,\n      target: target,\n      connectionStart: connectionStart,\n      connectionEnd: connectionEnd,\n      waypoints: hints.waypoints || connection.waypoints\n    });\n  }\n\n  // fallback if no waypoints were provided nor created with layouter\n  if (!connection.waypoints || !connection.waypoints.length) {\n    connection.waypoints = [\n      source ? getMid(source) : connectionStart,\n      target ? getMid(target) : connectionEnd\n    ];\n  }\n\n  // optional cropping\n  if (this._connectionDocking && (source || target) && !noCropping) {\n    connection.waypoints = this._connectionDocking.getCroppedWaypoints(connection, source, target);\n  }\n\n  this._graphicsFactory.drawConnection(connectionPreviewGfx, connection);\n};\n\n/**\n * Draw simple connection between source and target or provided points.\n *\n * @param {SVGElement} connectionPreviewGfx container for the connection\n * @param {Object} hints\n * @param {djs.model.shape} [hints.source] source element\n * @param {djs.model.shape} [hints.target] target element\n * @param {Point} [hints.connectionStart] required if source is not provided\n * @param {Point} [hints.connectionEnd] required if target is not provided\n */\nConnectionPreview.prototype.drawNoopPreview = function(connectionPreviewGfx, hints) {\n  var source = hints.source,\n      target = hints.target,\n      start = hints.connectionStart || getMid(source),\n      end = hints.connectionEnd || getMid(target);\n\n  var waypoints = this.cropWaypoints(start, end, source, target);\n\n  var connection = this.createNoopConnection(waypoints[0], waypoints[1]);\n\n  svgAppend(connectionPreviewGfx, connection);\n};\n\n/**\n * Return cropped waypoints.\n *\n * @param {Point} start\n * @param {Point} end\n * @param {djs.model.shape} source\n * @param {djs.model.shape} target\n *\n * @returns {Array}\n */\nConnectionPreview.prototype.cropWaypoints = function(start, end, source, target) {\n  var graphicsFactory = this._graphicsFactory,\n      sourcePath = source && graphicsFactory.getShapePath(source),\n      targetPath = target && graphicsFactory.getShapePath(target),\n      connectionPath = graphicsFactory.getConnectionPath({ waypoints: [ start, end ] });\n\n  start = (source && getElementLineIntersection(sourcePath, connectionPath, true)) || start;\n  end = (target && getElementLineIntersection(targetPath, connectionPath, false)) || end;\n\n  return [ start, end ];\n};\n\n/**\n * Remove connection preview container if it exists.\n *\n * @param {Object} [context]\n * @param {SVGElement} [context.connectionPreviewGfx] preview container\n */\nConnectionPreview.prototype.cleanUp = function(context) {\n  if (context && context.connectionPreviewGfx) {\n    svgRemove(context.connectionPreviewGfx);\n  }\n};\n\n/**\n * Get connection that connects source and target.\n *\n * @param {Object|boolean} canConnect\n *\n * @returns {djs.model.connection}\n */\nConnectionPreview.prototype.getConnection = function(canConnect) {\n  var attrs = ensureConnectionAttrs(canConnect);\n\n  return this._elementFactory.createConnection(attrs);\n};\n\n\n/**\n * Add and return preview graphics.\n *\n * @returns {SVGElement}\n */\nConnectionPreview.prototype.createConnectionPreviewGfx = function() {\n  var gfx = svgCreate('g');\n\n  svgAttr(gfx, {\n    pointerEvents: 'none'\n  });\n\n  svgClasses(gfx).add(MARKER_CONNECTION_PREVIEW);\n\n  svgAppend(this._canvas.getDefaultLayer(), gfx);\n\n  return gfx;\n};\n\n/**\n * Create and return simple connection.\n *\n * @param {Point} start\n * @param {Point} end\n *\n * @returns {SVGElement}\n */\nConnectionPreview.prototype.createNoopConnection = function(start, end) {\n  var connection = svgCreate('polyline');\n\n  svgAttr(connection, {\n    'stroke': '#333',\n    'strokeDasharray': [ 1 ],\n    'strokeWidth': 2,\n    'pointer-events': 'none'\n  });\n\n  svgAttr(connection, { 'points': [ start.x, start.y, end.x, end.y ] });\n\n  return connection;\n};\n\n// helpers //////////\n\n/**\n * Returns function that returns cached return values referenced by stringified first argument.\n *\n * @param {Function} fn\n *\n * @return {Function}\n */\nfunction cacheReturnValues(fn) {\n  var returnValues = {};\n\n  /**\n   * Return cached return value referenced by stringified first argument.\n   *\n   * @returns {*}\n   */\n  return function(firstArgument) {\n    var key = JSON.stringify(firstArgument);\n\n    var returnValue = returnValues[key];\n\n    if (!returnValue) {\n      returnValue = returnValues[key] = fn.apply(null, arguments);\n    }\n\n    return returnValue;\n  };\n}\n\n/**\n * Ensure connection attributes is object.\n *\n * @param {Object|boolean} canConnect\n *\n * @returns {Object}\n */\nfunction ensureConnectionAttrs(canConnect) {\n  if (isObject(canConnect)) {\n    return canConnect;\n  } else {\n    return {};\n  }\n}\n","import ConnectionPreview from './ConnectionPreview';\n\nexport default {\n  __init__: [ 'connectionPreview' ],\n  connectionPreview: [ 'type', ConnectionPreview ]\n};\n","import {\n  assign,\n  bind,\n  pick\n} from 'min-dash';\n\nimport {\n  domify,\n  query as domQuery,\n  event as domEvent,\n  remove as domRemove\n} from 'min-dom';\n\nvar min = Math.min,\n    max = Math.max;\n\nfunction preventDefault(e) {\n  e.preventDefault();\n}\n\nfunction stopPropagation(e) {\n  e.stopPropagation();\n}\n\nfunction isTextNode(node) {\n  return node.nodeType === Node.TEXT_NODE;\n}\n\nfunction toArray(nodeList) {\n  return [].slice.call(nodeList);\n}\n\n/**\n * Initializes a container for a content editable div.\n *\n * Structure:\n *\n * container\n *   parent\n *     content\n *     resize-handle\n *\n * @param {object} options\n * @param {DOMElement} options.container The DOM element to append the contentContainer to\n * @param {Function} options.keyHandler Handler for key events\n * @param {Function} options.resizeHandler Handler for resize events\n */\nexport default function TextBox(options) {\n  this.container = options.container;\n\n  this.parent = domify(\n    '<div class=\"djs-direct-editing-parent\">' +\n      '<div class=\"djs-direct-editing-content\" contenteditable=\"true\"></div>' +\n    '</div>'\n  );\n\n  this.content = domQuery('[contenteditable]', this.parent);\n\n  this.keyHandler = options.keyHandler || function() {};\n  this.resizeHandler = options.resizeHandler || function() {};\n\n  this.autoResize = bind(this.autoResize, this);\n  this.handlePaste = bind(this.handlePaste, this);\n}\n\n\n/**\n * Create a text box with the given position, size, style and text content\n *\n * @param {Object} bounds\n * @param {Number} bounds.x absolute x position\n * @param {Number} bounds.y absolute y position\n * @param {Number} [bounds.width] fixed width value\n * @param {Number} [bounds.height] fixed height value\n * @param {Number} [bounds.maxWidth] maximum width value\n * @param {Number} [bounds.maxHeight] maximum height value\n * @param {Number} [bounds.minWidth] minimum width value\n * @param {Number} [bounds.minHeight] minimum height value\n * @param {Object} [style]\n * @param {String} value text content\n *\n * @return {DOMElement} The created content DOM element\n */\nTextBox.prototype.create = function(bounds, style, value, options) {\n  var self = this;\n\n  var parent = this.parent,\n      content = this.content,\n      container = this.container;\n\n  options = this.options = options || {};\n\n  style = this.style = style || {};\n\n  var parentStyle = pick(style, [\n    'width',\n    'height',\n    'maxWidth',\n    'maxHeight',\n    'minWidth',\n    'minHeight',\n    'left',\n    'top',\n    'backgroundColor',\n    'position',\n    'overflow',\n    'border',\n    'wordWrap',\n    'textAlign',\n    'outline',\n    'transform'\n  ]);\n\n  assign(parent.style, {\n    width: bounds.width + 'px',\n    height: bounds.height + 'px',\n    maxWidth: bounds.maxWidth + 'px',\n    maxHeight: bounds.maxHeight + 'px',\n    minWidth: bounds.minWidth + 'px',\n    minHeight: bounds.minHeight + 'px',\n    left: bounds.x + 'px',\n    top: bounds.y + 'px',\n    backgroundColor: '#ffffff',\n    position: 'absolute',\n    overflow: 'visible',\n    border: '1px solid #ccc',\n    boxSizing: 'border-box',\n    wordWrap: 'normal',\n    textAlign: 'center',\n    outline: 'none'\n  }, parentStyle);\n\n  var contentStyle = pick(style, [\n    'fontFamily',\n    'fontSize',\n    'fontWeight',\n    'lineHeight',\n    'padding',\n    'paddingTop',\n    'paddingRight',\n    'paddingBottom',\n    'paddingLeft'\n  ]);\n\n  assign(content.style, {\n    boxSizing: 'border-box',\n    width: '100%',\n    outline: 'none',\n    wordWrap: 'break-word'\n  }, contentStyle);\n\n  if (options.centerVertically) {\n    assign(content.style, {\n      position: 'absolute',\n      top: '50%',\n      transform: 'translate(0, -50%)'\n    }, contentStyle);\n  }\n\n  content.innerText = value;\n\n  domEvent.bind(content, 'keydown', this.keyHandler);\n  domEvent.bind(content, 'mousedown', stopPropagation);\n  domEvent.bind(content, 'paste', self.handlePaste);\n\n  if (options.autoResize) {\n    domEvent.bind(content, 'input', this.autoResize);\n  }\n\n  if (options.resizable) {\n    this.resizable(style);\n  }\n\n  container.appendChild(parent);\n\n  // set selection to end of text\n  this.setSelection(content.lastChild, content.lastChild && content.lastChild.length);\n\n  return parent;\n};\n\n/**\n * Intercept paste events to remove formatting from pasted text.\n */\nTextBox.prototype.handlePaste = function(e) {\n  var options = this.options,\n      style = this.style;\n\n  e.preventDefault();\n\n  var text;\n\n  if (e.clipboardData) {\n\n    // Chrome, Firefox, Safari\n    text = e.clipboardData.getData('text/plain');\n  } else {\n\n    // Internet Explorer\n    text = window.clipboardData.getData('Text');\n  }\n\n  this.insertText(text);\n\n  if (options.autoResize) {\n    var hasResized = this.autoResize(style);\n\n    if (hasResized) {\n      this.resizeHandler(hasResized);\n    }\n  }\n};\n\nTextBox.prototype.insertText = function(text) {\n\n  // insertText command not supported by Internet Explorer\n  var success = document.execCommand('insertText', false, text);\n\n  if (success) {\n    return;\n  }\n\n  this._insertTextIE(text);\n};\n\nTextBox.prototype._insertTextIE = function(text) {\n\n  // Internet Explorer\n  var range = this.getSelection(),\n      startContainer = range.startContainer,\n      endContainer = range.endContainer,\n      startOffset = range.startOffset,\n      endOffset = range.endOffset,\n      commonAncestorContainer = range.commonAncestorContainer;\n\n  var childNodesArray = toArray(commonAncestorContainer.childNodes);\n\n  var container,\n      offset;\n\n  if (isTextNode(commonAncestorContainer)) {\n    var containerTextContent = startContainer.textContent;\n\n    startContainer.textContent =\n      containerTextContent.substring(0, startOffset)\n      + text\n      + containerTextContent.substring(endOffset);\n\n    container = startContainer;\n    offset = startOffset + text.length;\n\n  } else if (startContainer === this.content && endContainer === this.content) {\n    var textNode = document.createTextNode(text);\n\n    this.content.insertBefore(textNode, childNodesArray[startOffset]);\n\n    container = textNode;\n    offset = textNode.textContent.length;\n  } else {\n    var startContainerChildIndex = childNodesArray.indexOf(startContainer),\n        endContainerChildIndex = childNodesArray.indexOf(endContainer);\n\n    childNodesArray.forEach(function(childNode, index) {\n\n      if (index === startContainerChildIndex) {\n        childNode.textContent =\n          startContainer.textContent.substring(0, startOffset) +\n          text +\n          endContainer.textContent.substring(endOffset);\n      } else if (index > startContainerChildIndex && index <= endContainerChildIndex) {\n        domRemove(childNode);\n      }\n    });\n\n    container = startContainer;\n    offset = startOffset + text.length;\n  }\n\n  if (container && offset !== undefined) {\n\n    // is necessary in Internet Explorer\n    setTimeout(function() {\n      self.setSelection(container, offset);\n    });\n  }\n};\n\n/**\n * Automatically resize element vertically to fit its content.\n */\nTextBox.prototype.autoResize = function() {\n  var parent = this.parent,\n      content = this.content;\n\n  var fontSize = parseInt(this.style.fontSize) || 12;\n\n  if (content.scrollHeight > parent.offsetHeight ||\n      content.scrollHeight < parent.offsetHeight - fontSize) {\n    var bounds = parent.getBoundingClientRect();\n\n    var height = content.scrollHeight;\n    parent.style.height = height + 'px';\n\n    this.resizeHandler({\n      width: bounds.width,\n      height: bounds.height,\n      dx: 0,\n      dy: height - bounds.height\n    });\n  }\n};\n\n/**\n * Make an element resizable by adding a resize handle.\n */\nTextBox.prototype.resizable = function() {\n  var self = this;\n\n  var parent = this.parent,\n      resizeHandle = this.resizeHandle;\n\n  var minWidth = parseInt(this.style.minWidth) || 0,\n      minHeight = parseInt(this.style.minHeight) || 0,\n      maxWidth = parseInt(this.style.maxWidth) || Infinity,\n      maxHeight = parseInt(this.style.maxHeight) || Infinity;\n\n  if (!resizeHandle) {\n    resizeHandle = this.resizeHandle = domify(\n      '<div class=\"djs-direct-editing-resize-handle\"></div>'\n    );\n\n    var startX, startY, startWidth, startHeight;\n\n    var onMouseDown = function(e) {\n      preventDefault(e);\n      stopPropagation(e);\n\n      startX = e.clientX;\n      startY = e.clientY;\n\n      var bounds = parent.getBoundingClientRect();\n\n      startWidth = bounds.width;\n      startHeight = bounds.height;\n\n      domEvent.bind(document, 'mousemove', onMouseMove);\n      domEvent.bind(document, 'mouseup', onMouseUp);\n    };\n\n    var onMouseMove = function(e) {\n      preventDefault(e);\n      stopPropagation(e);\n\n      var newWidth = min(max(startWidth + e.clientX - startX, minWidth), maxWidth);\n      var newHeight = min(max(startHeight + e.clientY - startY, minHeight), maxHeight);\n\n      parent.style.width = newWidth + 'px';\n      parent.style.height = newHeight + 'px';\n\n      self.resizeHandler({\n        width: startWidth,\n        height: startHeight,\n        dx: e.clientX - startX,\n        dy: e.clientY - startY\n      });\n    };\n\n    var onMouseUp = function(e) {\n      preventDefault(e);\n      stopPropagation(e);\n\n      domEvent.unbind(document,'mousemove', onMouseMove, false);\n      domEvent.unbind(document, 'mouseup', onMouseUp, false);\n    };\n\n    domEvent.bind(resizeHandle, 'mousedown', onMouseDown);\n  }\n\n  assign(resizeHandle.style, {\n    position: 'absolute',\n    bottom: '0px',\n    right: '0px',\n    cursor: 'nwse-resize',\n    width: '0',\n    height: '0',\n    borderTop: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid transparent',\n    borderRight: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid #ccc',\n    borderBottom: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid #ccc',\n    borderLeft: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid transparent'\n  });\n\n  parent.appendChild(resizeHandle);\n};\n\n\n/**\n * Clear content and style of the textbox, unbind listeners and\n * reset CSS style.\n */\nTextBox.prototype.destroy = function() {\n  var parent = this.parent,\n      content = this.content,\n      resizeHandle = this.resizeHandle;\n\n  // clear content\n  content.innerText = '';\n\n  // clear styles\n  parent.removeAttribute('style');\n  content.removeAttribute('style');\n\n  domEvent.unbind(content, 'keydown', this.keyHandler);\n  domEvent.unbind(content, 'mousedown', stopPropagation);\n  domEvent.unbind(content, 'input', this.autoResize);\n  domEvent.unbind(content, 'paste', this.handlePaste);\n\n  if (resizeHandle) {\n    resizeHandle.removeAttribute('style');\n\n    domRemove(resizeHandle);\n  }\n\n  domRemove(parent);\n};\n\n\nTextBox.prototype.getValue = function() {\n  return this.content.innerText.trim();\n};\n\n\nTextBox.prototype.getSelection = function() {\n  var selection = window.getSelection(),\n      range = selection.getRangeAt(0);\n\n  return range;\n};\n\n\nTextBox.prototype.setSelection = function(container, offset) {\n  var range = document.createRange();\n\n  if (container === null) {\n    range.selectNodeContents(this.content);\n  } else {\n    range.setStart(container, offset);\n    range.setEnd(container, offset);\n  }\n\n  var selection = window.getSelection();\n\n  selection.removeAllRanges();\n  selection.addRange(range);\n};\n","import {\n  bind,\n  find\n} from 'min-dash';\n\nimport TextBox from './TextBox';\n\n\n/**\n * A direct editing component that allows users\n * to edit an elements text directly in the diagram\n *\n * @param {EventBus} eventBus the event bus\n */\nexport default function DirectEditing(eventBus, canvas) {\n\n  this._eventBus = eventBus;\n\n  this._providers = [];\n  this._textbox = new TextBox({\n    container: canvas.getContainer(),\n    keyHandler: bind(this._handleKey, this),\n    resizeHandler: bind(this._handleResize, this)\n  });\n}\n\nDirectEditing.$inject = [ 'eventBus', 'canvas' ];\n\n\n/**\n * Register a direct editing provider\n\n * @param {Object} provider the provider, must expose an #activate(element) method that returns\n *                          an activation context ({ bounds: {x, y, width, height }, text }) if\n *                          direct editing is available for the given element.\n *                          Additionally the provider must expose a #update(element, value) method\n *                          to receive direct editing updates.\n */\nDirectEditing.prototype.registerProvider = function(provider) {\n  this._providers.push(provider);\n};\n\n\n/**\n * Returns true if direct editing is currently active\n *\n * @return {Boolean}\n */\nDirectEditing.prototype.isActive = function() {\n  return !!this._active;\n};\n\n\n/**\n * Cancel direct editing, if it is currently active\n */\nDirectEditing.prototype.cancel = function() {\n  if (!this._active) {\n    return;\n  }\n\n  this._fire('cancel');\n  this.close();\n};\n\n\nDirectEditing.prototype._fire = function(event, context) {\n  this._eventBus.fire('directEditing.' + event, context || { active: this._active });\n};\n\nDirectEditing.prototype.close = function() {\n  this._textbox.destroy();\n\n  this._fire('deactivate');\n\n  this._active = null;\n\n  this.resizable = undefined;\n};\n\n\nDirectEditing.prototype.complete = function() {\n\n  var active = this._active;\n\n  if (!active) {\n    return;\n  }\n\n  var containerBounds,\n      previousBounds = active.context.bounds,\n      newBounds = this.$textbox.getBoundingClientRect(),\n      newText = this.getValue(),\n      previousText = active.context.text;\n\n  if (\n    newText !== previousText ||\n    newBounds.height !== previousBounds.height ||\n    newBounds.width !== previousBounds.width\n  ) {\n    containerBounds = this._textbox.container.getBoundingClientRect();\n\n    active.provider.update(active.element, newText, active.context.text, {\n      x: newBounds.left - containerBounds.left,\n      y: newBounds.top - containerBounds.top,\n      width: newBounds.width,\n      height: newBounds.height\n    });\n  }\n\n  this._fire('complete');\n\n  this.close();\n};\n\n\nDirectEditing.prototype.getValue = function() {\n  return this._textbox.getValue();\n};\n\n\nDirectEditing.prototype._handleKey = function(e) {\n\n  // stop bubble\n  e.stopPropagation();\n\n  var key = e.keyCode || e.charCode;\n\n  // ESC\n  if (key === 27) {\n    e.preventDefault();\n    return this.cancel();\n  }\n\n  // Enter\n  if (key === 13 && !e.shiftKey) {\n    e.preventDefault();\n    return this.complete();\n  }\n};\n\n\nDirectEditing.prototype._handleResize = function(event) {\n  this._fire('resize', event);\n};\n\n\n/**\n * Activate direct editing on the given element\n *\n * @param {Object} ElementDescriptor the descriptor for a shape or connection\n * @return {Boolean} true if the activation was possible\n */\nDirectEditing.prototype.activate = function(element) {\n  if (this.isActive()) {\n    this.cancel();\n  }\n\n  // the direct editing context\n  var context;\n\n  var provider = find(this._providers, function(p) {\n    return (context = p.activate(element)) ? p : null;\n  });\n\n  // check if activation took place\n  if (context) {\n    this.$textbox = this._textbox.create(\n      context.bounds,\n      context.style,\n      context.text,\n      context.options\n    );\n\n    this._active = {\n      element: element,\n      context: context,\n      provider: provider\n    };\n\n    if (context.options && context.options.resizable) {\n      this.resizable = true;\n    }\n\n    this._fire('activate');\n  }\n\n  return !!context;\n};\n","import InteractionEventsModule from 'diagram-js/lib/features/interaction-events';\n\nimport DirectEditing from './lib/DirectEditing';\n\nexport default {\n  __depends__: [\n    InteractionEventsModule\n  ],\n  __init__: [ 'directEditing' ],\n  directEditing: [ 'type', DirectEditing ]\n};","import {\n  assign,\n  isFunction,\n  isArray,\n  forEach,\n  isDefined\n} from 'min-dash';\n\nimport {\n  delegate as domDelegate,\n  event as domEvent,\n  attr as domAttr,\n  query as domQuery,\n  classes as domClasses,\n  domify as domify\n} from 'min-dom';\n\nvar entrySelector = '.entry';\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A context pad that displays element specific, contextual actions next\n * to a diagram element.\n *\n * @param {Object} config\n * @param {Boolean|Object} [config.scale={ min: 1.0, max: 1.5 }]\n * @param {Number} [config.scale.min]\n * @param {Number} [config.scale.max]\n * @param {EventBus} eventBus\n * @param {Overlays} overlays\n */\nexport default function ContextPad(config, eventBus, overlays) {\n\n  this._eventBus = eventBus;\n  this._overlays = overlays;\n\n  var scale = isDefined(config && config.scale) ? config.scale : {\n    min: 1,\n    max: 1.5\n  };\n\n  this._overlaysConfig = {\n    position: {\n      right: -9,\n      top: -6\n    },\n    scale: scale\n  };\n\n  this._current = null;\n\n  this._init();\n}\n\nContextPad.$inject = [\n  'config.contextPad',\n  'eventBus',\n  'overlays'\n];\n\n\n/**\n * Registers events needed for interaction with other components\n */\nContextPad.prototype._init = function() {\n\n  var eventBus = this._eventBus;\n\n  var self = this;\n\n  eventBus.on('selection.changed', function(e) {\n\n    var selection = e.newSelection;\n\n    if (selection.length === 1) {\n      self.open(selection[0]);\n    } else {\n      self.close();\n    }\n  });\n\n  eventBus.on('elements.delete', function(event) {\n    var elements = event.elements;\n\n    forEach(elements, function(e) {\n      if (self.isOpen(e)) {\n        self.close();\n      }\n    });\n  });\n\n  eventBus.on('element.changed', function(event) {\n    var element = event.element,\n        current = self._current;\n\n    // force reopen if element for which we are currently opened changed\n    if (current && current.element === element) {\n      self.open(element, true);\n    }\n  });\n};\n\n\n/**\n * Register a provider with the context pad\n *\n * @param  {Number} [priority=1000]\n * @param  {ContextPadProvider} provider\n *\n * @example\n * const contextPadProvider = {\n  *   getContextPadEntries: function(element) {\n  *     return function(entries) {\n  *       return {\n  *         ...entries,\n  *         'entry-1': {\n  *           label: 'My Entry',\n  *           action: function() { alert(\"I have been clicked!\"); }\n  *         }\n  *       };\n  *     }\n  *   }\n  * };\n  *\n * contextPad.registerProvider(800, contextPadProvider);\n */\nContextPad.prototype.registerProvider = function(priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on('contextPad.getProviders', priority, function(event) {\n    event.providers.push(provider);\n  });\n};\n\n\n/**\n * Returns the context pad entries for a given element\n *\n * @param {djs.element.Base} element\n *\n * @return {Array<ContextPadEntryDescriptor>} list of entries\n */\nContextPad.prototype.getEntries = function(element) {\n  var providers = this._getProviders();\n\n  var entries = {};\n\n  // loop through all providers and their entries.\n  // group entries by id so that overriding an entry is possible\n  forEach(providers, function(provider) {\n    var entriesOrUpdater = provider.getContextPadEntries(element);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function(entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n\n  return entries;\n};\n\n\n/**\n * Trigger an action available on the opened context pad\n *\n * @param  {String} action\n * @param  {Event} event\n * @param  {Boolean} [autoActivate=false]\n */\nContextPad.prototype.trigger = function(action, event, autoActivate) {\n\n  var element = this._current.element,\n      entries = this._current.entries,\n      entry,\n      handler,\n      originalEvent,\n      button = event.delegateTarget || event.target;\n\n  if (!button) {\n    return event.preventDefault();\n  }\n\n  entry = entries[domAttr(button, 'data-action')];\n  handler = entry.action;\n\n  originalEvent = event.originalEvent || event;\n\n  // simple action (via callback function)\n  if (isFunction(handler)) {\n    if (action === 'click') {\n      return handler(originalEvent, element, autoActivate);\n    }\n  } else {\n    if (handler[action]) {\n      return handler[action](originalEvent, element, autoActivate);\n    }\n  }\n\n  // silence other actions\n  event.preventDefault();\n};\n\n\n/**\n * Open the context pad for the given element\n *\n * @param {djs.model.Base} element\n * @param {Boolean} force if true, force reopening the context pad\n */\nContextPad.prototype.open = function(element, force) {\n  if (!force && this.isOpen(element)) {\n    return;\n  }\n\n  this.close();\n  this._updateAndOpen(element);\n};\n\nContextPad.prototype._getProviders = function(id) {\n\n  var event = this._eventBus.createEvent({\n    type: 'contextPad.getProviders',\n    providers: []\n  });\n\n  this._eventBus.fire(event);\n\n  return event.providers;\n};\n\nContextPad.prototype._updateAndOpen = function(element) {\n\n  var entries = this.getEntries(element),\n      pad = this.getPad(element),\n      html = pad.html;\n\n  forEach(entries, function(entry, id) {\n    var grouping = entry.group || 'default',\n        control = domify(entry.html || '<div class=\"entry\" draggable=\"true\"></div>'),\n        container;\n\n    domAttr(control, 'data-action', id);\n\n    container = domQuery('[data-group=' + grouping + ']', html);\n    if (!container) {\n      container = domify('<div class=\"group\" data-group=\"' + grouping + '\"></div>');\n      html.appendChild(container);\n    }\n\n    container.appendChild(control);\n\n    if (entry.className) {\n      addClasses(control, entry.className);\n    }\n\n    if (entry.title) {\n      domAttr(control, 'title', entry.title);\n    }\n\n    if (entry.imageUrl) {\n      control.appendChild(domify('<img src=\"' + entry.imageUrl + '\">'));\n    }\n  });\n\n  domClasses(html).add('open');\n\n  this._current = {\n    element: element,\n    pad: pad,\n    entries: entries\n  };\n\n  this._eventBus.fire('contextPad.open', { current: this._current });\n};\n\n\nContextPad.prototype.getPad = function(element) {\n  if (this.isOpen()) {\n    return this._current.pad;\n  }\n\n  var self = this;\n\n  var overlays = this._overlays;\n\n  var html = domify('<div class=\"djs-context-pad\"></div>');\n\n  var overlaysConfig = assign({\n    html: html\n  }, this._overlaysConfig);\n\n  domDelegate.bind(html, entrySelector, 'click', function(event) {\n    self.trigger('click', event);\n  });\n\n  domDelegate.bind(html, entrySelector, 'dragstart', function(event) {\n    self.trigger('dragstart', event);\n  });\n\n  // stop propagation of mouse events\n  domEvent.bind(html, 'mousedown', function(event) {\n    event.stopPropagation();\n  });\n\n  this._overlayId = overlays.add(element, 'context-pad', overlaysConfig);\n\n  var pad = overlays.get(this._overlayId);\n\n  this._eventBus.fire('contextPad.create', { element: element, pad: pad });\n\n  return pad;\n};\n\n\n/**\n * Close the context pad\n */\nContextPad.prototype.close = function() {\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._overlays.remove(this._overlayId);\n\n  this._overlayId = null;\n\n  this._eventBus.fire('contextPad.close', { current: this._current });\n\n  this._current = null;\n};\n\n/**\n * Check if pad is open. If element is given, will check\n * if pad is opened with given element.\n *\n * @param {Element} element\n * @return {Boolean}\n */\nContextPad.prototype.isOpen = function(element) {\n  return !!this._current && (!element ? true : this._current.element === element);\n};\n\n\n\n\n// helpers //////////////////////\n\nfunction addClasses(element, classNames) {\n\n  var classes = domClasses(element);\n\n  var actualClassNames = isArray(classNames) ? classNames : classNames.split(/\\s+/g);\n  actualClassNames.forEach(function(cls) {\n    classes.add(cls);\n  });\n}","import InteractionEventsModule from '../interaction-events';\nimport OverlaysModule from '../overlays';\n\nimport ContextPad from './ContextPad';\n\n\nexport default {\n  __depends__: [\n    InteractionEventsModule,\n    OverlaysModule\n  ],\n  contextPad: [ 'type', ContextPad ]\n};","import {\r\n  forEach\r\n} from 'min-dash';\r\n\r\nimport {\r\n  append as svgAppend,\r\n  attr as svgAttr,\r\n  classes as svgClasses,\r\n  clone as svgClone,\r\n  create as svgCreate,\r\n  remove as svgRemove\r\n} from 'tiny-svg';\r\n\r\nimport { query as domQuery } from 'min-dom';\r\n\r\nimport { getVisual } from '../../util/GraphicsUtil';\r\n\r\nvar MARKER_TYPES = [\r\n  'marker-start',\r\n  'marker-mid',\r\n  'marker-end'\r\n];\r\n\r\nvar NODES_CAN_HAVE_MARKER = [\r\n  'circle',\r\n  'ellipse',\r\n  'line',\r\n  'path',\r\n  'polygon',\r\n  'polyline',\r\n  'rect'\r\n];\r\n\r\n\r\n/**\r\n * Adds support for previews of moving/resizing elements.\r\n */\r\nexport default function PreviewSupport(elementRegistry, eventBus, canvas, styles) {\r\n  this._elementRegistry = elementRegistry;\r\n  this._canvas = canvas;\r\n  this._styles = styles;\r\n\r\n  this._clonedMarkers = {};\r\n\r\n  var self = this;\r\n\r\n  eventBus.on('drag.cleanup', function() {\r\n    forEach(self._clonedMarkers, function(clonedMarker) {\r\n      svgRemove(clonedMarker);\r\n    });\r\n\r\n    self._clonedMarkers = {};\r\n  });\r\n}\r\n\r\nPreviewSupport.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'canvas',\r\n  'styles'\r\n];\r\n\r\n\r\n/**\r\n * Returns graphics of an element.\r\n *\r\n * @param {djs.model.Base} element\r\n *\r\n * @return {SVGElement}\r\n */\r\nPreviewSupport.prototype.getGfx = function(element) {\r\n  return this._elementRegistry.getGraphics(element);\r\n};\r\n\r\n/**\r\n * Adds a move preview of a given shape to a given svg group.\r\n *\r\n * @param {djs.model.Base} element\r\n * @param {SVGElement} group\r\n * @param {SVGElement} [gfx]\r\n *\r\n * @return {SVGElement} dragger\r\n */\r\nPreviewSupport.prototype.addDragger = function(element, group, gfx) {\r\n  gfx = gfx || this.getGfx(element);\r\n\r\n  var dragger = svgClone(gfx);\r\n  var bbox = gfx.getBoundingClientRect();\r\n\r\n  this._cloneMarkers(getVisual(dragger));\r\n\r\n  svgAttr(dragger, this._styles.cls('djs-dragger', [], {\r\n    x: bbox.top,\r\n    y: bbox.left\r\n  }));\r\n\r\n  svgAppend(group, dragger);\r\n\r\n  return dragger;\r\n};\r\n\r\n/**\r\n * Adds a resize preview of a given shape to a given svg group.\r\n *\r\n * @param {djs.model.Base} element\r\n * @param {SVGElement} group\r\n *\r\n * @return {SVGElement} frame\r\n */\r\nPreviewSupport.prototype.addFrame = function(shape, group) {\r\n\r\n  var frame = svgCreate('rect', {\r\n    class: 'djs-resize-overlay',\r\n    width:  shape.width,\r\n    height: shape.height,\r\n    x: shape.x,\r\n    y: shape.y\r\n  });\r\n\r\n  svgAppend(group, frame);\r\n\r\n  return frame;\r\n};\r\n\r\n/**\r\n * Clone all markers referenced by a node and its child nodes.\r\n *\r\n * @param {SVGElement} gfx\r\n */\r\nPreviewSupport.prototype._cloneMarkers = function(gfx) {\r\n  var self = this;\r\n\r\n  if (gfx.childNodes) {\r\n\r\n    // TODO: use forEach once we drop PhantomJS\r\n    for (var i = 0; i < gfx.childNodes.length; i++) {\r\n\r\n      // recursively clone markers of child nodes\r\n      self._cloneMarkers(gfx.childNodes[ i ]);\r\n    }\r\n  }\r\n\r\n  if (!canHaveMarker(gfx)) {\r\n    return;\r\n  }\r\n\r\n  MARKER_TYPES.forEach(function(markerType) {\r\n    if (svgAttr(gfx, markerType)) {\r\n      var marker = getMarker(gfx, markerType, self._canvas.getContainer());\r\n\r\n      self._cloneMarker(gfx, marker, markerType);\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Clone marker referenced by an element.\r\n *\r\n * @param {SVGElement} gfx\r\n * @param {SVGElement} marker\r\n * @param {string} markerType\r\n */\r\nPreviewSupport.prototype._cloneMarker = function(gfx, marker, markerType) {\r\n  var markerId = marker.id;\r\n\r\n  var clonedMarker = this._clonedMarkers[ markerId ];\r\n\r\n  if (!clonedMarker) {\r\n    clonedMarker = svgClone(marker);\r\n\r\n    var clonedMarkerId = markerId + '-clone';\r\n\r\n    clonedMarker.id = clonedMarkerId;\r\n\r\n    svgClasses(clonedMarker)\r\n      .add('djs-dragger')\r\n      .add('djs-dragger-marker');\r\n\r\n    this._clonedMarkers[ markerId ] = clonedMarker;\r\n\r\n    var defs = domQuery('defs', this._canvas._svg);\r\n\r\n    if (!defs) {\r\n      defs = svgCreate('defs');\r\n\r\n      svgAppend(this._canvas._svg, defs);\r\n    }\r\n\r\n    svgAppend(defs, clonedMarker);\r\n  }\r\n\r\n  var reference = idToReference(this._clonedMarkers[ markerId ].id);\r\n\r\n  svgAttr(gfx, markerType, reference);\r\n};\r\n\r\n// helpers //////////\r\n\r\n/**\r\n * Get marker of given type referenced by node.\r\n *\r\n * @param {Node} node\r\n * @param {string} markerType\r\n * @param {Node} [parentNode]\r\n *\r\n * @param {Node}\r\n */\r\nfunction getMarker(node, markerType, parentNode) {\r\n  var id = referenceToId(svgAttr(node, markerType));\r\n\r\n  return domQuery('marker#' + id, parentNode || document);\r\n}\r\n\r\n/**\r\n * Get ID of fragment within current document from its functional IRI reference.\r\n * References may use single or double quotes.\r\n *\r\n * @param {string} reference\r\n *\r\n * @returns {string}\r\n */\r\nfunction referenceToId(reference) {\r\n  return reference.match(/url\\(['\"]?#([^'\"]*)['\"]?\\)/)[1];\r\n}\r\n\r\n/**\r\n * Get functional IRI reference for given ID of fragment within current document.\r\n *\r\n * @param {string} id\r\n *\r\n * @returns {string}\r\n */\r\nfunction idToReference(id) {\r\n  return 'url(#' + id + ')';\r\n}\r\n\r\n/**\r\n * Check wether node type can have marker attributes.\r\n *\r\n * @param {Node} node\r\n *\r\n * @returns {boolean}\r\n */\r\nfunction canHaveMarker(node) {\r\n  return NODES_CAN_HAVE_MARKER.indexOf(node.nodeName) !== -1;\r\n}","import PreviewSupport from './PreviewSupport';\n\nexport default {\n  __init__: [ 'previewSupport' ],\n  previewSupport: [ 'type', PreviewSupport ]\n};\n","var MARKER_OK = 'drop-ok',\n    MARKER_NOT_OK = 'drop-not-ok',\n    MARKER_ATTACH = 'attach-ok',\n    MARKER_NEW_PARENT = 'new-parent';\n\nimport {\n  assign,\n  filter,\n  find,\n  forEach,\n  isArray,\n  isNumber,\n  map\n} from 'min-dash';\n\nimport { getBBox } from '../../util/Elements';\n\nvar PREFIX = 'create';\n\nvar HIGH_PRIORITY = 2000;\n\n\n/**\n * Create new elements through drag and drop.\n *\n * @param {Canvas} canvas\n * @param {Dragging} dragging\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {Rules} rules\n */\nexport default function Create(\n    canvas,\n    dragging,\n    eventBus,\n    modeling,\n    rules\n) {\n\n  // rules //////////\n\n  /**\n   * Check wether elements can be created.\n   *\n   * @param {Array<djs.model.Base>} elements\n   * @param {djs.model.Base} target\n   * @param {Point} position\n   * @param {djs.model.Base} [source]\n   *\n   * @returns {boolean|null|Object}\n   */\n  function canCreate(elements, target, position, source) {\n    if (!target) {\n      return false;\n    }\n\n    // ignore child elements and external labels\n    elements = filter(elements, function(element) {\n      var labelTarget = element.labelTarget;\n\n      return !element.parent && !(isLabel(element) && elements.indexOf(labelTarget) !== -1);\n    });\n\n    var shape = find(elements, function(element) {\n      return !isConnection(element);\n    });\n\n    var attach = false,\n        connect = false,\n        create = false;\n\n    // (1) attaching single shapes\n    if (isSingleShape(elements)) {\n      attach = rules.allowed('shape.attach', {\n        position: position,\n        shape: shape,\n        target: target\n      });\n    }\n\n    if (!attach) {\n\n      // (2) creating elements\n      if (isSingleShape(elements)) {\n        create = rules.allowed('shape.create', {\n          position: position,\n          shape: shape,\n          source: source,\n          target: target\n        });\n      } else {\n        create = rules.allowed('elements.create', {\n          elements: elements,\n          position: position,\n          target: target\n        });\n      }\n\n    }\n\n    // (3) appending single shapes\n    if (create || attach) {\n\n      if (shape && source) {\n        connect = rules.allowed('connection.create', {\n          source: source,\n          target: shape,\n          hints: {\n            targetParent: target,\n            targetAttach: attach\n          }\n        });\n      }\n\n      return {\n        attach: attach,\n        connect: connect\n      };\n    }\n\n    // ignore wether or not elements can be created\n    if (create === null || attach === null) {\n      return null;\n    }\n\n    return false;\n  }\n\n  function setMarker(element, marker) {\n    [ MARKER_ATTACH, MARKER_OK, MARKER_NOT_OK, MARKER_NEW_PARENT ].forEach(function(m) {\n\n      if (m === marker) {\n        canvas.addMarker(element, m);\n      } else {\n        canvas.removeMarker(element, m);\n      }\n    });\n  }\n\n  // event handling //////////\n\n  eventBus.on([ 'create.move', 'create.hover' ], function(event) {\n    var context = event.context,\n        elements = context.elements,\n        hover = event.hover,\n        source = context.source;\n\n    if (!hover) {\n      context.canExecute = false;\n      context.target = null;\n\n      return;\n    }\n\n    ensureConstraints(event);\n\n    var position = {\n      x: event.x,\n      y: event.y\n    };\n\n    var canExecute = context.canExecute = hover && canCreate(elements, hover, position, source);\n\n    if (hover && canExecute !== null) {\n      context.target = hover;\n\n      if (canExecute && canExecute.attach) {\n        setMarker(hover, MARKER_ATTACH);\n      } else {\n        setMarker(hover, canExecute ? MARKER_NEW_PARENT : MARKER_NOT_OK);\n      }\n    }\n  });\n\n  eventBus.on([ 'create.end', 'create.out', 'create.cleanup' ], function(event) {\n    var hover = event.hover;\n\n    if (hover) {\n      setMarker(hover, null);\n    }\n  });\n\n  eventBus.on('create.end', function(event) {\n    var context = event.context,\n        source = context.source,\n        shape = context.shape,\n        elements = context.elements,\n        target = context.target,\n        hints = context.hints,\n        canExecute = context.canExecute,\n        attach = canExecute && canExecute.attach,\n        connect = canExecute && canExecute.connect;\n\n    if (canExecute === false || !target) {\n      return false;\n    }\n\n    ensureConstraints(event);\n\n    var position = {\n      x: event.x,\n      y: event.y\n    };\n\n    if (connect) {\n      shape = modeling.appendShape(source, shape, position, target, {\n        attach: attach,\n        connection: connect === true ? {} : connect\n      });\n    } else {\n      elements = modeling.createElements(elements, position, target, assign({}, hints, {\n        attach: attach\n      }));\n\n      // update shape\n      shape = find(elements, function(element) {\n        return !isConnection(element);\n      });\n    }\n\n    // update elements and shape\n    assign(context, {\n      elements: elements,\n      shape: shape\n    });\n\n    assign(event, {\n      elements: elements,\n      shape: shape\n    });\n  });\n\n  function cancel() {\n    var context = dragging.context();\n\n    if (context && context.prefix === PREFIX) {\n      dragging.cancel();\n    }\n  }\n\n  // cancel on <elements.changed> that is not result of <drag.end>\n  eventBus.on('create.init', function() {\n    eventBus.on('elements.changed', cancel);\n\n    eventBus.once([ 'create.cancel', 'create.end' ], HIGH_PRIORITY, function() {\n      eventBus.off('elements.changed', cancel);\n    });\n  });\n\n  // API //////////\n\n  this.start = function(event, elements, context) {\n    if (!isArray(elements)) {\n      elements = [ elements ];\n    }\n\n    var shape = find(elements, function(element) {\n      return !isConnection(element);\n    });\n\n    if (!shape) {\n\n      // at least one shape is required\n      return;\n    }\n\n    context = assign({\n      elements: elements,\n      hints: {},\n      shape: shape\n    }, context || {});\n\n    // make sure each element has x and y\n    forEach(elements, function(element) {\n      if (!isNumber(element.x)) {\n        element.x = 0;\n      }\n\n      if (!isNumber(element.y)) {\n        element.y = 0;\n      }\n    });\n\n    var bbox = getBBox(elements);\n\n    // center elements around cursor\n    forEach(elements, function(element) {\n      if (isConnection(element)) {\n        element.waypoints = map(element.waypoints, function(waypoint) {\n          return {\n            x: waypoint.x - bbox.x - bbox.width / 2,\n            y: waypoint.y - bbox.y - bbox.height / 2\n          };\n        });\n      }\n\n      assign(element, {\n        x: element.x - bbox.x - bbox.width / 2,\n        y: element.y - bbox.y - bbox.height / 2\n      });\n    });\n\n    dragging.init(event, PREFIX, {\n      cursor: 'grabbing',\n      autoActivate: true,\n      data: {\n        shape: shape,\n        elements: elements,\n        context: context\n      }\n    });\n  };\n}\n\nCreate.$inject = [\n  'canvas',\n  'dragging',\n  'eventBus',\n  'modeling',\n  'rules'\n];\n\n// helpers //////////\n\nfunction ensureConstraints(event) {\n  var context = event.context,\n      createConstraints = context.createConstraints;\n\n  if (!createConstraints) {\n    return;\n  }\n\n  if (createConstraints.left) {\n    event.x = Math.max(event.x, createConstraints.left);\n  }\n\n  if (createConstraints.right) {\n    event.x = Math.min(event.x, createConstraints.right);\n  }\n\n  if (createConstraints.top) {\n    event.y = Math.max(event.y, createConstraints.top);\n  }\n\n  if (createConstraints.bottom) {\n    event.y = Math.min(event.y, createConstraints.bottom);\n  }\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction isSingleShape(elements) {\n  return elements && elements.length === 1 && !isConnection(elements[0]);\n}\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}\n","import {\r\n  translate\r\n} from '../../util/SvgTransformUtil';\r\n\r\nimport { getVisual } from '../../util/GraphicsUtil';\r\n\r\nimport {\r\n  append as svgAppend,\r\n  attr as svgAttr,\r\n  create as svgCreate,\r\n  remove as svgRemove\r\n} from 'tiny-svg';\r\n\r\nvar LOW_PRIORITY = 750;\r\n\r\n\r\nexport default function CreatePreview(\r\n    canvas,\r\n    eventBus,\r\n    graphicsFactory,\r\n    previewSupport,\r\n    styles\r\n) {\r\n  function createDragGroup(elements) {\r\n    var dragGroup = svgCreate('g');\r\n\r\n    svgAttr(dragGroup, styles.cls('djs-drag-group', [ 'no-events' ]));\r\n\r\n    var childrenGfx = svgCreate('g');\r\n\r\n    elements.forEach(function(element) {\r\n\r\n      // create graphics\r\n      var gfx;\r\n\r\n      if (element.hidden) {\r\n        return;\r\n      }\r\n\r\n      if (element.waypoints) {\r\n        gfx = graphicsFactory._createContainer('connection', childrenGfx);\r\n\r\n        graphicsFactory.drawConnection(getVisual(gfx), element);\r\n      } else {\r\n        gfx = graphicsFactory._createContainer('shape', childrenGfx);\r\n\r\n        graphicsFactory.drawShape(getVisual(gfx), element);\r\n\r\n        translate(gfx, element.x, element.y);\r\n      }\r\n\r\n      // add preview\r\n      previewSupport.addDragger(element, dragGroup, gfx);\r\n    });\r\n\r\n    return dragGroup;\r\n  }\r\n\r\n  eventBus.on('create.move', LOW_PRIORITY, function(event) {\r\n\r\n    var hover = event.hover,\r\n        context = event.context,\r\n        elements = context.elements,\r\n        dragGroup = context.dragGroup;\r\n\r\n    // lazily create previews\r\n    if (!dragGroup) {\r\n      dragGroup = context.dragGroup = createDragGroup(elements);\r\n    }\r\n\r\n    var defaultLayer;\r\n\r\n    if (hover) {\r\n      if (!dragGroup.parentNode) {\r\n        defaultLayer = canvas.getDefaultLayer();\r\n\r\n        svgAppend(defaultLayer, dragGroup);\r\n      }\r\n\r\n      translate(dragGroup, event.x, event.y);\r\n    } else {\r\n      svgRemove(dragGroup);\r\n    }\r\n  });\r\n\r\n  eventBus.on('create.cleanup', function(event) {\r\n    var context = event.context,\r\n        dragGroup = context.dragGroup;\r\n\r\n    if (dragGroup) {\r\n      svgRemove(dragGroup);\r\n    }\r\n  });\r\n}\r\n\r\nCreatePreview.$inject = [\r\n  'canvas',\r\n  'eventBus',\r\n  'graphicsFactory',\r\n  'previewSupport',\r\n  'styles'\r\n];\r\n","import DraggingModule from '../dragging';\nimport PreviewSupportModule from '../preview-support';\nimport RulesModule from '../rules';\nimport SelectionModule from '../selection';\n\nimport Create from './Create';\nimport CreatePreview from './CreatePreview';\n\n\nexport default {\n  __depends__: [\n    DraggingModule,\n    PreviewSupportModule,\n    RulesModule,\n    SelectionModule\n  ],\n  __init__: [\n    'create',\n    'createPreview'\n  ],\n  create: [ 'type', Create ],\n  createPreview: [ 'type', CreatePreview ]\n};\n","import {\n  assign,\n  forEach,\n  isFunction,\n  isDefined,\n  omit,\n  size\n} from 'min-dash';\n\nimport {\n  delegate as domDelegate,\n  domify as domify,\n  classes as domClasses,\n  attr as domAttr,\n  remove as domRemove\n} from 'min-dom';\n\nvar DATA_REF = 'data-id';\n\nvar CLOSE_EVENTS = [\n  'contextPad.close',\n  'canvas.viewbox.changing',\n  'commandStack.changed'\n];\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A popup menu that can be used to display a list of actions anywhere in the canvas.\n *\n * @param {Object} config\n * @param {Boolean|Object} [config.scale={ min: 1.0, max: 1.5 }]\n * @param {Number} [config.scale.min]\n * @param {Number} [config.scale.max]\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n *\n * @class\n * @constructor\n */\nexport default function PopupMenu(config, eventBus, canvas) {\n\n  var scale = isDefined(config && config.scale) ? config.scale : {\n    min: 1,\n    max: 1.5\n  };\n\n  this._config = {\n    scale: scale\n  };\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n  this._providers = {};\n  this._current = {};\n}\n\nPopupMenu.$inject = [\n  'config.popupMenu',\n  'eventBus',\n  'canvas'\n];\n\n/**\n * Registers a popup menu provider\n *\n * @param  {String} id\n * @param {Number} [priority=1000]\n * @param  {Object} provider\n *\n * @example\n * const popupMenuProvider = {\n *   getPopupMenuEntries: function(element) {\n *     return {\n *       'entry-1': {\n *         label: 'My Entry',\n *         action: function() { alert(\"I have been clicked!\"); }\n *       }\n *     }\n *   }\n * };\n *\n * popupMenu.registerProvider('myMenuID', popupMenuProvider);\n */\nPopupMenu.prototype.registerProvider = function(id, priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on('popupMenu.getProviders.' + id, priority, function(event) {\n    event.providers.push(provider);\n  });\n};\n\n/**\n * Determine if the popup menu has entries.\n *\n * @return {Boolean} true if empty\n */\nPopupMenu.prototype.isEmpty = function(element, providerId) {\n  if (!element) {\n    throw new Error('element parameter is missing');\n  }\n\n  if (!providerId) {\n    throw new Error('providerId parameter is missing');\n  }\n\n  var providers = this._getProviders(providerId);\n\n  if (!providers) {\n    return true;\n  }\n\n  var entries = this._getEntries(element, providers),\n      headerEntries = this._getHeaderEntries(element, providers);\n\n  var hasEntries = size(entries) > 0,\n      hasHeaderEntries = headerEntries && size(headerEntries) > 0;\n\n  return !hasEntries && !hasHeaderEntries;\n};\n\n\n/**\n * Create entries and open popup menu at given position\n *\n * @param  {Object} element\n * @param  {String} id provider id\n * @param  {Object} position\n *\n * @return {Object} popup menu instance\n */\nPopupMenu.prototype.open = function(element, id, position) {\n\n  var providers = this._getProviders(id);\n\n  if (!element) {\n    throw new Error('Element is missing');\n  }\n\n  if (!providers || !providers.length) {\n    throw new Error('No registered providers for: ' + id);\n  }\n\n  if (!position) {\n    throw new Error('the position argument is missing');\n  }\n\n  if (this.isOpen()) {\n    this.close();\n  }\n\n  this._emit('open');\n\n  var current = this._current = {\n    className: id,\n    element: element,\n    position: position\n  };\n\n  var entries = this._getEntries(element, providers),\n      headerEntries = this._getHeaderEntries(element, providers);\n\n  current.entries = assign({}, entries, headerEntries);\n\n  current.container = this._createContainer();\n\n  if (size(headerEntries)) {\n    current.container.appendChild(\n      this._createEntries(headerEntries, 'djs-popup-header')\n    );\n  }\n\n  if (size(entries)) {\n    current.container.appendChild(\n      this._createEntries(entries, 'djs-popup-body')\n    );\n  }\n\n  var canvas = this._canvas,\n      parent = canvas.getContainer();\n\n  this._attachContainer(current.container, parent, position.cursor);\n  this._bindAutoClose();\n};\n\n\n/**\n * Removes the popup menu and unbinds the event handlers.\n */\nPopupMenu.prototype.close = function() {\n\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._emit('close');\n\n  this._unbindAutoClose();\n  domRemove(this._current.container);\n  this._current.container = null;\n};\n\n\n/**\n * Determine if an open popup menu exist.\n *\n * @return {Boolean} true if open\n */\nPopupMenu.prototype.isOpen = function() {\n  return !!this._current.container;\n};\n\n\n/**\n * Trigger an action associated with an entry.\n *\n * @param {Object} event\n *\n * @return the result of the action callback, if any\n */\nPopupMenu.prototype.trigger = function(event) {\n\n  // silence other actions\n  event.preventDefault();\n\n  var element = event.delegateTarget || event.target,\n      entryId = domAttr(element, DATA_REF);\n\n  var entry = this._getEntry(entryId);\n\n  if (entry.action) {\n    return entry.action.call(null, event, entry);\n  }\n};\n\nPopupMenu.prototype._getProviders = function(id) {\n\n  var event = this._eventBus.createEvent({\n    type: 'popupMenu.getProviders.' + id,\n    providers: []\n  });\n\n  this._eventBus.fire(event);\n\n  return event.providers;\n};\n\nPopupMenu.prototype._getEntries = function(element, providers) {\n\n  var entries = {};\n\n  forEach(providers, function(provider) {\n\n    // handle legacy method\n    if (!provider.getPopupMenuEntries) {\n      forEach(provider.getEntries(element), function(entry) {\n        var id = entry.id;\n\n        if (!id) {\n          throw new Error('every entry must have the id property set');\n        }\n\n        entries[id] = omit(entry, [ 'id' ]);\n      });\n\n      return;\n    }\n\n    var entriesOrUpdater = provider.getPopupMenuEntries(element);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function(entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n\n  return entries;\n};\n\nPopupMenu.prototype._getHeaderEntries = function(element, providers) {\n\n  var entries = {};\n\n  forEach(providers, function(provider) {\n\n    // handle legacy method\n    if (!provider.getPopupMenuHeaderEntries) {\n      if (!provider.getHeaderEntries) {\n        return;\n      }\n\n      forEach(provider.getHeaderEntries(element), function(entry) {\n        var id = entry.id;\n\n        if (!id) {\n          throw new Error('every entry must have the id property set');\n        }\n\n        entries[id] = omit(entry, [ 'id' ]);\n      });\n\n      return;\n    }\n\n    var entriesOrUpdater = provider.getPopupMenuHeaderEntries(element);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function(entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n\n  return entries;\n\n\n};\n\n/**\n * Gets an entry instance (either entry or headerEntry) by id.\n *\n * @param  {String} entryId\n *\n * @return {Object} entry instance\n */\nPopupMenu.prototype._getEntry = function(entryId) {\n\n  var entry = this._current.entries[entryId];\n\n  if (!entry) {\n    throw new Error('entry not found');\n  }\n\n  return entry;\n};\n\nPopupMenu.prototype._emit = function(eventName) {\n  this._eventBus.fire('popupMenu.' + eventName);\n};\n\n/**\n * Creates the popup menu container.\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createContainer = function() {\n  var container = domify('<div class=\"djs-popup\">'),\n      position = this._current.position,\n      className = this._current.className;\n\n  assign(container.style, {\n    position: 'absolute',\n    left: position.x + 'px',\n    top: position.y + 'px',\n    visibility: 'hidden'\n  });\n\n  domClasses(container).add(className);\n\n  return container;\n};\n\n\n/**\n * Attaches the container to the DOM.\n *\n * @param {Object} container\n * @param {Object} parent\n */\nPopupMenu.prototype._attachContainer = function(container, parent, cursor) {\n  var self = this;\n\n  // Event handler\n  domDelegate.bind(container, '.entry' ,'click', function(event) {\n    self.trigger(event);\n  });\n\n  this._updateScale(container);\n\n  // Attach to DOM\n  parent.appendChild(container);\n\n  if (cursor) {\n    this._assureIsInbounds(container, cursor);\n  }\n};\n\n\n/**\n * Updates popup style.transform with respect to the config and zoom level.\n *\n * @method _updateScale\n *\n * @param {Object} container\n */\nPopupMenu.prototype._updateScale = function(container) {\n  var zoom = this._canvas.zoom();\n\n  var scaleConfig = this._config.scale,\n      minScale,\n      maxScale,\n      scale = zoom;\n\n  if (scaleConfig !== true) {\n\n    if (scaleConfig === false) {\n      minScale = 1;\n      maxScale = 1;\n    } else {\n      minScale = scaleConfig.min;\n      maxScale = scaleConfig.max;\n    }\n\n    if (isDefined(minScale) && zoom < minScale) {\n      scale = minScale;\n    }\n\n    if (isDefined(maxScale) && zoom > maxScale) {\n      scale = maxScale;\n    }\n\n  }\n\n  setTransform(container, 'scale(' + scale + ')');\n};\n\n\n/**\n * Make sure that the menu is always fully shown\n *\n * @method function\n *\n * @param  {Object} container\n * @param  {Position} cursor {x, y}\n */\nPopupMenu.prototype._assureIsInbounds = function(container, cursor) {\n  var canvas = this._canvas,\n      clientRect = canvas._container.getBoundingClientRect();\n\n  var containerX = container.offsetLeft,\n      containerY = container.offsetTop,\n      containerWidth = container.scrollWidth,\n      containerHeight = container.scrollHeight,\n      overAxis = {},\n      left, top;\n\n  var cursorPosition = {\n    x: cursor.x - clientRect.left,\n    y: cursor.y - clientRect.top\n  };\n\n  if (containerX + containerWidth > clientRect.width) {\n    overAxis.x = true;\n  }\n\n  if (containerY + containerHeight > clientRect.height) {\n    overAxis.y = true;\n  }\n\n  if (overAxis.x && overAxis.y) {\n    left = cursorPosition.x - containerWidth + 'px';\n    top = cursorPosition.y - containerHeight + 'px';\n  } else if (overAxis.x) {\n    left = cursorPosition.x - containerWidth + 'px';\n    top = cursorPosition.y + 'px';\n  } else if (overAxis.y && cursorPosition.y < containerHeight) {\n    left = cursorPosition.x + 'px';\n    top = 10 + 'px';\n  } else if (overAxis.y) {\n    left = cursorPosition.x + 'px';\n    top = cursorPosition.y - containerHeight + 'px';\n  }\n\n  assign(container.style, { left: left, top: top }, { visibility: 'visible', 'z-index': 1000 });\n};\n\n\n/**\n * Creates a list of entries and returns them as a DOM container.\n *\n * @param {Array<Object>} entries an array of entry objects\n * @param {String} className the class name of the entry container\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createEntries = function(entries, className) {\n\n  var entriesContainer = domify('<div>'),\n      self = this;\n\n  domClasses(entriesContainer).add(className);\n\n  forEach(entries, function(entry, id) {\n    var entryContainer = self._createEntry(entry, id);\n    entriesContainer.appendChild(entryContainer);\n  });\n\n  return entriesContainer;\n};\n\n\n/**\n * Creates a single entry and returns it as a DOM container.\n *\n * @param  {Object} entry\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createEntry = function(entry, id) {\n\n  var entryContainer = domify('<div>'),\n      entryClasses = domClasses(entryContainer);\n\n  entryClasses.add('entry');\n\n  if (entry.className) {\n    entry.className.split(' ').forEach(function(className) {\n      entryClasses.add(className);\n    });\n  }\n\n  domAttr(entryContainer, DATA_REF, id);\n\n  if (entry.label) {\n    var label = domify('<span>');\n    label.textContent = entry.label;\n    entryContainer.appendChild(label);\n  }\n\n  if (entry.imageUrl) {\n    entryContainer.appendChild(domify('<img src=\"' + entry.imageUrl + '\" />'));\n  }\n\n  if (entry.active === true) {\n    entryClasses.add('active');\n  }\n\n  if (entry.disabled === true) {\n    entryClasses.add('disabled');\n  }\n\n  if (entry.title) {\n    entryContainer.title = entry.title;\n  }\n\n  return entryContainer;\n};\n\n\n/**\n * Set up listener to close popup automatically on certain events.\n */\nPopupMenu.prototype._bindAutoClose = function() {\n  this._eventBus.once(CLOSE_EVENTS, this.close, this);\n};\n\n\n/**\n * Remove the auto-closing listener.\n */\nPopupMenu.prototype._unbindAutoClose = function() {\n  this._eventBus.off(CLOSE_EVENTS, this.close, this);\n};\n\n\n\n// helpers /////////////////////////////\n\nfunction setTransform(element, transform) {\n  element.style['transform-origin'] = 'top left';\n\n  [ '', '-ms-', '-webkit-' ].forEach(function(prefix) {\n    element.style[prefix + 'transform'] = transform;\n  });\n}","import PopupMenu from './PopupMenu';\n\nexport default {\n  __init__: [ 'popupMenu' ],\n  popupMenu: [ 'type', PopupMenu ]\n};\n","/**\n * A clip board stub\n */\nexport default function Clipboard() {}\n\n\nClipboard.prototype.get = function() {\n  return this._data;\n};\n\nClipboard.prototype.set = function(data) {\n  this._data = data;\n};\n\nClipboard.prototype.clear = function() {\n  var data = this._data;\n\n  delete this._data;\n\n  return data;\n};\n\nClipboard.prototype.isEmpty = function() {\n  return !this._data;\n};","import Clipboard from './Clipboard';\n\nexport default {\n  clipboard: [ 'type', Clipboard ]\n};\n","export default function Mouse(eventBus) {\r\n  var self = this;\r\n\r\n  this._lastMoveEvent = null;\r\n\r\n  function setLastMoveEvent(mousemoveEvent) {\r\n    self._lastMoveEvent = mousemoveEvent;\r\n  }\r\n\r\n  eventBus.on('canvas.init', function(context) {\r\n    var svg = self._svg = context.svg;\r\n\r\n    svg.addEventListener('mousemove', setLastMoveEvent);\r\n  });\r\n\r\n  eventBus.on('canvas.destroy', function() {\r\n    self._lastMouseEvent = null;\r\n\r\n    self._svg.removeEventListener('mousemove', setLastMoveEvent);\r\n  });\r\n}\r\n\r\nMouse.$inject = [ 'eventBus' ];\r\n\r\nMouse.prototype.getLastMoveEvent = function() {\r\n  return this._lastMoveEvent || createMoveEvent(0, 0);\r\n};\r\n\r\n// helpers //////////\r\n\r\nexport function createMoveEvent(x, y) {\r\n  var event = document.createEvent('MouseEvent');\r\n\r\n  var screenX = x,\r\n      screenY = y,\r\n      clientX = x,\r\n      clientY = y;\r\n\r\n  if (event.initMouseEvent) {\r\n    event.initMouseEvent(\r\n      'mousemove',\r\n      true,\r\n      true,\r\n      window,\r\n      0,\r\n      screenX,\r\n      screenY,\r\n      clientX,\r\n      clientY,\r\n      false,\r\n      false,\r\n      false,\r\n      false,\r\n      0,\r\n      null\r\n    );\r\n  }\r\n\r\n  return event;\r\n}","import Mouse from './Mouse';\n\nexport default {\n  __init__: [ 'mouse' ],\n  mouse: [ 'type', Mouse ]\n};\n","import {\n  assign,\n  find,\n  forEach,\n  isArray,\n  isNumber,\n  map,\n  matchPattern,\n  omit,\n  sortBy\n} from 'min-dash';\n\nimport {\n  getBBox,\n  getParents\n} from '../../util/Elements';\n\nimport { eachElement } from '../../util/Elements';\n\n/**\n * @typedef {Function} <copyPaste.canCopyElements> listener\n *\n * @param {Object} context\n * @param {Array<djs.model.Base>} context.elements\n *\n * @returns {Array<djs.model.Base>|boolean} - Return elements to be copied or false to disallow\n * copying.\n */\n\n/**\n * @typedef {Function} <copyPaste.copyElement> listener\n *\n * @param {Object} context\n * @param {Object} context.descriptor\n * @param {djs.model.Base} context.element\n * @param {Array<djs.model.Base>} context.elements\n */\n\n/**\n * @typedef {Function} <copyPaste.elementsCopied> listener\n *\n * @param {Object} context\n * @param {Object} context.elements\n * @param {Object} context.tree\n */\n\n/**\n * @typedef {Function} <copyPaste.pasteElement> listener\n *\n * @param {Object} context\n * @param {Object} context.cache - Already created elements.\n * @param {Object} context.descriptor\n */\n\n/**\n * @typedef {Function} <copyPaste.pasteElements> listener\n *\n * @param {Object} context\n * @param {Object} context.hints - Add hints before pasting.\n */\n\n/**\n * Copy and paste elements.\n *\n * @param {Canvas} canvas\n * @param {Create} create\n * @param {Clipboard} clipboard\n * @param {ElementFactory} elementFactory\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {Mouse} mouse\n * @param {Rules} rules\n */\nexport default function CopyPaste(\n    canvas,\n    create,\n    clipboard,\n    elementFactory,\n    eventBus,\n    modeling,\n    mouse,\n    rules\n) {\n\n  this._canvas = canvas;\n  this._create = create;\n  this._clipboard = clipboard;\n  this._elementFactory = elementFactory;\n  this._eventBus = eventBus;\n  this._modeling = modeling;\n  this._mouse = mouse;\n  this._rules = rules;\n\n  eventBus.on('copyPaste.copyElement', function(context) {\n    var descriptor = context.descriptor,\n        element = context.element,\n        elements = context.elements;\n\n    // default priority (priority = 1)\n    descriptor.priority = 1;\n\n    descriptor.id = element.id;\n\n    var parentCopied = find(elements, function(e) {\n      return e === element.parent;\n    });\n\n    // do NOT reference parent if parent wasn't copied\n    if (parentCopied) {\n      descriptor.parent = element.parent.id;\n    }\n\n    // attachers (priority = 2)\n    if (isAttacher(element)) {\n      descriptor.priority = 2;\n\n      descriptor.host = element.host.id;\n    }\n\n    // connections (priority = 3)\n    if (isConnection(element)) {\n      descriptor.priority = 3;\n\n      descriptor.source = element.source.id;\n      descriptor.target = element.target.id;\n\n      descriptor.waypoints = copyWaypoints(element);\n    }\n\n    // labels (priority = 4)\n    if (isLabel(element)) {\n      descriptor.priority = 4;\n\n      descriptor.labelTarget = element.labelTarget.id;\n    }\n\n    forEach([ 'x', 'y', 'width', 'height' ], function(property) {\n      if (isNumber(element[ property ])) {\n        descriptor[ property ] = element[ property ];\n      }\n    });\n\n    descriptor.hidden = element.hidden;\n    descriptor.collapsed = element.collapsed;\n\n  });\n\n  eventBus.on('copyPaste.pasteElements', function(context) {\n    var hints = context.hints;\n\n    assign(hints, {\n      createElementsBehavior: false\n    });\n  });\n}\n\nCopyPaste.$inject = [\n  'canvas',\n  'create',\n  'clipboard',\n  'elementFactory',\n  'eventBus',\n  'modeling',\n  'mouse',\n  'rules'\n];\n\n\n/**\n * Copy elements.\n *\n * @param {Array<djs.model.Base>} elements\n *\n * @returns {Object}\n */\nCopyPaste.prototype.copy = function(elements) {\n  var allowed,\n      tree;\n\n  if (!isArray(elements)) {\n    elements = elements ? [ elements ] : [];\n  }\n\n  allowed = this._eventBus.fire('copyPaste.canCopyElements', {\n    elements: elements\n  });\n\n  if (allowed === false) {\n    tree = {};\n  } else {\n    tree = this.createTree(isArray(allowed) ? allowed : elements);\n  }\n\n  // we set an empty tree, selection of elements\n  // to copy was empty.\n  this._clipboard.set(tree);\n\n  this._eventBus.fire('copyPaste.elementsCopied', {\n    elements: elements,\n    tree: tree\n  });\n\n  return tree;\n};\n\n/**\n * Paste elements.\n *\n * @param {Object} [context]\n * @param {djs.model.base} [context.element] - Parent.\n * @param {Point} [context.point] - Position.\n * @param {Object} [context.hints] - Hints.\n */\nCopyPaste.prototype.paste = function(context) {\n  var tree = this._clipboard.get();\n\n  if (this._clipboard.isEmpty()) {\n    return;\n  }\n\n  var hints = context && context.hints || {};\n\n  this._eventBus.fire('copyPaste.pasteElements', {\n    hints: hints\n  });\n\n  var elements = this._createElements(tree);\n\n  // paste directly\n  if (context && context.element && context.point) {\n    return this._paste(elements, context.element, context.point, hints);\n  }\n\n  this._create.start(this._mouse.getLastMoveEvent(), elements, {\n    hints: hints || {}\n  });\n};\n\n/**\n * Paste elements directly.\n *\n * @param {Array<djs.model.Base>} elements\n * @param {djs.model.base} target\n * @param {Point} position\n * @param {Object} [hints]\n */\nCopyPaste.prototype._paste = function(elements, target, position, hints) {\n\n  // make sure each element has x and y\n  forEach(elements, function(element) {\n    if (!isNumber(element.x)) {\n      element.x = 0;\n    }\n\n    if (!isNumber(element.y)) {\n      element.y = 0;\n    }\n  });\n\n  var bbox = getBBox(elements);\n\n  // center elements around cursor\n  forEach(elements, function(element) {\n    if (isConnection(element)) {\n      element.waypoints = map(element.waypoints, function(waypoint) {\n        return {\n          x: waypoint.x - bbox.x - bbox.width / 2,\n          y: waypoint.y - bbox.y - bbox.height / 2\n        };\n      });\n    }\n\n    assign(element, {\n      x: element.x - bbox.x - bbox.width / 2,\n      y: element.y - bbox.y - bbox.height / 2\n    });\n  });\n\n  return this._modeling.createElements(elements, position, target, assign({}, hints));\n};\n\n/**\n * Create elements from tree.\n */\nCopyPaste.prototype._createElements = function(tree) {\n  var self = this;\n\n  var eventBus = this._eventBus;\n\n  var cache = {};\n\n  var elements = [];\n\n  forEach(tree, function(branch, depth) {\n\n    depth = parseInt(depth, 10);\n\n    // sort by priority\n    branch = sortBy(branch, 'priority');\n\n    forEach(branch, function(descriptor) {\n\n      // remove priority\n      var attrs = assign({}, omit(descriptor, [ 'priority' ]));\n\n      if (cache[ descriptor.parent ]) {\n        attrs.parent = cache[ descriptor.parent ];\n      } else {\n        delete attrs.parent;\n      }\n\n      eventBus.fire('copyPaste.pasteElement', {\n        cache: cache,\n        descriptor: attrs\n      });\n\n      var element;\n\n      if (isConnection(attrs)) {\n        attrs.source = cache[ descriptor.source ];\n        attrs.target = cache[ descriptor.target ];\n\n        element = cache[ descriptor.id ] = self.createConnection(attrs);\n\n        elements.push(element);\n\n        return;\n      }\n\n      if (isLabel(attrs)) {\n        attrs.labelTarget = cache[ attrs.labelTarget ];\n\n        element = cache[ descriptor.id ] = self.createLabel(attrs);\n\n        elements.push(element);\n\n        return;\n      }\n\n      if (attrs.host) {\n        attrs.host = cache[ attrs.host ];\n      }\n\n      element = cache[ descriptor.id ] = self.createShape(attrs);\n\n      elements.push(element);\n    });\n\n  });\n\n  return elements;\n};\n\nCopyPaste.prototype.createConnection = function(attrs) {\n  var connection = this._elementFactory.createConnection(omit(attrs, [ 'id' ]));\n\n  return connection;\n};\n\nCopyPaste.prototype.createLabel = function(attrs) {\n  var label = this._elementFactory.createLabel(omit(attrs, [ 'id' ]));\n\n  return label;\n};\n\nCopyPaste.prototype.createShape = function(attrs) {\n  var shape = this._elementFactory.createShape(omit(attrs, [ 'id' ]));\n\n  return shape;\n};\n\n/**\n * Check wether element has relations to other elements e.g. attachers, labels and connections.\n *\n * @param  {Object} element\n * @param  {Array<djs.model.Base>} elements\n *\n * @returns {Boolean}\n */\nCopyPaste.prototype.hasRelations = function(element, elements) {\n  var labelTarget,\n      source,\n      target;\n\n  if (isConnection(element)) {\n    source = find(elements, matchPattern({ id: element.source.id }));\n    target = find(elements, matchPattern({ id: element.target.id }));\n\n    if (!source || !target) {\n      return false;\n    }\n  }\n\n  if (isLabel(element)) {\n    labelTarget = find(elements, matchPattern({ id: element.labelTarget.id }));\n\n    if (!labelTarget) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\n/**\n * Create a tree-like structure from elements.\n *\n * @example\n * tree: {\n  *  0: [\n  *    { id: 'Shape_1', priority: 1, ... },\n  *    { id: 'Shape_2', priority: 1, ... },\n  *    { id: 'Connection_1', source: 'Shape_1', target: 'Shape_2', priority: 3, ... },\n  *    ...\n  *  ],\n  *  1: [\n  *    { id: 'Shape_3', parent: 'Shape1', priority: 1, ... },\n  *    ...\n  *  ]\n  * };\n  *\n  * @param  {Array<djs.model.base>} elements\n  *\n  * @return {Object}\n  */\nCopyPaste.prototype.createTree = function(elements) {\n  var rules = this._rules,\n      self = this;\n\n  var tree = {},\n      elementsData = [];\n\n  var parents = getParents(elements);\n\n  function canCopy(element, elements) {\n    return rules.allowed('element.copy', {\n      element: element,\n      elements: elements\n    });\n  }\n\n  function addElementData(element, depth) {\n\n    // (1) check wether element has already been added\n    var foundElementData = find(elementsData, function(elementsData) {\n      return element === elementsData.element;\n    });\n\n    // (2) add element if not already added\n    if (!foundElementData) {\n      elementsData.push({\n        element: element,\n        depth: depth\n      });\n\n      return;\n    }\n\n    // (3) update depth\n    if (foundElementData.depth < depth) {\n      elementsData = removeElementData(foundElementData, elementsData);\n\n      elementsData.push({\n        element: foundElementData.element,\n        depth: depth\n      });\n    }\n  }\n\n  function removeElementData(elementData, elementsData) {\n    var index = elementsData.indexOf(elementData);\n\n    if (index !== -1) {\n      elementsData.splice(index, 1);\n    }\n\n    return elementsData;\n  }\n\n  // (1) add elements\n  eachElement(parents, function(element, _index, depth) {\n\n    // do NOT add external labels directly\n    if (isLabel(element)) {\n      return;\n    }\n\n    // always copy external labels\n    forEach(element.labels, function(label) {\n      addElementData(label, depth);\n    });\n\n    function addRelatedElements(elements) {\n      elements && elements.length && forEach(elements, function(element) {\n\n        // add external labels\n        forEach(element.labels, function(label) {\n          addElementData(label, depth);\n        });\n\n        addElementData(element, depth);\n      });\n    }\n\n    forEach([ element.attachers, element.incoming, element.outgoing ], addRelatedElements);\n\n    addElementData(element, depth);\n\n    return element.children;\n  });\n\n  elements = map(elementsData, function(elementData) {\n    return elementData.element;\n  });\n\n  // (2) copy elements\n  elementsData = map(elementsData, function(elementData) {\n    elementData.descriptor = {};\n\n    self._eventBus.fire('copyPaste.copyElement', {\n      descriptor: elementData.descriptor,\n      element: elementData.element,\n      elements: elements\n    });\n\n    return elementData;\n  });\n\n  // (3) sort elements by priority\n  elementsData = sortBy(elementsData, function(elementData) {\n    return elementData.descriptor.priority;\n  });\n\n  elements = map(elementsData, function(elementData) {\n    return elementData.element;\n  });\n\n  // (4) create tree\n  forEach(elementsData, function(elementData) {\n    var depth = elementData.depth;\n\n    if (!self.hasRelations(elementData.element, elements)) {\n      removeElement(elementData.element, elements);\n\n      return;\n    }\n\n    if (!canCopy(elementData.element, elements)) {\n      removeElement(elementData.element, elements);\n\n      return;\n    }\n\n    if (!tree[depth]) {\n      tree[depth] = [];\n    }\n\n    tree[depth].push(elementData.descriptor);\n  });\n\n  return tree;\n};\n\n// helpers //////////\n\nfunction isAttacher(element) {\n  return !!element.host;\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}\n\nfunction copyWaypoints(element) {\n  return map(element.waypoints, function(waypoint) {\n\n    waypoint = copyWaypoint(waypoint);\n\n    if (waypoint.original) {\n      waypoint.original = copyWaypoint(waypoint.original);\n    }\n\n    return waypoint;\n  });\n}\n\nfunction copyWaypoint(waypoint) {\n  return assign({}, waypoint);\n}\n\nfunction removeElement(element, elements) {\n  var index = elements.indexOf(element);\n\n  if (index === -1) {\n    return elements;\n  }\n\n  return elements.splice(index, 1);\n}\n","import ClipboardModule from '../clipboard';\nimport CreateModule from '../create';\nimport MouseModule from '../mouse';\nimport RulesModule from '../rules';\n\nimport CopyPaste from './CopyPaste';\n\n\nexport default {\n  __depends__: [\n    ClipboardModule,\n    CreateModule,\n    MouseModule,\n    RulesModule\n  ],\n  __init__: [ 'copyPaste' ],\n  copyPaste: [ 'type', CopyPaste ]\n};\n","import {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  forEach,\n  isArray,\n  isUndefined,\n  omit,\n  reduce\n} from 'min-dash';\n\nfunction copyProperties(source, target, properties) {\n  if (!isArray(properties)) {\n    properties = [ properties ];\n  }\n\n  forEach(properties, function(property) {\n    if (!isUndefined(source[property])) {\n      target[property] = source[property];\n    }\n  });\n}\n\nfunction removeProperties(element, properties) {\n  if (!isArray(properties)) {\n    properties = [ properties ];\n  }\n\n  forEach(properties, function(property) {\n    if (element[property]) {\n      delete element[property];\n    }\n  });\n}\n\nvar LOW_PRIORITY = 750;\n\n\nexport default function BpmnCopyPaste(bpmnFactory, eventBus, moddleCopy) {\n\n  eventBus.on('copyPaste.copyElement', LOW_PRIORITY, function(context) {\n    var descriptor = context.descriptor,\n        element = context.element;\n\n    var businessObject = descriptor.oldBusinessObject = getBusinessObject(element);\n\n    descriptor.type = element.type;\n\n    copyProperties(businessObject, descriptor, 'name');\n\n    descriptor.di = {};\n\n    // fill and stroke will be set to DI\n    copyProperties(businessObject.di, descriptor.di, [\n      'fill',\n      'stroke'\n    ]);\n\n    copyProperties(businessObject.di, descriptor, 'isExpanded');\n\n    if (isLabel(descriptor)) {\n      return descriptor;\n    }\n\n    // default sequence flow\n    if (businessObject.default) {\n      descriptor.default = businessObject.default.id;\n    }\n  });\n\n  eventBus.on('moddleCopy.canCopyProperty', function(context) {\n    var parent = context.parent,\n        property = context.property,\n        propertyName = context.propertyName,\n        bpmnProcess;\n\n    if (\n      propertyName === 'processRef' &&\n      is(parent, 'bpmn:Participant') &&\n      is(property, 'bpmn:Process')\n    ) {\n      bpmnProcess = bpmnFactory.create('bpmn:Process');\n\n      // return copy of process\n      return moddleCopy.copyElement(property, bpmnProcess);\n    }\n  });\n\n  var references;\n\n  function resolveReferences(descriptor, cache) {\n    var businessObject = getBusinessObject(descriptor);\n\n    // default sequence flows\n    if (descriptor.default) {\n\n      // relationship cannot be resolved immediately\n      references[ descriptor.default ] = {\n        element: businessObject,\n        property: 'default'\n      };\n    }\n\n    // boundary events\n    if (descriptor.host) {\n\n      // relationship can be resolved immediately\n      getBusinessObject(descriptor).attachedToRef = getBusinessObject(cache[ descriptor.host ]);\n    }\n\n    references = omit(references, reduce(references, function(array, reference, key) {\n      var element = reference.element,\n          property = reference.property;\n\n      if (key === descriptor.id) {\n        element[ property ] = businessObject;\n\n        array.push(descriptor.id);\n      }\n\n      return array;\n    }, []));\n  }\n\n  eventBus.on('copyPaste.pasteElements', function() {\n    references = {};\n  });\n\n  eventBus.on('copyPaste.pasteElement', function(context) {\n    var cache = context.cache,\n        descriptor = context.descriptor,\n        oldBusinessObject = descriptor.oldBusinessObject,\n        newBusinessObject;\n\n    // do NOT copy business object if external label\n    if (isLabel(descriptor)) {\n      descriptor.businessObject = getBusinessObject(cache[ descriptor.labelTarget ]);\n\n      return;\n    }\n\n    newBusinessObject = bpmnFactory.create(oldBusinessObject.$type);\n\n    descriptor.businessObject = moddleCopy.copyElement(\n      oldBusinessObject,\n      newBusinessObject\n    );\n\n    // resolve references e.g. default sequence flow\n    resolveReferences(descriptor, cache);\n\n    copyProperties(descriptor, newBusinessObject, [\n      'isExpanded',\n      'name'\n    ]);\n\n    removeProperties(descriptor, 'oldBusinessObject');\n  });\n\n}\n\n\nBpmnCopyPaste.$inject = [\n  'bpmnFactory',\n  'eventBus',\n  'moddleCopy'\n];\n\n// helpers //////////\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}\n","import {\n  find,\n  forEach,\n  isArray,\n  isDefined,\n  isObject,\n  matchPattern,\n  reduce,\n  has,\n  sortBy\n} from 'min-dash';\n\nvar DISALLOWED_PROPERTIES = [\n  'artifacts',\n  'dataInputAssociations',\n  'dataOutputAssociations',\n  'default',\n  'flowElements',\n  'lanes',\n  'incoming',\n  'outgoing'\n];\n\n/**\n * @typedef {Function} <moddleCopy.canCopyProperties> listener\n *\n * @param {Object} context\n * @param {Array<string>} context.propertyNames\n * @param {ModdleElement} context.sourceElement\n * @param {ModdleElement} context.targetElement\n *\n * @returns {Array<string>|boolean} - Return properties to be copied or false to disallow\n * copying.\n */\n\n/**\n * @typedef {Function} <moddleCopy.canCopyProperty> listener\n *\n * @param {Object} context\n * @param {ModdleElement} context.parent\n * @param {*} context.property\n * @param {string} context.propertyName\n *\n * @returns {*|boolean} - Return copied property or false to disallow\n * copying.\n */\n\n/**\n * @typedef {Function} <moddleCopy.canSetCopiedProperty> listener\n *\n * @param {Object} context\n * @param {ModdleElement} context.parent\n * @param {*} context.property\n * @param {string} context.propertyName\n *\n * @returns {boolean} - Return false to disallow\n * setting copied property.\n */\n\n/**\n * Utility for copying model properties from source element to target element.\n *\n * @param {EventBus} eventBus\n * @param {BpmnFactory} bpmnFactory\n * @param {BpmnModdle} moddle\n */\nexport default function ModdleCopy(eventBus, bpmnFactory, moddle) {\n  this._bpmnFactory = bpmnFactory;\n  this._eventBus = eventBus;\n  this._moddle = moddle;\n\n  // copy extension elements last\n  eventBus.on('moddleCopy.canCopyProperties', function(context) {\n    var propertyNames = context.propertyNames;\n\n    if (!propertyNames || !propertyNames.length) {\n      return;\n    }\n\n    return sortBy(propertyNames, function(propertyName) {\n      return propertyName === 'extensionElements';\n    });\n  });\n\n  // default check whether property can be copied\n  eventBus.on('moddleCopy.canCopyProperty', function(context) {\n    var parent = context.parent,\n        parentDescriptor = isObject(parent) && parent.$descriptor,\n        propertyName = context.propertyName;\n\n    if (propertyName && DISALLOWED_PROPERTIES.indexOf(propertyName) !== -1) {\n\n      // disallow copying property\n      return false;\n    }\n\n    if (propertyName &&\n      parentDescriptor &&\n      !find(parentDescriptor.properties, matchPattern({ name: propertyName }))) {\n\n      // disallow copying property\n      return false;\n    }\n  });\n\n  // do NOT allow to copy empty extension elements\n  eventBus.on('moddleCopy.canSetCopiedProperty', function(context) {\n    var property = context.property;\n\n    if (is(property, 'bpmn:ExtensionElements') && (!property.values || !property.values.length)) {\n\n      // disallow setting copied property\n      return false;\n    }\n  });\n}\n\nModdleCopy.$inject = [\n  'eventBus',\n  'bpmnFactory',\n  'moddle'\n];\n\n/**\n * Copy model properties of source element to target element.\n *\n * @param {ModdleElement} sourceElement\n * @param {ModdleElement} targetElement\n * @param {Array<string>} [propertyNames]\n *\n * @param {ModdleElement}\n */\nModdleCopy.prototype.copyElement = function(sourceElement, targetElement, propertyNames) {\n  var self = this;\n\n  if (propertyNames && !isArray(propertyNames)) {\n    propertyNames = [ propertyNames ];\n  }\n\n  propertyNames = propertyNames || getPropertyNames(sourceElement.$descriptor);\n\n  var canCopyProperties = this._eventBus.fire('moddleCopy.canCopyProperties', {\n    propertyNames: propertyNames,\n    sourceElement: sourceElement,\n    targetElement: targetElement\n  });\n\n  if (canCopyProperties === false) {\n    return targetElement;\n  }\n\n  if (isArray(canCopyProperties)) {\n    propertyNames = canCopyProperties;\n  }\n\n  // copy properties\n  forEach(propertyNames, function(propertyName) {\n    var sourceProperty;\n\n    if (has(sourceElement, propertyName)) {\n      sourceProperty = sourceElement.get(propertyName);\n    }\n\n    var copiedProperty = self.copyProperty(sourceProperty, targetElement, propertyName);\n\n    var canSetProperty = self._eventBus.fire('moddleCopy.canSetCopiedProperty', {\n      parent: parent,\n      property: copiedProperty,\n      propertyName: propertyName\n    });\n\n    if (canSetProperty === false) {\n      return;\n    }\n\n    if (isDefined(copiedProperty)) {\n      targetElement.set(propertyName, copiedProperty);\n    }\n  });\n\n  return targetElement;\n};\n\n/**\n * Copy model property.\n *\n * @param {*} property\n * @param {ModdleElement} parent\n * @param {string} propertyName\n *\n * @returns {*}\n */\nModdleCopy.prototype.copyProperty = function(property, parent, propertyName) {\n  var self = this;\n\n  // allow others to copy property\n  var copiedProperty = this._eventBus.fire('moddleCopy.canCopyProperty', {\n    parent: parent,\n    property: property,\n    propertyName: propertyName\n  });\n\n  // return if copying is NOT allowed\n  if (copiedProperty === false) {\n    return;\n  }\n\n  if (copiedProperty) {\n    if (isObject(copiedProperty) && copiedProperty.$type && !copiedProperty.$parent) {\n      copiedProperty.$parent = parent;\n    }\n\n    return copiedProperty;\n  }\n\n  var propertyDescriptor = this._moddle.getPropertyDescriptor(parent, propertyName);\n\n  // do NOT copy Ids and references\n  if (propertyDescriptor.isId || propertyDescriptor.isReference) {\n    return;\n  }\n\n  // copy arrays\n  if (isArray(property)) {\n    return reduce(property, function(childProperties, childProperty) {\n\n      // recursion\n      copiedProperty = self.copyProperty(childProperty, parent, propertyName);\n\n      // copying might NOT be allowed\n      if (copiedProperty) {\n        copiedProperty.$parent = parent;\n\n        return childProperties.concat(copiedProperty);\n      }\n\n      return childProperties;\n    }, []);\n  }\n\n  // copy model elements\n  if (isObject(property) && property.$type) {\n    if (this._moddle.getElementDescriptor(property).isGeneric) {\n      return;\n    }\n\n    copiedProperty = self._bpmnFactory.create(property.$type);\n\n    copiedProperty.$parent = parent;\n\n    // recursion\n    copiedProperty = self.copyElement(property, copiedProperty);\n\n    return copiedProperty;\n  }\n\n  // copy primitive properties\n  return property;\n};\n\n// helpers //////////\n\nexport function getPropertyNames(descriptor, keepDefaultProperties) {\n  return reduce(descriptor.properties, function(properties, property) {\n\n    if (keepDefaultProperties && property.default) {\n      return properties;\n    }\n\n    return properties.concat(property.name);\n  }, []);\n}\n\nfunction is(element, type) {\n  return element && (typeof element.$instanceOf === 'function') && element.$instanceOf(type);\n}","import CopyPasteModule from 'diagram-js/lib/features/copy-paste';\n\nimport BpmnCopyPaste from './BpmnCopyPaste';\nimport ModdleCopy from './ModdleCopy';\n\nexport default {\n  __depends__: [\n    CopyPasteModule\n  ],\n  __init__: [ 'bpmnCopyPaste', 'moddleCopy' ],\n  bpmnCopyPaste: [ 'type', BpmnCopyPaste ],\n  moddleCopy: [ 'type', ModdleCopy ]\n};\n","import {\n  assign\n} from 'min-dash';\n\nvar round = Math.round;\n\n/**\n * Service that allow replacing of elements.\n */\nexport default function Replace(modeling) {\n\n  this._modeling = modeling;\n}\n\nReplace.$inject = [ 'modeling' ];\n\n/**\n * @param {Element} oldElement - Element to be replaced\n * @param {Object}  newElementData - Containing information about the new element,\n *                                   for example the new bounds and type.\n * @param {Object}  options - Custom options that will be attached to the context. It can be used to inject data\n *                            that is needed in the command chain. For example it could be used in\n *                            eventbus.on('commandStack.shape.replace.postExecute') to change shape attributes after\n *                            shape creation.\n */\nReplace.prototype.replaceElement = function(oldElement, newElementData, options) {\n\n  if (oldElement.waypoints) {\n\n    // TODO(nikku): we do not replace connections, yet\n    return null;\n  }\n\n  var modeling = this._modeling;\n\n  var width = newElementData.width || oldElement.width,\n      height = newElementData.height || oldElement.height,\n      x = newElementData.x || oldElement.x,\n      y = newElementData.y || oldElement.y,\n      centerX = round(x + width / 2),\n      centerY = round(y + height / 2);\n\n  // modeling API requires center coordinates,\n  // account for that when handling shape bounds\n\n  return modeling.replaceShape(\n    oldElement,\n    assign(\n      {},\n      newElementData,\n      {\n        x: centerX,\n        y: centerY,\n        width: width,\n        height: height\n      }\n    ),\n    options\n  );\n};\n","import Replace from './Replace';\n\nexport default {\n  __init__: [ 'replace' ],\n  replace: [ 'type', Replace ]\n};","import {\n  pick,\n  assign,\n  filter,\n  forEach,\n  isArray,\n  isUndefined,\n  has\n} from 'min-dash';\n\nimport {\n  is,\n  getBusinessObject\n} from '../../util/ModelUtil';\n\nimport {\n  isAny\n} from '../modeling/util/ModelingUtil';\n\nimport {\n  isExpanded,\n  isEventSubProcess\n} from '../../util/DiUtil';\n\nimport { getPropertyNames } from '../copy-paste/ModdleCopy';\n\nfunction copyProperties(source, target, properties) {\n  if (!isArray(properties)) {\n    properties = [ properties ];\n  }\n\n  forEach(properties, function(property) {\n    if (!isUndefined(source[property])) {\n      target[property] = source[property];\n    }\n  });\n}\n\nvar CUSTOM_PROPERTIES = [\n  'cancelActivity',\n  'instantiate',\n  'eventGatewayType',\n  'triggeredByEvent',\n  'isInterrupting'\n];\n\n\nfunction toggeling(element, target) {\n\n  var oldCollapsed = (\n    element && has(element, 'collapsed') ? element.collapsed : !isExpanded(element)\n  );\n\n  var targetCollapsed;\n\n  if (target && (has(target, 'collapsed') || has(target, 'isExpanded'))) {\n\n    // property is explicitly set so use it\n    targetCollapsed = (\n      has(target, 'collapsed') ? target.collapsed : !target.isExpanded\n    );\n  } else {\n\n    // keep old state\n    targetCollapsed = oldCollapsed;\n  }\n\n  if (oldCollapsed !== targetCollapsed) {\n    element.collapsed = oldCollapsed;\n    return true;\n  }\n\n  return false;\n}\n\n\n\n/**\n * This module takes care of replacing BPMN elements\n */\nexport default function BpmnReplace(\n    bpmnFactory,\n    elementFactory,\n    moddleCopy,\n    modeling,\n    replace,\n    selection\n) {\n\n  /**\n   * Prepares a new business object for the replacement element\n   * and triggers the replace operation.\n   *\n   * @param  {djs.model.Base} element\n   * @param  {Object} target\n   * @param  {Object} [hints]\n   *\n   * @return {djs.model.Base} the newly created element\n   */\n  function replaceElement(element, target, hints) {\n\n    hints = hints || {};\n\n    var type = target.type,\n        oldBusinessObject = element.businessObject;\n\n    if (isSubProcess(oldBusinessObject)) {\n      if (type === 'bpmn:SubProcess') {\n        if (toggeling(element, target)) {\n\n          // expanding or collapsing process\n          modeling.toggleCollapse(element);\n\n          return element;\n        }\n      }\n    }\n\n    var newBusinessObject = bpmnFactory.create(type);\n\n    var newElement = {\n      type: type,\n      businessObject: newBusinessObject\n    };\n\n    var elementProps = getPropertyNames(oldBusinessObject.$descriptor),\n        newElementProps = getPropertyNames(newBusinessObject.$descriptor, true),\n        copyProps = intersection(elementProps, newElementProps);\n\n    // initialize special properties defined in target definition\n    assign(newBusinessObject, pick(target, CUSTOM_PROPERTIES));\n\n    var properties = filter(copyProps, function(propertyName) {\n\n      // copying event definitions, unless we replace\n      if (propertyName === 'eventDefinitions') {\n        return hasEventDefinition(element, target.eventDefinitionType);\n      }\n\n      // retain loop characteristics if the target element\n      // is not an event sub process\n      if (propertyName === 'loopCharacteristics') {\n        return !isEventSubProcess(newBusinessObject);\n      }\n\n      // so the applied properties from 'target' don't get lost\n      if (newBusinessObject.hasOwnProperty(propertyName)) {\n        return false;\n      }\n\n      if (propertyName === 'processRef' && target.isExpanded === false) {\n        return false;\n      }\n\n      if (propertyName === 'triggeredByEvent') {\n        return false;\n      }\n\n      return true;\n    });\n\n    newBusinessObject = moddleCopy.copyElement(\n      oldBusinessObject,\n      newBusinessObject,\n      properties\n    );\n\n    // initialize custom BPMN extensions\n    if (target.eventDefinitionType) {\n\n      // only initialize with new eventDefinition\n      // if we did not set an event definition yet,\n      // i.e. because we copied it\n      if (!hasEventDefinition(newBusinessObject, target.eventDefinitionType)) {\n        newElement.eventDefinitionType = target.eventDefinitionType;\n      }\n    }\n\n    if (is(oldBusinessObject, 'bpmn:Activity')) {\n\n      if (isSubProcess(oldBusinessObject)) {\n\n        // no toggeling, so keep old state\n        newElement.isExpanded = isExpanded(oldBusinessObject);\n      }\n\n      // else if property is explicitly set, use it\n      else if (target && has(target, 'isExpanded')) {\n        newElement.isExpanded = target.isExpanded;\n      }\n\n      // TODO: need also to respect min/max Size\n      // copy size, from an expanded subprocess to an expanded alternative subprocess\n      // except bpmn:Task, because Task is always expanded\n      if ((isExpanded(oldBusinessObject) && !is(oldBusinessObject, 'bpmn:Task')) && newElement.isExpanded) {\n        newElement.width = element.width;\n        newElement.height = element.height;\n      }\n    }\n\n    // remove children if not expanding sub process\n    if (isSubProcess(oldBusinessObject) && !isSubProcess(newBusinessObject)) {\n      hints.moveChildren = false;\n    }\n\n    // transform collapsed/expanded pools\n    if (is(oldBusinessObject, 'bpmn:Participant')) {\n\n      // create expanded pool\n      if (target.isExpanded === true) {\n        newBusinessObject.processRef = bpmnFactory.create('bpmn:Process');\n      } else {\n\n        // remove children when transforming to collapsed pool\n        hints.moveChildren = false;\n      }\n\n      // apply same width and default height\n      newElement.width = element.width;\n      newElement.height = elementFactory._getDefaultSize(newBusinessObject).height;\n    }\n\n    newBusinessObject.name = oldBusinessObject.name;\n\n    // retain default flow's reference between inclusive <-> exclusive gateways and activities\n    if (\n      isAny(oldBusinessObject, [\n        'bpmn:ExclusiveGateway',\n        'bpmn:InclusiveGateway',\n        'bpmn:Activity'\n      ]) &&\n      isAny(newBusinessObject, [\n        'bpmn:ExclusiveGateway',\n        'bpmn:InclusiveGateway',\n        'bpmn:Activity'\n      ])\n    ) {\n      newBusinessObject.default = oldBusinessObject.default;\n    }\n\n    if (\n      target.host &&\n      !is(oldBusinessObject, 'bpmn:BoundaryEvent') &&\n      is(newBusinessObject, 'bpmn:BoundaryEvent')\n    ) {\n      newElement.host = target.host;\n    }\n\n    newElement.di = {};\n\n    // fill and stroke will be set to DI\n    copyProperties(oldBusinessObject.di, newElement.di, [\n      'fill',\n      'stroke'\n    ]);\n\n    newElement = replace.replaceElement(element, newElement, hints);\n\n    if (hints.select !== false) {\n      selection.select(newElement);\n    }\n\n    return newElement;\n  }\n\n  this.replaceElement = replaceElement;\n}\n\nBpmnReplace.$inject = [\n  'bpmnFactory',\n  'elementFactory',\n  'moddleCopy',\n  'modeling',\n  'replace',\n  'selection'\n];\n\n\nfunction isSubProcess(bo) {\n  return is(bo, 'bpmn:SubProcess');\n}\n\nfunction hasEventDefinition(element, type) {\n\n  var bo = getBusinessObject(element);\n\n  return type && bo.get('eventDefinitions').some(function(definition) {\n    return is(definition, type);\n  });\n}\n\n/**\n * Compute intersection between two arrays.\n */\nfunction intersection(a1, a2) {\n  return a1.filter(function(el) {\n    return a2.indexOf(el) !== -1;\n  });\n}\n","import CopyPasteModule from '../copy-paste';\nimport ReplaceModule from 'diagram-js/lib/features/replace';\nimport SelectionModule from 'diagram-js/lib/features/selection';\n\nimport BpmnReplace from './BpmnReplace';\n\nexport default {\n  __depends__: [\n    CopyPasteModule,\n    ReplaceModule,\n    SelectionModule\n  ],\n  bpmnReplace: [ 'type', BpmnReplace ]\n};\n","import {\n  getBusinessObject\n} from '../../../util/ModelUtil';\n\nimport {\n  isExpanded\n} from '../../../util/DiUtil';\n\n\n/**\n * Returns true, if an element is from a different type\n * than a target definition. Takes into account the type,\n * event definition type and triggeredByEvent property.\n *\n * @param {djs.model.Base} element\n *\n * @return {Boolean}\n */\nexport function isDifferentType(element) {\n\n  return function(entry) {\n    var target = entry.target;\n\n    var businessObject = getBusinessObject(element),\n        eventDefinition = businessObject.eventDefinitions && businessObject.eventDefinitions[0];\n\n    var isTypeEqual = businessObject.$type === target.type;\n\n    var isEventDefinitionEqual = (\n      (eventDefinition && eventDefinition.$type) === target.eventDefinitionType\n    );\n\n    var isTriggeredByEventEqual = (\n      businessObject.triggeredByEvent === target.triggeredByEvent\n    );\n\n    var isExpandedEqual = (\n      target.isExpanded === undefined ||\n      target.isExpanded === isExpanded(businessObject)\n    );\n\n    return !isTypeEqual || !isEventDefinitionEqual || !isTriggeredByEventEqual || !isExpandedEqual;\n  };\n}","export var START_EVENT = [\n  {\n    label: 'Start Event',\n    actionName: 'replace-with-none-start',\n    className: 'bpmn-icon-start-event-none',\n    target: {\n      type: 'bpmn:StartEvent'\n    }\n  },\n  {\n    label: 'Intermediate Throw Event',\n    actionName: 'replace-with-none-intermediate-throwing',\n    className: 'bpmn-icon-intermediate-event-none',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent'\n    }\n  },\n  {\n    label: 'End Event',\n    actionName: 'replace-with-none-end',\n    className: 'bpmn-icon-end-event-none',\n    target: {\n      type: 'bpmn:EndEvent'\n    }\n  },\n  {\n    label: 'Message Start Event',\n    actionName: 'replace-with-message-start',\n    className: 'bpmn-icon-start-event-message',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Timer Start Event',\n    actionName: 'replace-with-timer-start',\n    className: 'bpmn-icon-start-event-timer',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition'\n    }\n  },\n  {\n    label: 'Conditional Start Event',\n    actionName: 'replace-with-conditional-start',\n    className: 'bpmn-icon-start-event-condition',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Start Event',\n    actionName: 'replace-with-signal-start',\n    className: 'bpmn-icon-start-event-signal',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  }\n];\n\nexport var INTERMEDIATE_EVENT = [\n  {\n    label: 'Start Event',\n    actionName: 'replace-with-none-start',\n    className: 'bpmn-icon-start-event-none',\n    target: {\n      type: 'bpmn:StartEvent'\n    }\n  },\n  {\n    label: 'Intermediate Throw Event',\n    actionName: 'replace-with-none-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-none',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent'\n    }\n  },\n  {\n    label: 'End Event',\n    actionName: 'replace-with-none-end',\n    className: 'bpmn-icon-end-event-none',\n    target: {\n      type: 'bpmn:EndEvent'\n    }\n  },\n  {\n    label: 'Message Intermediate Catch Event',\n    actionName: 'replace-with-message-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-message',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Message Intermediate Throw Event',\n    actionName: 'replace-with-message-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-message',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Timer Intermediate Catch Event',\n    actionName: 'replace-with-timer-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-timer',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition'\n    }\n  },\n  {\n    label: 'Escalation Intermediate Throw Event',\n    actionName: 'replace-with-escalation-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-escalation',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition'\n    }\n  },\n  {\n    label: 'Conditional Intermediate Catch Event',\n    actionName: 'replace-with-conditional-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-condition',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition'\n    }\n  },\n  {\n    label: 'Link Intermediate Catch Event',\n    actionName: 'replace-with-link-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-link',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:LinkEventDefinition'\n    }\n  },\n  {\n    label: 'Link Intermediate Throw Event',\n    actionName: 'replace-with-link-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-link',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:LinkEventDefinition'\n    }\n  },\n  {\n    label: 'Compensation Intermediate Throw Event',\n    actionName: 'replace-with-compensation-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-compensation',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:CompensateEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Intermediate Catch Event',\n    actionName: 'replace-with-signal-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-signal',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Intermediate Throw Event',\n    actionName: 'replace-with-signal-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-signal',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  }\n];\n\nexport var END_EVENT = [\n  {\n    label: 'Start Event',\n    actionName: 'replace-with-none-start',\n    className: 'bpmn-icon-start-event-none',\n    target: {\n      type: 'bpmn:StartEvent'\n    }\n  },\n  {\n    label: 'Intermediate Throw Event',\n    actionName: 'replace-with-none-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-none',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent'\n    }\n  },\n  {\n    label: 'End Event',\n    actionName: 'replace-with-none-end',\n    className: 'bpmn-icon-end-event-none',\n    target: {\n      type: 'bpmn:EndEvent'\n    }\n  },\n  {\n    label: 'Message End Event',\n    actionName: 'replace-with-message-end',\n    className: 'bpmn-icon-end-event-message',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Escalation End Event',\n    actionName: 'replace-with-escalation-end',\n    className: 'bpmn-icon-end-event-escalation',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition'\n    }\n  },\n  {\n    label: 'Error End Event',\n    actionName: 'replace-with-error-end',\n    className: 'bpmn-icon-end-event-error',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:ErrorEventDefinition'\n    }\n  },\n  {\n    label: 'Cancel End Event',\n    actionName: 'replace-with-cancel-end',\n    className: 'bpmn-icon-end-event-cancel',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:CancelEventDefinition'\n    }\n  },\n  {\n    label: 'Compensation End Event',\n    actionName: 'replace-with-compensation-end',\n    className: 'bpmn-icon-end-event-compensation',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:CompensateEventDefinition'\n    }\n  },\n  {\n    label: 'Signal End Event',\n    actionName: 'replace-with-signal-end',\n    className: 'bpmn-icon-end-event-signal',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  },\n  {\n    label: 'Terminate End Event',\n    actionName: 'replace-with-terminate-end',\n    className: 'bpmn-icon-end-event-terminate',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:TerminateEventDefinition'\n    }\n  }\n];\n\nexport var GATEWAY = [\n  {\n    label: 'Exclusive Gateway',\n    actionName: 'replace-with-exclusive-gateway',\n    className: 'bpmn-icon-gateway-xor',\n    target: {\n      type: 'bpmn:ExclusiveGateway'\n    }\n  },\n  {\n    label: 'Parallel Gateway',\n    actionName: 'replace-with-parallel-gateway',\n    className: 'bpmn-icon-gateway-parallel',\n    target: {\n      type: 'bpmn:ParallelGateway'\n    }\n  },\n  {\n    label: 'Inclusive Gateway',\n    actionName: 'replace-with-inclusive-gateway',\n    className: 'bpmn-icon-gateway-or',\n    target: {\n      type: 'bpmn:InclusiveGateway'\n    }\n  },\n  {\n    label: 'Complex Gateway',\n    actionName: 'replace-with-complex-gateway',\n    className: 'bpmn-icon-gateway-complex',\n    target: {\n      type: 'bpmn:ComplexGateway'\n    }\n  },\n  {\n    label: 'Event based Gateway',\n    actionName: 'replace-with-event-based-gateway',\n    className: 'bpmn-icon-gateway-eventbased',\n    target: {\n      type: 'bpmn:EventBasedGateway',\n      instantiate: false,\n      eventGatewayType: 'Exclusive'\n    }\n  }\n\n  // Gateways deactivated until https://github.com/bpmn-io/bpmn-js/issues/194\n  // {\n  //   label: 'Event based instantiating Gateway',\n  //   actionName: 'replace-with-exclusive-event-based-gateway',\n  //   className: 'bpmn-icon-exclusive-event-based',\n  //   target: {\n  //     type: 'bpmn:EventBasedGateway'\n  //   },\n  //   options: {\n  //     businessObject: { instantiate: true, eventGatewayType: 'Exclusive' }\n  //   }\n  // },\n  // {\n  //   label: 'Parallel Event based instantiating Gateway',\n  //   actionName: 'replace-with-parallel-event-based-instantiate-gateway',\n  //   className: 'bpmn-icon-parallel-event-based-instantiate-gateway',\n  //   target: {\n  //     type: 'bpmn:EventBasedGateway'\n  //   },\n  //   options: {\n  //     businessObject: { instantiate: true, eventGatewayType: 'Parallel' }\n  //   }\n  // }\n];\n\nexport var SUBPROCESS_EXPANDED = [\n  {\n    label: 'Transaction',\n    actionName: 'replace-with-transaction',\n    className: 'bpmn-icon-transaction',\n    target: {\n      type: 'bpmn:Transaction',\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Event Sub Process',\n    actionName: 'replace-with-event-subprocess',\n    className: 'bpmn-icon-event-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      triggeredByEvent: true,\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Sub Process (collapsed)',\n    actionName: 'replace-with-collapsed-subprocess',\n    className: 'bpmn-icon-subprocess-collapsed',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: false\n    }\n  }\n];\n\nexport var TRANSACTION = [\n  {\n    label: 'Sub Process',\n    actionName: 'replace-with-subprocess',\n    className: 'bpmn-icon-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Event Sub Process',\n    actionName: 'replace-with-event-subprocess',\n    className: 'bpmn-icon-event-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      triggeredByEvent: true,\n      isExpanded: true\n    }\n  }\n];\n\nexport var EVENT_SUB_PROCESS = [\n  {\n    label: 'Sub Process',\n    actionName: 'replace-with-subprocess',\n    className: 'bpmn-icon-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Transaction',\n    actionName: 'replace-with-transaction',\n    className: 'bpmn-icon-transaction',\n    target: {\n      type: 'bpmn:Transaction',\n      isExpanded: true\n    }\n  }\n];\n\nexport var TASK = [\n  {\n    label: 'Task',\n    actionName: 'replace-with-task',\n    className: 'bpmn-icon-task',\n    target: {\n      type: 'bpmn:Task'\n    }\n  },\n  {\n    label: 'Send Task',\n    actionName: 'replace-with-send-task',\n    className: 'bpmn-icon-send',\n    target: {\n      type: 'bpmn:SendTask'\n    }\n  },\n  {\n    label: 'Receive Task',\n    actionName: 'replace-with-receive-task',\n    className: 'bpmn-icon-receive',\n    target: {\n      type: 'bpmn:ReceiveTask'\n    }\n  },\n  {\n    label: 'User Task',\n    actionName: 'replace-with-user-task',\n    className: 'bpmn-icon-user',\n    target: {\n      type: 'bpmn:UserTask'\n    }\n  },\n  {\n    label: 'Manual Task',\n    actionName: 'replace-with-manual-task',\n    className: 'bpmn-icon-manual',\n    target: {\n      type: 'bpmn:ManualTask'\n    }\n  },\n  {\n    label: 'Business Rule Task',\n    actionName: 'replace-with-rule-task',\n    className: 'bpmn-icon-business-rule',\n    target: {\n      type: 'bpmn:BusinessRuleTask'\n    }\n  },\n  {\n    label: 'Service Task',\n    actionName: 'replace-with-service-task',\n    className: 'bpmn-icon-service',\n    target: {\n      type: 'bpmn:ServiceTask'\n    }\n  },\n  {\n    label: 'Script Task',\n    actionName: 'replace-with-script-task',\n    className: 'bpmn-icon-script',\n    target: {\n      type: 'bpmn:ScriptTask'\n    }\n  },\n  {\n    label: 'Call Activity',\n    actionName: 'replace-with-call-activity',\n    className: 'bpmn-icon-call-activity',\n    target: {\n      type: 'bpmn:CallActivity'\n    }\n  },\n  {\n    label: 'Sub Process (collapsed)',\n    actionName: 'replace-with-collapsed-subprocess',\n    className: 'bpmn-icon-subprocess-collapsed',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: false\n    }\n  },\n  {\n    label: 'Sub Process (expanded)',\n    actionName: 'replace-with-expanded-subprocess',\n    className: 'bpmn-icon-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: true\n    }\n  }\n];\n\nexport var BOUNDARY_EVENT = [\n  {\n    label: 'Message Boundary Event',\n    actionName: 'replace-with-message-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-message',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Timer Boundary Event',\n    actionName: 'replace-with-timer-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-timer',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition'\n    }\n  },\n  {\n    label: 'Escalation Boundary Event',\n    actionName: 'replace-with-escalation-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-escalation',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition'\n    }\n  },\n  {\n    label: 'Conditional Boundary Event',\n    actionName: 'replace-with-conditional-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-condition',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition'\n    }\n  },\n  {\n    label: 'Error Boundary Event',\n    actionName: 'replace-with-error-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-error',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:ErrorEventDefinition'\n    }\n  },\n  {\n    label: 'Cancel Boundary Event',\n    actionName: 'replace-with-cancel-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-cancel',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:CancelEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Boundary Event',\n    actionName: 'replace-with-signal-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-signal',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  },\n  {\n    label: 'Compensation Boundary Event',\n    actionName: 'replace-with-compensation-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-compensation',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:CompensateEventDefinition'\n    }\n  },\n  {\n    label: 'Message Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-message-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-message',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition',\n      cancelActivity: false\n    }\n  },\n  {\n    label: 'Timer Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-timer-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-timer',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition',\n      cancelActivity: false\n    }\n  },\n  {\n    label: 'Escalation Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-escalation-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-escalation',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition',\n      cancelActivity: false\n    }\n  },\n  {\n    label: 'Conditional Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-conditional-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-condition',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition',\n      cancelActivity: false\n    }\n  },\n  {\n    label: 'Signal Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-signal-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-signal',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition',\n      cancelActivity: false\n    }\n  }\n];\n\nexport var EVENT_SUB_PROCESS_START_EVENT = [\n  {\n    label: 'Message Start Event',\n    actionName: 'replace-with-message-start',\n    className: 'bpmn-icon-start-event-message',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Timer Start Event',\n    actionName: 'replace-with-timer-start',\n    className: 'bpmn-icon-start-event-timer',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition'\n    }\n  },\n  {\n    label: 'Conditional Start Event',\n    actionName: 'replace-with-conditional-start',\n    className: 'bpmn-icon-start-event-condition',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Start Event',\n    actionName: 'replace-with-signal-start',\n    className: 'bpmn-icon-start-event-signal',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  },\n  {\n    label: 'Error Start Event',\n    actionName: 'replace-with-error-start',\n    className: 'bpmn-icon-start-event-error',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:ErrorEventDefinition'\n    }\n  },\n  {\n    label: 'Escalation Start Event',\n    actionName: 'replace-with-escalation-start',\n    className: 'bpmn-icon-start-event-escalation',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition'\n    }\n  },\n  {\n    label: 'Compensation Start Event',\n    actionName: 'replace-with-compensation-start',\n    className: 'bpmn-icon-start-event-compensation',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:CompensateEventDefinition'\n    }\n  },\n  {\n    label: 'Message Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-message-start',\n    className: 'bpmn-icon-start-event-non-interrupting-message',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition',\n      isInterrupting: false\n    }\n  },\n  {\n    label: 'Timer Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-timer-start',\n    className: 'bpmn-icon-start-event-non-interrupting-timer',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition',\n      isInterrupting: false\n    }\n  },\n  {\n    label: 'Conditional Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-conditional-start',\n    className: 'bpmn-icon-start-event-non-interrupting-condition',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition',\n      isInterrupting: false\n    }\n  },\n  {\n    label: 'Signal Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-signal-start',\n    className: 'bpmn-icon-start-event-non-interrupting-signal',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition',\n      isInterrupting: false\n    }\n  },\n  {\n    label: 'Escalation Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-escalation-start',\n    className: 'bpmn-icon-start-event-non-interrupting-escalation',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition',\n      isInterrupting: false\n    }\n  }\n];\n\nexport var SEQUENCE_FLOW = [\n  {\n    label: 'Sequence Flow',\n    actionName: 'replace-with-sequence-flow',\n    className: 'bpmn-icon-connection'\n  },\n  {\n    label: 'Default Flow',\n    actionName: 'replace-with-default-flow',\n    className: 'bpmn-icon-default-flow'\n  },\n  {\n    label: 'Conditional Flow',\n    actionName: 'replace-with-conditional-flow',\n    className: 'bpmn-icon-conditional-flow'\n  }\n];\n\nexport var PARTICIPANT = [\n  {\n    label: 'Expanded Pool',\n    actionName: 'replace-with-expanded-pool',\n    className: 'bpmn-icon-participant',\n    target: {\n      type: 'bpmn:Participant',\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Collapsed Pool',\n    actionName: 'replace-with-collapsed-pool',\n\n    // TODO(@janstuemmel): maybe design new icon\n    className: 'bpmn-icon-lane',\n    target: {\n      type: 'bpmn:Participant',\n      isExpanded: false\n    }\n  }\n];\n","import {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  isEventSubProcess,\n  isExpanded\n} from '../../util/DiUtil';\n\nimport {\n  isDifferentType\n} from './util/TypeUtil';\n\nimport {\n  forEach,\n  filter\n} from 'min-dash';\n\nimport * as replaceOptions from '../replace/ReplaceOptions';\n\n\n/**\n * This module is an element agnostic replace menu provider for the popup menu.\n */\nexport default function ReplaceMenuProvider(\n    popupMenu, modeling, moddle,\n    bpmnReplace, rules, translate) {\n\n  this._popupMenu = popupMenu;\n  this._modeling = modeling;\n  this._moddle = moddle;\n  this._bpmnReplace = bpmnReplace;\n  this._rules = rules;\n  this._translate = translate;\n\n  this.register();\n}\n\nReplaceMenuProvider.$inject = [\n  'popupMenu',\n  'modeling',\n  'moddle',\n  'bpmnReplace',\n  'rules',\n  'translate'\n];\n\n\n/**\n * Register replace menu provider in the popup menu\n */\nReplaceMenuProvider.prototype.register = function() {\n  this._popupMenu.registerProvider('bpmn-replace', this);\n};\n\n\n/**\n * Get all entries from replaceOptions for the given element and apply filters\n * on them. Get for example only elements, which are different from the current one.\n *\n * @param {djs.model.Base} element\n *\n * @return {Array<Object>} a list of menu entry items\n */\nReplaceMenuProvider.prototype.getEntries = function(element) {\n\n  var businessObject = element.businessObject;\n\n  var rules = this._rules;\n\n  var entries;\n\n  if (!rules.allowed('shape.replace', { element: element })) {\n    return [];\n  }\n\n  var differentType = isDifferentType(element);\n\n  // start events outside event sub processes\n  if (is(businessObject, 'bpmn:StartEvent') && !isEventSubProcess(businessObject.$parent)) {\n\n    entries = filter(replaceOptions.START_EVENT, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // expanded/collapsed pools\n  if (is(businessObject, 'bpmn:Participant')) {\n\n    entries = filter(replaceOptions.PARTICIPANT, function(entry) {\n      return isExpanded(businessObject) !== entry.target.isExpanded;\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // start events inside event sub processes\n  if (is(businessObject, 'bpmn:StartEvent') && isEventSubProcess(businessObject.$parent)) {\n\n    entries = filter(replaceOptions.EVENT_SUB_PROCESS_START_EVENT, function(entry) {\n\n      var target = entry.target;\n\n      var isInterrupting = target.isInterrupting !== false;\n\n      var isInterruptingEqual = getBusinessObject(element).isInterrupting === isInterrupting;\n\n      // filters elements which types and event definition are equal but have have different interrupting types\n      return differentType(entry) || !differentType(entry) && !isInterruptingEqual;\n\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // end events\n  if (is(businessObject, 'bpmn:EndEvent')) {\n\n    entries = filter(replaceOptions.END_EVENT, function(entry) {\n      var target = entry.target;\n\n      // hide cancel end events outside transactions\n      if (target.eventDefinitionType == 'bpmn:CancelEventDefinition' && !is(businessObject.$parent, 'bpmn:Transaction')) {\n        return false;\n      }\n\n      return differentType(entry);\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // boundary events\n  if (is(businessObject, 'bpmn:BoundaryEvent')) {\n\n    entries = filter(replaceOptions.BOUNDARY_EVENT, function(entry) {\n\n      var target = entry.target;\n\n      if (target.eventDefinition == 'bpmn:CancelEventDefinition' &&\n         !is(businessObject.attachedToRef, 'bpmn:Transaction')) {\n        return false;\n      }\n      var cancelActivity = target.cancelActivity !== false;\n\n      var isCancelActivityEqual = businessObject.cancelActivity == cancelActivity;\n\n      return differentType(entry) || !differentType(entry) && !isCancelActivityEqual;\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // intermediate events\n  if (is(businessObject, 'bpmn:IntermediateCatchEvent') ||\n      is(businessObject, 'bpmn:IntermediateThrowEvent')) {\n\n    entries = filter(replaceOptions.INTERMEDIATE_EVENT, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // gateways\n  if (is(businessObject, 'bpmn:Gateway')) {\n\n    entries = filter(replaceOptions.GATEWAY, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // transactions\n  if (is(businessObject, 'bpmn:Transaction')) {\n\n    entries = filter(replaceOptions.TRANSACTION, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // expanded event sub processes\n  if (isEventSubProcess(businessObject) && isExpanded(businessObject)) {\n\n    entries = filter(replaceOptions.EVENT_SUB_PROCESS, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // expanded sub processes\n  if (is(businessObject, 'bpmn:SubProcess') && isExpanded(businessObject)) {\n\n    entries = filter(replaceOptions.SUBPROCESS_EXPANDED, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // collapsed ad hoc sub processes\n  if (is(businessObject, 'bpmn:AdHocSubProcess') && !isExpanded(businessObject)) {\n\n    entries = filter(replaceOptions.TASK, function(entry) {\n\n      var target = entry.target;\n\n      var isTargetSubProcess = target.type === 'bpmn:SubProcess';\n\n      var isTargetExpanded = target.isExpanded === true;\n\n      return isDifferentType(element, target) && (!isTargetSubProcess || isTargetExpanded);\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // sequence flows\n  if (is(businessObject, 'bpmn:SequenceFlow')) {\n    return this._createSequenceFlowEntries(element, replaceOptions.SEQUENCE_FLOW);\n  }\n\n  // flow nodes\n  if (is(businessObject, 'bpmn:FlowNode')) {\n    entries = filter(replaceOptions.TASK, differentType);\n\n    // collapsed SubProcess can not be replaced with itself\n    if (is(businessObject, 'bpmn:SubProcess') && !isExpanded(businessObject)) {\n      entries = filter(entries, function(entry) {\n        return entry.label !== 'Sub Process (collapsed)';\n      });\n    }\n\n    return this._createEntries(element, entries);\n  }\n\n  return [];\n};\n\n\n/**\n * Get a list of header items for the given element. This includes buttons\n * for multi instance markers and for the ad hoc marker.\n *\n * @param {djs.model.Base} element\n *\n * @return {Array<Object>} a list of menu entry items\n */\nReplaceMenuProvider.prototype.getHeaderEntries = function(element) {\n\n  var headerEntries = [];\n\n  if (is(element, 'bpmn:Activity') && !isEventSubProcess(element)) {\n    headerEntries = headerEntries.concat(this._getLoopEntries(element));\n  }\n\n  if (is(element, 'bpmn:SubProcess') &&\n      !is(element, 'bpmn:Transaction') &&\n      !isEventSubProcess(element)) {\n    headerEntries.push(this._getAdHocEntry(element));\n  }\n\n  return headerEntries;\n};\n\n\n/**\n * Creates an array of menu entry objects for a given element and filters the replaceOptions\n * according to a filter function.\n *\n * @param  {djs.model.Base} element\n * @param  {Object} replaceOptions\n *\n * @return {Array<Object>} a list of menu items\n */\nReplaceMenuProvider.prototype._createEntries = function(element, replaceOptions) {\n  var menuEntries = [];\n\n  var self = this;\n\n  forEach(replaceOptions, function(definition) {\n    var entry = self._createMenuEntry(definition, element);\n\n    menuEntries.push(entry);\n  });\n\n  return menuEntries;\n};\n\n/**\n * Creates an array of menu entry objects for a given sequence flow.\n *\n * @param  {djs.model.Base} element\n * @param  {Object} replaceOptions\n\n * @return {Array<Object>} a list of menu items\n */\nReplaceMenuProvider.prototype._createSequenceFlowEntries = function(element, replaceOptions) {\n\n  var businessObject = getBusinessObject(element);\n\n  var menuEntries = [];\n\n  var modeling = this._modeling,\n      moddle = this._moddle;\n\n  var self = this;\n\n  forEach(replaceOptions, function(entry) {\n\n    switch (entry.actionName) {\n    case 'replace-with-default-flow':\n      if (businessObject.sourceRef.default !== businessObject &&\n            (is(businessObject.sourceRef, 'bpmn:ExclusiveGateway') ||\n             is(businessObject.sourceRef, 'bpmn:InclusiveGateway') ||\n             is(businessObject.sourceRef, 'bpmn:ComplexGateway') ||\n             is(businessObject.sourceRef, 'bpmn:Activity'))) {\n\n        menuEntries.push(self._createMenuEntry(entry, element, function() {\n          modeling.updateProperties(element.source, { default: businessObject });\n        }));\n      }\n      break;\n    case 'replace-with-conditional-flow':\n      if (!businessObject.conditionExpression && is(businessObject.sourceRef, 'bpmn:Activity')) {\n\n        menuEntries.push(self._createMenuEntry(entry, element, function() {\n          var conditionExpression = moddle.create('bpmn:FormalExpression', { body: '' });\n\n          modeling.updateProperties(element, { conditionExpression: conditionExpression });\n        }));\n      }\n      break;\n    default:\n\n      // default flows\n      if (is(businessObject.sourceRef, 'bpmn:Activity') && businessObject.conditionExpression) {\n        return menuEntries.push(self._createMenuEntry(entry, element, function() {\n          modeling.updateProperties(element, { conditionExpression: undefined });\n        }));\n      }\n\n      // conditional flows\n      if ((is(businessObject.sourceRef, 'bpmn:ExclusiveGateway') ||\n           is(businessObject.sourceRef, 'bpmn:InclusiveGateway') ||\n           is(businessObject.sourceRef, 'bpmn:ComplexGateway') ||\n           is(businessObject.sourceRef, 'bpmn:Activity')) &&\n           businessObject.sourceRef.default === businessObject) {\n\n        return menuEntries.push(self._createMenuEntry(entry, element, function() {\n          modeling.updateProperties(element.source, { default: undefined });\n        }));\n      }\n    }\n  });\n\n  return menuEntries;\n};\n\n\n/**\n * Creates and returns a single menu entry item.\n *\n * @param  {Object} definition a single replace options definition object\n * @param  {djs.model.Base} element\n * @param  {Function} [action] an action callback function which gets called when\n *                             the menu entry is being triggered.\n *\n * @return {Object} menu entry item\n */\nReplaceMenuProvider.prototype._createMenuEntry = function(definition, element, action) {\n  var translate = this._translate;\n  var replaceElement = this._bpmnReplace.replaceElement;\n\n  var replaceAction = function() {\n    return replaceElement(element, definition.target);\n  };\n\n  action = action || replaceAction;\n\n  var menuEntry = {\n    label: translate(definition.label),\n    className: definition.className,\n    id: definition.actionName,\n    action: action\n  };\n\n  return menuEntry;\n};\n\n/**\n * Get a list of menu items containing buttons for multi instance markers\n *\n * @param  {djs.model.Base} element\n *\n * @return {Array<Object>} a list of menu items\n */\nReplaceMenuProvider.prototype._getLoopEntries = function(element) {\n\n  var self = this;\n  var translate = this._translate;\n\n  function toggleLoopEntry(event, entry) {\n    var loopCharacteristics;\n\n    if (entry.active) {\n      loopCharacteristics = undefined;\n    } else {\n      loopCharacteristics = self._moddle.create(entry.options.loopCharacteristics);\n\n      if (entry.options.isSequential) {\n        loopCharacteristics.isSequential = entry.options.isSequential;\n      }\n    }\n    self._modeling.updateProperties(element, { loopCharacteristics: loopCharacteristics });\n  }\n\n  var businessObject = getBusinessObject(element),\n      loopCharacteristics = businessObject.loopCharacteristics;\n\n  var isSequential,\n      isLoop,\n      isParallel;\n\n  if (loopCharacteristics) {\n    isSequential = loopCharacteristics.isSequential;\n    isLoop = loopCharacteristics.isSequential === undefined;\n    isParallel = loopCharacteristics.isSequential !== undefined && !loopCharacteristics.isSequential;\n  }\n\n\n  var loopEntries = [\n    {\n      id: 'toggle-parallel-mi',\n      className: 'bpmn-icon-parallel-mi-marker',\n      title: translate('Parallel Multi Instance'),\n      active: isParallel,\n      action: toggleLoopEntry,\n      options: {\n        loopCharacteristics: 'bpmn:MultiInstanceLoopCharacteristics',\n        isSequential: false\n      }\n    },\n    {\n      id: 'toggle-sequential-mi',\n      className: 'bpmn-icon-sequential-mi-marker',\n      title: translate('Sequential Multi Instance'),\n      active: isSequential,\n      action: toggleLoopEntry,\n      options: {\n        loopCharacteristics: 'bpmn:MultiInstanceLoopCharacteristics',\n        isSequential: true\n      }\n    },\n    {\n      id: 'toggle-loop',\n      className: 'bpmn-icon-loop-marker',\n      title: translate('Loop'),\n      active: isLoop,\n      action: toggleLoopEntry,\n      options: {\n        loopCharacteristics: 'bpmn:StandardLoopCharacteristics'\n      }\n    }\n  ];\n  return loopEntries;\n};\n\n\n/**\n * Get the menu items containing a button for the ad hoc marker\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} a menu item\n */\nReplaceMenuProvider.prototype._getAdHocEntry = function(element) {\n  var translate = this._translate;\n  var businessObject = getBusinessObject(element);\n\n  var isAdHoc = is(businessObject, 'bpmn:AdHocSubProcess');\n\n  var replaceElement = this._bpmnReplace.replaceElement;\n\n  var adHocEntry = {\n    id: 'toggle-adhoc',\n    className: 'bpmn-icon-ad-hoc-marker',\n    title: translate('Ad-hoc'),\n    active: isAdHoc,\n    action: function(event, entry) {\n      if (isAdHoc) {\n        return replaceElement(element, { type: 'bpmn:SubProcess' }, {\n          autoResize: false,\n          layoutConnection: false\n        });\n      } else {\n        return replaceElement(element, { type: 'bpmn:AdHocSubProcess' }, {\n          autoResize: false,\n          layoutConnection: false\n        });\n      }\n    }\n  };\n\n  return adHocEntry;\n};\n","import PopupMenuModule from 'diagram-js/lib/features/popup-menu';\nimport ReplaceModule from '../replace';\n\nimport ReplaceMenuProvider from './ReplaceMenuProvider';\n\n\nexport default {\n  __depends__: [\n    PopupMenuModule,\n    ReplaceModule\n  ],\n  __init__: [ 'replaceMenuProvider' ],\n  replaceMenuProvider: [ 'type', ReplaceMenuProvider ]\n};","import {\n  filter,\n  isNumber\n} from 'min-dash';\n\nvar max = Math.max,\n    min = Math.min;\n\nvar DEFAULT_CHILD_BOX_PADDING = 20;\n\nimport {\n  getBBox\n} from '../../util/Elements';\n\nimport {\n  asTRBL,\n  asBounds\n} from '../../layout/LayoutUtil';\n\n\n/**\n * Substract a TRBL from another\n *\n * @param  {TRBL} trblA\n * @param  {TRBL} trblB\n *\n * @return {TRBL}\n */\nexport function substractTRBL(trblA, trblB) {\n  return {\n    top: trblA.top - trblB.top,\n    right: trblA.right - trblB.right,\n    bottom: trblA.bottom - trblB.bottom,\n    left: trblA.left - trblB.left\n  };\n}\n\n/**\n * Resize the given bounds by the specified delta from a given anchor point.\n *\n * @param {Bounds} bounds the bounding box that should be resized\n * @param {String} direction in which the element is resized (nw, ne, se, sw)\n * @param {Point} delta of the resize operation\n *\n * @return {Bounds} resized bounding box\n */\nexport function resizeBounds(bounds, direction, delta) {\n  var dx = delta.x,\n      dy = delta.y;\n\n  var newBounds = {\n    x: bounds.x,\n    y: bounds.y,\n    width: bounds.width,\n    height: bounds.height\n  };\n\n  if (direction.indexOf('n') !== -1) {\n    newBounds.y = bounds.y + dy;\n    newBounds.height = bounds.height - dy;\n  } else if (direction.indexOf('s') !== -1) {\n    newBounds.height = bounds.height + dy;\n  }\n\n  if (direction.indexOf('e') !== -1) {\n    newBounds.width = bounds.width + dx;\n  } else if (direction.indexOf('w') !== -1) {\n    newBounds.x = bounds.x + dx;\n    newBounds.width = bounds.width - dx;\n  }\n\n  return newBounds;\n}\n\n\n/**\n * Resize the given bounds by applying the passed\n * { top, right, bottom, left } delta.\n *\n * @param {Bounds} bounds\n * @param {TRBL} trblResize\n *\n * @return {Bounds}\n */\nexport function resizeTRBL(bounds, resize) {\n  return {\n    x: bounds.x + (resize.left || 0),\n    y: bounds.y + (resize.top || 0),\n    width: bounds.width - (resize.left || 0) + (resize.right || 0),\n    height: bounds.height - (resize.top || 0) + (resize.bottom || 0)\n  };\n}\n\n\nexport function reattachPoint(bounds, newBounds, point) {\n\n  var sx = bounds.width / newBounds.width,\n      sy = bounds.height / newBounds.height;\n\n  return {\n    x: Math.round((newBounds.x + newBounds.width / 2)) - Math.floor(((bounds.x + bounds.width / 2) - point.x) / sx),\n    y: Math.round((newBounds.y + newBounds.height / 2)) - Math.floor(((bounds.y + bounds.height / 2) - point.y) / sy)\n  };\n}\n\n\nfunction applyConstraints(attr, trbl, resizeConstraints) {\n\n  var value = trbl[attr],\n      minValue = resizeConstraints.min && resizeConstraints.min[attr],\n      maxValue = resizeConstraints.max && resizeConstraints.max[attr];\n\n  if (isNumber(minValue)) {\n    value = (/top|left/.test(attr) ? min : max)(value, minValue);\n  }\n\n  if (isNumber(maxValue)) {\n    value = (/top|left/.test(attr) ? max : min)(value, maxValue);\n  }\n\n  return value;\n}\n\nexport function ensureConstraints(currentBounds, resizeConstraints) {\n\n  if (!resizeConstraints) {\n    return currentBounds;\n  }\n\n  var currentTrbl = asTRBL(currentBounds);\n\n  return asBounds({\n    top: applyConstraints('top', currentTrbl, resizeConstraints),\n    right: applyConstraints('right', currentTrbl, resizeConstraints),\n    bottom: applyConstraints('bottom', currentTrbl, resizeConstraints),\n    left: applyConstraints('left', currentTrbl, resizeConstraints)\n  });\n}\n\n\nexport function getMinResizeBounds(direction, currentBounds, minDimensions, childrenBounds) {\n\n  var currentBox = asTRBL(currentBounds);\n\n  var minBox = {\n    top: /n/.test(direction) ? currentBox.bottom - minDimensions.height : currentBox.top,\n    left: /w/.test(direction) ? currentBox.right - minDimensions.width : currentBox.left,\n    bottom: /s/.test(direction) ? currentBox.top + minDimensions.height : currentBox.bottom,\n    right: /e/.test(direction) ? currentBox.left + minDimensions.width : currentBox.right\n  };\n\n  var childrenBox = childrenBounds ? asTRBL(childrenBounds) : minBox;\n\n  var combinedBox = {\n    top: min(minBox.top, childrenBox.top),\n    left: min(minBox.left, childrenBox.left),\n    bottom: max(minBox.bottom, childrenBox.bottom),\n    right: max(minBox.right, childrenBox.right)\n  };\n\n  return asBounds(combinedBox);\n}\n\nfunction asPadding(mayBePadding, defaultValue) {\n  if (typeof mayBePadding !== 'undefined') {\n    return mayBePadding;\n  } else {\n    return DEFAULT_CHILD_BOX_PADDING;\n  }\n}\n\nexport function addPadding(bbox, padding) {\n  var left, right, top, bottom;\n\n  if (typeof padding === 'object') {\n    left = asPadding(padding.left);\n    right = asPadding(padding.right);\n    top = asPadding(padding.top);\n    bottom = asPadding(padding.bottom);\n  } else {\n    left = right = top = bottom = asPadding(padding);\n  }\n\n  return {\n    x: bbox.x - left,\n    y: bbox.y - top,\n    width: bbox.width + left + right,\n    height: bbox.height + top + bottom\n  };\n}\n\n\n/**\n * Is the given element part of the resize\n * targets min boundary box?\n *\n * This is the default implementation which excludes\n * connections and labels.\n *\n * @param {djs.model.Base} element\n */\nfunction isBBoxChild(element) {\n\n  // exclude connections\n  if (element.waypoints) {\n    return false;\n  }\n\n  // exclude labels\n  if (element.type === 'label') {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Return children bounding computed from a shapes children\n * or a list of prefiltered children.\n *\n * @param  {djs.model.Shape|Array<djs.model.Shape>} shapeOrChildren\n * @param  {Number|Object} padding\n *\n * @return {Bounds}\n */\nexport function computeChildrenBBox(shapeOrChildren, padding) {\n\n  var elements;\n\n  // compute based on shape\n  if (shapeOrChildren.length === undefined) {\n\n    // grab all the children that are part of the\n    // parents children box\n    elements = filter(shapeOrChildren.children, isBBoxChild);\n\n  } else {\n    elements = shapeOrChildren;\n  }\n\n  if (elements.length) {\n    return addPadding(getBBox(elements), padding);\n  }\n}\n","import { is } from '../../../util/ModelUtil';\n\nimport {\n  getParent\n} from './ModelingUtil';\n\nimport {\n  asTRBL\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  substractTRBL,\n  resizeTRBL\n} from 'diagram-js/lib/features/resize/ResizeUtil';\n\nvar abs = Math.abs;\n\n\nfunction getTRBLResize(oldBounds, newBounds) {\n  return substractTRBL(asTRBL(newBounds), asTRBL(oldBounds));\n}\n\n\nvar LANE_PARENTS = [\n  'bpmn:Participant',\n  'bpmn:Process',\n  'bpmn:SubProcess'\n];\n\nexport var LANE_INDENTATION = 30;\n\n\n/**\n * Collect all lane shapes in the given paren\n *\n * @param  {djs.model.Shape} shape\n * @param  {Array<djs.model.Base>} [collectedShapes]\n *\n * @return {Array<djs.model.Base>}\n */\nexport function collectLanes(shape, collectedShapes) {\n\n  collectedShapes = collectedShapes || [];\n\n  shape.children.filter(function(s) {\n    if (is(s, 'bpmn:Lane')) {\n      collectLanes(s, collectedShapes);\n\n      collectedShapes.push(s);\n    }\n  });\n\n  return collectedShapes;\n}\n\n\n/**\n * Return the lane children of the given element.\n *\n * @param {djs.model.Shape} shape\n *\n * @return {Array<djs.model.Shape>}\n */\nexport function getChildLanes(shape) {\n  return shape.children.filter(function(c) {\n    return is(c, 'bpmn:Lane');\n  });\n}\n\n\n/**\n * Return the root element containing the given lane shape\n *\n * @param {djs.model.Shape} shape\n *\n * @return {djs.model.Shape}\n */\nexport function getLanesRoot(shape) {\n  return getParent(shape, LANE_PARENTS) || shape;\n}\n\n\n/**\n * Compute the required resize operations for lanes\n * adjacent to the given shape, assuming it will be\n * resized to the given new bounds.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n *\n * @return {Array<Object>}\n */\nexport function computeLanesResize(shape, newBounds) {\n\n  var rootElement = getLanesRoot(shape);\n\n  var initialShapes = is(rootElement, 'bpmn:Process') ? [] : [ rootElement ];\n\n  var allLanes = collectLanes(rootElement, initialShapes),\n      shapeTrbl = asTRBL(shape),\n      shapeNewTrbl = asTRBL(newBounds),\n      trblResize = getTRBLResize(shape, newBounds),\n      resizeNeeded = [];\n\n  allLanes.forEach(function(other) {\n\n    if (other === shape) {\n      return;\n    }\n\n    var topResize = 0,\n        rightResize = trblResize.right,\n        bottomResize = 0,\n        leftResize = trblResize.left;\n\n    var otherTrbl = asTRBL(other);\n\n    if (trblResize.top) {\n      if (abs(otherTrbl.bottom - shapeTrbl.top) < 10) {\n        bottomResize = shapeNewTrbl.top - otherTrbl.bottom;\n      }\n\n      if (abs(otherTrbl.top - shapeTrbl.top) < 5) {\n        topResize = shapeNewTrbl.top - otherTrbl.top;\n      }\n    }\n\n    if (trblResize.bottom) {\n      if (abs(otherTrbl.top - shapeTrbl.bottom) < 10) {\n        topResize = shapeNewTrbl.bottom - otherTrbl.top;\n      }\n\n      if (abs(otherTrbl.bottom - shapeTrbl.bottom) < 5) {\n        bottomResize = shapeNewTrbl.bottom - otherTrbl.bottom;\n      }\n    }\n\n    if (topResize || rightResize || bottomResize || leftResize) {\n\n      resizeNeeded.push({\n        shape: other,\n        newBounds: resizeTRBL(other, {\n          top: topResize,\n          right: rightResize,\n          bottom: bottomResize,\n          left: leftResize\n        })\n      });\n    }\n\n  });\n\n  return resizeNeeded;\n}","import {\n  assign,\n  forEach,\n  isArray\n} from 'min-dash';\n\nimport {\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  isExpanded,\n  isEventSubProcess\n} from '../../util/DiUtil';\n\nimport {\n  isAny\n} from '../modeling/util/ModelingUtil';\n\nimport {\n  getChildLanes\n} from '../modeling/util/LaneUtil';\n\nimport {\n  hasPrimaryModifier\n} from 'diagram-js/lib/util/Mouse';\n\n\n/**\n * A provider for BPMN 2.0 elements context pad\n */\nexport default function ContextPadProvider(\n    config, injector, eventBus,\n    contextPad, modeling, elementFactory,\n    connect, create, popupMenu,\n    canvas, rules, translate) {\n\n  config = config || {};\n\n  contextPad.registerProvider(this);\n\n  this._contextPad = contextPad;\n\n  this._modeling = modeling;\n\n  this._elementFactory = elementFactory;\n  this._connect = connect;\n  this._create = create;\n  this._popupMenu = popupMenu;\n  this._canvas = canvas;\n  this._rules = rules;\n  this._translate = translate;\n\n  if (config.autoPlace !== false) {\n    this._autoPlace = injector.get('autoPlace', false);\n  }\n\n  eventBus.on('create.end', 250, function(event) {\n    var context = event.context,\n        shape = context.shape;\n\n    if (!hasPrimaryModifier(event) || !contextPad.isOpen(shape)) {\n      return;\n    }\n\n    var entries = contextPad.getEntries(shape);\n\n    if (entries.replace) {\n      entries.replace.action.click(event, shape);\n    }\n  });\n}\n\nContextPadProvider.$inject = [\n  'config.contextPad',\n  'injector',\n  'eventBus',\n  'contextPad',\n  'modeling',\n  'elementFactory',\n  'connect',\n  'create',\n  'popupMenu',\n  'canvas',\n  'rules',\n  'translate'\n];\n\n\nContextPadProvider.prototype.getContextPadEntries = function(element) {\n\n  var contextPad = this._contextPad,\n      modeling = this._modeling,\n\n      elementFactory = this._elementFactory,\n      connect = this._connect,\n      create = this._create,\n      popupMenu = this._popupMenu,\n      canvas = this._canvas,\n      rules = this._rules,\n      autoPlace = this._autoPlace,\n      translate = this._translate;\n\n  var actions = {};\n\n  if (element.type === 'label') {\n    return actions;\n  }\n\n  var businessObject = element.businessObject;\n\n  function startConnect(event, element) {\n    connect.start(event, element);\n  }\n\n  function removeElement(e) {\n    modeling.removeElements([ element ]);\n  }\n\n  function getReplaceMenuPosition(element) {\n\n    var Y_OFFSET = 5;\n\n    var diagramContainer = canvas.getContainer(),\n        pad = contextPad.getPad(element).html;\n\n    var diagramRect = diagramContainer.getBoundingClientRect(),\n        padRect = pad.getBoundingClientRect();\n\n    var top = padRect.top - diagramRect.top;\n    var left = padRect.left - diagramRect.left;\n\n    var pos = {\n      x: left,\n      y: top + padRect.height + Y_OFFSET\n    };\n\n    return pos;\n  }\n\n\n  /**\n   * Create an append action\n   *\n   * @param {String} type\n   * @param {String} className\n   * @param {String} [title]\n   * @param {Object} [options]\n   *\n   * @return {Object} descriptor\n   */\n  function appendAction(type, className, title, options) {\n\n    if (typeof title !== 'string') {\n      options = title;\n      title = translate('Append {type}', { type: type.replace(/^bpmn:/, '') });\n    }\n\n    function appendStart(event, element) {\n\n      var shape = elementFactory.createShape(assign({ type: type }, options));\n      create.start(event, shape, {\n        source: element\n      });\n    }\n\n\n    var append = autoPlace ? function(event, element) {\n      var shape = elementFactory.createShape(assign({ type: type }, options));\n\n      autoPlace.append(element, shape);\n    } : appendStart;\n\n\n    return {\n      group: 'model',\n      className: className,\n      title: title,\n      action: {\n        dragstart: appendStart,\n        click: append\n      }\n    };\n  }\n\n  function splitLaneHandler(count) {\n\n    return function(event, element) {\n\n      // actual split\n      modeling.splitLane(element, count);\n\n      // refresh context pad after split to\n      // get rid of split icons\n      contextPad.open(element, true);\n    };\n  }\n\n\n  if (isAny(businessObject, [ 'bpmn:Lane', 'bpmn:Participant' ]) && isExpanded(businessObject)) {\n\n    var childLanes = getChildLanes(element);\n\n    assign(actions, {\n      'lane-insert-above': {\n        group: 'lane-insert-above',\n        className: 'bpmn-icon-lane-insert-above',\n        title: translate('Add Lane above'),\n        action: {\n          click: function(event, element) {\n            modeling.addLane(element, 'top');\n          }\n        }\n      }\n    });\n\n    if (childLanes.length < 2) {\n\n      if (element.height >= 120) {\n        assign(actions, {\n          'lane-divide-two': {\n            group: 'lane-divide',\n            className: 'bpmn-icon-lane-divide-two',\n            title: translate('Divide into two Lanes'),\n            action: {\n              click: splitLaneHandler(2)\n            }\n          }\n        });\n      }\n\n      if (element.height >= 180) {\n        assign(actions, {\n          'lane-divide-three': {\n            group: 'lane-divide',\n            className: 'bpmn-icon-lane-divide-three',\n            title: translate('Divide into three Lanes'),\n            action: {\n              click: splitLaneHandler(3)\n            }\n          }\n        });\n      }\n    }\n\n    assign(actions, {\n      'lane-insert-below': {\n        group: 'lane-insert-below',\n        className: 'bpmn-icon-lane-insert-below',\n        title: translate('Add Lane below'),\n        action: {\n          click: function(event, element) {\n            modeling.addLane(element, 'bottom');\n          }\n        }\n      }\n    });\n\n  }\n\n  if (is(businessObject, 'bpmn:FlowNode')) {\n\n    if (is(businessObject, 'bpmn:EventBasedGateway')) {\n\n      assign(actions, {\n        'append.receive-task': appendAction(\n          'bpmn:ReceiveTask',\n          'bpmn-icon-receive-task',\n          translate('Append ReceiveTask')\n        ),\n        'append.message-intermediate-event': appendAction(\n          'bpmn:IntermediateCatchEvent',\n          'bpmn-icon-intermediate-event-catch-message',\n          translate('Append MessageIntermediateCatchEvent'),\n          { eventDefinitionType: 'bpmn:MessageEventDefinition' }\n        ),\n        'append.timer-intermediate-event': appendAction(\n          'bpmn:IntermediateCatchEvent',\n          'bpmn-icon-intermediate-event-catch-timer',\n          translate('Append TimerIntermediateCatchEvent'),\n          { eventDefinitionType: 'bpmn:TimerEventDefinition' }\n        ),\n        'append.condition-intermediate-event': appendAction(\n          'bpmn:IntermediateCatchEvent',\n          'bpmn-icon-intermediate-event-catch-condition',\n          translate('Append ConditionIntermediateCatchEvent'),\n          { eventDefinitionType: 'bpmn:ConditionalEventDefinition' }\n        ),\n        'append.signal-intermediate-event': appendAction(\n          'bpmn:IntermediateCatchEvent',\n          'bpmn-icon-intermediate-event-catch-signal',\n          translate('Append SignalIntermediateCatchEvent'),\n          { eventDefinitionType: 'bpmn:SignalEventDefinition' }\n        )\n      });\n    } else\n\n    if (isEventType(businessObject, 'bpmn:BoundaryEvent', 'bpmn:CompensateEventDefinition')) {\n\n      assign(actions, {\n        'append.compensation-activity':\n            appendAction(\n              'bpmn:Task',\n              'bpmn-icon-task',\n              translate('Append compensation activity'),\n              {\n                isForCompensation: true\n              }\n            )\n      });\n    } else\n\n    if (!is(businessObject, 'bpmn:EndEvent') &&\n        !businessObject.isForCompensation &&\n        !isEventType(businessObject, 'bpmn:IntermediateThrowEvent', 'bpmn:LinkEventDefinition') &&\n        !isEventSubProcess(businessObject)) {\n\n      assign(actions, {\n        'append.end-event': appendAction(\n          'bpmn:EndEvent',\n          'bpmn-icon-end-event-none',\n          translate('Append EndEvent')\n        ),\n        'append.gateway': appendAction(\n          'bpmn:ExclusiveGateway',\n          'bpmn-icon-gateway-none',\n          translate('Append Gateway')\n        ),\n        'append.append-task': appendAction(\n          'bpmn:Task',\n          'bpmn-icon-task',\n          translate('Append Task')\n        ),\n        'append.intermediate-event': appendAction(\n          'bpmn:IntermediateThrowEvent',\n          'bpmn-icon-intermediate-event-none',\n          translate('Append Intermediate/Boundary Event')\n        )\n      });\n    }\n  }\n\n  if (!popupMenu.isEmpty(element, 'bpmn-replace')) {\n\n    // Replace menu entry\n    assign(actions, {\n      'replace': {\n        group: 'edit',\n        className: 'bpmn-icon-screw-wrench',\n        title: translate('Change type'),\n        action: {\n          click: function(event, element) {\n\n            var position = assign(getReplaceMenuPosition(element), {\n              cursor: { x: event.x, y: event.y }\n            });\n\n            popupMenu.open(element, 'bpmn-replace', position);\n          }\n        }\n      }\n    });\n  }\n\n  if (isAny(businessObject, [\n    'bpmn:FlowNode',\n    'bpmn:InteractionNode',\n    'bpmn:DataObjectReference',\n    'bpmn:DataStoreReference'\n  ])) {\n\n    assign(actions, {\n      'append.text-annotation': appendAction('bpmn:TextAnnotation', 'bpmn-icon-text-annotation'),\n\n      'connect': {\n        group: 'connect',\n        className: 'bpmn-icon-connection-multi',\n        title: translate('Connect using ' +\n                  (businessObject.isForCompensation ? '' : 'Sequence/MessageFlow or ') +\n                  'Association'),\n        action: {\n          click: startConnect,\n          dragstart: startConnect\n        }\n      }\n    });\n  }\n\n  if (isAny(businessObject, [ 'bpmn:DataObjectReference', 'bpmn:DataStoreReference' ])) {\n    assign(actions, {\n      'connect': {\n        group: 'connect',\n        className: 'bpmn-icon-connection-multi',\n        title: translate('Connect using DataInputAssociation'),\n        action: {\n          click: startConnect,\n          dragstart: startConnect\n        }\n      }\n    });\n  }\n\n  // delete element entry, only show if allowed by rules\n  var deleteAllowed = rules.allowed('elements.delete', { elements: [ element ] });\n\n  if (isArray(deleteAllowed)) {\n\n    // was the element returned as a deletion candidate?\n    deleteAllowed = deleteAllowed[0] === element;\n  }\n\n  if (deleteAllowed) {\n    assign(actions, {\n      'delete': {\n        group: 'edit',\n        className: 'bpmn-icon-trash',\n        title: translate('Remove'),\n        action: {\n          click: removeElement\n        }\n      }\n    });\n  }\n\n  return actions;\n};\n\n\n// helpers /////////\n\nfunction isEventType(eventBo, type, definition) {\n\n  var isType = eventBo.$instanceOf(type);\n  var isDefinition = false;\n\n  var definitions = eventBo.eventDefinitions || [];\n  forEach(definitions, function(def) {\n    if (def.$type === definition) {\n      isDefinition = true;\n    }\n  });\n\n  return isType && isDefinition;\n}\n","import DirectEditingModule from 'diagram-js-direct-editing';\nimport ContextPadModule from 'diagram-js/lib/features/context-pad';\nimport SelectionModule from 'diagram-js/lib/features/selection';\nimport ConnectModule from 'diagram-js/lib/features/connect';\nimport CreateModule from 'diagram-js/lib/features/create';\nimport PopupMenuModule from '../popup-menu';\n\nimport ContextPadProvider from './ContextPadProvider';\n\nexport default {\n  __depends__: [\n    DirectEditingModule,\n    ContextPadModule,\n    SelectionModule,\n    ConnectModule,\n    CreateModule,\n    PopupMenuModule\n  ],\n  __init__: [ 'contextPadProvider' ],\n  contextPadProvider: [ 'type', ContextPadProvider ]\n};","import {\n  sortBy,\n  forEach,\n  filter\n} from 'min-dash';\n\nvar AXIS_DIMENSIONS = {\n  horizontal: [ 'x', 'width' ],\n  vertical: [ 'y', 'height' ]\n};\n\nvar THRESHOLD = 5;\n\n\n/**\n * Groups and filters elements and then trigger even distribution.\n */\nexport default function DistributeElements(modeling) {\n  this._modeling = modeling;\n\n  this._filters = [];\n\n  // register filter for filtering big elements\n  this.registerFilter(function(elements, axis, dimension) {\n    var elementsSize = 0,\n        numOfShapes = 0,\n        avgDimension;\n\n    forEach(elements, function(element) {\n      if (element.waypoints || element.labelTarget) {\n        return;\n      }\n\n      elementsSize += element[dimension];\n\n      numOfShapes += 1;\n    });\n\n    avgDimension = Math.round(elementsSize / numOfShapes);\n\n    return filter(elements, function(element) {\n      return element[dimension] < (avgDimension + 50);\n    });\n  });\n\n}\n\nDistributeElements.$inject = [ 'modeling' ];\n\n\n/**\n * Registers filter functions that allow external parties to filter\n * out certain elements.\n *\n * @param  {Function} filterFn\n */\nDistributeElements.prototype.registerFilter = function(filterFn) {\n  if (typeof filterFn !== 'function') {\n    throw new Error('the filter has to be a function');\n  }\n\n  this._filters.push(filterFn);\n};\n\n/**\n * Distributes the elements with a given orientation\n *\n * @param  {Array} elements    [description]\n * @param  {String} orientation [description]\n */\nDistributeElements.prototype.trigger = function(elements, orientation) {\n  var modeling = this._modeling;\n\n  var groups,\n      distributableElements;\n\n  if (elements.length < 3) {\n    return;\n  }\n\n  this._setOrientation(orientation);\n\n  distributableElements = this._filterElements(elements);\n\n  groups = this._createGroups(distributableElements);\n\n  // nothing to distribute\n  if (groups.length <= 2) {\n    return;\n  }\n\n  modeling.distributeElements(groups, this._axis, this._dimension);\n\n  return groups;\n};\n\n/**\n * Filters the elements with provided filters by external parties\n *\n * @param  {Array[Elements]} elements\n *\n * @return {Array[Elements]}\n */\nDistributeElements.prototype._filterElements = function(elements) {\n  var filters = this._filters,\n      axis = this._axis,\n      dimension = this._dimension,\n      distributableElements = [].concat(elements);\n\n  if (!filters.length) {\n    return elements;\n  }\n\n  forEach(filters, function(filterFn) {\n    distributableElements = filterFn(distributableElements, axis, dimension);\n  });\n\n  return distributableElements;\n};\n\n\n/**\n * Create range (min, max) groups. Also tries to group elements\n * together that share the same range.\n *\n * @example\n * \tvar distributableElements = [\n * \t\t{\n * \t\t\trange: {\n * \t\t\t\tmin: 100,\n * \t\t\t\tmax: 200\n * \t\t\t},\n * \t\t\telements: [ { id: 'shape1', .. }]\n * \t\t}\n * \t]\n *\n * @param  {Array} elements\n *\n * @return {Array[Objects]}\n */\nDistributeElements.prototype._createGroups = function(elements) {\n  var rangeGroups = [],\n      self = this,\n      axis = this._axis,\n      dimension = this._dimension;\n\n  if (!axis) {\n    throw new Error('must have a defined \"axis\" and \"dimension\"');\n  }\n\n  // sort by 'left->right' or 'top->bottom'\n  var sortedElements = sortBy(elements, axis);\n\n  forEach(sortedElements, function(element, idx) {\n    var elementRange = self._findRange(element, axis, dimension),\n        range;\n\n    var previous = rangeGroups[rangeGroups.length - 1];\n\n    if (previous && self._hasIntersection(previous.range, elementRange)) {\n      rangeGroups[rangeGroups.length - 1].elements.push(element);\n    } else {\n      range = { range: elementRange, elements: [ element ] };\n\n      rangeGroups.push(range);\n    }\n  });\n\n  return rangeGroups;\n};\n\n\n/**\n * Maps a direction to the according axis and dimension\n *\n * @param  {String} direction 'horizontal' or 'vertical'\n */\nDistributeElements.prototype._setOrientation = function(direction) {\n  var orientation = AXIS_DIMENSIONS[direction];\n\n  this._axis = orientation[0];\n  this._dimension = orientation[1];\n};\n\n\n/**\n * Checks if the two ranges intercept each other\n *\n * @param  {Object} rangeA {min, max}\n * @param  {Object} rangeB {min, max}\n *\n * @return {Boolean}\n */\nDistributeElements.prototype._hasIntersection = function(rangeA, rangeB) {\n  return Math.max(rangeA.min, rangeA.max) >= Math.min(rangeB.min, rangeB.max) &&\n         Math.min(rangeA.min, rangeA.max) <= Math.max(rangeB.min, rangeB.max);\n};\n\n\n/**\n * Returns the min and max values for an element\n *\n * @param  {[type]} element   [description]\n * @param  {[type]} axis      [description]\n * @param  {[type]} dimension [description]\n *\n * @return {[type]}           [description]\n */\nDistributeElements.prototype._findRange = function(element) {\n  var axis = element[this._axis],\n      dimension = element[this._dimension];\n\n  return {\n    min: axis + THRESHOLD,\n    max: axis + dimension - THRESHOLD\n  };\n};\n","import DistributeElements from './DistributeElements';\n\nexport default {\n  __init__: [ 'distributeElements' ],\n  distributeElements: [ 'type', DistributeElements ]\n};\n","import {\n  filter\n} from 'min-dash';\n\nimport {\n  isAny\n} from '../modeling/util/ModelingUtil';\n\n\n/**\n * Registers element exclude filters for elements that\n * currently do not support distribution.\n */\nexport default function BpmnDistributeElements(distributeElements) {\n\n  distributeElements.registerFilter(function(elements) {\n    return filter(elements, function(element) {\n      var cannotDistribute = isAny(element, [\n        'bpmn:Association',\n        'bpmn:BoundaryEvent',\n        'bpmn:DataInputAssociation',\n        'bpmn:DataOutputAssociation',\n        'bpmn:Lane',\n        'bpmn:MessageFlow',\n        'bpmn:Participant',\n        'bpmn:SequenceFlow',\n        'bpmn:TextAnnotation'\n      ]);\n\n      return !(element.labelTarget || cannotDistribute);\n    });\n  });\n}\n\nBpmnDistributeElements.$inject = [ 'distributeElements' ];","import DistributeElementsModule from 'diagram-js/lib/features/distribute-elements';\n\nimport BpmnDistributeElements from './BpmnDistributeElements';\n\n\nexport default {\n  __depends__: [\n    DistributeElementsModule\n  ],\n  __init__: [ 'bpmnDistributeElements' ],\n  bpmnDistributeElements: [ 'type', BpmnDistributeElements ]\n};\n","import {\n  forEach,\n  isArray\n} from 'min-dash';\n\nvar NOT_REGISTERED_ERROR = 'is not a registered action',\n    IS_REGISTERED_ERROR = 'is already registered';\n\n\n/**\n * An interface that provides access to modeling actions by decoupling\n * the one who requests the action to be triggered and the trigger itself.\n *\n * It's possible to add new actions by registering them with ´registerAction´\n * and likewise unregister existing ones with ´unregisterAction´.\n *\n *\n * ## Life-Cycle and configuration\n *\n * The editor actions will wait for diagram initialization before\n * registering default actions _and_ firing an `editorActions.init` event.\n *\n * Interested parties may listen to the `editorActions.init` event with\n * low priority to check, which actions got registered. Other components\n * may use the event to register their own actions via `registerAction`.\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function EditorActions(eventBus, injector) {\n\n  // initialize actions\n  this._actions = {};\n\n  var self = this;\n\n  eventBus.on('diagram.init', function() {\n\n    // all diagram modules got loaded; check which ones\n    // are available and register the respective default actions\n    self._registerDefaultActions(injector);\n\n    // ask interested parties to register available editor\n    // actions on diagram initialization\n    eventBus.fire('editorActions.init', {\n      editorActions: self\n    });\n  });\n\n}\n\nEditorActions.$inject = [\n  'eventBus',\n  'injector'\n];\n\n/**\n * Register default actions.\n *\n * @param {Injector} injector\n */\nEditorActions.prototype._registerDefaultActions = function(injector) {\n\n  // (1) retrieve optional components to integrate with\n\n  var commandStack = injector.get('commandStack', false);\n  var modeling = injector.get('modeling', false);\n  var selection = injector.get('selection', false);\n  var zoomScroll = injector.get('zoomScroll', false);\n  var copyPaste = injector.get('copyPaste', false);\n  var canvas = injector.get('canvas', false);\n  var rules = injector.get('rules', false);\n  var keyboardMove = injector.get('keyboardMove', false);\n  var keyboardMoveSelection = injector.get('keyboardMoveSelection', false);\n\n  // (2) check components and register actions\n\n  if (commandStack) {\n    this.register('undo', function() {\n      commandStack.undo();\n    });\n\n    this.register('redo', function() {\n      commandStack.redo();\n    });\n  }\n\n  if (copyPaste && selection) {\n    this.register('copy', function() {\n      var selectedElements = selection.get();\n\n      copyPaste.copy(selectedElements);\n    });\n  }\n\n  if (copyPaste) {\n    this.register('paste', function() {\n      copyPaste.paste();\n    });\n  }\n\n  if (zoomScroll) {\n    this.register('stepZoom', function(opts) {\n      zoomScroll.stepZoom(opts.value);\n    });\n  }\n\n  if (canvas) {\n    this.register('zoom', function(opts) {\n      canvas.zoom(opts.value);\n    });\n  }\n\n  if (modeling && selection && rules) {\n    this.register('removeSelection', function() {\n\n      var selectedElements = selection.get();\n\n      if (!selectedElements.length) {\n        return;\n      }\n\n      var allowed = rules.allowed('elements.delete', { elements: selectedElements }),\n          removableElements;\n\n      if (allowed === false) {\n        return;\n      }\n      else if (isArray(allowed)) {\n        removableElements = allowed;\n      }\n      else {\n        removableElements = selectedElements;\n      }\n\n      if (removableElements.length) {\n        modeling.removeElements(removableElements.slice());\n      }\n    });\n  }\n\n  if (keyboardMove) {\n    this.register('moveCanvas', function(opts) {\n      keyboardMove.moveCanvas(opts);\n    });\n  }\n\n  if (keyboardMoveSelection) {\n    this.register('moveSelection', function(opts) {\n      keyboardMoveSelection.moveSelection(opts.direction, opts.accelerated);\n    });\n  }\n\n};\n\n\n/**\n * Triggers a registered action\n *\n * @param  {String} action\n * @param  {Object} opts\n *\n * @return {Unknown} Returns what the registered listener returns\n */\nEditorActions.prototype.trigger = function(action, opts) {\n  if (!this._actions[action]) {\n    throw error(action, NOT_REGISTERED_ERROR);\n  }\n\n  return this._actions[action](opts);\n};\n\n\n/**\n * Registers a collections of actions.\n * The key of the object will be the name of the action.\n *\n * @example\n * ´´´\n * var actions = {\n *   spaceTool: function() {\n *     spaceTool.activateSelection();\n *   },\n *   lassoTool: function() {\n *     lassoTool.activateSelection();\n *   }\n * ];\n *\n * editorActions.register(actions);\n *\n * editorActions.isRegistered('spaceTool'); // true\n * ´´´\n *\n * @param  {Object} actions\n */\nEditorActions.prototype.register = function(actions, listener) {\n  var self = this;\n\n  if (typeof actions === 'string') {\n    return this._registerAction(actions, listener);\n  }\n\n  forEach(actions, function(listener, action) {\n    self._registerAction(action, listener);\n  });\n};\n\n/**\n * Registers a listener to an action key\n *\n * @param  {String} action\n * @param  {Function} listener\n */\nEditorActions.prototype._registerAction = function(action, listener) {\n  if (this.isRegistered(action)) {\n    throw error(action, IS_REGISTERED_ERROR);\n  }\n\n  this._actions[action] = listener;\n};\n\n/**\n * Unregister an existing action\n *\n * @param {String} action\n */\nEditorActions.prototype.unregister = function(action) {\n  if (!this.isRegistered(action)) {\n    throw error(action, NOT_REGISTERED_ERROR);\n  }\n\n  this._actions[action] = undefined;\n};\n\n/**\n * Returns the number of actions that are currently registered\n *\n * @return {Number}\n */\nEditorActions.prototype.getActions = function() {\n  return Object.keys(this._actions);\n};\n\n/**\n * Checks wether the given action is registered\n *\n * @param {String} action\n *\n * @return {Boolean}\n */\nEditorActions.prototype.isRegistered = function(action) {\n  return !!this._actions[action];\n};\n\n\nfunction error(action, message) {\n  return new Error(action + ' ' + message);\n}\n","import EditorActions from './EditorActions';\n\nexport default {\n  __init__: [ 'editorActions' ],\n  editorActions: [ 'type', EditorActions ]\n};\n","import inherits from 'inherits';\n\nimport EditorActions from 'diagram-js/lib/features/editor-actions/EditorActions';\n\nimport { filter } from 'min-dash';\n\nimport { is } from '../../util/ModelUtil';\n\nimport {\n  getBBox\n} from 'diagram-js/lib/util/Elements';\n\n\n/**\n * Registers and executes BPMN specific editor actions.\n *\n * @param {Injector} injector\n */\nexport default function BpmnEditorActions(injector) {\n  injector.invoke(EditorActions, this);\n}\n\ninherits(BpmnEditorActions, EditorActions);\n\nBpmnEditorActions.$inject = [\n  'injector'\n];\n\n/**\n * Register default actions.\n *\n * @param {Injector} injector\n */\nBpmnEditorActions.prototype._registerDefaultActions = function(injector) {\n\n  // (0) invoke super method\n\n  EditorActions.prototype._registerDefaultActions.call(this, injector);\n\n  // (1) retrieve optional components to integrate with\n\n  var canvas = injector.get('canvas', false);\n  var elementRegistry = injector.get('elementRegistry', false);\n  var selection = injector.get('selection', false);\n  var spaceTool = injector.get('spaceTool', false);\n  var lassoTool = injector.get('lassoTool', false);\n  var handTool = injector.get('handTool', false);\n  var globalConnect = injector.get('globalConnect', false);\n  var distributeElements = injector.get('distributeElements', false);\n  var alignElements = injector.get('alignElements', false);\n  var directEditing = injector.get('directEditing', false);\n  var searchPad = injector.get('searchPad', false);\n  var modeling = injector.get('modeling', false);\n\n  // (2) check components and register actions\n\n  if (canvas && elementRegistry && selection) {\n    this._registerAction('selectElements', function() {\n\n      // select all elements except for the invisible\n      // root element\n      var rootElement = canvas.getRootElement();\n\n      var elements = elementRegistry.filter(function(element) {\n        return element !== rootElement;\n      });\n\n      selection.select(elements);\n\n      return elements;\n    });\n  }\n\n  if (spaceTool) {\n    this._registerAction('spaceTool', function() {\n      spaceTool.toggle();\n    });\n  }\n\n  if (lassoTool) {\n    this._registerAction('lassoTool', function() {\n      lassoTool.toggle();\n    });\n  }\n\n  if (handTool) {\n    this._registerAction('handTool', function() {\n      handTool.toggle();\n    });\n  }\n\n  if (globalConnect) {\n    this._registerAction('globalConnectTool', function() {\n      globalConnect.toggle();\n    });\n  }\n\n  if (selection && distributeElements) {\n    this._registerAction('distributeElements', function(opts) {\n      var currentSelection = selection.get(),\n          type = opts.type;\n\n      if (currentSelection.length) {\n        distributeElements.trigger(currentSelection, type);\n      }\n    });\n  }\n\n  if (selection && alignElements) {\n    this._registerAction('alignElements', function(opts) {\n      var currentSelection = selection.get(),\n          aligneableElements = [],\n          type = opts.type;\n\n      if (currentSelection.length) {\n        aligneableElements = filter(currentSelection, function(element) {\n          return !is(element, 'bpmn:Lane');\n        });\n\n        alignElements.trigger(aligneableElements, type);\n      }\n    });\n  }\n\n  if (selection && modeling) {\n    this._registerAction('setColor', function(opts) {\n      var currentSelection = selection.get();\n\n      if (currentSelection.length) {\n        modeling.setColor(currentSelection, opts);\n      }\n    });\n  }\n\n  if (selection && directEditing) {\n    this._registerAction('directEditing', function() {\n      var currentSelection = selection.get();\n\n      if (currentSelection.length) {\n        directEditing.activate(currentSelection[0]);\n      }\n    });\n  }\n\n  if (searchPad) {\n    this._registerAction('find', function() {\n      searchPad.toggle();\n    });\n  }\n\n  if (canvas && modeling) {\n    this._registerAction('moveToOrigin', function() {\n      var rootElement = canvas.getRootElement(),\n          boundingBox,\n          elements;\n\n      if (is(rootElement, 'bpmn:Collaboration')) {\n        elements = elementRegistry.filter(function(element) {\n          return is(element.parent, 'bpmn:Collaboration');\n        });\n      } else {\n        elements = elementRegistry.filter(function(element) {\n          return element !== rootElement && !is(element.parent, 'bpmn:SubProcess');\n        });\n      }\n\n      boundingBox = getBBox(elements);\n\n      modeling.moveElements(\n        elements,\n        { x: -boundingBox.x, y: -boundingBox.y },\n        rootElement\n      );\n    });\n  }\n\n};","import EditorActionsModule from 'diagram-js/lib/features/editor-actions';\n\nimport BpmnEditorActions from './BpmnEditorActions';\n\nexport default {\n  __depends__: [\n    EditorActionsModule\n  ],\n  editorActions: [ 'type', BpmnEditorActions ]\n};\n","import { isAny } from '../modeling/util/ModelingUtil';\r\n\r\nexport default function BpmnGridSnapping(eventBus) {\r\n  eventBus.on([\r\n    'create.init',\r\n    'shape.move.init'\r\n  ], function(event) {\r\n    var context = event.context,\r\n        shape = event.shape;\r\n\r\n    if (isAny(shape, [\r\n      'bpmn:Participant',\r\n      'bpmn:SubProcess',\r\n      'bpmn:TextAnnotation'\r\n    ])) {\r\n      if (!context.gridSnappingContext) {\r\n        context.gridSnappingContext = {};\r\n      }\r\n\r\n      context.gridSnappingContext.snapLocation = 'top-left';\r\n    }\r\n  });\r\n}\r\n\r\nBpmnGridSnapping.$inject = [ 'eventBus' ];","export var SPACING = 10;\n\nexport function quantize(value, quantum, fn) {\n  if (!fn) {\n    fn = 'round';\n  }\n\n  return Math[ fn ](value / quantum) * quantum;\n}","import {\r\n  setSnapped,\r\n  isSnapped\r\n} from '../snapping/SnapUtil';\r\n\r\nimport { isCmd } from '../keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  assign,\r\n  isNumber\r\n} from 'min-dash';\r\n\r\nimport {\r\n  SPACING,\r\n  quantize\r\n} from './GridUtil';\r\n\r\nvar LOWER_PRIORITY = 1200;\r\nvar LOW_PRIORITY = 800;\r\n\r\n/**\r\n * Basic grid snapping that covers connecting, creating, moving, resizing shapes, moving bendpoints\r\n * and connection segments.\r\n */\r\nexport default function GridSnapping(elementRegistry, eventBus, config) {\r\n\r\n  var active = !config || config.active !== false;\r\n\r\n  this._eventBus = eventBus;\r\n\r\n  var self = this;\r\n\r\n  eventBus.on('diagram.init', LOW_PRIORITY, function() {\r\n    self.setActive(active);\r\n  });\r\n\r\n  eventBus.on([\r\n    'create.move',\r\n    'create.end',\r\n    'bendpoint.move.move',\r\n    'bendpoint.move.end',\r\n    'connect.move',\r\n    'connect.end',\r\n    'connectionSegment.move.move',\r\n    'connectionSegment.move.end',\r\n    'resize.move',\r\n    'resize.end',\r\n    'shape.move.move',\r\n    'shape.move.end'\r\n  ], LOWER_PRIORITY, function(event) {\r\n    var originalEvent = event.originalEvent;\r\n\r\n    if (!self.active || (originalEvent && isCmd(originalEvent))) {\r\n      return;\r\n    }\r\n\r\n    var context = event.context,\r\n        gridSnappingContext = context.gridSnappingContext;\r\n\r\n    if (!gridSnappingContext) {\r\n      gridSnappingContext = context.gridSnappingContext = {};\r\n    }\r\n\r\n    [ 'x', 'y' ].forEach(function(axis) {\r\n      var options = {};\r\n\r\n      // allow snapping with offset\r\n      var snapOffset = getSnapOffset(event, axis, elementRegistry);\r\n\r\n      if (snapOffset) {\r\n        options.offset = snapOffset;\r\n      }\r\n\r\n      // allow snapping with min and max\r\n      var snapConstraints = getSnapConstraints(event, axis);\r\n\r\n      if (snapConstraints) {\r\n        assign(options, snapConstraints);\r\n      }\r\n\r\n      if (!isSnapped(event, axis)) {\r\n        self.snapEvent(event, axis, options);\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Snap an events x or y with optional min, max and offset.\r\n *\r\n * @param {Object} event\r\n * @param {string} axis\r\n * @param {number} [options.min]\r\n * @param {number} [options.max]\r\n * @param {number} [options.offset]\r\n */\r\nGridSnapping.prototype.snapEvent = function(event, axis, options) {\r\n  var snappedValue = this.snapValue(event[ axis ], options);\r\n\r\n  setSnapped(event, axis, snappedValue);\r\n};\r\n\r\n/**\r\n * Expose grid spacing for third parties (i.e. extensions).\r\n *\r\n * @return {Number} spacing of grid dots\r\n */\r\nGridSnapping.prototype.getGridSpacing = function() {\r\n  return SPACING;\r\n};\r\n\r\n/**\r\n * Snap value with optional min, max and offset.\r\n *\r\n * @param {number} value\r\n * @param {Object} options\r\n * @param {number} [options.min]\r\n * @param {number} [options.max]\r\n * @param {number} [options.offset]\r\n */\r\nGridSnapping.prototype.snapValue = function(value, options) {\r\n  var offset = 0;\r\n\r\n  if (options && options.offset) {\r\n    offset = options.offset;\r\n  }\r\n\r\n  value += offset;\r\n\r\n  value = quantize(value, SPACING);\r\n\r\n  var min, max;\r\n\r\n  if (options && options.min) {\r\n    min = options.min;\r\n\r\n    if (isNumber(min)) {\r\n      min = quantize(min + offset, SPACING, 'ceil');\r\n\r\n      value = Math.max(value, min);\r\n    }\r\n  }\r\n\r\n  if (options && options.max) {\r\n    max = options.max;\r\n\r\n    if (isNumber(max)) {\r\n      max = quantize(max + offset, SPACING, 'floor');\r\n\r\n      value = Math.min(value, max);\r\n    }\r\n  }\r\n\r\n  value -= offset;\r\n\r\n  return value;\r\n};\r\n\r\nGridSnapping.prototype.isActive = function() {\r\n  return this.active;\r\n};\r\n\r\nGridSnapping.prototype.setActive = function(active) {\r\n  this.active = active;\r\n\r\n  this._eventBus.fire('gridSnapping.toggle', { active: active });\r\n};\r\n\r\nGridSnapping.prototype.toggleActive = function() {\r\n  this.setActive(!this.active);\r\n};\r\n\r\nGridSnapping.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'config.gridSnapping'\r\n];\r\n\r\n// helpers //////////\r\n\r\n/**\r\n * Get minimum and maximum snap constraints.\r\n * Constraints are cached.\r\n *\r\n * @param {Object} event\r\n * @param {Object} event.context\r\n * @param {string} axis\r\n *\r\n * @returns {boolean|Object}\r\n */\r\nfunction getSnapConstraints(event, axis) {\r\n  var context = event.context,\r\n      createConstraints = context.createConstraints,\r\n      resizeConstraints = context.resizeConstraints || {},\r\n      gridSnappingContext = context.gridSnappingContext,\r\n      snapConstraints = gridSnappingContext.snapConstraints;\r\n\r\n  // cache snap constraints\r\n  if (snapConstraints && snapConstraints[ axis ]) {\r\n    return snapConstraints[ axis ];\r\n  }\r\n\r\n  if (!snapConstraints) {\r\n    snapConstraints = gridSnappingContext.snapConstraints = {};\r\n  }\r\n\r\n  if (!snapConstraints[ axis ]) {\r\n    snapConstraints[ axis ] = {};\r\n  }\r\n\r\n  var direction = context.direction;\r\n\r\n  // create\r\n  if (createConstraints) {\r\n    if (isHorizontal(axis)) {\r\n      snapConstraints.x.min = createConstraints.left;\r\n      snapConstraints.x.max = createConstraints.right;\r\n    } else {\r\n      snapConstraints.y.min = createConstraints.top;\r\n      snapConstraints.y.max = createConstraints.bottom;\r\n    }\r\n  }\r\n\r\n  // resize\r\n  var minResizeConstraints = resizeConstraints.min,\r\n      maxResizeConstraints = resizeConstraints.max;\r\n\r\n  if (minResizeConstraints) {\r\n    if (isHorizontal(axis)) {\r\n\r\n      if (isWest(direction)) {\r\n        snapConstraints.x.max = minResizeConstraints.left;\r\n      } else {\r\n        snapConstraints.x.min = minResizeConstraints.right;\r\n      }\r\n\r\n    } else {\r\n\r\n      if (isNorth(direction)) {\r\n        snapConstraints.y.max = minResizeConstraints.top;\r\n      } else {\r\n        snapConstraints.y.min = minResizeConstraints.bottom;\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  if (maxResizeConstraints) {\r\n    if (isHorizontal(axis)) {\r\n\r\n      if (isWest(direction)) {\r\n        snapConstraints.x.min = maxResizeConstraints.left;\r\n      } else {\r\n        snapConstraints.x.max = maxResizeConstraints.right;\r\n      }\r\n\r\n    } else {\r\n\r\n      if (isNorth(direction)) {\r\n        snapConstraints.y.min = maxResizeConstraints.top;\r\n      } else {\r\n        snapConstraints.y.max = maxResizeConstraints.bottom;\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  return snapConstraints[ axis ];\r\n}\r\n\r\n/**\r\n * Get snap offset.\r\n * Offset is cached.\r\n *\r\n * @param {Object} event\r\n * @param {string} axis\r\n * @param {ElementRegistry} elementRegistry\r\n *\r\n * @returns {number}\r\n */\r\nfunction getSnapOffset(event, axis, elementRegistry) {\r\n  var context = event.context,\r\n      shape = event.shape,\r\n      gridSnappingContext = context.gridSnappingContext,\r\n      snapLocation = gridSnappingContext.snapLocation,\r\n      snapOffset = gridSnappingContext.snapOffset;\r\n\r\n  // cache snap offset\r\n  if (snapOffset && isNumber(snapOffset[ axis ])) {\r\n    return snapOffset[ axis ];\r\n  }\r\n\r\n  if (!snapOffset) {\r\n    snapOffset = gridSnappingContext.snapOffset = {};\r\n  }\r\n\r\n  if (!isNumber(snapOffset[ axis ])) {\r\n    snapOffset[ axis ] = 0;\r\n  }\r\n\r\n  if (!shape) {\r\n    return snapOffset[ axis ];\r\n  }\r\n\r\n  if (!elementRegistry.get(shape.id)) {\r\n\r\n    if (isHorizontal(axis)) {\r\n      snapOffset[ axis ] += shape[ axis ] + shape.width / 2;\r\n    } else {\r\n      snapOffset[ axis ] += shape[ axis ] + shape.height / 2;\r\n    }\r\n  }\r\n\r\n  if (!snapLocation) {\r\n    return snapOffset[ axis ];\r\n  }\r\n\r\n  if (axis === 'x') {\r\n    if (/left/.test(snapLocation)) {\r\n      snapOffset[ axis ] -= shape.width / 2;\r\n    } else if (/right/.test(snapLocation)) {\r\n      snapOffset[ axis ] += shape.width / 2;\r\n    }\r\n  } else {\r\n    if (/top/.test(snapLocation)) {\r\n      snapOffset[ axis ] -= shape.height / 2;\r\n    } else if (/bottom/.test(snapLocation)) {\r\n      snapOffset[ axis ] += shape.height / 2;\r\n    }\r\n  }\r\n\r\n  return snapOffset[ axis ];\r\n}\r\n\r\nfunction isHorizontal(axis) {\r\n  return axis === 'x';\r\n}\r\n\r\nfunction isNorth(direction) {\r\n  return direction.indexOf('n') !== -1;\r\n}\r\n\r\nfunction isWest(direction) {\r\n  return direction.indexOf('w') !== -1;\r\n}","import inherits from 'inherits';\r\n\r\nimport CommandInterceptor from '../../../command/CommandInterceptor';\r\n\r\nimport {\r\n  assign,\r\n  isString\r\n} from 'min-dash';\r\n\r\n\r\n/**\r\n * Integrates resizing with grid snapping.\r\n */\r\nexport default function ResizeBehavior(eventBus, gridSnapping) {\r\n  CommandInterceptor.call(this, eventBus);\r\n\r\n  this._gridSnapping = gridSnapping;\r\n\r\n  var self = this;\r\n\r\n  this.preExecute('shape.resize', function(event) {\r\n    var context = event.context,\r\n        hints = context.hints || {},\r\n        autoResize = hints.autoResize;\r\n\r\n    if (!autoResize) {\r\n      return;\r\n    }\r\n\r\n    var shape = context.shape,\r\n        newBounds = context.newBounds;\r\n\r\n    if (isString(autoResize)) {\r\n      context.newBounds = self.snapComplex(newBounds, autoResize);\r\n    } else {\r\n      context.newBounds = self.snapSimple(shape, newBounds);\r\n    }\r\n  });\r\n}\r\n\r\nResizeBehavior.$inject = [\r\n  'eventBus',\r\n  'gridSnapping',\r\n  'modeling'\r\n];\r\n\r\ninherits(ResizeBehavior, CommandInterceptor);\r\n\r\n/**\r\n * Snap width and height in relation to center.\r\n *\r\n * @param {djs.model.shape} shape\r\n * @param {Bounds} newBounds\r\n *\r\n * @returns {Bounds} Snapped bounds.\r\n */\r\nResizeBehavior.prototype.snapSimple = function(shape, newBounds) {\r\n  var gridSnapping = this._gridSnapping;\r\n\r\n  newBounds.width = gridSnapping.snapValue(newBounds.width, {\r\n    min: newBounds.width\r\n  });\r\n\r\n  newBounds.height = gridSnapping.snapValue(newBounds.height, {\r\n    min: newBounds.height\r\n  });\r\n\r\n  newBounds.x = shape.x + (shape.width / 2) - (newBounds.width / 2);\r\n  newBounds.y = shape.y + (shape.height / 2) - (newBounds.height / 2);\r\n\r\n  return newBounds;\r\n};\r\n\r\n/**\r\n * Snap x, y, width and height according to given directions.\r\n *\r\n * @param {Bounds} newBounds\r\n * @param {string} directions - Directions as {n|w|s|e}.\r\n *\r\n * @returns {Bounds} Snapped bounds.\r\n */\r\nResizeBehavior.prototype.snapComplex = function(newBounds, directions) {\r\n  if (/w|e/.test(directions)) {\r\n    newBounds = this.snapHorizontally(newBounds, directions);\r\n  }\r\n\r\n  if (/n|s/.test(directions)) {\r\n    newBounds = this.snapVertically(newBounds, directions);\r\n  }\r\n\r\n  return newBounds;\r\n};\r\n\r\n/**\r\n * Snap in one or both directions horizontally.\r\n *\r\n * @param {Bounds} newBounds\r\n * @param {string} directions - Directions as {n|w|s|e}.\r\n *\r\n * @returns {Bounds} Snapped bounds.\r\n */\r\nResizeBehavior.prototype.snapHorizontally = function(newBounds, directions) {\r\n  var gridSnapping = this._gridSnapping,\r\n      west = /w/.test(directions),\r\n      east = /e/.test(directions);\r\n\r\n  var snappedNewBounds = {};\r\n\r\n  snappedNewBounds.width = gridSnapping.snapValue(newBounds.width, {\r\n    min: newBounds.width\r\n  });\r\n\r\n  if (east) {\r\n\r\n    // handle <we>\r\n    if (west) {\r\n      snappedNewBounds.x = gridSnapping.snapValue(newBounds.x, {\r\n        max: newBounds.x\r\n      });\r\n\r\n      snappedNewBounds.width += gridSnapping.snapValue(newBounds.x - snappedNewBounds.x, {\r\n        min: newBounds.x - snappedNewBounds.x\r\n      });\r\n    }\r\n\r\n    // handle <e>\r\n    else {\r\n      newBounds.x = newBounds.x + newBounds.width - snappedNewBounds.width;\r\n    }\r\n  }\r\n\r\n  // assign snapped x and width\r\n  assign(newBounds, snappedNewBounds);\r\n\r\n  return newBounds;\r\n};\r\n\r\n/**\r\n * Snap in one or both directions vertically.\r\n *\r\n * @param {Bounds} newBounds\r\n * @param {string} directions - Directions as {n|w|s|e}.\r\n *\r\n * @returns {Bounds} Snapped bounds.\r\n */\r\nResizeBehavior.prototype.snapVertically = function(newBounds, directions) {\r\n  var gridSnapping = this._gridSnapping,\r\n      north = /n/.test(directions),\r\n      south = /s/.test(directions);\r\n\r\n  var snappedNewBounds = {};\r\n\r\n  snappedNewBounds.height = gridSnapping.snapValue(newBounds.height, {\r\n    min: newBounds.height\r\n  });\r\n\r\n  if (north) {\r\n\r\n    // handle <ns>\r\n    if (south) {\r\n      snappedNewBounds.y = gridSnapping.snapValue(newBounds.y, {\r\n        max: newBounds.y\r\n      });\r\n\r\n      snappedNewBounds.height += gridSnapping.snapValue(newBounds.y - snappedNewBounds.y, {\r\n        min: newBounds.y - snappedNewBounds.y\r\n      });\r\n    }\r\n\r\n    // handle <n>\r\n    else {\r\n      newBounds.y = newBounds.y + newBounds.height - snappedNewBounds.height;\r\n    }\r\n  }\r\n\r\n  // assign snapped y and height\r\n  assign(newBounds, snappedNewBounds);\r\n\r\n  return newBounds;\r\n};","var HIGH_PRIORITY = 2000;\r\n\r\n/**\r\n * Integrates space tool with grid snapping.\r\n */\r\nexport default function SpaceToolBehavior(eventBus, gridSnapping) {\r\n  eventBus.on([\r\n    'spaceTool.move',\r\n    'spaceTool.end'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context;\r\n\r\n    if (!context.initialized) {\r\n      return;\r\n    }\r\n\r\n    var axis = context.axis;\r\n\r\n    var snapped;\r\n\r\n    if (axis === 'x') {\r\n\r\n      // snap delta x to multiple of 10\r\n      snapped = gridSnapping.snapValue(event.dx);\r\n\r\n      event.x = event.x + snapped - event.dx;\r\n      event.dx = snapped;\r\n    } else {\r\n\r\n      // snap delta y to multiple of 10\r\n      snapped = gridSnapping.snapValue(event.dy);\r\n\r\n      event.y = event.y + snapped - event.dy;\r\n      event.dy = snapped;\r\n    }\r\n  });\r\n}\r\n\r\nSpaceToolBehavior.$inject = [\r\n  'eventBus',\r\n  'gridSnapping'\r\n];","import ResizeBehavior from './ResizeBehavior';\r\nimport SpaceToolBehavior from './SpaceToolBehavior';\r\n\r\nexport default {\r\n  __init__: [\r\n    'gridSnappingResizeBehavior',\r\n    'gridSnappingSpaceToolBehavior'\r\n  ],\r\n  gridSnappingResizeBehavior: [ 'type', ResizeBehavior ],\r\n  gridSnappingSpaceToolBehavior: [ 'type', SpaceToolBehavior ]\r\n};","import GridSnapping from './GridSnapping';\r\n\r\nimport GridSnappingBehaviorModule from './behavior';\r\n\r\nexport default {\r\n  __depends__: [ GridSnappingBehaviorModule ],\r\n  __init__: [ 'gridSnapping' ],\r\n  gridSnapping: [ 'type', GridSnapping ]\r\n};","import { getNewShapePosition } from '../../auto-place/AutoPlaceUtil';\r\n\r\nimport { getMid } from 'diagram-js/lib/layout/LayoutUtil';\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\n\r\nexport default function AutoPlaceBehavior(eventBus, gridSnapping) {\r\n  eventBus.on('autoPlace', function(context) {\r\n    var source = context.source,\r\n        sourceMid = getMid(source),\r\n        shape = context.shape;\r\n\r\n    var position = getNewShapePosition(source, shape);\r\n\r\n    [ 'x', 'y' ].forEach(function(axis) {\r\n      var options = {};\r\n\r\n      // do not snap if x/y equal\r\n      if (position[ axis ] === sourceMid[ axis ]) {\r\n        return;\r\n      }\r\n\r\n      if (position[ axis ] > sourceMid[ axis ]) {\r\n        options.min = position[ axis ];\r\n      } else {\r\n        options.max = position[ axis ];\r\n      }\r\n\r\n      if (is(shape, 'bpmn:TextAnnotation')) {\r\n\r\n        if (isHorizontal(axis)) {\r\n          options.offset = -shape.width / 2;\r\n        } else {\r\n          options.offset = -shape.height / 2;\r\n        }\r\n\r\n      }\r\n\r\n      position[ axis ] = gridSnapping.snapValue(position[ axis ], options);\r\n\r\n    });\r\n\r\n    // must be returned to be considered by auto place\r\n    return position;\r\n  });\r\n}\r\n\r\nAutoPlaceBehavior.$inject = [\r\n  'eventBus',\r\n  'gridSnapping'\r\n];\r\n\r\n// helpers //////////\r\n\r\nfunction isHorizontal(axis) {\r\n  return axis === 'x';\r\n}","import { is } from '../../../util/ModelUtil';\r\n\r\nvar HIGHER_PRIORITY = 1750;\r\n\r\n\r\nexport default function CreateParticipantBehavior(canvas, eventBus, gridSnapping) {\r\n  eventBus.on([\r\n    'create.start',\r\n    'shape.move.start'\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        rootElement = canvas.getRootElement();\r\n\r\n    if (!is(shape, 'bpmn:Participant') ||\r\n      !is(rootElement, 'bpmn:Process') ||\r\n      !rootElement.children.length) {\r\n      return;\r\n    }\r\n\r\n    var createConstraints = context.createConstraints;\r\n\r\n    if (!createConstraints) {\r\n      return;\r\n    }\r\n\r\n    shape.width = gridSnapping.snapValue(shape.width, { min: shape.width });\r\n    shape.height = gridSnapping.snapValue(shape.height, { min: shape.height });\r\n  });\r\n}\r\n\r\nCreateParticipantBehavior.$inject = [\r\n  'canvas',\r\n  'eventBus',\r\n  'gridSnapping'\r\n];","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { pointsAligned } from 'diagram-js/lib/util/Geometry';\n\nimport {\n  assign\n} from 'min-dash';\n\nvar HIGH_PRIORITY = 3000;\n\n\n/**\n * Snaps connections with Manhattan layout.\n */\nexport default function LayoutConnectionBehavior(eventBus, gridSnapping, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  this._gridSnapping = gridSnapping;\n\n  var self = this;\n\n  this.postExecuted([\n    'connection.create',\n    'connection.layout'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        connection = context.connection,\n        hints = context.hints || {},\n        waypoints = connection.waypoints;\n\n    if (hints.connectionStart || hints.connectionEnd || hints.createElementsBehavior === false) {\n      return;\n    }\n\n    if (!hasMiddleSegments(waypoints)) {\n      return;\n    }\n\n    modeling.updateWaypoints(connection, self.snapMiddleSegments(waypoints));\n  });\n}\n\nLayoutConnectionBehavior.$inject = [\n  'eventBus',\n  'gridSnapping',\n  'modeling'\n];\n\ninherits(LayoutConnectionBehavior, CommandInterceptor);\n\n/**\n * Snap middle segments of a given connection.\n *\n * @param {Array<Point>} waypoints\n *\n * @returns {Array<Point>}\n */\nLayoutConnectionBehavior.prototype.snapMiddleSegments = function(waypoints) {\n  var gridSnapping = this._gridSnapping,\n      snapped;\n\n  waypoints = waypoints.slice();\n\n  for (var i = 1; i < waypoints.length - 2; i++) {\n\n    snapped = snapSegment(gridSnapping, waypoints[i], waypoints[i + 1]);\n\n    waypoints[i] = snapped[0];\n    waypoints[i + 1] = snapped[1];\n  }\n\n  return waypoints;\n};\n\n\n// helpers //////////\n\n/**\n * Check whether a connection has a middle segments.\n *\n * @param {Array} waypoints\n *\n * @returns {boolean}\n */\nfunction hasMiddleSegments(waypoints) {\n  return waypoints.length > 3;\n}\n\n/**\n * Check whether an alignment is horizontal.\n *\n * @param {string} aligned\n *\n * @returns {boolean}\n */\nfunction horizontallyAligned(aligned) {\n  return aligned === 'h';\n}\n\n/**\n * Check whether an alignment is vertical.\n *\n * @param {string} aligned\n *\n * @returns {boolean}\n */\nfunction verticallyAligned(aligned) {\n  return aligned === 'v';\n}\n\n/**\n * Get middle segments from a given connection.\n *\n * @param {Array} waypoints\n *\n * @returns {Array}\n */\nfunction snapSegment(gridSnapping, segmentStart, segmentEnd) {\n\n  var aligned = pointsAligned(segmentStart, segmentEnd);\n\n  var snapped = {};\n\n  if (horizontallyAligned(aligned)) {\n\n    // snap horizontally\n    snapped.y = gridSnapping.snapValue(segmentStart.y);\n  }\n\n  if (verticallyAligned(aligned)) {\n\n    // snap vertically\n    snapped.x = gridSnapping.snapValue(segmentStart.x);\n  }\n\n  if ('x' in snapped || 'y' in snapped) {\n    segmentStart = assign({}, segmentStart, snapped);\n    segmentEnd = assign({}, segmentEnd, snapped);\n  }\n\n  return [ segmentStart, segmentEnd ];\n}","import AutoPlaceBehavior from './AutoPlaceBehavior';\r\nimport CreateParticipantBehavior from './CreateParticipantBehavior';\r\nimport LayoutConnectionBehavior from './LayoutConnectionBehavior';\r\n\r\nexport default {\r\n  __init__: [\r\n    'gridSnappingAutoPlaceBehavior',\r\n    'gridSnappingCreateParticipantBehavior',\r\n    'gridSnappingLayoutConnectionBehavior',\r\n  ],\r\n  gridSnappingAutoPlaceBehavior: [ 'type', AutoPlaceBehavior ],\r\n  gridSnappingCreateParticipantBehavior: [ 'type', CreateParticipantBehavior ],\r\n  gridSnappingLayoutConnectionBehavior: [ 'type', LayoutConnectionBehavior ]\r\n};","import BpmnGridSnapping from './BpmnGridSnapping';\r\nimport GridSnappingModule from 'diagram-js/lib/features/grid-snapping';\r\n\r\nimport GridSnappingBehaviorModule from './behavior';\r\n\r\nexport default {\r\n  __depends__: [\r\n    GridSnappingModule,\r\n    GridSnappingBehaviorModule\r\n  ],\r\n  __init__: [ 'bpmnGridSnapping' ],\r\n  bpmnGridSnapping: [ 'type', BpmnGridSnapping ]\r\n};","import { is } from '../../util/ModelUtil';\n\nimport { isExpanded } from '../../util/DiUtil';\n\nvar LABEL_WIDTH = 30,\n    LABEL_HEIGHT = 30;\n\n\n/**\n * BPMN-specific hit zones and interaction fixes.\n *\n * @param {EventBus} eventBus\n * @param {InteractionEvents} interactionEvents\n */\nexport default function BpmnInteractionEvents(eventBus, interactionEvents) {\n\n  this._interactionEvents = interactionEvents;\n\n  var self = this;\n\n  eventBus.on([\n    'interactionEvents.createHit',\n    'interactionEvents.updateHit'\n  ], function(context) {\n    var element = context.element,\n        gfx = context.gfx;\n\n    if (is(element, 'bpmn:Lane')) {\n      return self.createParticipantHit(element, gfx);\n    } else\n\n    if (is(element, 'bpmn:Participant')) {\n      if (isExpanded(element)) {\n        return self.createParticipantHit(element, gfx);\n      } else {\n        return self.createDefaultHit(element, gfx);\n      }\n    } else\n\n    if (is(element, 'bpmn:SubProcess')) {\n      if (isExpanded(element)) {\n        return self.createSubProcessHit(element, gfx);\n      } else {\n        return self.createDefaultHit(element, gfx);\n      }\n    }\n  });\n\n}\n\nBpmnInteractionEvents.$inject = [\n  'eventBus',\n  'interactionEvents'\n];\n\n\nBpmnInteractionEvents.prototype.createDefaultHit = function(element, gfx) {\n  this._interactionEvents.removeHits(gfx);\n\n  this._interactionEvents.createDefaultHit(element, gfx);\n\n  // indicate that we created a hit\n  return true;\n};\n\nBpmnInteractionEvents.prototype.createParticipantHit = function(element, gfx) {\n\n  // remove existing hits\n  this._interactionEvents.removeHits(gfx);\n\n  // add outline hit\n  this._interactionEvents.createBoxHit(gfx, 'click-stroke', {\n    width: element.width,\n    height: element.height\n  });\n\n  // add label hit\n  this._interactionEvents.createBoxHit(gfx, 'all', {\n    width: LABEL_WIDTH,\n    height: element.height\n  });\n\n  // indicate that we created a hit\n  return true;\n};\n\nBpmnInteractionEvents.prototype.createSubProcessHit = function(element, gfx) {\n\n  // remove existing hits\n  this._interactionEvents.removeHits(gfx);\n\n  // add outline hit\n  this._interactionEvents.createBoxHit(gfx, 'click-stroke', {\n    width: element.width,\n    height: element.height\n  });\n\n  // add label hit\n  this._interactionEvents.createBoxHit(gfx, 'all', {\n    width: element.width,\n    height: LABEL_HEIGHT\n  });\n\n  // indicate that we created a hit\n  return true;\n};","import BpmnInteractionEvents from './BpmnInteractionEvents';\n\nexport default {\n  __init__: [ 'bpmnInteractionEvents' ],\n  bpmnInteractionEvents: [ 'type', BpmnInteractionEvents ]\n};","import inherits from 'inherits';\n\nimport KeyboardBindings from 'diagram-js/lib/features/keyboard/KeyboardBindings';\n\n\n/**\n * BPMN 2.0 specific keyboard bindings.\n *\n * @param {Injector} injector\n */\nexport default function BpmnKeyboardBindings(injector) {\n  injector.invoke(KeyboardBindings, this);\n}\n\ninherits(BpmnKeyboardBindings, KeyboardBindings);\n\nBpmnKeyboardBindings.$inject = [\n  'injector'\n];\n\n\n/**\n * Register available keyboard bindings.\n *\n * @param {Keyboard} keyboard\n * @param {EditorActions} editorActions\n */\nBpmnKeyboardBindings.prototype.registerBindings = function(keyboard, editorActions) {\n\n  // inherit default bindings\n  KeyboardBindings.prototype.registerBindings.call(this, keyboard, editorActions);\n\n  /**\n   * Add keyboard binding if respective editor action\n   * is registered.\n   *\n   * @param {String} action name\n   * @param {Function} fn that implements the key binding\n   */\n  function addListener(action, fn) {\n\n    if (editorActions.isRegistered(action)) {\n      keyboard.addListener(fn);\n    }\n  }\n\n  // select all elements\n  // CTRL + A\n  addListener('selectElements', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.isKey(['a', 'A'], event) && keyboard.isCmd(event)) {\n      editorActions.trigger('selectElements');\n\n      return true;\n    }\n  });\n\n  // search labels\n  // CTRL + F\n  addListener('find', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.isKey(['f', 'F'], event) && keyboard.isCmd(event)) {\n      editorActions.trigger('find');\n\n      return true;\n    }\n  });\n\n  // activate space tool\n  // S\n  addListener('spaceTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['s', 'S'], event)) {\n      editorActions.trigger('spaceTool');\n\n      return true;\n    }\n  });\n\n  // activate lasso tool\n  // L\n  addListener('lassoTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['l', 'L'], event)) {\n      editorActions.trigger('lassoTool');\n\n      return true;\n    }\n  });\n\n  // activate hand tool\n  // H\n  addListener('handTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['h', 'H'], event)) {\n      editorActions.trigger('handTool');\n\n      return true;\n    }\n  });\n\n  // activate global connect tool\n  // C\n  addListener('globalConnectTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['c', 'C'], event)) {\n      editorActions.trigger('globalConnectTool');\n\n      return true;\n    }\n  });\n\n  // activate direct editing\n  // E\n  addListener('directEditing', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['e', 'E'], event)) {\n      editorActions.trigger('directEditing');\n\n      return true;\n    }\n  });\n\n};","import KeyboardModule from 'diagram-js/lib/features/keyboard';\n\nimport BpmnKeyboardBindings from './BpmnKeyboardBindings';\n\nexport default {\n  __depends__: [\n    KeyboardModule\n  ],\n  __init__: [ 'keyboardBindings' ],\n  keyboardBindings: [ 'type', BpmnKeyboardBindings ]\n};\n","import {\n  assign\n} from 'min-dash';\n\n\nvar DEFAULT_CONFIG = {\n  moveSpeed: 1,\n  moveSpeedAccelerated: 10\n};\n\nvar HIGHER_PRIORITY = 1500;\n\nvar LEFT = 'left';\nvar UP = 'up';\nvar RIGHT = 'right';\nvar DOWN = 'down';\n\nvar KEY_TO_DIRECTION = {\n  ArrowLeft: LEFT,\n  Left: LEFT,\n  ArrowUp: UP,\n  Up: UP,\n  ArrowRight: RIGHT,\n  Right: RIGHT,\n  ArrowDown: DOWN,\n  Down: DOWN\n};\n\nvar DIRECTIONS_DELTA = {\n  left: function(speed) {\n    return {\n      x: -speed,\n      y: 0\n    };\n  },\n  up: function(speed) {\n    return {\n      x: 0,\n      y: -speed\n    };\n  },\n  right: function(speed) {\n    return {\n      x: speed,\n      y: 0\n    };\n  },\n  down: function(speed) {\n    return {\n      x: 0,\n      y: speed\n    };\n  }\n};\n\n\n/**\n * Enables to move selection with keyboard arrows.\n * Use with Shift for modified speed (default=1, with Shift=10).\n * Pressed Cmd/Ctrl turns the feature off.\n *\n * @param {Object} config\n * @param {Number} [config.moveSpeed=1]\n * @param {Number} [config.moveSpeedAccelerated=10]\n * @param {Keyboard} keyboard\n * @param {Modeling} modeling\n * @param {Selection} selection\n */\nexport default function KeyboardMoveSelection(\n    config,\n    keyboard,\n    modeling,\n    rules,\n    selection\n) {\n\n  var self = this;\n\n  this._config = assign({}, DEFAULT_CONFIG, config || {});\n\n  keyboard.addListener(HIGHER_PRIORITY, function(event) {\n\n    var keyEvent = event.keyEvent;\n\n    var direction = KEY_TO_DIRECTION[keyEvent.key];\n\n    if (!direction) {\n      return;\n    }\n\n    if (keyboard.isCmd(keyEvent)) {\n      return;\n    }\n\n    var accelerated = keyboard.isShift(keyEvent);\n\n    self.moveSelection(direction, accelerated);\n\n    return true;\n  });\n\n\n  /**\n   * Move selected elements in the given direction,\n   * optionally specifying accelerated movement.\n   *\n   * @param {String} direction\n   * @param {Boolean} [accelerated=false]\n   */\n  this.moveSelection = function(direction, accelerated) {\n\n    var selectedElements = selection.get();\n\n    if (!selectedElements.length) {\n      return;\n    }\n\n    var speed = this._config[\n      accelerated ?\n        'moveSpeedAccelerated' :\n        'moveSpeed'\n    ];\n\n    var delta = DIRECTIONS_DELTA[direction](speed);\n\n    var canMove = rules.allowed('elements.move', {\n      shapes: selectedElements\n    });\n\n    if (canMove) {\n      modeling.moveElements(selectedElements, delta);\n    }\n  };\n\n}\n\nKeyboardMoveSelection.$inject = [\n  'config.keyboardMoveSelection',\n  'keyboard',\n  'modeling',\n  'rules',\n  'selection'\n];","import KeyboardModule from '../keyboard';\nimport SelectionModule from '../selection';\n\nimport KeyboardMoveSelection from './KeyboardMoveSelection';\n\nexport default {\n  __depends__: [\n    KeyboardModule,\n    SelectionModule\n  ],\n  __init__: [\n    'keyboardMoveSelection'\n  ],\n  keyboardMoveSelection: [ 'type', KeyboardMoveSelection ]\n};\n","import {\n  getType as getElementType\n} from '../../util/Elements';\n\n/**\n * Adds change support to the diagram, including\n *\n * <ul>\n *   <li>redrawing shapes and connections on change</li>\n * </ul>\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {ElementRegistry} elementRegistry\n * @param {GraphicsFactory} graphicsFactory\n */\nexport default function ChangeSupport(\n    eventBus, canvas, elementRegistry,\n    graphicsFactory) {\n\n\n  // redraw shapes / connections on change\n\n  eventBus.on('element.changed', function(event) {\n\n    var element = event.element;\n\n    // element might have been deleted and replaced by new element with same ID\n    // thus check for parent of element except for root element\n    if (element.parent || element === canvas.getRootElement()) {\n      event.gfx = elementRegistry.getGraphics(element);\n    }\n\n    // shape + gfx may have been deleted\n    if (!event.gfx) {\n      return;\n    }\n\n    eventBus.fire(getElementType(element) + '.changed', event);\n  });\n\n  eventBus.on('elements.changed', function(event) {\n\n    var elements = event.elements;\n\n    elements.forEach(function(e) {\n      eventBus.fire('element.changed', { element: e });\n    });\n\n    graphicsFactory.updateContainments(elements);\n  });\n\n  eventBus.on('shape.changed', function(event) {\n    graphicsFactory.update('shape', event.element, event.gfx);\n  });\n\n  eventBus.on('connection.changed', function(event) {\n    graphicsFactory.update('connection', event.element, event.gfx);\n  });\n}\n\nChangeSupport.$inject = [\n  'eventBus',\n  'canvas',\n  'elementRegistry',\n  'graphicsFactory'\n];","import ChangeSupport from './ChangeSupport';\n\nexport default {\n  __init__: [ 'changeSupport'],\n  changeSupport: [ 'type', ChangeSupport ]\n};","import {\n  pick,\n  assign\n} from 'min-dash';\n\nimport {\n  resizeBounds,\n  ensureConstraints,\n  computeChildrenBBox,\n  getMinResizeBounds\n} from './ResizeUtil';\n\nimport {\n  asTRBL,\n  getMid,\n  roundBounds\n} from '../../layout/LayoutUtil';\n\nvar DEFAULT_MIN_WIDTH = 10;\n\n\n/**\n * A component that provides resizing of shapes on the canvas.\n *\n * The following components are part of shape resize:\n *\n *  * adding resize handles,\n *  * creating a visual during resize\n *  * checking resize rules\n *  * committing a change once finished\n *\n *\n * ## Customizing\n *\n * It's possible to customize the resizing behaviour by intercepting 'resize.start'\n * and providing the following parameters through the 'context':\n *\n *   * minDimensions ({ width, height }): minimum shape dimensions\n *\n *   * childrenBoxPadding ({ left, top, bottom, right } || number):\n *     gap between the minimum bounding box and the container\n *\n * f.ex:\n *\n * ```javascript\n * eventBus.on('resize.start', 1500, function(event) {\n *   var context = event.context,\n *\n *  context.minDimensions = { width: 140, height: 120 };\n *\n *  // Passing general padding\n *  context.childrenBoxPadding = 30;\n *\n *  // Passing padding to a specific side\n *  context.childrenBoxPadding.left = 20;\n * });\n * ```\n */\nexport default function Resize(eventBus, rules, modeling, dragging) {\n\n  this._dragging = dragging;\n  this._rules = rules;\n\n  var self = this;\n\n\n  /**\n   * Handle resize move by specified delta.\n   *\n   * @param {Object} context\n   * @param {Point} delta\n   */\n  function handleMove(context, delta) {\n\n    var shape = context.shape,\n        direction = context.direction,\n        resizeConstraints = context.resizeConstraints,\n        newBounds;\n\n    context.delta = delta;\n\n    newBounds = resizeBounds(shape, direction, delta);\n\n    // ensure constraints during resize\n    context.newBounds = ensureConstraints(newBounds, resizeConstraints);\n\n    // update + cache executable state\n    context.canExecute = self.canResize(context);\n  }\n\n  /**\n   * Handle resize start.\n   *\n   * @param  {Object} context\n   */\n  function handleStart(context) {\n\n    var resizeConstraints = context.resizeConstraints,\n\n        // evaluate minBounds for backwards compatibility\n        minBounds = context.minBounds;\n\n    if (resizeConstraints !== undefined) {\n      return;\n    }\n\n    if (minBounds === undefined) {\n      minBounds = self.computeMinResizeBox(context);\n    }\n\n    context.resizeConstraints = {\n      min: asTRBL(minBounds)\n    };\n  }\n\n  /**\n   * Handle resize end.\n   *\n   * @param  {Object} context\n   */\n  function handleEnd(context) {\n    var shape = context.shape,\n        canExecute = context.canExecute,\n        newBounds = context.newBounds;\n\n    if (canExecute) {\n\n      // ensure we have actual pixel values for new bounds\n      // (important when zoom level was > 1 during move)\n      newBounds = roundBounds(newBounds);\n\n      if (!boundsChanged(shape, newBounds)) {\n\n        // no resize necessary\n        return;\n      }\n\n      // perform the actual resize\n      modeling.resizeShape(shape, newBounds);\n    }\n  }\n\n\n  eventBus.on('resize.start', function(event) {\n    handleStart(event.context);\n  });\n\n  eventBus.on('resize.move', function(event) {\n    var delta = {\n      x: event.dx,\n      y: event.dy\n    };\n\n    handleMove(event.context, delta);\n  });\n\n  eventBus.on('resize.end', function(event) {\n    handleEnd(event.context);\n  });\n\n}\n\n\nResize.prototype.canResize = function(context) {\n  var rules = this._rules;\n\n  var ctx = pick(context, [ 'newBounds', 'shape', 'delta', 'direction' ]);\n\n  return rules.allowed('shape.resize', ctx);\n};\n\n/**\n * Activate a resize operation.\n *\n * You may specify additional contextual information and must specify a\n * resize direction during activation of the resize event.\n *\n * @param {MouseEvent} event\n * @param {djs.model.Shape} shape\n * @param {Object|String} contextOrDirection\n */\nResize.prototype.activate = function(event, shape, contextOrDirection) {\n  var dragging = this._dragging,\n      context,\n      direction;\n\n  if (typeof contextOrDirection === 'string') {\n    contextOrDirection = {\n      direction: contextOrDirection\n    };\n  }\n\n  context = assign({ shape: shape }, contextOrDirection);\n\n  direction = context.direction;\n\n  if (!direction) {\n    throw new Error('must provide a direction (n|w|s|e|nw|se|ne|sw)');\n  }\n\n  dragging.init(event, getReferencePoint(shape, direction), 'resize', {\n    autoActivate: true,\n    cursor: getCursor(direction),\n    data: {\n      shape: shape,\n      context: context\n    }\n  });\n};\n\nResize.prototype.computeMinResizeBox = function(context) {\n  var shape = context.shape,\n      direction = context.direction,\n      minDimensions,\n      childrenBounds;\n\n  minDimensions = context.minDimensions || {\n    width: DEFAULT_MIN_WIDTH,\n    height: DEFAULT_MIN_WIDTH\n  };\n\n  // get children bounds\n  childrenBounds = computeChildrenBBox(shape, context.childrenBoxPadding);\n\n  // get correct minimum bounds from given resize direction\n  // basically ensures that the minBounds is max(childrenBounds, minDimensions)\n  return getMinResizeBounds(direction, shape, minDimensions, childrenBounds);\n};\n\n\nResize.$inject = [\n  'eventBus',\n  'rules',\n  'modeling',\n  'dragging'\n];\n\n// helpers //////////\n\nfunction boundsChanged(shape, newBounds) {\n  return shape.x !== newBounds.x ||\n    shape.y !== newBounds.y ||\n    shape.width !== newBounds.width ||\n    shape.height !== newBounds.height;\n}\n\nexport function getReferencePoint(shape, direction) {\n  var mid = getMid(shape),\n      trbl = asTRBL(shape);\n\n  var referencePoint = {\n    x: mid.x,\n    y: mid.y\n  };\n\n  if (direction.indexOf('n') !== -1) {\n    referencePoint.y = trbl.top;\n  } else if (direction.indexOf('s') !== -1) {\n    referencePoint.y = trbl.bottom;\n  }\n\n  if (direction.indexOf('e') !== -1) {\n    referencePoint.x = trbl.right;\n  } else if (direction.indexOf('w') !== -1) {\n    referencePoint.x = trbl.left;\n  }\n\n  return referencePoint;\n}\n\nfunction getCursor(direction) {\n  var prefix = 'resize-';\n\n  if (direction === 'n' || direction === 's') {\n    return prefix + 'ns';\n  } else if (direction === 'e' || direction === 'w') {\n    return prefix + 'ew';\n  } else if (direction === 'nw' || direction === 'se') {\n    return prefix + 'nwse';\n  } else {\n    return prefix + 'nesw';\n  }\n}","var MARKER_RESIZING = 'djs-resizing',\n    MARKER_RESIZE_NOT_OK = 'resize-not-ok';\n\nvar LOW_PRIORITY = 500;\n\nimport {\n  attr as svgAttr,\n  remove as svgRemove,\n  classes as svgClasses\n} from 'tiny-svg';\n\n\n/**\n * Provides previews for resizing shapes when resizing.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {PreviewSupport} previewSupport\n */\nexport default function ResizePreview(eventBus, canvas, previewSupport) {\n\n  /**\n   * Update resizer frame.\n   *\n   * @param {Object} context\n   */\n  function updateFrame(context) {\n\n    var shape = context.shape,\n        bounds = context.newBounds,\n        frame = context.frame;\n\n    if (!frame) {\n      frame = context.frame = previewSupport.addFrame(shape, canvas.getDefaultLayer());\n\n      canvas.addMarker(shape, MARKER_RESIZING);\n    }\n\n    if (bounds.width > 5) {\n      svgAttr(frame, { x: bounds.x, width: bounds.width });\n    }\n\n    if (bounds.height > 5) {\n      svgAttr(frame, { y: bounds.y, height: bounds.height });\n    }\n\n    if (context.canExecute) {\n      svgClasses(frame).remove(MARKER_RESIZE_NOT_OK);\n    } else {\n      svgClasses(frame).add(MARKER_RESIZE_NOT_OK);\n    }\n  }\n\n  /**\n   * Remove resizer frame.\n   *\n   * @param {Object} context\n   */\n  function removeFrame(context) {\n    var shape = context.shape,\n        frame = context.frame;\n\n    if (frame) {\n      svgRemove(context.frame);\n    }\n\n    canvas.removeMarker(shape, MARKER_RESIZING);\n  }\n\n  // add and update previews\n  eventBus.on('resize.move', LOW_PRIORITY, function(event) {\n    updateFrame(event.context);\n  });\n\n  // remove previews\n  eventBus.on('resize.cleanup', function(event) {\n    removeFrame(event.context);\n  });\n\n}\n\nResizePreview.$inject = [\n  'eventBus',\n  'canvas',\n  'previewSupport'\n];","import {\n  bind,\n  forEach\n} from 'min-dash';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  clear as svgClear,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  event as domEvent\n} from 'min-dom';\n\nimport {\n  isPrimaryButton\n} from '../../util/Mouse';\n\nimport {\n  transform\n} from '../../util/SvgTransformUtil';\n\nimport { getReferencePoint } from './Resize';\n\nvar HANDLE_OFFSET = -6,\n    HANDLE_SIZE = 4,\n    HANDLE_HIT_SIZE = 20;\n\nvar CLS_RESIZER = 'djs-resizer';\n\nvar directions = [ 'n', 'w', 's', 'e', 'nw', 'ne', 'se', 'sw' ];\n\n\n/**\n * This component is responsible for adding resize handles.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {Selection} selection\n * @param {Resize} resize\n */\nexport default function ResizeHandles(eventBus, canvas, selection, resize) {\n\n  this._resize = resize;\n  this._canvas = canvas;\n\n  var self = this;\n\n  eventBus.on('selection.changed', function(e) {\n    var newSelection = e.newSelection;\n\n    // remove old selection markers\n    self.removeResizers();\n\n    // add new selection markers ONLY if single selection\n    if (newSelection.length === 1) {\n      forEach(newSelection, bind(self.addResizer, self));\n    }\n  });\n\n  eventBus.on('shape.changed', function(e) {\n    var shape = e.element;\n\n    if (selection.isSelected(shape)) {\n      self.removeResizers();\n\n      self.addResizer(shape);\n    }\n  });\n}\n\n\nResizeHandles.prototype.makeDraggable = function(element, gfx, direction) {\n  var resize = this._resize;\n\n  function startResize(event) {\n\n    // only trigger on left mouse button\n    if (isPrimaryButton(event)) {\n      resize.activate(event, element, direction);\n    }\n  }\n\n  domEvent.bind(gfx, 'mousedown', startResize);\n  domEvent.bind(gfx, 'touchstart', startResize);\n};\n\n\nResizeHandles.prototype._createResizer = function(element, x, y, direction) {\n  var resizersParent = this._getResizersParent();\n\n  var offset = getHandleOffset(direction);\n\n  var group = svgCreate('g');\n\n  svgClasses(group).add(CLS_RESIZER);\n  svgClasses(group).add(CLS_RESIZER + '-' + element.id);\n  svgClasses(group).add(CLS_RESIZER + '-' + direction);\n\n  svgAppend(resizersParent, group);\n\n  var visual = svgCreate('rect');\n\n  svgAttr(visual, {\n    x: -HANDLE_SIZE / 2 + offset.x,\n    y: -HANDLE_SIZE / 2 + offset.y,\n    width: HANDLE_SIZE,\n    height: HANDLE_SIZE\n  });\n\n  svgClasses(visual).add(CLS_RESIZER + '-visual');\n\n  svgAppend(group, visual);\n\n  var hit = svgCreate('rect');\n\n  svgAttr(hit, {\n    x: -HANDLE_HIT_SIZE / 2 + offset.x,\n    y: -HANDLE_HIT_SIZE / 2 + offset.y,\n    width: HANDLE_HIT_SIZE,\n    height: HANDLE_HIT_SIZE\n  });\n\n  svgClasses(hit).add(CLS_RESIZER + '-hit');\n\n  svgAppend(group, hit);\n\n  transform(group, x, y);\n\n  return group;\n};\n\nResizeHandles.prototype.createResizer = function(element, direction) {\n  var point = getReferencePoint(element, direction);\n\n  var resizer = this._createResizer(element, point.x, point.y, direction);\n\n  this.makeDraggable(element, resizer, direction);\n};\n\n// resize handles implementation ///////////////////////////////\n\n/**\n * Add resizers for a given element.\n *\n * @param {djs.model.Shape} shape\n */\nResizeHandles.prototype.addResizer = function(shape) {\n  var self = this;\n\n  var resize = this._resize;\n\n  if (!resize.canResize({ shape: shape })) {\n    return;\n  }\n\n  forEach(directions, function(direction) {\n    self.createResizer(shape, direction);\n  });\n};\n\n/**\n * Remove all resizers\n */\nResizeHandles.prototype.removeResizers = function() {\n  var resizersParent = this._getResizersParent();\n\n  svgClear(resizersParent);\n};\n\nResizeHandles.prototype._getResizersParent = function() {\n  return this._canvas.getLayer('resizers');\n};\n\nResizeHandles.$inject = [\n  'eventBus',\n  'canvas',\n  'selection',\n  'resize'\n];\n\n// helpers //////////\n\nfunction getHandleOffset(direction) {\n  var offset = {\n    x: 0,\n    y: 0\n  };\n\n  if (direction.indexOf('e') !== -1) {\n    offset.x = -HANDLE_OFFSET;\n  } else if (direction.indexOf('w') !== -1) {\n    offset.x = HANDLE_OFFSET;\n  }\n\n  if (direction.indexOf('s') !== -1) {\n    offset.y = -HANDLE_OFFSET;\n  } else if (direction.indexOf('n') !== -1) {\n    offset.y = HANDLE_OFFSET;\n  }\n\n  return offset;\n}","import RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport PreviewSupportModule from '../preview-support';\n\nimport Resize from './Resize';\nimport ResizePreview from './ResizePreview';\nimport ResizeHandles from './ResizeHandles';\n\nexport default {\n  __depends__: [\n    RulesModule,\n    DraggingModule,\n    PreviewSupportModule\n  ],\n  __init__: [\n    'resize',\n    'resizePreview',\n    'resizeHandles'\n  ],\n  resize: [ 'type', Resize ],\n  resizePreview: [ 'type', ResizePreview ],\n  resizeHandles: [ 'type', ResizeHandles ]\n};\n","import {\n  add as collectionAdd\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  getBusinessObject\n} from '../../../../util/ModelUtil';\n\n/**\n * Creates a new bpmn:CategoryValue inside a new bpmn:Category\n *\n * @param {ModdleElement} definitions\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement} categoryValue.\n */\nexport function createCategoryValue(definitions, bpmnFactory) {\n  var categoryValue = bpmnFactory.create('bpmn:CategoryValue'),\n      category = bpmnFactory.create('bpmn:Category', {\n        categoryValue: [ categoryValue ]\n      });\n\n  // add to correct place\n  collectionAdd(definitions.get('rootElements'), category);\n  getBusinessObject(category).$parent = definitions;\n  getBusinessObject(categoryValue).$parent = category;\n\n  return categoryValue;\n\n}","import {\n  assign\n} from 'min-dash';\n\nimport {\n  getLabel\n} from './LabelUtil';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  createCategoryValue\n} from '../modeling/behavior/util/CategoryUtil';\n\nimport { isAny } from '../modeling/util/ModelingUtil';\nimport { isExpanded } from '../../util/DiUtil';\n\nimport {\n  getExternalLabelMid,\n  isLabelExternal,\n  hasExternalLabel,\n  isLabel\n} from '../../util/LabelUtil';\n\n\nexport default function LabelEditingProvider(\n    eventBus, bpmnFactory, canvas, directEditing,\n    modeling, resizeHandles, textRenderer) {\n\n  this._bpmnFactory = bpmnFactory;\n  this._canvas = canvas;\n  this._modeling = modeling;\n  this._textRenderer = textRenderer;\n\n  directEditing.registerProvider(this);\n\n  // listen to dblclick on non-root elements\n  eventBus.on('element.dblclick', function(event) {\n    activateDirectEdit(event.element, true);\n  });\n\n  // complete on followup canvas operation\n  eventBus.on([\n    'autoPlace.start',\n    'canvas.viewbox.changing',\n    'drag.init',\n    'element.mousedown',\n    'popupMenu.open'\n  ], function(event) {\n\n    if (directEditing.isActive()) {\n      directEditing.complete();\n    }\n  });\n\n  // cancel on command stack changes\n  eventBus.on([ 'commandStack.changed' ], function(e) {\n    if (directEditing.isActive()) {\n      directEditing.cancel();\n    }\n  });\n\n\n  eventBus.on('directEditing.activate', function(event) {\n    resizeHandles.removeResizers();\n  });\n\n  eventBus.on('create.end', 500, function(event) {\n\n    var context = event.context,\n        element = context.shape,\n        canExecute = event.context.canExecute,\n        isTouch = event.isTouch;\n\n    // TODO(nikku): we need to find a way to support the\n    // direct editing on mobile devices; right now this will\n    // break for desworkflowediting on mobile devices\n    // as it breaks the user interaction workflow\n\n    // TODO(nre): we should temporarily focus the edited element\n    // here and release the focused viewport after the direct edit\n    // operation is finished\n    if (isTouch) {\n      return;\n    }\n\n    if (!canExecute) {\n      return;\n    }\n\n    if (context.hints && context.hints.createElementsBehavior === false) {\n      return;\n    }\n\n    activateDirectEdit(element);\n  });\n\n  eventBus.on('autoPlace.end', 500, function(event) {\n    activateDirectEdit(event.shape);\n  });\n\n\n  function activateDirectEdit(element, force) {\n    if (force ||\n        isAny(element, [ 'bpmn:Task', 'bpmn:TextAnnotation', 'bpmn:Group' ]) ||\n        isCollapsedSubProcess(element)) {\n\n      directEditing.activate(element);\n    }\n  }\n\n}\n\nLabelEditingProvider.$inject = [\n  'eventBus',\n  'bpmnFactory',\n  'canvas',\n  'directEditing',\n  'modeling',\n  'resizeHandles',\n  'textRenderer'\n];\n\n\n/**\n * Activate direct editing for activities and text annotations.\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object with properties bounds (position and size), text and options\n */\nLabelEditingProvider.prototype.activate = function(element) {\n\n  // text\n  var text = getLabel(element);\n\n  if (text === undefined) {\n    return;\n  }\n\n  var context = {\n    text: text\n  };\n\n  // bounds\n  var bounds = this.getEditingBBox(element);\n\n  assign(context, bounds);\n\n  var options = {};\n\n  // tasks\n  if (\n    isAny(element, [\n      'bpmn:Task',\n      'bpmn:Participant',\n      'bpmn:Lane',\n      'bpmn:CallActivity'\n    ]) ||\n    isCollapsedSubProcess(element)\n  ) {\n    assign(options, {\n      centerVertically: true\n    });\n  }\n\n  // external labels\n  if (isLabelExternal(element)) {\n    assign(options, {\n      autoResize: true\n    });\n  }\n\n  // text annotations\n  if (is(element, 'bpmn:TextAnnotation')) {\n    assign(options, {\n      resizable: true,\n      autoResize: true\n    });\n  }\n\n  assign(context, {\n    options: options\n  });\n\n  return context;\n};\n\n\n/**\n * Get the editing bounding box based on the element's size and position\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object containing information about position\n *                  and size (fixed or minimum and/or maximum)\n */\nLabelEditingProvider.prototype.getEditingBBox = function(element) {\n  var canvas = this._canvas;\n\n  var target = element.label || element;\n\n  var bbox = canvas.getAbsoluteBBox(target);\n\n  var mid = {\n    x: bbox.x + bbox.width / 2,\n    y: bbox.y + bbox.height / 2\n  };\n\n  // default position\n  var bounds = { x: bbox.x, y: bbox.y };\n\n  var zoom = canvas.zoom();\n\n  var defaultStyle = this._textRenderer.getDefaultStyle(),\n      externalStyle = this._textRenderer.getExternalStyle();\n\n  // take zoom into account\n  var externalFontSize = externalStyle.fontSize * zoom,\n      externalLineHeight = externalStyle.lineHeight,\n      defaultFontSize = defaultStyle.fontSize * zoom,\n      defaultLineHeight = defaultStyle.lineHeight;\n\n  var style = {\n    fontFamily: this._textRenderer.getDefaultStyle().fontFamily,\n    fontWeight: this._textRenderer.getDefaultStyle().fontWeight\n  };\n\n  // adjust for expanded pools AND lanes\n  if (is(element, 'bpmn:Lane') || isExpandedPool(element)) {\n\n    assign(bounds, {\n      width: bbox.height,\n      height: 30 * zoom,\n      x: bbox.x - bbox.height / 2 + (15 * zoom),\n      y: mid.y - (30 * zoom) / 2\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: (7 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (5 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px',\n      transform: 'rotate(-90deg)'\n    });\n  }\n\n\n  // internal labels for tasks and collapsed call activities,\n  // sub processes and participants\n  if (isAny(element, [ 'bpmn:Task', 'bpmn:CallActivity']) ||\n      isCollapsedPool(element) ||\n      isCollapsedSubProcess(element)) {\n\n    assign(bounds, {\n      width: bbox.width,\n      height: bbox.height\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: (7 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (5 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px'\n    });\n  }\n\n\n  // internal labels for expanded sub processes\n  if (isExpandedSubProcess(element)) {\n    assign(bounds, {\n      width: bbox.width,\n      x: bbox.x\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: (7 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (5 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px'\n    });\n  }\n\n  var width = 90 * zoom,\n      paddingTop = 7 * zoom,\n      paddingBottom = 4 * zoom;\n\n  // external labels for events, data elements, gateways, groups and connections\n  if (target.labelTarget) {\n    assign(bounds, {\n      width: width,\n      height: bbox.height + paddingTop + paddingBottom,\n      x: mid.x - width / 2,\n      y: bbox.y - paddingTop\n    });\n\n    assign(style, {\n      fontSize: externalFontSize + 'px',\n      lineHeight: externalLineHeight,\n      paddingTop: paddingTop + 'px',\n      paddingBottom: paddingBottom + 'px'\n    });\n  }\n\n  // external label not yet created\n  if (isLabelExternal(target)\n      && !hasExternalLabel(target)\n      && !isLabel(target)) {\n\n    var externalLabelMid = getExternalLabelMid(element);\n\n    var absoluteBBox = canvas.getAbsoluteBBox({\n      x: externalLabelMid.x,\n      y: externalLabelMid.y,\n      width: 0,\n      height: 0\n    });\n\n    var height = externalFontSize + paddingTop + paddingBottom;\n\n    assign(bounds, {\n      width: width,\n      height: height,\n      x: absoluteBBox.x - width / 2,\n      y: absoluteBBox.y - height / 2\n    });\n\n    assign(style, {\n      fontSize: externalFontSize + 'px',\n      lineHeight: externalLineHeight,\n      paddingTop: paddingTop + 'px',\n      paddingBottom: paddingBottom + 'px'\n    });\n  }\n\n  // text annotations\n  if (is(element, 'bpmn:TextAnnotation')) {\n    assign(bounds, {\n      width: bbox.width,\n      height: bbox.height,\n      minWidth: 30 * zoom,\n      minHeight: 10 * zoom\n    });\n\n    assign(style, {\n      textAlign: 'left',\n      paddingTop: (5 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (7 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px',\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight\n    });\n  }\n\n  return { bounds: bounds, style: style };\n};\n\n\nLabelEditingProvider.prototype.update = function(\n    element, newLabel,\n    activeContextText, bounds) {\n\n  var newBounds,\n      bbox;\n\n  if (is(element, 'bpmn:TextAnnotation')) {\n\n    bbox = this._canvas.getAbsoluteBBox(element);\n\n    newBounds = {\n      x: element.x,\n      y: element.y,\n      width: element.width / bbox.width * bounds.width,\n      height: element.height / bbox.height * bounds.height\n    };\n  }\n\n  if (is(element, 'bpmn:Group')) {\n\n    var businessObject = getBusinessObject(element);\n\n    // initialize categoryValue if not existing\n    if (!businessObject.categoryValueRef) {\n\n      var rootElement = this._canvas.getRootElement(),\n          definitions = getBusinessObject(rootElement).$parent;\n\n      var categoryValue = createCategoryValue(definitions, this._bpmnFactory);\n\n      getBusinessObject(element).categoryValueRef = categoryValue;\n    }\n\n  }\n\n  if (isEmptyText(newLabel)) {\n    newLabel = null;\n  }\n\n  this._modeling.updateLabel(element, newLabel, newBounds);\n};\n\n\n\n// helpers //////////////////////\n\nfunction isCollapsedSubProcess(element) {\n  return is(element, 'bpmn:SubProcess') && !isExpanded(element);\n}\n\nfunction isExpandedSubProcess(element) {\n  return is(element, 'bpmn:SubProcess') && isExpanded(element);\n}\n\nfunction isCollapsedPool(element) {\n  return is(element, 'bpmn:Participant') && !isExpanded(element);\n}\n\nfunction isExpandedPool(element) {\n  return is(element, 'bpmn:Participant') && isExpanded(element);\n}\n\nfunction isEmptyText(label) {\n  return !label || !label.trim();\n}","import {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  translate\n} from 'diagram-js/lib/util/SvgTransformUtil';\n\nvar MARKER_HIDDEN = 'djs-element-hidden',\n    MARKER_LABEL_HIDDEN = 'djs-label-hidden';\n\n\nexport default function LabelEditingPreview(\n    eventBus, canvas, elementRegistry,\n    pathMap) {\n\n  var self = this;\n\n  var defaultLayer = canvas.getDefaultLayer();\n\n  var element, absoluteElementBBox, gfx;\n\n  eventBus.on('directEditing.activate', function(context) {\n    var activeProvider = context.active;\n\n    element = activeProvider.element.label || activeProvider.element;\n\n    // text annotation\n    if (is(element, 'bpmn:TextAnnotation')) {\n      absoluteElementBBox = canvas.getAbsoluteBBox(element);\n\n      gfx = svgCreate('g');\n\n      var textPathData = pathMap.getScaledPath('TEXT_ANNOTATION', {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.0,\n          my: 0.0\n        }\n      });\n\n      var path = self.path = svgCreate('path');\n\n      svgAttr(path, {\n        d: textPathData,\n        strokeWidth: 2,\n        stroke: getStrokeColor(element)\n      });\n\n      svgAppend(gfx, path);\n\n      svgAppend(defaultLayer, gfx);\n\n      translate(gfx, element.x, element.y);\n    }\n\n    if (is(element, 'bpmn:TextAnnotation') ||\n        element.labelTarget) {\n      canvas.addMarker(element, MARKER_HIDDEN);\n    } else if (is(element, 'bpmn:Task') ||\n               is(element, 'bpmn:CallActivity') ||\n               is(element, 'bpmn:SubProcess') ||\n               is(element, 'bpmn:Participant')) {\n      canvas.addMarker(element, MARKER_LABEL_HIDDEN);\n    }\n  });\n\n  eventBus.on('directEditing.resize', function(context) {\n\n    // text annotation\n    if (is(element, 'bpmn:TextAnnotation')) {\n      var height = context.height,\n          dy = context.dy;\n\n      var newElementHeight = Math.max(element.height / absoluteElementBBox.height * (height + dy), 0);\n\n      var textPathData = pathMap.getScaledPath('TEXT_ANNOTATION', {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: newElementHeight,\n        position: {\n          mx: 0.0,\n          my: 0.0\n        }\n      });\n\n      svgAttr(self.path, {\n        d: textPathData\n      });\n    }\n  });\n\n  eventBus.on([ 'directEditing.complete', 'directEditing.cancel' ], function(context) {\n    var activeProvider = context.active;\n\n    if (activeProvider) {\n      canvas.removeMarker(activeProvider.element.label || activeProvider.element, MARKER_HIDDEN);\n      canvas.removeMarker(element, MARKER_LABEL_HIDDEN);\n    }\n\n    element = undefined;\n    absoluteElementBBox = undefined;\n\n    if (gfx) {\n      svgRemove(gfx);\n\n      gfx = undefined;\n    }\n  });\n}\n\nLabelEditingPreview.$inject = [\n  'eventBus',\n  'canvas',\n  'elementRegistry',\n  'pathMap'\n];\n\n\n// helpers ///////////////////\n\nfunction getStrokeColor(element, defaultColor) {\n  var bo = getBusinessObject(element);\n\n  return bo.di.get('stroke') || defaultColor || 'black';\n}","import ChangeSupportModule from 'diagram-js/lib/features/change-support';\nimport ResizeModule from 'diagram-js/lib/features/resize';\nimport DirectEditingModule from 'diagram-js-direct-editing';\n\nimport LabelEditingProvider from './LabelEditingProvider';\nimport LabelEditingPreview from './LabelEditingPreview';\n\n\nexport default {\n  __depends__: [\n    ChangeSupportModule,\n    ResizeModule,\n    DirectEditingModule\n  ],\n  __init__: [\n    'labelEditingProvider',\n    'labelEditingPreview'\n  ],\n  labelEditingProvider: [ 'type', LabelEditingProvider ],\n  labelEditingPreview: [ 'type', LabelEditingPreview ]\n};\n","import inherits from 'inherits';\n\nimport {\n  getOrientation,\n  getMid,\n  asTRBL\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  substract\n} from 'diagram-js/lib/util/Math';\n\nimport {\n  hasExternalLabel\n} from '../../../util/LabelUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nvar ALIGNMENTS = [\n  'top',\n  'bottom',\n  'left',\n  'right'\n];\n\nvar ELEMENT_LABEL_DISTANCE = 10;\n\n/**\n * A component that makes sure that external labels are added\n * together with respective elements and properly updated (DI wise)\n * during move.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function AdaptiveLabelPositioningBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this.postExecuted([\n    'connection.create',\n    'connection.layout',\n    'connection.updateWaypoints'\n  ], function(event) {\n    var context = event.context,\n        connection = context.connection,\n        source = connection.source,\n        target = connection.target,\n        hints = context.hints || {};\n\n    if (hints.createElementsBehavior !== false) {\n      checkLabelAdjustment(source);\n      checkLabelAdjustment(target);\n    }\n  });\n\n\n  this.postExecuted([\n    'label.create'\n  ], function(event) {\n    var context = event.context,\n        shape = context.shape,\n        hints = context.hints || {};\n\n    if (hints.createElementsBehavior !== false) {\n      checkLabelAdjustment(shape.labelTarget);\n    }\n  });\n\n\n  this.postExecuted([\n    'elements.create'\n  ], function(event) {\n    var context = event.context,\n        elements = context.elements,\n        hints = context.hints || {};\n\n    if (hints.createElementsBehavior !== false) {\n      elements.forEach(function(element) {\n        checkLabelAdjustment(element);\n      });\n    }\n  });\n\n  function checkLabelAdjustment(element) {\n\n    // skip non-existing labels\n    if (!hasExternalLabel(element)) {\n      return;\n    }\n\n    var optimalPosition = getOptimalPosition(element);\n\n    // no optimal position found\n    if (!optimalPosition) {\n      return;\n    }\n\n    adjustLabelPosition(element, optimalPosition);\n  }\n\n  function adjustLabelPosition(element, orientation) {\n\n    var elementMid = getMid(element),\n        label = element.label,\n        labelMid = getMid(label);\n\n    // ignore labels that are being created\n    if (!label.parent) {\n      return;\n    }\n\n    var elementTrbl = asTRBL(element);\n\n    var newLabelMid;\n\n    switch (orientation) {\n    case 'top':\n      newLabelMid = {\n        x: elementMid.x,\n        y: elementTrbl.top - ELEMENT_LABEL_DISTANCE - label.height / 2\n      };\n\n      break;\n\n    case 'left':\n\n      newLabelMid = {\n        x: elementTrbl.left - ELEMENT_LABEL_DISTANCE - label.width / 2,\n        y: elementMid.y\n      };\n\n      break;\n\n    case 'bottom':\n\n      newLabelMid = {\n        x: elementMid.x,\n        y: elementTrbl.bottom + ELEMENT_LABEL_DISTANCE + label.height / 2\n      };\n\n      break;\n\n    case 'right':\n\n      newLabelMid = {\n        x: elementTrbl.right + ELEMENT_LABEL_DISTANCE + label.width / 2,\n        y: elementMid.y\n      };\n\n      break;\n    }\n\n    var delta = substract(newLabelMid, labelMid);\n\n    modeling.moveShape(label, delta);\n  }\n\n}\n\ninherits(AdaptiveLabelPositioningBehavior, CommandInterceptor);\n\nAdaptiveLabelPositioningBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n\n\n// helpers //////////////////////\n\n/**\n * Return alignments which are taken by a boundary's host element\n *\n * @param {Shape} element\n *\n * @return {Array<String>}\n */\nfunction getTakenHostAlignments(element) {\n\n  var hostElement = element.host,\n      elementMid = getMid(element),\n      hostOrientation = getOrientation(elementMid, hostElement);\n\n  var freeAlignments;\n\n  // check whether there is a multi-orientation, e.g. 'top-left'\n  if (hostOrientation.indexOf('-') >= 0) {\n    freeAlignments = hostOrientation.split('-');\n  } else {\n    freeAlignments = [ hostOrientation ];\n  }\n\n  var takenAlignments = ALIGNMENTS.filter(function(alignment) {\n\n    return freeAlignments.indexOf(alignment) === -1;\n  });\n\n  return takenAlignments;\n\n}\n\n/**\n * Return alignments which are taken by related connections\n *\n * @param {Shape} element\n *\n * @return {Array<String>}\n */\nfunction getTakenConnectionAlignments(element) {\n\n  var elementMid = getMid(element);\n\n  var takenAlignments = [].concat(\n    element.incoming.map(function(c) {\n      return c.waypoints[c.waypoints.length - 2 ];\n    }),\n    element.outgoing.map(function(c) {\n      return c.waypoints[1];\n    })\n  ).map(function(point) {\n    return getApproximateOrientation(elementMid, point);\n  });\n\n  return takenAlignments;\n}\n\n/**\n * Return the optimal label position around an element\n * or _undefined_, if none was found.\n *\n * @param  {Shape} element\n *\n * @return {String} positioning identifier\n */\nfunction getOptimalPosition(element) {\n\n  var labelMid = getMid(element.label);\n\n  var elementMid = getMid(element);\n\n  var labelOrientation = getApproximateOrientation(elementMid, labelMid);\n\n  if (!isAligned(labelOrientation)) {\n    return;\n  }\n\n  var takenAlignments = getTakenConnectionAlignments(element);\n\n  if (element.host) {\n    var takenHostAlignments = getTakenHostAlignments(element);\n\n    takenAlignments = takenAlignments.concat(takenHostAlignments);\n  }\n\n  var freeAlignments = ALIGNMENTS.filter(function(alignment) {\n\n    return takenAlignments.indexOf(alignment) === -1;\n  });\n\n  // NOTHING TO DO; label already aligned a.O.K.\n  if (freeAlignments.indexOf(labelOrientation) !== -1) {\n    return;\n  }\n\n  return freeAlignments[0];\n}\n\nfunction getApproximateOrientation(p0, p1) {\n  return getOrientation(p1, p0, 5);\n}\n\nfunction isAligned(orientation) {\n  return ALIGNMENTS.indexOf(orientation) !== -1;\n}\n","import inherits from 'inherits';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\n\nexport default function AppendBehavior(eventBus, elementFactory, bpmnRules) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  // assign correct shape position unless already set\n\n  this.preExecute('shape.append', function(context) {\n\n    var source = context.source,\n        shape = context.shape;\n\n    if (!context.position) {\n\n      if (is(shape, 'bpmn:TextAnnotation')) {\n        context.position = {\n          x: source.x + source.width / 2 + 75,\n          y: source.y - (50) - shape.height / 2\n        };\n      } else {\n        context.position = {\n          x: source.x + source.width + 80 + shape.width / 2,\n          y: source.y + source.height / 2\n        };\n      }\n    }\n  }, true);\n}\n\ninherits(AppendBehavior, CommandInterceptor);\n\nAppendBehavior.$inject = [\n  'eventBus',\n  'elementFactory',\n  'bpmnRules'\n];","import inherits from 'inherits';\r\n\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\r\n\r\nimport {\r\n  filter,\r\n  forEach\r\n} from 'min-dash';\r\n\r\n\r\nexport default function AssociationBehavior(injector, modeling) {\r\n  injector.invoke(CommandInterceptor, this);\r\n\r\n  this.postExecute('shape.move', function(context) {\r\n    var newParent = context.newParent,\r\n        shape = context.shape;\r\n\r\n    var associations = filter(shape.incoming.concat(shape.outgoing), function(connection) {\r\n      return is(connection, 'bpmn:Association');\r\n    });\r\n\r\n    forEach(associations, function(association) {\r\n      modeling.moveConnection(association, { x: 0, y: 0 }, newParent);\r\n    });\r\n  }, true);\r\n}\r\n\r\ninherits(AssociationBehavior, CommandInterceptor);\r\n\r\nAssociationBehavior.$inject = [\r\n  'injector',\r\n  'modeling'\r\n];","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { getBusinessObject } from '../../../util/ModelUtil';\n\nimport { isAny } from '../util/ModelingUtil';\n\nimport { isLabel } from '../../../util/LabelUtil';\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * Replace intermediate event with boundary event when creating or moving results in attached event.\n */\nexport default function AttachEventBehavior(bpmnReplace, injector) {\n  injector.invoke(CommandInterceptor, this);\n\n  this._bpmnReplace = bpmnReplace;\n\n  var self = this;\n\n  this.postExecuted('elements.create', LOW_PRIORITY, function(context) {\n    var elements = context.elements;\n\n    elements = elements.filter(function(shape) {\n      var host = shape.host;\n\n      return shouldReplace(shape, host);\n    });\n\n    if (elements.length !== 1) {\n      return;\n    }\n\n    elements.map(function(element) {\n      return elements.indexOf(element);\n    }).forEach(function(index) {\n      var host = elements[ index ];\n\n      context.elements[ index ] = self.replaceShape(elements[ index ], host);\n    });\n  }, true);\n\n\n  this.preExecute('elements.move', LOW_PRIORITY, function(context) {\n    var shapes = context.shapes,\n        host = context.newHost;\n\n    if (shapes.length !== 1) {\n      return;\n    }\n\n    var shape = shapes[0];\n\n    if (shouldReplace(shape, host)) {\n      context.shapes = [ self.replaceShape(shape, host) ];\n    }\n  }, true);\n}\n\nAttachEventBehavior.$inject = [\n  'bpmnReplace',\n  'injector'\n];\n\ninherits(AttachEventBehavior, CommandInterceptor);\n\nAttachEventBehavior.prototype.replaceShape = function(shape, host) {\n  var eventDefinition = getEventDefinition(shape);\n\n  var boundaryEvent = {\n    type: 'bpmn:BoundaryEvent',\n    host: host\n  };\n\n  if (eventDefinition) {\n    boundaryEvent.eventDefinitionType = eventDefinition.$type;\n  }\n\n  return this._bpmnReplace.replaceElement(shape, boundaryEvent, { layoutConnection: false });\n};\n\n\n// helpers //////////\n\nfunction getEventDefinition(element) {\n  var businessObject = getBusinessObject(element),\n      eventDefinitions = businessObject.eventDefinitions;\n\n  return eventDefinitions && eventDefinitions[0];\n}\n\nfunction shouldReplace(shape, host) {\n  return !isLabel(shape) &&\n    isAny(shape, [ 'bpmn:IntermediateThrowEvent', 'bpmn:IntermediateCatchEvent' ]) && !!host;\n}\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport {\n  filter,\n  forEach\n} from 'min-dash';\n\n\n/**\n * BPMN specific boundary event behavior\n */\nexport default function BoundaryEventBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  function getBoundaryEvents(element) {\n    return filter(element.attachers, function(attacher) {\n      return is(attacher, 'bpmn:BoundaryEvent');\n    });\n  }\n\n  // remove after connecting to event-based gateway\n  this.postExecute('connection.create', function(event) {\n    var source = event.context.source,\n        target = event.context.target,\n        boundaryEvents = getBoundaryEvents(target);\n\n    if (\n      is(source, 'bpmn:EventBasedGateway') &&\n      is(target, 'bpmn:ReceiveTask') &&\n      boundaryEvents.length > 0\n    ) {\n      modeling.removeElements(boundaryEvents);\n    }\n\n  });\n\n  // remove after replacing connected gateway with event-based gateway\n  this.postExecute('connection.reconnect', function(event) {\n    var oldSource = event.context.oldSource,\n        newSource = event.context.newSource;\n\n    if (is(oldSource, 'bpmn:Gateway') &&\n        is(newSource, 'bpmn:EventBasedGateway')) {\n      forEach(newSource.outgoing, function(connection) {\n        var target = connection.target,\n            attachedboundaryEvents = getBoundaryEvents(target);\n\n        if (is(target, 'bpmn:ReceiveTask') &&\n            attachedboundaryEvents.length > 0) {\n          modeling.removeElements(attachedboundaryEvents);\n        }\n      });\n    }\n  });\n}\n\nBoundaryEventBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n\ninherits(BoundaryEventBehavior, CommandInterceptor);\n","import inherits from 'inherits';\r\n\r\nimport {\r\n  find,\r\n  isArray,\r\n  matchPattern,\r\n  some\r\n} from 'min-dash';\r\n\r\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\r\n\r\nimport {\r\n  add as collectionAdd,\r\n  remove as collectionRemove\r\n} from 'diagram-js/lib/util/Collections';\r\n\r\nimport {\r\n  getBusinessObject,\r\n  is\r\n} from '../../../util/ModelUtil';\r\n\r\nimport { isAny } from '../util/ModelingUtil';\r\n\r\nimport { hasEventDefinition } from '../../../util/DiUtil';\r\n\r\nvar LOW_PRIORITY = 500;\r\n\r\n\r\n/**\r\n * Add referenced root elements (error, escalation, message, signal) if they don't exist.\r\n * Copy referenced root elements on copy & paste.\r\n */\r\nexport default function RootElementReferenceBehavior(\r\n    bpmnjs, eventBus, injector, moddleCopy, bpmnFactory\r\n) {\r\n  injector.invoke(CommandInterceptor, this);\r\n\r\n  function canHaveRootElementReference(element) {\r\n    return isAny(element, [ 'bpmn:ReceiveTask', 'bpmn:SendTask' ]) ||\r\n      hasAnyEventDefinition(element, [\r\n        'bpmn:ErrorEventDefinition',\r\n        'bpmn:EscalationEventDefinition',\r\n        'bpmn:MessageEventDefinition',\r\n        'bpmn:SignalEventDefinition'\r\n      ]);\r\n  }\r\n\r\n  function hasRootElement(rootElement) {\r\n    var definitions = bpmnjs.getDefinitions(),\r\n        rootElements = definitions.get('rootElements');\r\n\r\n    return !!find(rootElements, matchPattern({ id: rootElement.id }));\r\n  }\r\n\r\n  function getRootElementReferencePropertyName(eventDefinition) {\r\n    if (is(eventDefinition, 'bpmn:ErrorEventDefinition')) {\r\n      return 'errorRef';\r\n    } else if (is(eventDefinition, 'bpmn:EscalationEventDefinition')) {\r\n      return 'escalationRef';\r\n    } else if (is(eventDefinition, 'bpmn:MessageEventDefinition')) {\r\n      return 'messageRef';\r\n    } else if (is(eventDefinition, 'bpmn:SignalEventDefinition')) {\r\n      return 'signalRef';\r\n    }\r\n  }\r\n\r\n  function getRootElement(businessObject) {\r\n    if (isAny(businessObject, [ 'bpmn:ReceiveTask', 'bpmn:SendTask' ])) {\r\n      return businessObject.get('messageRef');\r\n    }\r\n\r\n    var eventDefinitions = businessObject.get('eventDefinitions'),\r\n        eventDefinition = eventDefinitions[ 0 ];\r\n\r\n    return eventDefinition.get(getRootElementReferencePropertyName(eventDefinition));\r\n  }\r\n\r\n  function setRootElement(businessObject, rootElement) {\r\n    if (isAny(businessObject, [ 'bpmn:ReceiveTask', 'bpmn:SendTask' ])) {\r\n      return businessObject.set('messageRef', rootElement);\r\n    }\r\n\r\n    var eventDefinitions = businessObject.get('eventDefinitions'),\r\n        eventDefinition = eventDefinitions[ 0 ];\r\n\r\n    return eventDefinition.set(getRootElementReferencePropertyName(eventDefinition), rootElement);\r\n  }\r\n\r\n  // create shape\r\n  this.executed('shape.create', function(context) {\r\n    var shape = context.shape;\r\n\r\n    if (!canHaveRootElementReference(shape)) {\r\n      return;\r\n    }\r\n\r\n    var businessObject = getBusinessObject(shape),\r\n        rootElement = getRootElement(businessObject),\r\n        rootElements;\r\n\r\n    if (rootElement && !hasRootElement(rootElement)) {\r\n      rootElements = bpmnjs.getDefinitions().get('rootElements');\r\n\r\n      // add root element\r\n      collectionAdd(rootElements, rootElement);\r\n\r\n      context.addedRootElement = rootElement;\r\n    }\r\n  }, true);\r\n\r\n  this.reverted('shape.create', function(context) {\r\n    var addedRootElement = context.addedRootElement;\r\n\r\n    if (!addedRootElement) {\r\n      return;\r\n    }\r\n\r\n    var rootElements = bpmnjs.getDefinitions().get('rootElements');\r\n\r\n    // remove root element\r\n    collectionRemove(rootElements, addedRootElement);\r\n  }, true);\r\n\r\n  eventBus.on('copyPaste.copyElement', function(context) {\r\n    var descriptor = context.descriptor,\r\n        element = context.element;\r\n\r\n    if (!canHaveRootElementReference(element)) {\r\n      return;\r\n    }\r\n\r\n    var businessObject = getBusinessObject(element),\r\n        rootElement = getRootElement(businessObject);\r\n\r\n    if (rootElement) {\r\n      descriptor.referencedRootElement = rootElement;\r\n    }\r\n  });\r\n\r\n  eventBus.on('copyPaste.pasteElement', LOW_PRIORITY, function(context) {\r\n    var descriptor = context.descriptor,\r\n        businessObject = descriptor.businessObject;\r\n\r\n    if (!canHaveRootElementReference(businessObject)) {\r\n      return;\r\n    }\r\n\r\n    var referencedRootElement = descriptor.referencedRootElement;\r\n\r\n    if (!referencedRootElement) {\r\n      return;\r\n    }\r\n\r\n    if (!hasRootElement(referencedRootElement)) {\r\n      referencedRootElement = moddleCopy.copyElement(\r\n        referencedRootElement,\r\n        bpmnFactory.create(referencedRootElement.$type)\r\n      );\r\n    }\r\n\r\n    setRootElement(businessObject, referencedRootElement);\r\n  });\r\n}\r\n\r\nRootElementReferenceBehavior.$inject = [\r\n  'bpmnjs',\r\n  'eventBus',\r\n  'injector',\r\n  'moddleCopy',\r\n  'bpmnFactory'\r\n];\r\n\r\ninherits(RootElementReferenceBehavior, CommandInterceptor);\r\n\r\n// helpers //////////\r\n\r\nfunction hasAnyEventDefinition(element, types) {\r\n  if (!isArray(types)) {\r\n    types = [ types ];\r\n  }\r\n\r\n  return some(types, function(type) {\r\n    return hasEventDefinition(element, type);\r\n  });\r\n}","import inherits from 'inherits';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { getParent } from '../util/ModelingUtil';\n\n\nexport default function CreateBehavior(injector) {\n  injector.invoke(CommandInterceptor, this);\n\n  this.preExecute('shape.create', 1500, function(event) {\n    var context = event.context,\n        parent = context.parent,\n        shape = context.shape;\n\n    if (is(parent, 'bpmn:Lane') && !is(shape, 'bpmn:Lane')) {\n      context.parent = getParent(parent, 'bpmn:Participant');\n    }\n  });\n\n}\n\n\nCreateBehavior.$inject = [ 'injector' ];\n\ninherits(CreateBehavior, CommandInterceptor);","import { getLanesRoot } from '../util/LaneUtil';\r\n\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\nimport { isAny } from '../util/ModelingUtil';\r\n\r\nvar HIGH_PRIORITY = 1500;\r\nvar HIGHEST_PRIORITY = 2000;\r\n\r\n\r\n/**\r\n * Correct hover targets in certain situations to improve diagram interaction.\r\n *\r\n * @param {ElementRegistry} elementRegistry\r\n * @param {EventBus} eventBus\r\n * @param {Canvas} canvas\r\n */\r\nexport default function FixHoverBehavior(elementRegistry, eventBus, canvas) {\r\n\r\n  eventBus.on([\r\n    'create.hover',\r\n    'create.move',\r\n    'create.end',\r\n    'shape.move.hover',\r\n    'shape.move.move',\r\n    'shape.move.end'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape || event.shape,\r\n        hover = event.hover;\r\n\r\n    // ensure elements are not dropped onto a bpmn:Lane but onto\r\n    // the underlying bpmn:Participant\r\n    if (is(hover, 'bpmn:Lane') && !isAny(shape, [ 'bpmn:Lane', 'bpmn:Participant' ])) {\r\n      event.hover = getLanesRoot(hover);\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n\r\n    var rootElement = canvas.getRootElement();\r\n\r\n    // ensure bpmn:Group and label elements are dropped\r\n    // always onto the root\r\n    if (hover !== rootElement && (shape.labelTarget || is(shape, 'bpmn:Group'))) {\r\n      event.hover = rootElement;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n\r\n  eventBus.on([\r\n    'connect.hover',\r\n    'connect.out',\r\n    'connect.end',\r\n    'connect.cleanup',\r\n    'global-connect.hover',\r\n    'global-connect.out',\r\n    'global-connect.end',\r\n    'global-connect.cleanup'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var hover = event.hover;\r\n\r\n    // ensure connections start/end on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(hover, 'bpmn:Lane')) {\r\n      event.hover = getLanesRoot(hover) || hover;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n\r\n  eventBus.on([\r\n    'bendpoint.move.hover'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        hover = event.hover,\r\n        type = context.type;\r\n\r\n    // ensure reconnect start/end on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(hover, 'bpmn:Lane') && /reconnect/.test(type)) {\r\n      event.hover = getLanesRoot(hover) || hover;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n\r\n  eventBus.on([\r\n    'connect.start'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        start = context.start;\r\n\r\n    // ensure connect start on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(start, 'bpmn:Lane')) {\r\n      context.start = getLanesRoot(start) || start;\r\n    }\r\n  });\r\n\r\n\r\n  // allow movement of participants from lanes\r\n  eventBus.on('shape.move.start', HIGHEST_PRIORITY, function(event) {\r\n    var shape = event.shape;\r\n\r\n    if (is(shape, 'bpmn:Lane')) {\r\n      event.shape = getLanesRoot(shape) || shape;\r\n    }\r\n  });\r\n\r\n}\r\n\r\nFixHoverBehavior.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'canvas'\r\n];","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\n\n/**\n * BPMN specific create data object behavior\n */\nexport default function CreateDataObjectBehavior(eventBus, bpmnFactory, moddle) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this.preExecute('shape.create', function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:DataObjectReference') && shape.type !== 'label') {\n\n      // create a DataObject every time a DataObjectReference is created\n      var dataObject = bpmnFactory.create('bpmn:DataObject');\n\n      // set the reference to the DataObject\n      shape.businessObject.dataObjectRef = dataObject;\n    }\n  });\n\n}\n\nCreateDataObjectBehavior.$inject = [\n  'eventBus',\n  'bpmnFactory',\n  'moddle'\n];\n\ninherits(CreateDataObjectBehavior, CommandInterceptor);","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport { isLabel } from '../../../util/LabelUtil';\n\nimport { getBBox } from 'diagram-js/lib/util/Elements';\n\nimport {\n  assign,\n  find\n} from 'min-dash';\n\nimport { asTRBL } from 'diagram-js/lib/layout/LayoutUtil';\n\nvar HORIZONTAL_PARTICIPANT_PADDING = 20,\n    VERTICAL_PARTICIPANT_PADDING = 20;\n\nexport var PARTICIPANT_BORDER_WIDTH = 30;\n\nvar HIGH_PRIORITY = 2000;\n\n\n/**\n * BPMN-specific behavior for creating participants.\n */\nexport default function CreateParticipantBehavior(canvas, eventBus, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  // fit participant\n  eventBus.on([\n    'create.start',\n    'shape.move.start'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        shape = context.shape,\n        rootElement = canvas.getRootElement();\n\n    if (!is(shape, 'bpmn:Participant') ||\n      !is(rootElement, 'bpmn:Process') ||\n      !rootElement.children.length) {\n      return;\n    }\n\n    // ignore connections, groups and labels\n    var children = rootElement.children.filter(function(element) {\n      return !is(element, 'bpmn:Group') &&\n        !isLabel(element) &&\n        !isConnection(element);\n    });\n\n    // ensure for available children to calculate bounds\n    if (!children.length) {\n      return;\n    }\n\n    var childrenBBox = getBBox(children);\n\n    var participantBounds = getParticipantBounds(shape, childrenBBox);\n\n    // assign width and height\n    assign(shape, participantBounds);\n\n    // assign create constraints\n    context.createConstraints = getParticipantCreateConstraints(shape, childrenBBox);\n  });\n\n  // force hovering process when creating first participant\n  eventBus.on('create.start', HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        shape = context.shape,\n        rootElement = canvas.getRootElement(),\n        rootElementGfx = canvas.getGraphics(rootElement);\n\n    function ensureHoveringProcess(event) {\n      event.element = rootElement;\n      event.gfx = rootElementGfx;\n    }\n\n    if (is(shape, 'bpmn:Participant') && is(rootElement, 'bpmn:Process')) {\n      eventBus.on('element.hover', HIGH_PRIORITY, ensureHoveringProcess);\n\n      eventBus.once('create.cleanup', function() {\n        eventBus.off('element.hover', ensureHoveringProcess);\n      });\n    }\n  });\n\n  function ensureCollaboration(context) {\n    var parent = context.parent,\n        collaboration;\n\n    var rootElement = canvas.getRootElement();\n\n    if (is(rootElement, 'bpmn:Collaboration')) {\n      collaboration = rootElement;\n    } else {\n\n      // update root element by making collaboration\n      collaboration = modeling.makeCollaboration();\n\n      // re-use process when creating first participant\n      context.process = parent;\n    }\n\n    context.parent = collaboration;\n  }\n\n  // turn process into collaboration before adding participant\n  this.preExecute('shape.create', function(context) {\n    var parent = context.parent,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Participant') && is(parent, 'bpmn:Process')) {\n      ensureCollaboration(context);\n    }\n  }, true);\n\n  this.execute('shape.create', function(context) {\n    var process = context.process,\n        shape = context.shape;\n\n    if (process) {\n      context.oldProcessRef = shape.businessObject.processRef;\n\n      // re-use process when creating first participant\n      shape.businessObject.processRef = process.businessObject;\n    }\n  }, true);\n\n  this.revert('shape.create', function(context) {\n    var process = context.process,\n        shape = context.shape;\n\n    if (process) {\n\n      // re-use process when creating first participant\n      shape.businessObject.processRef = context.oldProcessRef;\n    }\n  }, true);\n\n  this.postExecute('shape.create', function(context) {\n    var process = context.process,\n        shape = context.shape;\n\n    if (process) {\n\n      // move children from process to participant\n      var processChildren = process.children.slice();\n\n      modeling.moveElements(processChildren, { x: 0, y: 0 }, shape);\n    }\n\n  }, true);\n\n  // turn process into collaboration when creating participants\n  this.preExecute('elements.create', HIGH_PRIORITY, function(context) {\n    var elements = context.elements,\n        parent = context.parent,\n        participant;\n\n    var hasParticipants = findParticipant(elements);\n\n    if (hasParticipants && is(parent, 'bpmn:Process')) {\n      ensureCollaboration(context);\n\n      participant = findParticipant(elements);\n\n      context.oldProcessRef = participant.businessObject.processRef;\n\n      // re-use process when creating first participant\n      participant.businessObject.processRef = parent.businessObject;\n    }\n  }, true);\n\n  this.revert('elements.create', function(context) {\n    var elements = context.elements,\n        process = context.process,\n        participant;\n\n    if (process) {\n      participant = findParticipant(elements);\n\n      // re-use process when creating first participant\n      participant.businessObject.processRef = context.oldProcessRef;\n    }\n  }, true);\n\n  this.postExecute('elements.create', function(context) {\n    var elements = context.elements,\n        process = context.process,\n        participant;\n\n    if (process) {\n      participant = findParticipant(elements);\n\n      // move children from process to first participant\n      var processChildren = process.children.slice();\n\n      modeling.moveElements(processChildren, { x: 0, y: 0 }, participant);\n    }\n\n  }, true);\n\n}\n\nCreateParticipantBehavior.$inject = [\n  'canvas',\n  'eventBus',\n  'modeling'\n];\n\ninherits(CreateParticipantBehavior, CommandInterceptor);\n\n// helpers //////////\n\nfunction getParticipantBounds(shape, childrenBBox) {\n  childrenBBox = {\n    width: childrenBBox.width + HORIZONTAL_PARTICIPANT_PADDING * 2 + PARTICIPANT_BORDER_WIDTH,\n    height: childrenBBox.height + VERTICAL_PARTICIPANT_PADDING * 2\n  };\n\n  var width = Math.max(shape.width, childrenBBox.width),\n      height = Math.max(shape.height, childrenBBox.height);\n\n  return {\n    x: -width / 2,\n    y: -height / 2,\n    width: width,\n    height: height\n  };\n}\n\nfunction getParticipantCreateConstraints(shape, childrenBBox) {\n  childrenBBox = asTRBL(childrenBBox);\n\n  return {\n    bottom: childrenBBox.top + shape.height / 2 - VERTICAL_PARTICIPANT_PADDING,\n    left: childrenBBox.right - shape.width / 2 + HORIZONTAL_PARTICIPANT_PADDING,\n    top: childrenBBox.bottom - shape.height / 2 + VERTICAL_PARTICIPANT_PADDING,\n    right: childrenBBox.left + shape.width / 2 - HORIZONTAL_PARTICIPANT_PADDING - PARTICIPANT_BORDER_WIDTH\n  };\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction findParticipant(elements) {\n  return find(elements, function(element) {\n    return is(element, 'bpmn:Participant');\n  });\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  find\n} from 'min-dash';\n\nimport {\n  is\n} from '../../../util/ModelUtil';\n\nvar TARGET_REF_PLACEHOLDER_NAME = '__targetRef_placeholder';\n\n\n/**\n * This behavior makes sure we always set a fake\n * DataInputAssociation#targetRef as demanded by the BPMN 2.0\n * XSD schema.\n *\n * The reference is set to a bpmn:Property{ name: '__targetRef_placeholder' }\n * which is created on the fly and cleaned up afterwards if not needed\n * anymore.\n *\n * @param {EventBus} eventBus\n * @param {BpmnFactory} bpmnFactory\n */\nexport default function DataInputAssociationBehavior(eventBus, bpmnFactory) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  this.executed([\n    'connection.create',\n    'connection.delete',\n    'connection.move',\n    'connection.reconnect'\n  ], ifDataInputAssociation(fixTargetRef));\n\n  this.reverted([\n    'connection.create',\n    'connection.delete',\n    'connection.move',\n    'connection.reconnect'\n  ], ifDataInputAssociation(fixTargetRef));\n\n\n  function usesTargetRef(element, targetRef, removedConnection) {\n\n    var inputAssociations = element.get('dataInputAssociations');\n\n    return find(inputAssociations, function(association) {\n      return association !== removedConnection &&\n             association.targetRef === targetRef;\n    });\n  }\n\n  function getTargetRef(element, create) {\n\n    var properties = element.get('properties');\n\n    var targetRefProp = find(properties, function(p) {\n      return p.name === TARGET_REF_PLACEHOLDER_NAME;\n    });\n\n    if (!targetRefProp && create) {\n      targetRefProp = bpmnFactory.create('bpmn:Property', {\n        name: TARGET_REF_PLACEHOLDER_NAME\n      });\n\n      collectionAdd(properties, targetRefProp);\n    }\n\n    return targetRefProp;\n  }\n\n  function cleanupTargetRef(element, connection) {\n\n    var targetRefProp = getTargetRef(element);\n\n    if (!targetRefProp) {\n      return;\n    }\n\n    if (!usesTargetRef(element, targetRefProp, connection)) {\n      collectionRemove(element.get('properties'), targetRefProp);\n    }\n  }\n\n  /**\n   * Make sure targetRef is set to a valid property or\n   * `null` if the connection is detached.\n   *\n   * @param {Event} event\n   */\n  function fixTargetRef(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        connectionBo = connection.businessObject,\n        target = connection.target,\n        targetBo = target && target.businessObject,\n        newTarget = context.newTarget,\n        newTargetBo = newTarget && newTarget.businessObject,\n        oldTarget = context.oldTarget || context.target,\n        oldTargetBo = oldTarget && oldTarget.businessObject;\n\n    var dataAssociation = connection.businessObject,\n        targetRefProp;\n\n    if (oldTargetBo && oldTargetBo !== targetBo) {\n      cleanupTargetRef(oldTargetBo, connectionBo);\n    }\n\n    if (newTargetBo && newTargetBo !== targetBo) {\n      cleanupTargetRef(newTargetBo, connectionBo);\n    }\n\n    if (targetBo) {\n      targetRefProp = getTargetRef(targetBo, true);\n      dataAssociation.targetRef = targetRefProp;\n    } else {\n      dataAssociation.targetRef = null;\n    }\n  }\n}\n\nDataInputAssociationBehavior.$inject = [\n  'eventBus',\n  'bpmnFactory'\n];\n\ninherits(DataInputAssociationBehavior, CommandInterceptor);\n\n\n/**\n * Only call the given function when the event\n * touches a bpmn:DataInputAssociation.\n *\n * @param {Function} fn\n * @return {Function}\n */\nfunction ifDataInputAssociation(fn) {\n\n  return function(event) {\n    var context = event.context,\n        connection = context.connection;\n\n    if (is(connection, 'bpmn:DataInputAssociation')) {\n      return fn(event);\n    }\n  };\n}","export default function UpdateSemanticParentHandler(bpmnUpdater) {\r\n  this._bpmnUpdater = bpmnUpdater;\r\n}\r\n\r\nUpdateSemanticParentHandler.$inject = [ 'bpmnUpdater' ];\r\n\r\n\r\nUpdateSemanticParentHandler.prototype.execute = function(context) {\r\n  var dataStoreBo = context.dataStoreBo,\r\n      newSemanticParent = context.newSemanticParent,\r\n      newDiParent = context.newDiParent;\r\n\r\n  context.oldSemanticParent = dataStoreBo.$parent;\r\n  context.oldDiParent = dataStoreBo.di.$parent;\r\n\r\n  // update semantic parent\r\n  this._bpmnUpdater.updateSemanticParent(dataStoreBo, newSemanticParent);\r\n\r\n  // update DI parent\r\n  this._bpmnUpdater.updateDiParent(dataStoreBo.di, newDiParent);\r\n};\r\n\r\nUpdateSemanticParentHandler.prototype.revert = function(context) {\r\n  var dataStoreBo = context.dataStoreBo,\r\n      oldSemanticParent = context.oldSemanticParent,\r\n      oldDiParent = context.oldDiParent;\r\n\r\n  // update semantic parent\r\n  this._bpmnUpdater.updateSemanticParent(dataStoreBo, oldSemanticParent);\r\n\r\n  // update DI parent\r\n  this._bpmnUpdater.updateDiParent(dataStoreBo.di, oldDiParent);\r\n};\r\n\r\n","import inherits from 'inherits';\r\n\r\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\r\n\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\nimport { isAny } from '../util/ModelingUtil';\r\n\r\nimport UpdateSemanticParentHandler from '../cmd/UpdateSemanticParentHandler';\r\n\r\n\r\n/**\r\n * BPMN specific data store behavior\r\n */\r\nexport default function DataStoreBehavior(\r\n    canvas, commandStack, elementRegistry,\r\n    eventBus) {\r\n\r\n  CommandInterceptor.call(this, eventBus);\r\n\r\n  commandStack.registerHandler('dataStore.updateContainment', UpdateSemanticParentHandler);\r\n\r\n  function getFirstParticipant() {\r\n    return elementRegistry.filter(function(element) {\r\n      return is(element, 'bpmn:Participant');\r\n    })[0];\r\n  }\r\n\r\n  function getDataStores(element) {\r\n    return element.children.filter(function(child) {\r\n      return is(child, 'bpmn:DataStoreReference') && !child.labelTarget;\r\n    });\r\n  }\r\n\r\n  function updateDataStoreParent(dataStore, newDataStoreParent) {\r\n    var dataStoreBo = dataStore.businessObject || dataStore;\r\n\r\n    newDataStoreParent = newDataStoreParent || getFirstParticipant();\r\n\r\n    if (newDataStoreParent) {\r\n      var newDataStoreParentBo = newDataStoreParent.businessObject || newDataStoreParent;\r\n\r\n      commandStack.execute('dataStore.updateContainment', {\r\n        dataStoreBo: dataStoreBo,\r\n        newSemanticParent: newDataStoreParentBo.processRef || newDataStoreParentBo,\r\n        newDiParent: newDataStoreParentBo.di\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  // disable auto-resize for data stores\r\n  this.preExecute('shape.create', function(event) {\r\n\r\n    var context = event.context,\r\n        shape = context.shape;\r\n\r\n    if (is(shape, 'bpmn:DataStoreReference') &&\r\n        shape.type !== 'label') {\r\n\r\n      if (!context.hints) {\r\n        context.hints = {};\r\n      }\r\n\r\n      // prevent auto resizing\r\n      context.hints.autoResize = false;\r\n    }\r\n  });\r\n\r\n\r\n  // disable auto-resize for data stores\r\n  this.preExecute('elements.move', function(event) {\r\n    var context = event.context,\r\n        shapes = context.shapes;\r\n\r\n    var dataStoreReferences = shapes.filter(function(shape) {\r\n      return is(shape, 'bpmn:DataStoreReference');\r\n    });\r\n\r\n    if (dataStoreReferences.length) {\r\n      if (!context.hints) {\r\n        context.hints = {};\r\n      }\r\n\r\n      // prevent auto resizing for data store references\r\n      context.hints.autoResize = shapes.filter(function(shape) {\r\n        return !is(shape, 'bpmn:DataStoreReference');\r\n      });\r\n    }\r\n  });\r\n\r\n\r\n  // update parent on data store created\r\n  this.postExecute('shape.create', function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        parent = shape.parent;\r\n\r\n\r\n    if (is(shape, 'bpmn:DataStoreReference') &&\r\n        shape.type !== 'label' &&\r\n        is(parent, 'bpmn:Collaboration')) {\r\n\r\n      updateDataStoreParent(shape);\r\n    }\r\n  });\r\n\r\n\r\n  // update parent on data store moved\r\n  this.postExecute('shape.move', function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        oldParent = context.oldParent,\r\n        parent = shape.parent;\r\n\r\n    if (is(oldParent, 'bpmn:Collaboration')) {\r\n\r\n      // do nothing if not necessary\r\n      return;\r\n    }\r\n\r\n    if (is(shape, 'bpmn:DataStoreReference') &&\r\n        shape.type !== 'label' &&\r\n        is(parent, 'bpmn:Collaboration')) {\r\n\r\n      var participant = is(oldParent, 'bpmn:Participant') ?\r\n        oldParent :\r\n        getAncestor(oldParent, 'bpmn:Participant');\r\n\r\n      updateDataStoreParent(shape, participant);\r\n    }\r\n  });\r\n\r\n\r\n  // update data store parents on participant or subprocess deleted\r\n  this.postExecute('shape.delete', function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        rootElement = canvas.getRootElement();\r\n\r\n    if (isAny(shape, [ 'bpmn:Participant', 'bpmn:SubProcess' ])\r\n        && is(rootElement, 'bpmn:Collaboration')) {\r\n      getDataStores(rootElement)\r\n        .filter(function(dataStore) {\r\n          return isDescendant(dataStore, shape);\r\n        })\r\n        .forEach(function(dataStore) {\r\n          updateDataStoreParent(dataStore);\r\n        });\r\n    }\r\n  });\r\n\r\n  // update data store parents on collaboration -> process\r\n  this.postExecute('canvas.updateRoot', function(event) {\r\n    var context = event.context,\r\n        oldRoot = context.oldRoot,\r\n        newRoot = context.newRoot;\r\n\r\n    var dataStores = getDataStores(oldRoot);\r\n\r\n    dataStores.forEach(function(dataStore) {\r\n\r\n      if (is(newRoot, 'bpmn:Process')) {\r\n        updateDataStoreParent(dataStore, newRoot);\r\n      }\r\n\r\n    });\r\n  });\r\n}\r\n\r\nDataStoreBehavior.$inject = [\r\n  'canvas',\r\n  'commandStack',\r\n  'elementRegistry',\r\n  'eventBus',\r\n];\r\n\r\ninherits(DataStoreBehavior, CommandInterceptor);\r\n\r\n\r\n// helpers //////////\r\n\r\nfunction isDescendant(descendant, ancestor) {\r\n  var descendantBo = descendant.businessObject || descendant,\r\n      ancestorBo = ancestor.businessObject || ancestor;\r\n\r\n  while (descendantBo.$parent) {\r\n    if (descendantBo.$parent === ancestorBo.processRef || ancestorBo) {\r\n      return true;\r\n    }\r\n\r\n    descendantBo = descendantBo.$parent;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nfunction getAncestor(element, type) {\r\n\r\n  while (element.parent) {\r\n    if (is(element.parent, type)) {\r\n      return element.parent;\r\n    }\r\n\r\n    element = element.parent;\r\n  }\r\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport {\n  getChildLanes\n} from '../util/LaneUtil';\n\nimport {\n  eachElement\n} from 'diagram-js/lib/util/Elements';\n\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * BPMN specific delete lane behavior\n */\nexport default function DeleteLaneBehavior(eventBus, modeling, spaceTool) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  function compensateLaneDelete(shape, oldParent) {\n\n    var siblings = getChildLanes(oldParent);\n\n    var topAffected = [];\n    var bottomAffected = [];\n\n    eachElement(siblings, function(element) {\n\n      if (element.y > shape.y) {\n        bottomAffected.push(element);\n      } else {\n        topAffected.push(element);\n      }\n\n      return element.children;\n    });\n\n    if (!siblings.length) {\n      return;\n    }\n\n    var offset;\n\n    if (bottomAffected.length && topAffected.length) {\n      offset = shape.height / 2;\n    } else {\n      offset = shape.height;\n    }\n\n    var topAdjustments,\n        bottomAdjustments;\n\n    if (topAffected.length) {\n      topAdjustments = spaceTool.calculateAdjustments(\n        topAffected, 'y', offset, shape.y - 10);\n\n      spaceTool.makeSpace(\n        topAdjustments.movingShapes,\n        topAdjustments.resizingShapes,\n        { x: 0, y: offset }, 's');\n    }\n\n    if (bottomAffected.length) {\n      bottomAdjustments = spaceTool.calculateAdjustments(\n        bottomAffected, 'y', -offset, shape.y + shape.height + 10);\n\n      spaceTool.makeSpace(\n        bottomAdjustments.movingShapes,\n        bottomAdjustments.resizingShapes,\n        { x: 0, y: -offset }, 'n');\n    }\n  }\n\n\n  /**\n   * Adjust sizes of other lanes after lane deletion\n   */\n  this.postExecuted('shape.delete', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape,\n        oldParent = context.oldParent;\n\n    // only compensate lane deletes\n    if (!is(shape, 'bpmn:Lane')) {\n      return;\n    }\n\n    // compensate root deletes only\n    if (hints && hints.nested) {\n      return;\n    }\n\n    compensateLaneDelete(shape, oldParent);\n  });\n}\n\nDeleteLaneBehavior.$inject = [\n  'eventBus',\n  'modeling',\n  'spaceTool'\n];\n\ninherits(DeleteLaneBehavior, CommandInterceptor);","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../../util/ModelUtil';\n\nimport { isLabel } from '../../../util/LabelUtil';\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * Replace boundary event with intermediate event when creating or moving results in detached event.\n */\nexport default function DetachEventBehavior(bpmnReplace, injector) {\n  injector.invoke(CommandInterceptor, this);\n\n  this._bpmnReplace = bpmnReplace;\n\n  var self = this;\n\n  this.postExecuted('elements.create', LOW_PRIORITY, function(context) {\n    var elements = context.elements;\n\n    elements.filter(function(shape) {\n      var host = shape.host;\n\n      return shouldReplace(shape, host);\n    }).map(function(shape) {\n      return elements.indexOf(shape);\n    }).forEach(function(index) {\n      context.elements[ index ] = self.replaceShape(elements[ index ]);\n    });\n  }, true);\n\n  this.preExecute('elements.move', LOW_PRIORITY, function(context) {\n    var shapes = context.shapes,\n        newHost = context.newHost;\n\n    shapes.forEach(function(shape, index) {\n      var host = shape.host;\n\n      if (shouldReplace(shape, includes(shapes, host) ? host : newHost)) {\n        shapes[ index ] = self.replaceShape(shape);\n      }\n    });\n  }, true);\n}\n\nDetachEventBehavior.$inject = [\n  'bpmnReplace',\n  'injector'\n];\n\ninherits(DetachEventBehavior, CommandInterceptor);\n\nDetachEventBehavior.prototype.replaceShape = function(shape) {\n  var eventDefinition = getEventDefinition(shape),\n      intermediateEvent;\n\n  if (eventDefinition) {\n    intermediateEvent = {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: eventDefinition.$type\n    };\n  } else {\n    intermediateEvent = {\n      type: 'bpmn:IntermediateThrowEvent'\n    };\n  }\n\n  return this._bpmnReplace.replaceElement(shape, intermediateEvent, { layoutConnection: false });\n};\n\n\n// helpers //////////\n\nfunction getEventDefinition(element) {\n  var businessObject = getBusinessObject(element),\n      eventDefinitions = businessObject.eventDefinitions;\n\n  return eventDefinitions && eventDefinitions[0];\n}\n\nfunction shouldReplace(shape, host) {\n  return !isLabel(shape) && is(shape, 'bpmn:BoundaryEvent') && !host;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}","import inherits from 'inherits';\n\nimport {\n  assign,\n  filter,\n  find,\n  isNumber\n} from 'min-dash';\n\nimport { getMid } from 'diagram-js/lib/layout/LayoutUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getApproxIntersection\n} from 'diagram-js/lib/util/LineIntersection';\n\n\nexport default function DropOnFlowBehavior(eventBus, bpmnRules, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Reconnect start / end of a connection after\n   * dropping an element on a flow.\n   */\n\n  function insertShape(shape, targetFlow, positionOrBounds) {\n    var waypoints = targetFlow.waypoints,\n        waypointsBefore,\n        waypointsAfter,\n        dockingPoint,\n        source,\n        target,\n        incomingConnection,\n        outgoingConnection,\n        oldOutgoing = shape.outgoing.slice(),\n        oldIncoming = shape.incoming.slice();\n\n    var mid;\n\n    if (isNumber(positionOrBounds.width)) {\n      mid = getMid(positionOrBounds);\n    } else {\n      mid = positionOrBounds;\n    }\n\n    var intersection = getApproxIntersection(waypoints, mid);\n\n    if (intersection) {\n      waypointsBefore = waypoints.slice(0, intersection.index);\n      waypointsAfter = waypoints.slice(intersection.index + (intersection.bendpoint ? 1 : 0));\n\n      // due to inaccuracy intersection might have been found\n      if (!waypointsBefore.length || !waypointsAfter.length) {\n        return;\n      }\n\n      dockingPoint = intersection.bendpoint ? waypoints[intersection.index] : mid;\n\n      // if last waypointBefore is inside shape's bounds, ignore docking point\n      if (!isPointInsideBBox(shape, waypointsBefore[waypointsBefore.length-1])) {\n        waypointsBefore.push(copy(dockingPoint));\n      }\n\n      // if first waypointAfter is inside shape's bounds, ignore docking point\n      if (!isPointInsideBBox(shape, waypointsAfter[0])) {\n        waypointsAfter.unshift(copy(dockingPoint));\n      }\n    }\n\n    source = targetFlow.source;\n    target = targetFlow.target;\n\n    if (bpmnRules.canConnect(source, shape, targetFlow)) {\n\n      // reconnect source -> inserted shape\n      modeling.reconnectEnd(targetFlow, shape, waypointsBefore || mid);\n\n      incomingConnection = targetFlow;\n    }\n\n    if (bpmnRules.canConnect(shape, target, targetFlow)) {\n\n      if (!incomingConnection) {\n\n        // reconnect inserted shape -> end\n        modeling.reconnectStart(targetFlow, shape, waypointsAfter || mid);\n\n        outgoingConnection = targetFlow;\n      } else {\n        outgoingConnection = modeling.connect(\n          shape, target, { type: targetFlow.type, waypoints: waypointsAfter }\n        );\n      }\n    }\n\n    var duplicateConnections = [].concat(\n\n      incomingConnection && filter(oldIncoming, function(connection) {\n        return connection.source === incomingConnection.source;\n      }) || [],\n\n      outgoingConnection && filter(oldOutgoing, function(connection) {\n        return connection.target === outgoingConnection.target;\n      }) || []\n    );\n\n    if (duplicateConnections.length) {\n      modeling.removeElements(duplicateConnections);\n    }\n  }\n\n  this.preExecute('elements.move', function(context) {\n\n    var newParent = context.newParent,\n        shapes = context.shapes,\n        delta = context.delta,\n        shape = shapes[0];\n\n    if (!shape || !newParent) {\n      return;\n    }\n\n    // if the new parent is a connection,\n    // change it to the new parent's parent\n    if (newParent && newParent.waypoints) {\n      context.newParent = newParent = newParent.parent;\n    }\n\n    var shapeMid = getMid(shape);\n    var newShapeMid = {\n      x: shapeMid.x + delta.x,\n      y: shapeMid.y + delta.y\n    };\n\n    // find a connection which intersects with the\n    // element's mid point\n    var connection = find(newParent.children, function(element) {\n      var canInsert = bpmnRules.canInsert(shapes, element);\n\n      return canInsert && getApproxIntersection(element.waypoints, newShapeMid);\n    });\n\n    if (connection) {\n      context.targetFlow = connection;\n      context.position = newShapeMid;\n    }\n\n  }, true);\n\n  this.postExecuted('elements.move', function(context) {\n\n    var shapes = context.shapes,\n        targetFlow = context.targetFlow,\n        position = context.position;\n\n    if (targetFlow) {\n      insertShape(shapes[0], targetFlow, position);\n    }\n\n  }, true);\n\n  this.preExecute('shape.create', function(context) {\n\n    var parent = context.parent,\n        shape = context.shape;\n\n    if (bpmnRules.canInsert(shape, parent)) {\n      context.targetFlow = parent;\n      context.parent = parent.parent;\n    }\n  }, true);\n\n  this.postExecuted('shape.create', function(context) {\n\n    var shape = context.shape,\n        targetFlow = context.targetFlow,\n        positionOrBounds = context.position;\n\n    if (targetFlow) {\n      insertShape(shape, targetFlow, positionOrBounds);\n    }\n  }, true);\n}\n\ninherits(DropOnFlowBehavior, CommandInterceptor);\n\nDropOnFlowBehavior.$inject = [\n  'eventBus',\n  'bpmnRules',\n  'modeling'\n];\n\n\n// helpers /////////////////////\n\nfunction isPointInsideBBox(bbox, point) {\n  var x = point.x,\n      y = point.y;\n\n  return x >= bbox.x &&\n    x <= bbox.x + bbox.width &&\n    y >= bbox.y &&\n    y <= bbox.y + bbox.height;\n}\n\nfunction copy(obj) {\n  return assign({}, obj);\n}\n\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nexport default function EventBasedGatewayBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Remove existing sequence flows of event-based target before connecting\n   * from event-based gateway.\n   */\n  this.preExecuted('connection.create', function(event) {\n\n    var context = event.context,\n        source = context.source,\n        target = context.target,\n        existingIncomingConnections = target.incoming.slice();\n\n    if (context.hints && context.hints.createElementsBehavior === false) {\n      return;\n    }\n\n    if (\n      is(source, 'bpmn:EventBasedGateway') &&\n      target.incoming.length\n    ) {\n\n      existingIncomingConnections.filter(isSequenceFlow)\n        .forEach(function(sequenceFlow) {\n          modeling.removeConnection(sequenceFlow);\n        });\n    }\n  });\n\n  /**\n   *  After replacing shape with event-based gateway, remove incoming sequence\n   *  flows of event-based targets which do not belong to event-based gateway\n   *  source.\n   */\n  this.preExecuted('shape.replace', function(event) {\n\n    var newShape = event.context.newShape,\n        newShapeTargets,\n        newShapeTargetsIncomingSequenceFlows;\n\n    if (!is(newShape, 'bpmn:EventBasedGateway')) {\n      return;\n    }\n\n    newShapeTargets = newShape.outgoing.filter(isSequenceFlow)\n      .map(function(sequenceFlow) {\n        return sequenceFlow.target;\n      });\n\n    newShapeTargetsIncomingSequenceFlows = newShapeTargets.reduce(function(sequenceFlows, target) {\n      var incomingSequenceFlows = target.incoming.filter(isSequenceFlow);\n\n      return sequenceFlows.concat(incomingSequenceFlows);\n    }, []);\n\n    newShapeTargetsIncomingSequenceFlows.forEach(function(sequenceFlow) {\n      if (sequenceFlow.source !== newShape) {\n        modeling.removeConnection(sequenceFlow);\n      }\n    });\n  });\n}\n\nEventBasedGatewayBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n\ninherits(EventBasedGatewayBehavior, CommandInterceptor);\n\n\n\n// helpers //////////////////////\n\nfunction isSequenceFlow(connection) {\n  return is(connection, 'bpmn:SequenceFlow');\n}\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../../util/ModelUtil';\n\nimport {\n  createCategoryValue\n} from './util/CategoryUtil';\n\nvar HIGH_PRIORITY = 2000;\n\n\n/**\n * BPMN specific Group behavior\n */\nexport default function GroupBehavior(\n    bpmnFactory,\n    canvas,\n    elementRegistry,\n    eventBus,\n    injector,\n    moddleCopy\n) {\n  injector.invoke(CommandInterceptor, this);\n\n  /**\n   * Gets process definitions\n   *\n   * @return {ModdleElement} definitions\n   */\n  function getDefinitions() {\n    var rootElement = canvas.getRootElement(),\n        businessObject = getBusinessObject(rootElement);\n\n    return businessObject.$parent;\n  }\n\n  /**\n   * Removes a referenced category value for a given group shape\n   *\n   * @param {djs.model.Shape} shape\n   */\n  function removeReferencedCategoryValue(shape) {\n\n    var businessObject = getBusinessObject(shape),\n        categoryValue = businessObject.categoryValueRef;\n\n    if (!categoryValue) {\n      return;\n    }\n\n    var category = categoryValue.$parent;\n\n    if (!categoryValue) {\n      return;\n    }\n\n    collectionRemove(category.categoryValue, categoryValue);\n\n    // cleanup category if it is empty\n    if (category && !category.categoryValue.length) {\n      removeCategory(category);\n    }\n  }\n\n  /**\n   * Removes a given category from the definitions\n   *\n   * @param {ModdleElement} category\n   */\n  function removeCategory(category) {\n\n    var definitions = getDefinitions();\n\n    collectionRemove(definitions.get('rootElements'), category);\n  }\n\n  /**\n   * Returns all group element in the current registry\n   *\n   * @return {Array<djs.model.shape>} a list of group shapes\n   */\n  function getGroupElements() {\n    return elementRegistry.filter(function(e) {\n      return is(e, 'bpmn:Group');\n    });\n  }\n\n  /**\n   * Returns true if given categoryValue is referenced in one of the given elements\n   *\n   * @param {Array<djs.model.shape>} elements\n   * @param {ModdleElement} categoryValue\n   * @return {Boolean}\n   */\n  function isReferenced(elements, categoryValue) {\n    return elements.some(function(e) {\n\n      var businessObject = getBusinessObject(e);\n\n      return businessObject.categoryValueRef\n        && businessObject.categoryValueRef === categoryValue;\n    });\n  }\n\n  /**\n   * remove referenced category + value when group was deleted\n   */\n  this.executed('shape.delete', function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Group')) {\n\n      var businessObject = getBusinessObject(shape),\n          categoryValueRef = businessObject.categoryValueRef,\n          groupElements = getGroupElements();\n\n      if (!isReferenced(groupElements, categoryValueRef)) {\n        removeReferencedCategoryValue(shape);\n      }\n    }\n  });\n\n  /**\n   * re-attach removed category\n   */\n  this.reverted('shape.delete', function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Group')) {\n\n      var businessObject = getBusinessObject(shape),\n          categoryValueRef = businessObject.categoryValueRef,\n          definitions = getDefinitions(),\n          category = categoryValueRef ? categoryValueRef.$parent : null;\n\n      collectionAdd(category.get('categoryValue'), categoryValueRef);\n      collectionAdd(definitions.get('rootElements'), category);\n    }\n  });\n\n  /**\n   * create new category + value when group was created\n   */\n  this.execute('shape.create', function(event) {\n    var context = event.context,\n        shape = context.shape,\n        businessObject = getBusinessObject(shape);\n\n    if (is(businessObject, 'bpmn:Group') && !businessObject.categoryValueRef) {\n\n      var definitions = getDefinitions(),\n          categoryValue = createCategoryValue(definitions, bpmnFactory);\n\n      // link the reference to the Group\n      businessObject.categoryValueRef = categoryValue;\n    }\n  });\n\n\n  this.revert('shape.create', function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Group')) {\n      removeReferencedCategoryValue(shape);\n\n      delete getBusinessObject(shape).categoryValueRef;\n\n    }\n  });\n\n  // copy bpmn:CategoryValue when copying element\n  eventBus.on('moddleCopy.canCopyProperty', HIGH_PRIORITY, function(context) {\n    var property = context.property,\n        categoryValue;\n\n    if (is(property, 'bpmn:CategoryValue')) {\n      categoryValue = createCategoryValue(getDefinitions(), bpmnFactory);\n\n      // return copy of category\n      return moddleCopy.copyElement(property, categoryValue);\n    }\n  });\n\n}\n\nGroupBehavior.$inject = [\n  'bpmnFactory',\n  'canvas',\n  'elementRegistry',\n  'eventBus',\n  'injector',\n  'moddleCopy'\n];\n\ninherits(GroupBehavior, CommandInterceptor);","/**\n * Returns the intersection between two line segments a and b.\n *\n * @param {Point} l1s\n * @param {Point} l1e\n * @param {Point} l2s\n * @param {Point} l2e\n *\n * @return {Point}\n */\nexport default function lineIntersect(l1s, l1e, l2s, l2e) {\n\n  // if the lines intersect, the result contains the x and y of the\n  // intersection (treating the lines as infinite) and booleans for\n  // whether line segment 1 or line segment 2 contain the point\n  var denominator, a, b, c, numerator;\n\n  denominator = ((l2e.y - l2s.y) * (l1e.x - l1s.x)) - ((l2e.x - l2s.x) * (l1e.y - l1s.y));\n\n  if (denominator == 0) {\n    return null;\n  }\n\n  a = l1s.y - l2s.y;\n  b = l1s.x - l2s.x;\n  numerator = ((l2e.x - l2s.x) * a) - ((l2e.y - l2s.y) * b);\n\n  c = numerator / denominator;\n\n  // if we cast these lines infinitely in\n  // both directions, they intersect here\n  return {\n    x: Math.round(l1s.x + (c * (l1e.x - l1s.x))),\n    y: Math.round(l1s.y + (c * (l1e.y - l1s.y)))\n  };\n}","import {\n  getMid\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport lineIntersect from './util/LineIntersect';\n\n\n/**\n * Fix broken dockings after DI imports.\n *\n * @param {EventBus} eventBus\n */\nexport default function ImportDockingFix(eventBus) {\n\n  function adjustDocking(startPoint, nextPoint, elementMid) {\n\n    var elementTop = {\n      x: elementMid.x,\n      y: elementMid.y - 50\n    };\n\n    var elementLeft = {\n      x: elementMid.x - 50,\n      y: elementMid.y\n    };\n\n    var verticalIntersect = lineIntersect(startPoint, nextPoint, elementMid, elementTop),\n        horizontalIntersect = lineIntersect(startPoint, nextPoint, elementMid, elementLeft);\n\n    // original is horizontal or vertical center cross intersection\n    var centerIntersect;\n\n    if (verticalIntersect && horizontalIntersect) {\n      if (getDistance(verticalIntersect, elementMid) > getDistance(horizontalIntersect, elementMid)) {\n        centerIntersect = horizontalIntersect;\n      } else {\n        centerIntersect = verticalIntersect;\n      }\n    } else {\n      centerIntersect = verticalIntersect || horizontalIntersect;\n    }\n\n    startPoint.original = centerIntersect;\n  }\n\n  function fixDockings(connection) {\n    var waypoints = connection.waypoints;\n\n    adjustDocking(\n      waypoints[0],\n      waypoints[1],\n      getMid(connection.source)\n    );\n\n    adjustDocking(\n      waypoints[waypoints.length - 1],\n      waypoints[waypoints.length - 2],\n      getMid(connection.target)\n    );\n  }\n\n  eventBus.on('bpmnElement.added', function(e) {\n\n    var element = e.element;\n\n    if (element.waypoints) {\n      fixDockings(element);\n    }\n  });\n}\n\nImportDockingFix.$inject = [\n  'eventBus'\n];\n\n\n// helpers //////////////////////\n\nfunction getDistance(p1, p2) {\n  return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getBusinessObject\n} from '../../../util/ModelUtil';\n\nimport {\n  isAny\n} from '../util/ModelingUtil';\n\n/**\n * A component that makes sure that each created or updated\n * Pool and Lane is assigned an isHorizontal property set to true.\n *\n * @param {EventBus} eventBus\n */\nexport default function IsHorizontalFix(eventBus) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var elementTypesToUpdate = [\n    'bpmn:Participant',\n    'bpmn:Lane'\n  ];\n\n  this.executed([ 'shape.move', 'shape.create', 'shape.resize' ], function(event) {\n    var bo = getBusinessObject(event.context.shape);\n\n    if (isAny(bo, elementTypesToUpdate) && !bo.di.get('isHorizontal')) {\n\n      // set attribute directly to avoid modeling#updateProperty side effects\n      bo.di.set('isHorizontal', true);\n    }\n  });\n\n}\n\nIsHorizontalFix.$inject = [ 'eventBus' ];\n\ninherits(IsHorizontalFix, CommandInterceptor);\n","/**\n * Returns the length of a vector\n *\n * @param {Vector}\n * @return {Float}\n */\nexport function vectorLength(v) {\n  return Math.sqrt(Math.pow(v.x, 2) + Math.pow(v.y, 2));\n}\n\n\n/**\n * Calculates the angle between a line a the yAxis\n *\n * @param {Array}\n * @return {Float}\n */\nexport function getAngle(line) {\n\n  // return value is between 0, 180 and -180, -0\n  // @janstuemmel: maybe replace return a/b with b/a\n  return Math.atan((line[1].y - line[0].y) / (line[1].x - line[0].x));\n}\n\n\n/**\n * Rotates a vector by a given angle\n *\n * @param {Vector}\n * @param {Float} Angle in radians\n * @return {Vector}\n */\nexport function rotateVector(vector, angle) {\n  return (!angle) ? vector : {\n    x: Math.cos(angle) * vector.x - Math.sin(angle) * vector.y,\n    y: Math.sin(angle) * vector.x + Math.cos(angle) * vector.y\n  };\n}\n\n\n/**\n * Solves a 2D equation system\n * a + r*b = c, where a,b,c are 2D vectors\n *\n * @param {Vector}\n * @param {Vector}\n * @param {Vector}\n * @return {Float}\n */\nfunction solveLambaSystem(a, b, c) {\n\n  // the 2d system\n  var system = [\n    { n: a[0] - c[0], lambda: b[0] },\n    { n: a[1] - c[1], lambda: b[1] }\n  ];\n\n  // solve\n  var n = system[0].n * b[0] + system[1].n * b[1],\n      l = system[0].lambda * b[0] + system[1].lambda * b[1];\n\n  return -n/l;\n}\n\n\n/**\n * Position of perpendicular foot\n *\n * @param {Point}\n * @param [ {Point}, {Point} ] line defined through two points\n * @return {Point} the perpendicular foot position\n */\nexport function perpendicularFoot(point, line) {\n\n  var a = line[0], b = line[1];\n\n  // relative position of b from a\n  var bd = { x: b.x - a.x, y: b.y - a.y };\n\n  // solve equation system to the parametrized vectors param real value\n  var r = solveLambaSystem([ a.x, a.y ], [ bd.x, bd.y ], [ point.x, point.y ]);\n\n  return { x: a.x + r*bd.x, y: a.y + r*bd.y };\n}\n\n\n/**\n * Calculates the distance between a point and a line\n *\n * @param {Point}\n * @param [ {Point}, {Point} ] line defined through two points\n * @return {Float} distance\n */\nexport function getDistancePointLine(point, line) {\n\n  var pfPoint = perpendicularFoot(point, line);\n\n  // distance vector\n  var connectionVector = {\n    x: pfPoint.x - point.x,\n    y: pfPoint.y - point.y\n  };\n\n  return vectorLength(connectionVector);\n}\n\n\n/**\n * Calculates the distance between two points\n *\n * @param {Point}\n * @param {Point}\n * @return {Float} distance\n */\nexport function getDistancePointPoint(point1, point2) {\n\n  return vectorLength({\n    x: point1.x - point2.x,\n    y: point1.y - point2.y\n  });\n}","var sqrt = Math.sqrt,\n    min = Math.min,\n    max = Math.max,\n    abs = Math.abs;\n\n/**\n * Calculate the square (power to two) of a number.\n *\n * @param {Number} n\n *\n * @return {Number}\n */\nfunction sq(n) {\n  return Math.pow(n, 2);\n}\n\n/**\n * Get distance between two points.\n *\n * @param {Point} p1\n * @param {Point} p2\n *\n * @return {Number}\n */\nfunction getDistance(p1, p2) {\n  return sqrt(sq(p1.x - p2.x) + sq(p1.y - p2.y));\n}\n\n/**\n * Return the attachment of the given point on the specified line.\n *\n * The attachment is either a bendpoint (attached to the given point)\n * or segment (attached to a location on a line segment) attachment:\n *\n * ```javascript\n * var pointAttachment = {\n *   type: 'bendpoint',\n *   bendpointIndex: 3,\n *   position: { x: 10, y: 10 } // the attach point on the line\n * };\n *\n * var segmentAttachment = {\n *   type: 'segment',\n *   segmentIndex: 2,\n *   relativeLocation: 0.31, // attach point location between 0 (at start) and 1 (at end)\n *   position: { x: 10, y: 10 } // the attach point on the line\n * };\n * ```\n *\n * @param {Point} point\n * @param {Array<Point>} line\n *\n * @return {Object} attachment\n */\nexport function getAttachment(point, line) {\n\n  var idx = 0,\n      segmentStart,\n      segmentEnd,\n      segmentStartDistance,\n      segmentEndDistance,\n      attachmentPosition,\n      minDistance,\n      intersections,\n      attachment,\n      attachmentDistance,\n      closestAttachmentDistance,\n      closestAttachment;\n\n  for (idx = 0; idx < line.length - 1; idx++) {\n\n    segmentStart = line[idx];\n    segmentEnd = line[idx + 1];\n\n    if (pointsEqual(segmentStart, segmentEnd)) {\n      intersections = [ segmentStart ];\n    } else {\n      segmentStartDistance = getDistance(point, segmentStart);\n      segmentEndDistance = getDistance(point, segmentEnd);\n\n      minDistance = min(segmentStartDistance, segmentEndDistance);\n\n      intersections = getCircleSegmentIntersections(segmentStart, segmentEnd, point, minDistance);\n    }\n\n    if (intersections.length < 1) {\n      throw new Error('expected between [1, 2] circle -> line intersections');\n    }\n\n    // one intersection -> bendpoint attachment\n    if (intersections.length === 1) {\n      attachment = {\n        type: 'bendpoint',\n        position: intersections[0],\n        segmentIndex: idx,\n        bendpointIndex: pointsEqual(segmentStart, intersections[0]) ? idx : idx + 1\n      };\n    }\n\n    // two intersections -> segment attachment\n    if (intersections.length === 2) {\n\n      attachmentPosition = mid(intersections[0], intersections[1]);\n\n      attachment = {\n        type: 'segment',\n        position: attachmentPosition,\n        segmentIndex: idx,\n        relativeLocation: getDistance(segmentStart, attachmentPosition) / getDistance(segmentStart, segmentEnd)\n      };\n    }\n\n    attachmentDistance = getDistance(attachment.position, point);\n\n    if (!closestAttachment || closestAttachmentDistance > attachmentDistance) {\n      closestAttachment = attachment;\n      closestAttachmentDistance = attachmentDistance;\n    }\n  }\n\n  return closestAttachment;\n}\n\n/**\n * Gets the intersection between a circle and a line segment.\n *\n * @param {Point} s1 segment start\n * @param {Point} s2 segment end\n * @param {Point} cc circle center\n * @param {Number} cr circle radius\n *\n * @return {Array<Point>} intersections\n */\nfunction getCircleSegmentIntersections(s1, s2, cc, cr) {\n\n  var baX = s2.x - s1.x;\n  var baY = s2.y - s1.y;\n  var caX = cc.x - s1.x;\n  var caY = cc.y - s1.y;\n\n  var a = baX * baX + baY * baY;\n  var bBy2 = baX * caX + baY * caY;\n  var c = caX * caX + caY * caY - cr * cr;\n\n  var pBy2 = bBy2 / a;\n  var q = c / a;\n\n  var disc = pBy2 * pBy2 - q;\n\n  // check against negative value to work around\n  // negative, very close to zero results (-4e-15)\n  // being produced in some environments\n  if (disc < 0 && disc > -0.000001) {\n    disc = 0;\n  }\n\n  if (disc < 0) {\n    return [];\n  }\n\n  // if disc == 0 ... dealt with later\n  var tmpSqrt = sqrt(disc);\n  var abScalingFactor1 = -pBy2 + tmpSqrt;\n  var abScalingFactor2 = -pBy2 - tmpSqrt;\n\n  var i1 = {\n    x: s1.x - baX * abScalingFactor1,\n    y: s1.y - baY * abScalingFactor1\n  };\n\n  if (disc === 0) { // abScalingFactor1 == abScalingFactor2\n    return [ i1 ];\n  }\n\n  var i2 = {\n    x: s1.x - baX * abScalingFactor2,\n    y: s1.y - baY * abScalingFactor2\n  };\n\n  // return only points on line segment\n  return [ i1, i2 ].filter(function(p) {\n    return isPointInSegment(p, s1, s2);\n  });\n}\n\n\nfunction isPointInSegment(p, segmentStart, segmentEnd) {\n  return (\n    fenced(p.x, segmentStart.x, segmentEnd.x) &&\n    fenced(p.y, segmentStart.y, segmentEnd.y)\n  );\n}\n\nfunction fenced(n, rangeStart, rangeEnd) {\n\n  // use matching threshold to work around\n  // precision errors in intersection computation\n\n  return (\n    n >= min(rangeStart, rangeEnd) - EQUAL_THRESHOLD &&\n    n <= max(rangeStart, rangeEnd) + EQUAL_THRESHOLD\n  );\n}\n\n/**\n * Calculate mid of two points.\n *\n * @param {Point} p1\n * @param {Point} p2\n *\n * @return {Point}\n */\nfunction mid(p1, p2) {\n\n  return {\n    x: (p1.x + p2.x) / 2,\n    y: (p1.y + p2.y) / 2\n  };\n}\n\nvar EQUAL_THRESHOLD = 0.1;\n\nfunction pointsEqual(p1, p2) {\n\n  return (\n    abs(p1.x - p2.x) <= EQUAL_THRESHOLD &&\n    abs(p1.y - p2.y) <= EQUAL_THRESHOLD\n  );\n}\n","import {\n  getDistancePointPoint,\n  rotateVector,\n  getAngle\n} from './GeometricUtil';\n\nimport {\n  getAttachment\n} from './LineAttachmentUtil';\n\nimport {\n  roundPoint\n} from 'diagram-js/lib/layout/LayoutUtil';\n\n\nexport function findNewLabelLineStartIndex(oldWaypoints, newWaypoints, attachment, hints) {\n\n  var index = attachment.segmentIndex;\n\n  var offset = newWaypoints.length - oldWaypoints.length;\n\n  // segmentMove happened\n  if (hints.segmentMove) {\n\n    var oldSegmentStartIndex = hints.segmentMove.segmentStartIndex,\n        newSegmentStartIndex = hints.segmentMove.newSegmentStartIndex;\n\n    // if label was on moved segment return new segment index\n    if (index === oldSegmentStartIndex) {\n      return newSegmentStartIndex;\n    }\n\n    // label is after new segment index\n    if (index >= newSegmentStartIndex) {\n      return (index+offset < newSegmentStartIndex) ? newSegmentStartIndex : index+offset;\n    }\n\n    // if label is before new segment index\n    return index;\n  }\n\n  // bendpointMove happened\n  if (hints.bendpointMove) {\n\n    var insert = hints.bendpointMove.insert,\n        bendpointIndex = hints.bendpointMove.bendpointIndex,\n        newIndex;\n\n    // waypoints length didnt change\n    if (offset === 0) {\n      return index;\n    }\n\n    // label behind new/removed bendpoint\n    if (index >= bendpointIndex) {\n      newIndex = insert ? index + 1 : index - 1;\n    }\n\n    // label before new/removed bendpoint\n    if (index < bendpointIndex) {\n\n      newIndex = index;\n\n      // decide label should take right or left segment\n      if (insert && attachment.type !== 'bendpoint' && bendpointIndex-1 === index) {\n\n        var rel = relativePositionMidWaypoint(newWaypoints, bendpointIndex);\n\n        if (rel < attachment.relativeLocation) {\n          newIndex++;\n        }\n      }\n    }\n\n    return newIndex;\n  }\n\n  // start/end changed\n  if (offset === 0) {\n    return index;\n  }\n\n  if (hints.connectionStart) {\n    return (index === 0) ? 0 : null;\n  }\n\n  if (hints.connectionEnd) {\n    return (index === oldWaypoints.length - 2) ? newWaypoints.length - 2 : null;\n  }\n\n  // if nothing fits, return null\n  return null;\n}\n\n\n/**\n * Calculate the required adjustment (move delta) for the given label\n * after the connection waypoints got updated.\n *\n * @param {djs.model.Label} label\n * @param {Array<Point>} newWaypoints\n * @param {Array<Point>} oldWaypoints\n * @param {Object} hints\n *\n * @return {Point} delta\n */\nexport function getLabelAdjustment(label, newWaypoints, oldWaypoints, hints) {\n\n  var x = 0,\n      y = 0;\n\n  var labelPosition = getLabelMid(label);\n\n  // get closest attachment\n  var attachment = getAttachment(labelPosition, oldWaypoints),\n      oldLabelLineIndex = attachment.segmentIndex,\n      newLabelLineIndex = findNewLabelLineStartIndex(oldWaypoints, newWaypoints, attachment, hints);\n\n  if (newLabelLineIndex === null) {\n    return { x: x, y: y };\n  }\n\n  // should never happen\n  // TODO(@janstuemmel): throw an error here when connectionSegmentMove is refactored\n  if (newLabelLineIndex < 0 ||\n      newLabelLineIndex > newWaypoints.length - 2) {\n    return { x: x, y: y };\n  }\n\n  var oldLabelLine = getLine(oldWaypoints, oldLabelLineIndex),\n      newLabelLine = getLine(newWaypoints, newLabelLineIndex),\n      oldFoot = attachment.position;\n\n  var relativeFootPosition = getRelativeFootPosition(oldLabelLine, oldFoot),\n      angleDelta = getAngleDelta(oldLabelLine, newLabelLine);\n\n  // special rule if label on bendpoint\n  if (attachment.type === 'bendpoint') {\n\n    var offset = newWaypoints.length - oldWaypoints.length,\n        oldBendpointIndex = attachment.bendpointIndex,\n        oldBendpoint = oldWaypoints[oldBendpointIndex];\n\n    // bendpoint position hasn't changed, return same position\n    if (newWaypoints.indexOf(oldBendpoint) !== -1) {\n      return { x: x, y: y };\n    }\n\n    // new bendpoint and old bendpoint have same index, then just return the offset\n    if (offset === 0) {\n      var newBendpoint = newWaypoints[oldBendpointIndex];\n\n      return {\n        x: newBendpoint.x - attachment.position.x,\n        y: newBendpoint.y - attachment.position.y\n      };\n    }\n\n    // if bendpoints get removed\n    if (offset < 0 && oldBendpointIndex !== 0 && oldBendpointIndex < oldWaypoints.length - 1) {\n      relativeFootPosition = relativePositionMidWaypoint(oldWaypoints, oldBendpointIndex);\n    }\n  }\n\n  var newFoot = {\n    x: (newLabelLine[1].x - newLabelLine[0].x) * relativeFootPosition + newLabelLine[0].x,\n    y: (newLabelLine[1].y - newLabelLine[0].y) * relativeFootPosition + newLabelLine[0].y\n  };\n\n  // the rotated vector to label\n  var newLabelVector = rotateVector({\n    x: labelPosition.x - oldFoot.x,\n    y: labelPosition.y - oldFoot.y\n  }, angleDelta);\n\n  // the new relative position\n  x = newFoot.x + newLabelVector.x - labelPosition.x;\n  y = newFoot.y + newLabelVector.y - labelPosition.y;\n\n  return roundPoint({\n    x: x,\n    y: y\n  });\n}\n\n\n// HELPERS //////////////////////\n\nfunction relativePositionMidWaypoint(waypoints, idx) {\n\n  var distanceSegment1 = getDistancePointPoint(waypoints[idx-1], waypoints[idx]),\n      distanceSegment2 = getDistancePointPoint(waypoints[idx], waypoints[idx+1]);\n\n  var relativePosition = distanceSegment1 / (distanceSegment1 + distanceSegment2);\n\n  return relativePosition;\n}\n\nfunction getLabelMid(label) {\n  return {\n    x: label.x + label.width / 2,\n    y: label.y + label.height / 2\n  };\n}\n\nfunction getAngleDelta(l1, l2) {\n  var a1 = getAngle(l1),\n      a2 = getAngle(l2);\n  return a2 - a1;\n}\n\nfunction getLine(waypoints, idx) {\n  return [ waypoints[idx], waypoints[idx+1] ];\n}\n\nfunction getRelativeFootPosition(line, foot) {\n\n  var length = getDistancePointPoint(line[0], line[1]),\n      lengthToFoot = getDistancePointPoint(line[0], foot);\n\n  return length === 0 ? 0 : lengthToFoot / length;\n}\n","import {\n  roundPoint\n} from '../layout/LayoutUtil';\n\nimport {\n  center,\n  delta\n} from './PositionUtil';\n\n\n/**\n * Calculates the absolute point relative to the new element's position\n *\n * @param {point} point [absolute]\n * @param {bounds} oldBounds\n * @param {bounds} newBounds\n *\n * @return {point} point [absolute]\n */\nexport function getNewAttachPoint(point, oldBounds, newBounds) {\n  var oldCenter = center(oldBounds),\n      newCenter = center(newBounds),\n      oldDelta = delta(point, oldCenter);\n\n  var newDelta = {\n    x: oldDelta.x * (newBounds.width / oldBounds.width),\n    y: oldDelta.y * (newBounds.height / oldBounds.height)\n  };\n\n  return roundPoint({\n    x: newCenter.x + newDelta.x,\n    y: newCenter.y + newDelta.y\n  });\n}\n\n\n/**\n * Calculates the shape's delta relative to a new position\n * of a certain element's bounds\n *\n * @param {djs.model.Shape} point [absolute]\n * @param {bounds} oldBounds\n * @param {bounds} newBounds\n *\n * @return {delta} delta\n */\nexport function getNewAttachShapeDelta(shape, oldBounds, newBounds) {\n  var shapeCenter = center(shape),\n      oldCenter = center(oldBounds),\n      newCenter = center(newBounds),\n      shapeDelta = delta(shape, shapeCenter),\n      oldCenterDelta = delta(shapeCenter, oldCenter);\n\n  var newCenterDelta = {\n    x: oldCenterDelta.x * (newBounds.width / oldBounds.width),\n    y: oldCenterDelta.y * (newBounds.height / oldBounds.height)\n  };\n\n  var newShapeCenter = {\n    x: newCenter.x + newCenterDelta.x,\n    y: newCenter.y + newCenterDelta.y\n  };\n\n  return roundPoint({\n    x: newShapeCenter.x + shapeDelta.x - shape.x,\n    y: newShapeCenter.y + shapeDelta.y - shape.y\n  });\n}","import {\n  assign\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport {\n  is,\n  getBusinessObject\n} from '../../../util/ModelUtil';\n\nimport {\n  isLabelExternal,\n  getExternalLabelMid,\n  hasExternalLabel,\n  isLabel\n} from '../../../util/LabelUtil';\n\nimport {\n  getLabel\n} from '../../label-editing/LabelUtil';\n\nimport {\n  getLabelAdjustment\n} from './util/LabelLayoutUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getNewAttachPoint\n} from 'diagram-js/lib/util/AttachUtil';\n\nimport {\n  getMid,\n  roundPoint\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  delta\n} from 'diagram-js/lib/util/PositionUtil';\n\nimport {\n  sortBy\n} from 'min-dash';\n\nimport {\n  getDistancePointLine,\n  perpendicularFoot\n} from './util/GeometricUtil';\n\nvar DEFAULT_LABEL_DIMENSIONS = {\n  width: 90,\n  height: 20\n};\n\nvar NAME_PROPERTY = 'name';\nvar TEXT_PROPERTY = 'text';\n\n/**\n * A component that makes sure that external labels are added\n * together with respective elements and properly updated (DI wise)\n * during move.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {BpmnFactory} bpmnFactory\n * @param {TextRenderer} textRenderer\n */\nexport default function LabelBehavior(\n    eventBus, modeling, bpmnFactory,\n    textRenderer) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  // update label if name property was updated\n  this.postExecute('element.updateProperties', function(e) {\n    var context = e.context,\n        element = context.element,\n        properties = context.properties;\n\n    if (NAME_PROPERTY in properties) {\n      modeling.updateLabel(element, properties[NAME_PROPERTY]);\n    }\n\n    if (TEXT_PROPERTY in properties\n        && is(element, 'bpmn:TextAnnotation')) {\n\n      var newBounds = textRenderer.getTextAnnotationBounds(\n        {\n          x: element.x,\n          y: element.y,\n          width: element.width,\n          height: element.height\n        },\n        properties[TEXT_PROPERTY] || ''\n      );\n\n      modeling.updateLabel(element, properties.text, newBounds);\n    }\n  });\n\n  // create label shape after shape/connection was created\n  this.postExecute([ 'shape.create', 'connection.create' ], function(e) {\n    var context = e.context,\n        hints = context.hints || {};\n\n    if (hints.createElementsBehavior === false) {\n      return;\n    }\n\n    var element = context.shape || context.connection,\n        businessObject = element.businessObject;\n\n    if (isLabel(element) || !isLabelExternal(element)) {\n      return;\n    }\n\n    // only create label if attribute available\n    if (!getLabel(element)) {\n      return;\n    }\n\n    var labelCenter = getExternalLabelMid(element);\n\n    // we don't care about x and y\n    var labelDimensions = textRenderer.getExternalLabelBounds(\n      DEFAULT_LABEL_DIMENSIONS,\n      getLabel(element)\n    );\n\n    modeling.createLabel(element, labelCenter, {\n      id: businessObject.id + '_label',\n      businessObject: businessObject,\n      width: labelDimensions.width,\n      height: labelDimensions.height\n    });\n  });\n\n  // update label after label shape was deleted\n  this.postExecute('shape.delete', function(event) {\n    var context = event.context,\n        labelTarget = context.labelTarget,\n        hints = context.hints || {};\n\n    // check if label\n    if (labelTarget && hints.unsetLabel !== false) {\n      modeling.updateLabel(labelTarget, null, null, { removeShape: false });\n    }\n  });\n\n  // update di information on label creation\n  this.postExecute([ 'label.create' ], function(event) {\n\n    var context = event.context,\n        element = context.shape,\n        businessObject,\n        di;\n\n    // we want to trigger on real labels only\n    if (!element.labelTarget) {\n      return;\n    }\n\n    // we want to trigger on BPMN elements only\n    if (!is(element.labelTarget || element, 'bpmn:BaseElement')) {\n      return;\n    }\n\n    businessObject = element.businessObject,\n    di = businessObject.di;\n\n\n    if (!di.label) {\n      di.label = bpmnFactory.create('bpmndi:BPMNLabel', {\n        bounds: bpmnFactory.create('dc:Bounds')\n      });\n    }\n\n    assign(di.label.bounds, {\n      x: element.x,\n      y: element.y,\n      width: element.width,\n      height: element.height\n    });\n  });\n\n  function getVisibleLabelAdjustment(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        label = connection.label,\n        hints = assign({}, context.hints),\n        newWaypoints = context.newWaypoints || connection.waypoints,\n        oldWaypoints = context.oldWaypoints;\n\n\n    if (typeof hints.startChanged === 'undefined') {\n      hints.startChanged = !!hints.connectionStart;\n    }\n\n    if (typeof hints.endChanged === 'undefined') {\n      hints.endChanged = !!hints.connectionEnd;\n    }\n\n    return getLabelAdjustment(label, newWaypoints, oldWaypoints, hints);\n  }\n\n  this.postExecute([\n    'connection.layout',\n    'connection.updateWaypoints'\n  ], function(event) {\n    var context = event.context,\n        hints = context.hints || {};\n\n    if (hints.labelBehavior === false) {\n      return;\n    }\n\n    var connection = context.connection,\n        label = connection.label,\n        labelAdjustment;\n\n    // handle missing label as well as the case\n    // that the label parent does not exist (yet),\n    // because it is being pasted / created via multi element create\n    //\n    // Cf. https://github.com/bpmn-io/bpmn-js/pull/1227\n    if (!label || !label.parent) {\n      return;\n    }\n\n    labelAdjustment = getVisibleLabelAdjustment(event);\n\n    modeling.moveShape(label, labelAdjustment);\n  });\n\n\n  // keep label position on shape replace\n  this.postExecute([ 'shape.replace' ], function(event) {\n    var context = event.context,\n        newShape = context.newShape,\n        oldShape = context.oldShape;\n\n    var businessObject = getBusinessObject(newShape);\n\n    if (businessObject\n      && isLabelExternal(businessObject)\n      && oldShape.label\n      && newShape.label) {\n      newShape.label.x = oldShape.label.x;\n      newShape.label.y = oldShape.label.y;\n    }\n  });\n\n\n  // move external label after resizing\n  this.postExecute('shape.resize', function(event) {\n\n    var context = event.context,\n        shape = context.shape,\n        newBounds = context.newBounds,\n        oldBounds = context.oldBounds;\n\n    if (hasExternalLabel(shape)) {\n\n      var label = shape.label,\n          labelMid = getMid(label),\n          edges = asEdges(oldBounds);\n\n      // get nearest border point to label as reference point\n      var referencePoint = getReferencePoint(labelMid, edges);\n\n      var delta = getReferencePointDelta(referencePoint, oldBounds, newBounds);\n\n      modeling.moveShape(label, delta);\n\n    }\n\n  });\n\n}\n\ninherits(LabelBehavior, CommandInterceptor);\n\nLabelBehavior.$inject = [\n  'eventBus',\n  'modeling',\n  'bpmnFactory',\n  'textRenderer'\n];\n\n// helpers //////////////////////\n\n/**\n * Calculates a reference point delta relative to a new position\n * of a certain element's bounds\n *\n * @param {Point} point\n * @param {Bounds} oldBounds\n * @param {Bounds} newBounds\n *\n * @return {Delta} delta\n */\nexport function getReferencePointDelta(referencePoint, oldBounds, newBounds) {\n\n  var newReferencePoint = getNewAttachPoint(referencePoint, oldBounds, newBounds);\n\n  return roundPoint(delta(newReferencePoint, referencePoint));\n}\n\n/**\n * Generates the nearest point (reference point) for a given point\n * onto given set of lines\n *\n * @param {Array<Point, Point>} lines\n * @param {Point} point\n *\n * @param {Point}\n */\nexport function getReferencePoint(point, lines) {\n\n  if (!lines.length) {\n    return;\n  }\n\n  var nearestLine = getNearestLine(point, lines);\n\n  return perpendicularFoot(point, nearestLine);\n}\n\n/**\n * Convert the given bounds to a lines array containing all edges\n *\n * @param {Bounds|Point} bounds\n *\n * @return Array<Point>\n */\nexport function asEdges(bounds) {\n  return [\n    [ // top\n      {\n        x: bounds.x,\n        y: bounds.y\n      },\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y\n      }\n    ],\n    [ // right\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y\n      },\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y + (bounds.height || 0)\n      }\n    ],\n    [ // bottom\n      {\n        x: bounds.x,\n        y: bounds.y + (bounds.height || 0)\n      },\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y + (bounds.height || 0)\n      }\n    ],\n    [ // left\n      {\n        x: bounds.x,\n        y: bounds.y\n      },\n      {\n        x: bounds.x,\n        y: bounds.y + (bounds.height || 0)\n      }\n    ]\n  ];\n}\n\n/**\n * Returns the nearest line for a given point by distance\n * @param {Point} point\n * @param Array<Point> lines\n *\n * @return Array<Point>\n */\nfunction getNearestLine(point, lines) {\n\n  var distances = lines.map(function(l) {\n    return {\n      line: l,\n      distance: getDistancePointLine(point, l)\n    };\n  });\n\n  var sorted = sortBy(distances, 'distance');\n\n  return sorted[0].line;\n}\n","import { is } from '../../../util/ModelUtil';\n\nvar COLLAB_ERR_MSG = 'flow elements must be children of pools/participants',\n    PROCESS_ERR_MSG = 'participants cannot be pasted onto a non-empty process diagram';\n\n\nexport default function ModelingFeedback(eventBus, tooltips, translate) {\n\n  function showError(position, message, timeout) {\n    tooltips.add({\n      position: {\n        x: position.x + 5,\n        y: position.y + 5\n      },\n      type: 'error',\n      timeout: timeout || 2000,\n      html: '<div>' + message + '</div>'\n    });\n  }\n\n  eventBus.on([ 'shape.move.rejected', 'create.rejected' ], function(event) {\n    var context = event.context,\n        shape = context.shape,\n        target = context.target;\n\n    if (is(target, 'bpmn:Collaboration') && is(shape, 'bpmn:FlowNode')) {\n      showError(event, translate(COLLAB_ERR_MSG));\n    }\n  });\n\n  eventBus.on([ 'elements.paste.rejected' ], function(event) {\n    var context = event.context,\n        position = context.position,\n        target = context.target;\n\n    if (is(target, 'bpmn:Collaboration')) {\n      showError(position, translate(COLLAB_ERR_MSG));\n    }\n\n    if (is(target, 'bpmn:Process')) {\n      showError(position, translate(PROCESS_ERR_MSG), 3000);\n    }\n  });\n}\n\nModelingFeedback.$inject = [\n  'eventBus',\n  'tooltips',\n  'translate'\n];\n","import {\n  forEach,\n  find,\n  matchPattern\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\n\nexport default function ReplaceConnectionBehavior(eventBus, modeling, bpmnRules, injector) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var dragging = injector.get('dragging', false);\n\n  function fixConnection(connection) {\n\n    var source = connection.source,\n        target = connection.target,\n        parent = connection.parent;\n\n    // do not do anything if connection\n    // is already deleted (may happen due to other\n    // behaviors plugged-in before)\n    if (!parent) {\n      return;\n    }\n\n    var replacementType,\n        remove;\n\n    /**\n     * Check if incoming or outgoing connections\n     * can stay or could be substituted with an\n     * appropriate replacement.\n     *\n     * This holds true for SequenceFlow <> MessageFlow.\n     */\n\n    if (is(connection, 'bpmn:SequenceFlow')) {\n      if (!bpmnRules.canConnectSequenceFlow(source, target)) {\n        remove = true;\n      }\n\n      if (bpmnRules.canConnectMessageFlow(source, target)) {\n        replacementType = 'bpmn:MessageFlow';\n      }\n    }\n\n    // transform message flows into sequence flows, if possible\n\n    if (is(connection, 'bpmn:MessageFlow')) {\n\n      if (!bpmnRules.canConnectMessageFlow(source, target)) {\n        remove = true;\n      }\n\n      if (bpmnRules.canConnectSequenceFlow(source, target)) {\n        replacementType = 'bpmn:SequenceFlow';\n      }\n    }\n\n    if (is(connection, 'bpmn:Association') && !bpmnRules.canConnectAssociation(source, target)) {\n      remove = true;\n    }\n\n\n    // remove invalid connection,\n    // unless it has been removed already\n    if (remove) {\n      modeling.removeConnection(connection);\n    }\n\n    // replace SequenceFlow <> MessageFlow\n\n    if (replacementType) {\n      modeling.connect(source, target, {\n        type: replacementType,\n        waypoints: connection.waypoints.slice()\n      });\n    }\n  }\n\n  function replaceReconnectedConnection(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        source = context.newSource || connection.source,\n        target = context.newTarget || connection.target,\n        allowed,\n        replacement;\n\n    allowed = bpmnRules.canConnect(source, target);\n\n    if (!allowed || allowed.type === connection.type) {\n      return;\n    }\n\n    replacement = modeling.connect(source, target, {\n      type: allowed.type,\n      waypoints: connection.waypoints.slice()\n    });\n\n    // remove old connection\n    modeling.removeConnection(connection);\n\n    // replace connection in context to reconnect end/start\n    context.connection = replacement;\n\n    if (dragging) {\n      cleanDraggingSelection(connection, replacement);\n    }\n  }\n\n  // monkey-patch selection saved in dragging in order to re-select it when operation is finished\n  function cleanDraggingSelection(oldConnection, newConnection) {\n    var context = dragging.context(),\n        previousSelection = context && context.payload.previousSelection,\n        index;\n\n    // do nothing if not dragging or no selection was present\n    if (!previousSelection || !previousSelection.length) {\n      return;\n    }\n\n    index = previousSelection.indexOf(oldConnection);\n\n    if (index === -1) {\n      return;\n    }\n\n    previousSelection.splice(index, 1, newConnection);\n  }\n\n  // lifecycle hooks\n\n  this.postExecuted('elements.move', function(context) {\n\n    var closure = context.closure,\n        allConnections = closure.allConnections;\n\n    forEach(allConnections, fixConnection);\n  }, true);\n\n  this.preExecute('connection.reconnect', replaceReconnectedConnection);\n\n  this.postExecuted('element.updateProperties', function(event) {\n    var context = event.context,\n        properties = context.properties,\n        element = context.element,\n        businessObject = element.businessObject,\n        connection;\n\n    // remove condition on change to default\n    if (properties.default) {\n      connection = find(\n        element.outgoing,\n        matchPattern({ id: element.businessObject.default.id })\n      );\n\n      if (connection) {\n        modeling.updateProperties(connection, { conditionExpression: undefined });\n      }\n    }\n\n    // remove default from source on change to conditional\n    if (properties.conditionExpression && businessObject.sourceRef.default === businessObject) {\n      modeling.updateProperties(element.source, { default: undefined });\n    }\n  });\n}\n\ninherits(ReplaceConnectionBehavior, CommandInterceptor);\n\nReplaceConnectionBehavior.$inject = [\n  'eventBus',\n  'modeling',\n  'bpmnRules',\n  'injector'\n];\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\n\n/**\n * BPMN specific remove behavior\n */\nexport default function RemoveParticipantBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  /**\n   * morph collaboration diagram into process diagram\n   * after the last participant has been removed\n   */\n\n  this.preExecute('shape.delete', function(context) {\n\n    var shape = context.shape,\n        parent = shape.parent;\n\n    // activate the behavior if the shape to be removed\n    // is a participant\n    if (is(shape, 'bpmn:Participant')) {\n      context.collaborationRoot = parent;\n    }\n  }, true);\n\n  this.postExecute('shape.delete', function(context) {\n\n    var collaborationRoot = context.collaborationRoot;\n\n    if (collaborationRoot && !collaborationRoot.businessObject.participants.length) {\n\n      // replace empty collaboration with process diagram\n      modeling.makeProcess();\n    }\n  }, true);\n\n}\n\nRemoveParticipantBehavior.$inject = [ 'eventBus', 'modeling' ];\n\ninherits(RemoveParticipantBehavior, CommandInterceptor);","import inherits from 'inherits';\n\nimport { forEach } from 'min-dash';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { isEventSubProcess } from '../../../util/DiUtil';\n\n\n/**\n * BPMN-specific replace behavior.\n */\nexport default function ReplaceElementBehaviour(\n    bpmnReplace,\n    bpmnRules,\n    elementRegistry,\n    injector,\n    modeling,\n    selection\n) {\n  injector.invoke(CommandInterceptor, this);\n\n  this._bpmnReplace = bpmnReplace;\n  this._elementRegistry = elementRegistry;\n  this._selection = selection;\n\n  // replace elements on move\n  this.postExecuted([ 'elements.move' ], 500, function(event) {\n    var context = event.context,\n        target = context.newParent,\n        newHost = context.newHost,\n        elements = [];\n\n    forEach(context.closure.topLevel, function(topLevelElements) {\n      if (isEventSubProcess(topLevelElements)) {\n        elements = elements.concat(topLevelElements.children);\n      } else {\n        elements = elements.concat(topLevelElements);\n      }\n    });\n\n    // set target to host if attaching\n    if (elements.length === 1 && newHost) {\n      target = newHost;\n    }\n\n    var canReplace = bpmnRules.canReplace(elements, target);\n\n    if (canReplace) {\n      this.replaceElements(elements, canReplace.replacements, newHost);\n    }\n  }, this);\n\n  // update attachments on host replace\n  this.postExecute([ 'shape.replace' ], 1500, function(e) {\n    var context = e.context,\n        oldShape = context.oldShape,\n        newShape = context.newShape,\n        attachers = oldShape.attachers,\n        canReplace;\n\n    if (attachers && attachers.length) {\n      canReplace = bpmnRules.canReplace(attachers, newShape);\n\n      this.replaceElements(attachers, canReplace.replacements);\n    }\n\n  }, this);\n\n  // keep ID on shape replace\n  this.postExecuted([ 'shape.replace' ], 1500, function(e) {\n    var context = e.context,\n        oldShape = context.oldShape,\n        newShape = context.newShape;\n\n    modeling.unclaimId(oldShape.businessObject.id, oldShape.businessObject);\n    modeling.updateProperties(newShape, { id: oldShape.id });\n  });\n}\n\ninherits(ReplaceElementBehaviour, CommandInterceptor);\n\nReplaceElementBehaviour.prototype.replaceElements = function(elements, newElements) {\n  var elementRegistry = this._elementRegistry,\n      bpmnReplace = this._bpmnReplace,\n      selection = this._selection;\n\n  forEach(newElements, function(replacement) {\n    var newElement = {\n      type: replacement.newElementType\n    };\n\n    var oldElement = elementRegistry.get(replacement.oldElementId);\n\n    var idx = elements.indexOf(oldElement);\n\n    elements[idx] = bpmnReplace.replaceElement(oldElement, newElement, { select: false });\n  });\n\n  if (newElements) {\n    selection.select(elements);\n  }\n};\n\nReplaceElementBehaviour.$inject = [\n  'bpmnReplace',\n  'bpmnRules',\n  'elementRegistry',\n  'injector',\n  'modeling',\n  'selection'\n];\n","import { is } from '../../../../util/ModelUtil';\r\n\r\nimport {\r\n  asTRBL\r\n} from 'diagram-js/lib/layout/LayoutUtil';\r\n\r\nimport {\r\n  collectLanes,\r\n  getLanesRoot\r\n} from '../../../modeling/util/LaneUtil';\r\n\r\nvar abs = Math.abs,\r\n    min = Math.min,\r\n    max = Math.max;\r\n\r\n\r\nfunction addToTrbl(trbl, attr, value, choice) {\r\n  var current = trbl[attr];\r\n\r\n  // make sure to set the value if it does not exist\r\n  // or apply the correct value by comparing against\r\n  // choice(value, currentValue)\r\n  trbl[attr] = current === undefined ? value : choice(value, current);\r\n}\r\n\r\nfunction addMin(trbl, attr, value) {\r\n  return addToTrbl(trbl, attr, value, min);\r\n}\r\n\r\nfunction addMax(trbl, attr, value) {\r\n  return addToTrbl(trbl, attr, value, max);\r\n}\r\n\r\nvar LANE_MIN_HEIGHT = 60,\r\n    LANE_MIN_WIDTH = 300,\r\n    LANE_RIGHT_PADDING = 20,\r\n    LANE_LEFT_PADDING = 50,\r\n    LANE_TOP_PADDING = 20,\r\n    LANE_BOTTOM_PADDING = 20;\r\n\r\n\r\nexport function getParticipantResizeConstraints(laneShape, resizeDirection, balanced) {\r\n  var lanesRoot = getLanesRoot(laneShape);\r\n\r\n  var isFirst = true,\r\n      isLast = true;\r\n\r\n  // max top/bottom size for lanes\r\n  var allLanes = collectLanes(lanesRoot, [ lanesRoot ]);\r\n\r\n  var laneTrbl = asTRBL(laneShape);\r\n\r\n  var maxTrbl = {},\r\n      minTrbl = {};\r\n\r\n  if (/e/.test(resizeDirection)) {\r\n    minTrbl.right = laneTrbl.left + LANE_MIN_WIDTH;\r\n  } else\r\n  if (/w/.test(resizeDirection)) {\r\n    minTrbl.left = laneTrbl.right - LANE_MIN_WIDTH;\r\n  }\r\n\r\n  allLanes.forEach(function(other) {\r\n\r\n    var otherTrbl = asTRBL(other);\r\n\r\n    if (/n/.test(resizeDirection)) {\r\n\r\n      if (otherTrbl.top < (laneTrbl.top - 10)) {\r\n        isFirst = false;\r\n      }\r\n\r\n      // max top size (based on next element)\r\n      if (balanced && abs(laneTrbl.top - otherTrbl.bottom) < 10) {\r\n        addMax(maxTrbl, 'top', otherTrbl.top + LANE_MIN_HEIGHT);\r\n      }\r\n\r\n      // min top size (based on self or nested element)\r\n      if (abs(laneTrbl.top - otherTrbl.top) < 5) {\r\n        addMin(minTrbl, 'top', otherTrbl.bottom - LANE_MIN_HEIGHT);\r\n      }\r\n    }\r\n\r\n    if (/s/.test(resizeDirection)) {\r\n\r\n      if (otherTrbl.bottom > (laneTrbl.bottom + 10)) {\r\n        isLast = false;\r\n      }\r\n\r\n      // max bottom size (based on previous element)\r\n      if (balanced && abs(laneTrbl.bottom - otherTrbl.top) < 10) {\r\n        addMin(maxTrbl, 'bottom', otherTrbl.bottom - LANE_MIN_HEIGHT);\r\n      }\r\n\r\n      // min bottom size (based on self or nested element)\r\n      if (abs(laneTrbl.bottom - otherTrbl.bottom) < 5) {\r\n        addMax(minTrbl, 'bottom', otherTrbl.top + LANE_MIN_HEIGHT);\r\n      }\r\n    }\r\n  });\r\n\r\n  // max top/bottom/left/right size based on flow nodes\r\n  var flowElements = lanesRoot.children.filter(function(s) {\r\n    return !s.hidden && !s.waypoints && (is(s, 'bpmn:FlowElement') || is(s, 'bpmn:Artifact'));\r\n  });\r\n\r\n  flowElements.forEach(function(flowElement) {\r\n\r\n    var flowElementTrbl = asTRBL(flowElement);\r\n\r\n    if (isFirst && /n/.test(resizeDirection)) {\r\n      addMin(minTrbl, 'top', flowElementTrbl.top - LANE_TOP_PADDING);\r\n    }\r\n\r\n    if (/e/.test(resizeDirection)) {\r\n      addMax(minTrbl, 'right', flowElementTrbl.right + LANE_RIGHT_PADDING);\r\n    }\r\n\r\n    if (isLast && /s/.test(resizeDirection)) {\r\n      addMax(minTrbl, 'bottom', flowElementTrbl.bottom + LANE_BOTTOM_PADDING);\r\n    }\r\n\r\n    if (/w/.test(resizeDirection)) {\r\n      addMin(minTrbl, 'left', flowElementTrbl.left - LANE_LEFT_PADDING);\r\n    }\r\n  });\r\n\r\n  return {\r\n    min: minTrbl,\r\n    max: maxTrbl\r\n  };\r\n}","import { is } from '../../../util/ModelUtil';\r\n\r\nimport { isExpanded } from '../../../util/DiUtil';\r\n\r\nimport { getParticipantResizeConstraints } from './util/ResizeUtil';\r\n\r\nvar HIGH_PRIORITY = 1500;\r\n\r\nexport var PARTICIPANT_MIN_DIMENSIONS = { width: 300, height: 150 };\r\n\r\nexport var SUB_PROCESS_MIN_DIMENSIONS = { width: 140, height: 120 };\r\n\r\nexport var TEXT_ANNOTATION_MIN_DIMENSIONS = { width: 50, height: 30 };\r\n\r\n\r\n/**\r\n * Set minimum bounds/resize constraints on resize.\r\n *\r\n * @param {EventBus} eventBus\r\n */\r\nexport default function ResizeBehavior(eventBus) {\r\n  eventBus.on('resize.start', HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        direction = context.direction,\r\n        balanced = context.balanced;\r\n\r\n    if (is(shape, 'bpmn:Lane') || is(shape, 'bpmn:Participant')) {\r\n      context.resizeConstraints = getParticipantResizeConstraints(shape, direction, balanced);\r\n    }\r\n\r\n    if (is(shape, 'bpmn:Participant')) {\r\n      context.minDimensions = PARTICIPANT_MIN_DIMENSIONS;\r\n    }\r\n\r\n    if (is(shape, 'bpmn:SubProcess') && isExpanded(shape)) {\r\n      context.minDimensions = SUB_PROCESS_MIN_DIMENSIONS;\r\n    }\r\n\r\n    if (is(shape, 'bpmn:TextAnnotation')) {\r\n      context.minDimensions = TEXT_ANNOTATION_MIN_DIMENSIONS;\r\n    }\r\n  });\r\n}\r\n\r\nResizeBehavior.$inject = [ 'eventBus' ];","import { is } from '../../../util/ModelUtil';\n\nimport {\n  roundBounds\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  hasPrimaryModifier\n} from 'diagram-js/lib/util/Mouse';\n\nvar SLIGHTLY_HIGHER_PRIORITY = 1001;\n\n\n/**\n * Invoke {@link Modeling#resizeLane} instead of\n * {@link Modeling#resizeShape} when resizing a Lane\n * or Participant shape.\n */\nexport default function ResizeLaneBehavior(eventBus, modeling) {\n\n  eventBus.on('resize.start', SLIGHTLY_HIGHER_PRIORITY + 500, function(event) {\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Lane') || is(shape, 'bpmn:Participant')) {\n\n      // should we resize the opposite lane(s) in\n      // order to compensate for the resize operation?\n      context.balanced = !hasPrimaryModifier(event);\n    }\n  });\n\n  /**\n   * Intercept resize end and call resize lane function instead.\n   */\n  eventBus.on('resize.end', SLIGHTLY_HIGHER_PRIORITY, function(event) {\n    var context = event.context,\n        shape = context.shape,\n        canExecute = context.canExecute,\n        newBounds = context.newBounds;\n\n    if (is(shape, 'bpmn:Lane') || is(shape, 'bpmn:Participant')) {\n\n      if (canExecute) {\n\n        // ensure we have actual pixel values for new bounds\n        // (important when zoom level was > 1 during move)\n        newBounds = roundBounds(newBounds);\n\n        // perform the actual resize\n        modeling.resizeLane(shape, newBounds, context.balanced);\n      }\n\n      // stop propagation\n      return false;\n    }\n  });\n}\n\nResizeLaneBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n","import inherits from 'inherits';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport lineIntersect from './util/LineIntersect';\n\n\nexport default function RemoveElementBehavior(eventBus, bpmnRules, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Combine sequence flows when deleting an element\n   * if there is one incoming and one outgoing\n   * sequence flow\n   */\n  this.preExecute('shape.delete', function(e) {\n\n    var shape = e.context.shape;\n\n    // only handle [a] -> [shape] -> [b] patterns\n    if (shape.incoming.length !== 1 || shape.outgoing.length !== 1) {\n      return;\n    }\n\n    var inConnection = shape.incoming[0],\n        outConnection = shape.outgoing[0];\n\n    // only handle sequence flows\n    if (!is(inConnection, 'bpmn:SequenceFlow') || !is(outConnection, 'bpmn:SequenceFlow')) {\n      return;\n    }\n\n    if (bpmnRules.canConnect(inConnection.source, outConnection.target, inConnection)) {\n\n      // compute new, combined waypoints\n      var newWaypoints = getNewWaypoints(inConnection.waypoints, outConnection.waypoints);\n\n      modeling.reconnectEnd(inConnection, outConnection.target, newWaypoints);\n    }\n  });\n\n}\n\ninherits(RemoveElementBehavior, CommandInterceptor);\n\nRemoveElementBehavior.$inject = [\n  'eventBus',\n  'bpmnRules',\n  'modeling'\n];\n\n\n// helpers //////////////////////\n\nfunction getDocking(point) {\n  return point.original || point;\n}\n\n\nfunction getNewWaypoints(inWaypoints, outWaypoints) {\n\n  var intersection = lineIntersect(\n    getDocking(inWaypoints[inWaypoints.length - 2]),\n    getDocking(inWaypoints[inWaypoints.length - 1]),\n    getDocking(outWaypoints[1]),\n    getDocking(outWaypoints[0]));\n\n  if (intersection) {\n    return [].concat(\n      inWaypoints.slice(0, inWaypoints.length - 1),\n      [ intersection ],\n      outWaypoints.slice(1));\n  } else {\n    return [\n      getDocking(inWaypoints[0]),\n      getDocking(outWaypoints[outWaypoints.length - 1])\n    ];\n  }\n}","import { forEach } from 'min-dash';\r\n\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\nimport { isExpanded } from '../../../util/DiUtil';\r\n\r\nimport {\r\n  PARTICIPANT_MIN_DIMENSIONS,\r\n  SUB_PROCESS_MIN_DIMENSIONS,\r\n  TEXT_ANNOTATION_MIN_DIMENSIONS\r\n} from './ResizeBehavior';\r\n\r\nexport default function SpaceToolBehavior(eventBus) {\r\n  eventBus.on('spaceTool.getMinDimensions', function(context) {\r\n    var shapes = context.shapes,\r\n        minDimensions = {};\r\n\r\n    forEach(shapes, function(shape) {\r\n      var id = shape.id;\r\n\r\n      if (is(shape, 'bpmn:Participant')) {\r\n        minDimensions[ id ] = PARTICIPANT_MIN_DIMENSIONS;\r\n      }\r\n\r\n      if (is(shape, 'bpmn:SubProcess') && isExpanded(shape)) {\r\n        minDimensions[ id ] = SUB_PROCESS_MIN_DIMENSIONS;\r\n      }\r\n\r\n      if (is(shape, 'bpmn:TextAnnotation')) {\r\n        minDimensions[ id ] = TEXT_ANNOTATION_MIN_DIMENSIONS;\r\n      }\r\n    });\r\n\r\n    return minDimensions;\r\n  });\r\n}\r\n\r\nSpaceToolBehavior.$inject = [ 'eventBus' ];\r\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\nimport { isExpanded } from '../../../util/DiUtil.js';\n\n/**\n * Add start event replacing element with expanded sub process.\n *\n * @param {Injector} injector\n * @param {Modeling} modeling\n */\nexport default function SubProcessStartEventBehavior(injector, modeling) {\n  injector.invoke(CommandInterceptor, this);\n\n  this.postExecuted('shape.replace', function(event) {\n    var oldShape = event.context.oldShape,\n        newShape = event.context.newShape;\n\n    if (\n      !is(newShape, 'bpmn:SubProcess') ||\n      !is(oldShape, 'bpmn:Task') ||\n      !isExpanded(newShape)\n    ) {\n      return;\n    }\n\n    var position = getStartEventPosition(newShape);\n\n    modeling.createShape({ type: 'bpmn:StartEvent' }, position, newShape);\n  });\n}\n\nSubProcessStartEventBehavior.$inject = [\n  'injector',\n  'modeling'\n];\n\ninherits(SubProcessStartEventBehavior, CommandInterceptor);\n\n// helpers //////////\n\nfunction getStartEventPosition(shape) {\n  return {\n    x: shape.x + shape.width / 6,\n    y: shape.y + shape.height / 2\n  };\n}\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../../util/ModelUtil';\n\nimport {\n  computeChildrenBBox\n} from 'diagram-js/lib/features/resize/ResizeUtil';\n\n\nvar LOW_PRIORITY = 500;\n\n\nexport default function ToggleElementCollapseBehaviour(\n    eventBus, elementFactory, modeling,\n    resize) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  function hideEmptyLabels(children) {\n    if (children.length) {\n      children.forEach(function(child) {\n        if (child.type === 'label' && !child.businessObject.name) {\n          child.hidden = true;\n        }\n      });\n    }\n  }\n\n  function expandedBounds(shape, defaultSize) {\n    var children = shape.children,\n        newBounds = defaultSize,\n        visibleElements,\n        visibleBBox;\n\n    visibleElements = filterVisible(children).concat([ shape ]);\n\n    visibleBBox = computeChildrenBBox(visibleElements);\n\n    if (visibleBBox) {\n\n      // center to visibleBBox with max(defaultSize, childrenBounds)\n      newBounds.width = Math.max(visibleBBox.width, newBounds.width);\n      newBounds.height = Math.max(visibleBBox.height, newBounds.height);\n\n      newBounds.x = visibleBBox.x + (visibleBBox.width - newBounds.width) / 2;\n      newBounds.y = visibleBBox.y + (visibleBBox.height - newBounds.height) / 2;\n    } else {\n\n      // center to collapsed shape with defaultSize\n      newBounds.x = shape.x + (shape.width - newBounds.width) / 2;\n      newBounds.y = shape.y + (shape.height - newBounds.height) / 2;\n    }\n\n    return newBounds;\n  }\n\n  function collapsedBounds(shape, defaultSize) {\n\n    return {\n      x: shape.x + (shape.width - defaultSize.width) / 2,\n      y: shape.y + (shape.height - defaultSize.height) / 2,\n      width: defaultSize.width,\n      height: defaultSize.height\n    };\n  }\n\n  this.executed([ 'shape.toggleCollapse' ], LOW_PRIORITY, function(e) {\n\n    var context = e.context,\n        shape = context.shape;\n\n    if (!is(shape, 'bpmn:SubProcess')) {\n      return;\n    }\n\n    if (!shape.collapsed) {\n\n      // all children got made visible through djs, hide empty labels\n      hideEmptyLabels(shape.children);\n\n      // remove collapsed marker\n      getBusinessObject(shape).di.isExpanded = true;\n    } else {\n\n      // place collapsed marker\n      getBusinessObject(shape).di.isExpanded = false;\n    }\n  });\n\n  this.reverted([ 'shape.toggleCollapse' ], LOW_PRIORITY, function(e) {\n\n    var context = e.context;\n    var shape = context.shape;\n\n\n    // revert removing/placing collapsed marker\n    if (!shape.collapsed) {\n      getBusinessObject(shape).di.isExpanded = true;\n\n    } else {\n      getBusinessObject(shape).di.isExpanded = false;\n    }\n  });\n\n  this.postExecuted([ 'shape.toggleCollapse' ], LOW_PRIORITY, function(e) {\n    var shape = e.context.shape,\n        defaultSize = elementFactory._getDefaultSize(shape),\n        newBounds;\n\n    if (shape.collapsed) {\n\n      // resize to default size of collapsed shapes\n      newBounds = collapsedBounds(shape, defaultSize);\n    } else {\n\n      // resize to bounds of max(visible children, defaultSize)\n      newBounds = expandedBounds(shape, defaultSize);\n    }\n\n    modeling.resizeShape(shape, newBounds, null, {\n      autoResize: shape.collapsed ? false : 'nwse'\n    });\n  });\n\n}\n\n\ninherits(ToggleElementCollapseBehaviour, CommandInterceptor);\n\nToggleElementCollapseBehaviour.$inject = [\n  'eventBus',\n  'elementFactory',\n  'modeling'\n];\n\n\n// helpers //////////////////////\n\nfunction filterVisible(elements) {\n  return elements.filter(function(e) {\n    return !e.hidden;\n  });\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\nimport { isExpanded } from '../../../util/DiUtil';\nimport { isLabel } from '../../../util/LabelUtil';\n\n\n/**\n * Unclaims model IDs on element deletion.\n *\n * @param {Canvas} canvas\n * @param {Injector} injector\n * @param {Moddle} moddle\n * @param {Modeling} modeling\n */\nexport default function UnclaimIdBehavior(canvas, injector, moddle, modeling) {\n  injector.invoke(CommandInterceptor, this);\n\n  this.preExecute('shape.delete', function(event) {\n    var context = event.context,\n        shape = context.shape,\n        shapeBo = shape.businessObject;\n\n    if (isLabel(shape)) {\n      return;\n    }\n\n    if (is(shape, 'bpmn:Participant') && isExpanded(shape)) {\n      moddle.ids.unclaim(shapeBo.processRef.id);\n    }\n\n    modeling.unclaimId(shapeBo.id, shapeBo);\n  });\n\n\n  this.preExecute('connection.delete', function(event) {\n    var context = event.context,\n        connection = context.connection,\n        connectionBo = connection.businessObject;\n\n    modeling.unclaimId(connectionBo.id, connectionBo);\n  });\n\n  this.preExecute('canvas.updateRoot', function() {\n    var rootElement = canvas.getRootElement(),\n        rootElementBo = rootElement.businessObject;\n\n    moddle.ids.unclaim(rootElementBo.id);\n  });\n}\n\ninherits(UnclaimIdBehavior, CommandInterceptor);\n\nUnclaimIdBehavior.$inject = [ 'canvas', 'injector', 'moddle', 'modeling' ];","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  is\n} from '../../../util/ModelUtil';\n\nvar LOW_PRIORITY = 500,\n    HIGH_PRIORITY = 5000;\n\n\n/**\n * BPMN specific delete lane behavior\n */\nexport default function UpdateFlowNodeRefsBehavior(eventBus, modeling, translate) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Ok, this is it:\n   *\n   * We have to update the Lane#flowNodeRefs _and_\n   * FlowNode#lanes with every FlowNode move/resize and\n   * Lane move/resize.\n   *\n   * We want to group that stuff to recompute containments\n   * as efficient as possible.\n   *\n   * Yea!\n   */\n\n  // the update context\n  var context;\n\n\n  function initContext() {\n    context = context || new UpdateContext();\n    context.enter();\n\n    return context;\n  }\n\n  function getContext() {\n    if (!context) {\n      throw new Error(translate('out of bounds release'));\n    }\n\n    return context;\n  }\n\n  function releaseContext() {\n\n    if (!context) {\n      throw new Error(translate('out of bounds release'));\n    }\n\n    var triggerUpdate = context.leave();\n\n    if (triggerUpdate) {\n      modeling.updateLaneRefs(context.flowNodes, context.lanes);\n\n      context = null;\n    }\n\n    return triggerUpdate;\n  }\n\n\n  var laneRefUpdateEvents = [\n    'spaceTool',\n    'lane.add',\n    'lane.resize',\n    'lane.split',\n    'elements.create',\n    'elements.delete',\n    'elements.move',\n    'shape.create',\n    'shape.delete',\n    'shape.move',\n    'shape.resize'\n  ];\n\n\n  // listen to a lot of stuff to group lane updates\n\n  this.preExecute(laneRefUpdateEvents, HIGH_PRIORITY, function(event) {\n    initContext();\n  });\n\n  this.postExecuted(laneRefUpdateEvents, LOW_PRIORITY, function(event) {\n    releaseContext();\n  });\n\n\n  // Mark flow nodes + lanes that need an update\n\n  this.preExecute([\n    'shape.create',\n    'shape.move',\n    'shape.delete',\n    'shape.resize'\n  ], function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    var updateContext = getContext();\n\n    // no need to update labels\n    if (shape.labelTarget) {\n      return;\n    }\n\n    if (is(shape, 'bpmn:Lane')) {\n      updateContext.addLane(shape);\n    }\n\n    if (is(shape, 'bpmn:FlowNode')) {\n      updateContext.addFlowNode(shape);\n    }\n  });\n}\n\nUpdateFlowNodeRefsBehavior.$inject = [\n  'eventBus',\n  'modeling' ,\n  'translate'\n];\n\ninherits(UpdateFlowNodeRefsBehavior, CommandInterceptor);\n\n\nfunction UpdateContext() {\n\n  this.flowNodes = [];\n  this.lanes = [];\n\n  this.counter = 0;\n\n  this.addLane = function(lane) {\n    this.lanes.push(lane);\n  };\n\n  this.addFlowNode = function(flowNode) {\n    this.flowNodes.push(flowNode);\n  };\n\n  this.enter = function() {\n    this.counter++;\n  };\n\n  this.leave = function() {\n    this.counter--;\n\n    return !this.counter;\n  };\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../../util/ModelUtil';\n\n\n/**\n * A behavior that unsets the Default property of\n * sequence flow source on element delete, if the\n * removed element is the Gateway or Task's default flow.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function DeleteSequenceFlowBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  this.preExecute('connection.delete', function(event) {\n    var context = event.context,\n        connection = context.connection,\n        source = connection.source;\n\n    if (isDefaultFlow(connection, source)) {\n      modeling.updateProperties(source, {\n        'default': null\n      });\n    }\n  });\n}\n\ninherits(DeleteSequenceFlowBehavior, CommandInterceptor);\n\nDeleteSequenceFlowBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n\n\n// helpers //////////////////////\n\nfunction isDefaultFlow(connection, source) {\n\n  if (!is(connection, 'bpmn:SequenceFlow')) {\n    return false;\n  }\n\n  var sourceBo = getBusinessObject(source),\n      sequenceFlow = getBusinessObject(connection);\n\n  return sourceBo.get('default') === sequenceFlow;\n}","import AdaptiveLabelPositioningBehavior from './AdaptiveLabelPositioningBehavior';\nimport AppendBehavior from './AppendBehavior';\nimport AssociationBehavior from './AssociationBehavior';\nimport AttachEventBehavior from './AttachEventBehavior';\nimport BoundaryEventBehavior from './BoundaryEventBehavior';\nimport RootElementReferenceBehavior from './RootElementReferenceBehavior';\nimport CreateBehavior from './CreateBehavior';\nimport FixHoverBehavior from './FixHoverBehavior';\nimport CreateDataObjectBehavior from './CreateDataObjectBehavior';\nimport CreateParticipantBehavior from './CreateParticipantBehavior';\nimport DataInputAssociationBehavior from './DataInputAssociationBehavior';\nimport DataStoreBehavior from './DataStoreBehavior';\nimport DeleteLaneBehavior from './DeleteLaneBehavior';\nimport DetachEventBehavior from './DetachEventBehavior';\nimport DropOnFlowBehavior from './DropOnFlowBehavior';\nimport EventBasedGatewayBehavior from './EventBasedGatewayBehavior';\nimport GroupBehavior from './GroupBehavior';\nimport ImportDockingFix from './ImportDockingFix';\nimport IsHorizontalFix from './IsHorizontalFix';\nimport LabelBehavior from './LabelBehavior';\nimport ModelingFeedback from './ModelingFeedback';\nimport ReplaceConnectionBehavior from './ReplaceConnectionBehavior';\nimport RemoveParticipantBehavior from './RemoveParticipantBehavior';\nimport ReplaceElementBehaviour from './ReplaceElementBehaviour';\nimport ResizeBehavior from './ResizeBehavior';\nimport ResizeLaneBehavior from './ResizeLaneBehavior';\nimport RemoveElementBehavior from './RemoveElementBehavior';\nimport SpaceToolBehavior from './SpaceToolBehavior';\nimport SubProcessStartEventBehavior from './SubProcessStartEventBehavior';\nimport ToggleElementCollapseBehaviour from './ToggleElementCollapseBehaviour';\nimport UnclaimIdBehavior from './UnclaimIdBehavior';\nimport UpdateFlowNodeRefsBehavior from './UpdateFlowNodeRefsBehavior';\nimport UnsetDefaultFlowBehavior from './UnsetDefaultFlowBehavior';\n\nexport default {\n  __init__: [\n    'adaptiveLabelPositioningBehavior',\n    'appendBehavior',\n    'associationBehavior',\n    'attachEventBehavior',\n    'boundaryEventBehavior',\n    'rootElementReferenceBehavior',\n    'createBehavior',\n    'fixHoverBehavior',\n    'createDataObjectBehavior',\n    'createParticipantBehavior',\n    'dataStoreBehavior',\n    'dataInputAssociationBehavior',\n    'deleteLaneBehavior',\n    'detachEventBehavior',\n    'dropOnFlowBehavior',\n    'eventBasedGatewayBehavior',\n    'groupBehavior',\n    'importDockingFix',\n    'isHorizontalFix',\n    'labelBehavior',\n    'modelingFeedback',\n    'removeElementBehavior',\n    'removeParticipantBehavior',\n    'replaceConnectionBehavior',\n    'replaceElementBehaviour',\n    'resizeBehavior',\n    'resizeLaneBehavior',\n    'toggleElementCollapseBehaviour',\n    'spaceToolBehavior',\n    'subProcessStartEventBehavior',\n    'unclaimIdBehavior',\n    'unsetDefaultFlowBehavior',\n    'updateFlowNodeRefsBehavior'\n  ],\n  adaptiveLabelPositioningBehavior: [ 'type', AdaptiveLabelPositioningBehavior ],\n  appendBehavior: [ 'type', AppendBehavior ],\n  associationBehavior: [ 'type', AssociationBehavior ],\n  attachEventBehavior: [ 'type', AttachEventBehavior ],\n  boundaryEventBehavior: [ 'type', BoundaryEventBehavior ],\n  rootElementReferenceBehavior: [ 'type', RootElementReferenceBehavior ],\n  createBehavior: [ 'type', CreateBehavior ],\n  fixHoverBehavior: [ 'type', FixHoverBehavior ],\n  createDataObjectBehavior: [ 'type', CreateDataObjectBehavior ],\n  createParticipantBehavior: [ 'type', CreateParticipantBehavior ],\n  dataInputAssociationBehavior: [ 'type', DataInputAssociationBehavior ],\n  dataStoreBehavior: [ 'type', DataStoreBehavior ],\n  deleteLaneBehavior: [ 'type', DeleteLaneBehavior ],\n  detachEventBehavior: [ 'type', DetachEventBehavior ],\n  dropOnFlowBehavior: [ 'type', DropOnFlowBehavior ],\n  eventBasedGatewayBehavior: [ 'type', EventBasedGatewayBehavior ],\n  groupBehavior: [ 'type', GroupBehavior ],\n  importDockingFix: [ 'type', ImportDockingFix ],\n  isHorizontalFix: [ 'type', IsHorizontalFix ],\n  labelBehavior: [ 'type', LabelBehavior ],\n  modelingFeedback: [ 'type', ModelingFeedback ],\n  replaceConnectionBehavior: [ 'type', ReplaceConnectionBehavior ],\n  removeParticipantBehavior: [ 'type', RemoveParticipantBehavior ],\n  replaceElementBehaviour: [ 'type', ReplaceElementBehaviour ],\n  resizeBehavior: [ 'type', ResizeBehavior ],\n  resizeLaneBehavior: [ 'type', ResizeLaneBehavior ],\n  removeElementBehavior: [ 'type', RemoveElementBehavior ],\n  toggleElementCollapseBehaviour : [ 'type', ToggleElementCollapseBehaviour ],\n  spaceToolBehavior: [ 'type', SpaceToolBehavior ],\n  subProcessStartEventBehavior: [ 'type', SubProcessStartEventBehavior ],\n  unclaimIdBehavior: [ 'type', UnclaimIdBehavior ],\n  updateFlowNodeRefsBehavior: [ 'type', UpdateFlowNodeRefsBehavior ],\n  unsetDefaultFlowBehavior: [ 'type', UnsetDefaultFlowBehavior ]\n};\n","import { getOrientation } from 'diagram-js/lib/layout/LayoutUtil';\r\n\r\nexport function getBoundaryAttachment(position, targetBounds) {\r\n\r\n  var orientation = getOrientation(position, targetBounds, -15);\r\n\r\n  if (orientation !== 'intersect') {\r\n    return orientation;\r\n  } else {\r\n    return null;\r\n  }\r\n}","import {\n  every,\n  find,\n  forEach,\n  some\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport {\n  is,\n  getBusinessObject\n} from '../../util/ModelUtil';\n\nimport {\n  getParent,\n  isAny\n} from '../modeling/util/ModelingUtil';\n\nimport {\n  isLabel\n} from '../../util/LabelUtil';\n\nimport {\n  isExpanded,\n  isEventSubProcess,\n  isInterrupting,\n  hasErrorEventDefinition,\n  hasEscalationEventDefinition,\n  hasCompensateEventDefinition\n} from '../../util/DiUtil';\n\nimport RuleProvider from 'diagram-js/lib/features/rules/RuleProvider';\n\nimport {\n  getBoundaryAttachment as isBoundaryAttachment\n} from '../snapping/BpmnSnappingUtil';\n\n\n/**\n * BPMN specific modeling rule\n */\nexport default function BpmnRules(eventBus) {\n  RuleProvider.call(this, eventBus);\n}\n\ninherits(BpmnRules, RuleProvider);\n\nBpmnRules.$inject = [ 'eventBus' ];\n\nBpmnRules.prototype.init = function() {\n\n  this.addRule('connection.start', function(context) {\n    var source = context.source;\n\n    return canStartConnection(source);\n  });\n\n  this.addRule('connection.create', function(context) {\n    var source = context.source,\n        target = context.target,\n        hints = context.hints || {},\n        targetParent = hints.targetParent,\n        targetAttach = hints.targetAttach;\n\n    // don't allow incoming connections on\n    // newly created boundary events\n    // to boundary events\n    if (targetAttach) {\n      return false;\n    }\n\n    // temporarily set target parent for scoping\n    // checks to work\n    if (targetParent) {\n      target.parent = targetParent;\n    }\n\n    try {\n      return canConnect(source, target);\n    } finally {\n\n      // unset temporary target parent\n      if (targetParent) {\n        target.parent = null;\n      }\n    }\n  });\n\n  this.addRule('connection.reconnect', function(context) {\n\n    var connection = context.connection,\n        source = context.source,\n        target = context.target;\n\n    return canConnect(source, target, connection);\n  });\n\n  this.addRule('connection.updateWaypoints', function(context) {\n    return {\n      type: context.connection.type\n    };\n  });\n\n  this.addRule('shape.resize', function(context) {\n\n    var shape = context.shape,\n        newBounds = context.newBounds;\n\n    return canResize(shape, newBounds);\n  });\n\n  this.addRule('elements.create', function(context) {\n    var elements = context.elements,\n        position = context.position,\n        target = context.target;\n\n    return every(elements, function(element) {\n      if (isConnection(element)) {\n        return canConnect(element.source, element.target, element);\n      }\n\n      if (element.host) {\n        return canAttach(element, element.host, null, position);\n      }\n\n      return canCreate(element, target, null, position);\n    });\n  });\n\n  this.addRule('elements.move', function(context) {\n\n    var target = context.target,\n        shapes = context.shapes,\n        position = context.position;\n\n    return canAttach(shapes, target, null, position) ||\n           canReplace(shapes, target, position) ||\n           canMove(shapes, target, position) ||\n           canInsert(shapes, target, position);\n  });\n\n  this.addRule('shape.create', function(context) {\n    return canCreate(\n      context.shape,\n      context.target,\n      context.source,\n      context.position\n    );\n  });\n\n  this.addRule('shape.attach', function(context) {\n\n    return canAttach(\n      context.shape,\n      context.target,\n      null,\n      context.position\n    );\n  });\n\n  this.addRule('element.copy', function(context) {\n    var element = context.element,\n        elements = context.elements;\n\n    return canCopy(elements, element);\n  });\n};\n\nBpmnRules.prototype.canConnectMessageFlow = canConnectMessageFlow;\n\nBpmnRules.prototype.canConnectSequenceFlow = canConnectSequenceFlow;\n\nBpmnRules.prototype.canConnectDataAssociation = canConnectDataAssociation;\n\nBpmnRules.prototype.canConnectAssociation = canConnectAssociation;\n\nBpmnRules.prototype.canMove = canMove;\n\nBpmnRules.prototype.canAttach = canAttach;\n\nBpmnRules.prototype.canReplace = canReplace;\n\nBpmnRules.prototype.canDrop = canDrop;\n\nBpmnRules.prototype.canInsert = canInsert;\n\nBpmnRules.prototype.canCreate = canCreate;\n\nBpmnRules.prototype.canConnect = canConnect;\n\nBpmnRules.prototype.canResize = canResize;\n\nBpmnRules.prototype.canCopy = canCopy;\n\n/**\n * Utility functions for rule checking\n */\n\n/**\n * Checks if given element can be used for starting connection.\n *\n * @param  {Element} source\n * @return {Boolean}\n */\nfunction canStartConnection(element) {\n  if (nonExistingOrLabel(element)) {\n    return null;\n  }\n\n  return isAny(element, [\n    'bpmn:FlowNode',\n    'bpmn:InteractionNode',\n    'bpmn:DataObjectReference',\n    'bpmn:DataStoreReference'\n  ]);\n}\n\nfunction nonExistingOrLabel(element) {\n  return !element || isLabel(element);\n}\n\nfunction isSame(a, b) {\n  return a === b;\n}\n\nfunction getOrganizationalParent(element) {\n\n  do {\n    if (is(element, 'bpmn:Process')) {\n      return getBusinessObject(element);\n    }\n\n    if (is(element, 'bpmn:Participant')) {\n      return (\n        getBusinessObject(element).processRef ||\n        getBusinessObject(element)\n      );\n    }\n  } while ((element = element.parent));\n\n}\n\nfunction isTextAnnotation(element) {\n  return is(element, 'bpmn:TextAnnotation');\n}\n\nfunction isGroup(element) {\n  return is(element, 'bpmn:Group') && !element.labelTarget;\n}\n\nfunction isCompensationBoundary(element) {\n  return is(element, 'bpmn:BoundaryEvent') &&\n         hasEventDefinition(element, 'bpmn:CompensateEventDefinition');\n}\n\nfunction isForCompensation(e) {\n  return getBusinessObject(e).isForCompensation;\n}\n\nfunction isSameOrganization(a, b) {\n  var parentA = getOrganizationalParent(a),\n      parentB = getOrganizationalParent(b);\n\n  return parentA === parentB;\n}\n\nfunction isMessageFlowSource(element) {\n  return (\n    is(element, 'bpmn:InteractionNode') && (\n      !is(element, 'bpmn:Event') || (\n        is(element, 'bpmn:ThrowEvent') &&\n        hasEventDefinitionOrNone(element, 'bpmn:MessageEventDefinition')\n      )\n    )\n  );\n}\n\nfunction isMessageFlowTarget(element) {\n  return (\n    is(element, 'bpmn:InteractionNode') &&\n    !isForCompensation(element) && (\n      !is(element, 'bpmn:Event') || (\n        is(element, 'bpmn:CatchEvent') &&\n        hasEventDefinitionOrNone(element, 'bpmn:MessageEventDefinition')\n      )\n    )\n  );\n}\n\nfunction getScopeParent(element) {\n\n  var parent = element;\n\n  while ((parent = parent.parent)) {\n\n    if (is(parent, 'bpmn:FlowElementsContainer')) {\n      return getBusinessObject(parent);\n    }\n\n    if (is(parent, 'bpmn:Participant')) {\n      return getBusinessObject(parent).processRef;\n    }\n  }\n\n  return null;\n}\n\nfunction isSameScope(a, b) {\n  var scopeParentA = getScopeParent(a),\n      scopeParentB = getScopeParent(b);\n\n  return scopeParentA === scopeParentB;\n}\n\nfunction hasEventDefinition(element, eventDefinition) {\n  var bo = getBusinessObject(element);\n\n  return !!find(bo.eventDefinitions || [], function(definition) {\n    return is(definition, eventDefinition);\n  });\n}\n\nfunction hasEventDefinitionOrNone(element, eventDefinition) {\n  var bo = getBusinessObject(element);\n\n  return (bo.eventDefinitions || []).every(function(definition) {\n    return is(definition, eventDefinition);\n  });\n}\n\nfunction isSequenceFlowSource(element) {\n  return (\n    is(element, 'bpmn:FlowNode') &&\n    !is(element, 'bpmn:EndEvent') &&\n    !isEventSubProcess(element) &&\n    !(is(element, 'bpmn:IntermediateThrowEvent') &&\n      hasEventDefinition(element, 'bpmn:LinkEventDefinition')\n    ) &&\n    !isCompensationBoundary(element) &&\n    !isForCompensation(element)\n  );\n}\n\nfunction isSequenceFlowTarget(element) {\n  return (\n    is(element, 'bpmn:FlowNode') &&\n    !is(element, 'bpmn:StartEvent') &&\n    !is(element, 'bpmn:BoundaryEvent') &&\n    !isEventSubProcess(element) &&\n    !(is(element, 'bpmn:IntermediateCatchEvent') &&\n      hasEventDefinition(element, 'bpmn:LinkEventDefinition')\n    ) &&\n    !isForCompensation(element)\n  );\n}\n\nfunction isEventBasedTarget(element) {\n  return (\n    is(element, 'bpmn:ReceiveTask') || (\n      is(element, 'bpmn:IntermediateCatchEvent') && (\n        hasEventDefinition(element, 'bpmn:MessageEventDefinition') ||\n        hasEventDefinition(element, 'bpmn:TimerEventDefinition') ||\n        hasEventDefinition(element, 'bpmn:ConditionalEventDefinition') ||\n        hasEventDefinition(element, 'bpmn:SignalEventDefinition')\n      )\n    )\n  );\n}\n\nfunction isConnection(element) {\n  return element.waypoints;\n}\n\nfunction getParents(element) {\n\n  var parents = [];\n\n  while (element) {\n    element = element.parent;\n\n    if (element) {\n      parents.push(element);\n    }\n  }\n\n  return parents;\n}\n\nfunction isParent(possibleParent, element) {\n  var allParents = getParents(element);\n  return allParents.indexOf(possibleParent) !== -1;\n}\n\nfunction canConnect(source, target, connection) {\n\n  if (nonExistingOrLabel(source) || nonExistingOrLabel(target)) {\n    return null;\n  }\n\n  if (!is(connection, 'bpmn:DataAssociation')) {\n\n    if (canConnectMessageFlow(source, target)) {\n      return { type: 'bpmn:MessageFlow' };\n    }\n\n    if (canConnectSequenceFlow(source, target)) {\n      return { type: 'bpmn:SequenceFlow' };\n    }\n  }\n\n  var connectDataAssociation = canConnectDataAssociation(source, target);\n\n  if (connectDataAssociation) {\n    return connectDataAssociation;\n  }\n\n  if (isCompensationBoundary(source) && isForCompensation(target)) {\n    return {\n      type: 'bpmn:Association',\n      associationDirection: 'One'\n    };\n  }\n\n  if (canConnectAssociation(source, target)) {\n\n    return {\n      type: 'bpmn:Association'\n    };\n  }\n\n  return false;\n}\n\n/**\n * Can an element be dropped into the target element\n *\n * @return {Boolean}\n */\nfunction canDrop(element, target, position) {\n\n  // can move labels and groups everywhere\n  if (isLabel(element) || isGroup(element)) {\n    return true;\n  }\n\n\n  // disallow to create elements on collapsed pools\n  if (is(target, 'bpmn:Participant') && !isExpanded(target)) {\n    return false;\n  }\n\n  // allow to create new participants on\n  // existing collaboration and process diagrams\n  if (is(element, 'bpmn:Participant')) {\n    return is(target, 'bpmn:Process') || is(target, 'bpmn:Collaboration');\n  }\n\n  // allow moving DataInput / DataOutput within its original container only\n  if (isAny(element, [ 'bpmn:DataInput', 'bpmn:DataOutput' ])) {\n\n    if (element.parent) {\n      return target === element.parent;\n    }\n  }\n\n  // allow creating lanes on participants and other lanes only\n  if (is(element, 'bpmn:Lane')) {\n    return is(target, 'bpmn:Participant') || is(target, 'bpmn:Lane');\n  }\n\n  // disallow dropping boundary events which cannot replace with intermediate event\n  if (is(element, 'bpmn:BoundaryEvent') && !isDroppableBoundaryEvent(element)) {\n    return false;\n  }\n\n  // drop flow elements onto flow element containers\n  // and participants\n  if (is(element, 'bpmn:FlowElement') && !is(element, 'bpmn:DataStoreReference')) {\n    if (is(target, 'bpmn:FlowElementsContainer')) {\n      return isExpanded(target);\n    }\n\n    return isAny(target, [ 'bpmn:Participant', 'bpmn:Lane' ]);\n  }\n\n  // account for the fact that data associations are always\n  // rendered and moved to top (Process or Collaboration level)\n  //\n  // artifacts may be placed wherever, too\n  if (isAny(element, [ 'bpmn:Artifact', 'bpmn:DataAssociation', 'bpmn:DataStoreReference' ])) {\n    return isAny(target, [\n      'bpmn:Collaboration',\n      'bpmn:Lane',\n      'bpmn:Participant',\n      'bpmn:Process',\n      'bpmn:SubProcess' ]);\n  }\n\n  if (is(element, 'bpmn:MessageFlow')) {\n    return is(target, 'bpmn:Collaboration')\n      || element.source.parent == target\n      || element.target.parent == target;\n  }\n\n  return false;\n}\n\nfunction isDroppableBoundaryEvent(event) {\n  return getBusinessObject(event).cancelActivity && (\n    hasNoEventDefinition(event) || hasCommonBoundaryIntermediateEventDefinition(event)\n  );\n}\n\nfunction isBoundaryEvent(element) {\n  return !isLabel(element) && is(element, 'bpmn:BoundaryEvent');\n}\n\nfunction isLane(element) {\n  return is(element, 'bpmn:Lane');\n}\n\n/**\n * We treat IntermediateThrowEvents as boundary events during create,\n * this must be reflected in the rules.\n */\nfunction isBoundaryCandidate(element) {\n  if (isBoundaryEvent(element)) {\n    return true;\n  }\n\n  if (is(element, 'bpmn:IntermediateThrowEvent') && hasNoEventDefinition(element)) {\n    return true;\n  }\n\n  return (\n    is(element, 'bpmn:IntermediateCatchEvent') &&\n    hasCommonBoundaryIntermediateEventDefinition(element)\n  );\n}\n\nfunction hasNoEventDefinition(element) {\n  var bo = getBusinessObject(element);\n\n  return bo && !(bo.eventDefinitions && bo.eventDefinitions.length);\n}\n\nfunction hasCommonBoundaryIntermediateEventDefinition(element) {\n  return hasOneOfEventDefinitions(element, [\n    'bpmn:MessageEventDefinition',\n    'bpmn:TimerEventDefinition',\n    'bpmn:SignalEventDefinition',\n    'bpmn:ConditionalEventDefinition'\n  ]);\n}\n\nfunction hasOneOfEventDefinitions(element, eventDefinitions) {\n  return eventDefinitions.some(function(definition) {\n    return hasEventDefinition(element, definition);\n  });\n}\n\nfunction isReceiveTaskAfterEventBasedGateway(element) {\n  return (\n    is(element, 'bpmn:ReceiveTask') &&\n    find(element.incoming, function(incoming) {\n      return is(incoming.source, 'bpmn:EventBasedGateway');\n    })\n  );\n}\n\n\nfunction canAttach(elements, target, source, position) {\n\n  if (!Array.isArray(elements)) {\n    elements = [ elements ];\n  }\n\n  // only (re-)attach one element at a time\n  if (elements.length !== 1) {\n    return false;\n  }\n\n  var element = elements[0];\n\n  // do not attach labels\n  if (isLabel(element)) {\n    return false;\n  }\n\n  // only handle boundary events\n  if (!isBoundaryCandidate(element)) {\n    return false;\n  }\n\n  // disallow drop on event sub processes\n  if (isEventSubProcess(target)) {\n    return false;\n  }\n\n  // only allow drop on non compensation activities\n  if (!is(target, 'bpmn:Activity') || isForCompensation(target)) {\n    return false;\n  }\n\n  // only attach to subprocess border\n  if (position && !isBoundaryAttachment(position, target)) {\n    return false;\n  }\n\n  // do not attach on receive tasks after event based gateways\n  if (isReceiveTaskAfterEventBasedGateway(target)) {\n    return false;\n  }\n\n  return 'attach';\n}\n\n\n/**\n * Defines how to replace elements for a given target.\n *\n * Returns an array containing all elements which will be replaced.\n *\n * @example\n *\n *  [{ id: 'IntermediateEvent_2',\n *     type: 'bpmn:StartEvent'\n *   },\n *   { id: 'IntermediateEvent_5',\n *     type: 'bpmn:EndEvent'\n *   }]\n *\n * @param  {Array} elements\n * @param  {Object} target\n *\n * @return {Object} an object containing all elements which have to be replaced\n */\nfunction canReplace(elements, target, position) {\n\n  if (!target) {\n    return false;\n  }\n\n  var canExecute = {\n    replacements: []\n  };\n\n  forEach(elements, function(element) {\n\n    if (!isEventSubProcess(target)) {\n\n      if (is(element, 'bpmn:StartEvent') &&\n          element.type !== 'label' &&\n          canDrop(element, target)) {\n\n        // replace a non-interrupting start event by a blank interrupting start event\n        // when the target is not an event sub process\n        if (!isInterrupting(element)) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: 'bpmn:StartEvent'\n          });\n        }\n\n        // replace an error/escalation/compensate start event by a blank interrupting start event\n        // when the target is not an event sub process\n        if (hasErrorEventDefinition(element) ||\n            hasEscalationEventDefinition(element) ||\n            hasCompensateEventDefinition(element)) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: 'bpmn:StartEvent'\n          });\n        }\n      }\n    }\n\n    if (!is(target, 'bpmn:Transaction')) {\n      if (hasEventDefinition(element, 'bpmn:CancelEventDefinition') &&\n          element.type !== 'label') {\n\n        if (is(element, 'bpmn:EndEvent') && canDrop(element, target)) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: 'bpmn:EndEvent'\n          });\n        }\n\n        if (is(element, 'bpmn:BoundaryEvent') && canAttach(element, target, null, position)) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: 'bpmn:BoundaryEvent'\n          });\n        }\n      }\n    }\n  });\n\n  return canExecute.replacements.length ? canExecute : false;\n}\n\nfunction canMove(elements, target) {\n\n  // do not move selection containing lanes\n  if (some(elements, isLane)) {\n    return false;\n  }\n\n  // allow default move check to start move operation\n  if (!target) {\n    return true;\n  }\n\n  return elements.every(function(element) {\n    return canDrop(element, target);\n  });\n}\n\nfunction canCreate(shape, target, source, position) {\n\n  if (!target) {\n    return false;\n  }\n\n  if (isLabel(shape) || isGroup(shape)) {\n    return true;\n  }\n\n  if (isSame(source, target)) {\n    return false;\n  }\n\n  // ensure we do not drop the element\n  // into source\n  if (source && isParent(source, target)) {\n    return false;\n  }\n\n  return canDrop(shape, target, position) || canInsert(shape, target, position);\n}\n\nfunction canResize(shape, newBounds) {\n  if (is(shape, 'bpmn:SubProcess')) {\n    return (\n      isExpanded(shape) && (\n        !newBounds || (newBounds.width >= 100 && newBounds.height >= 80)\n      )\n    );\n  }\n\n  if (is(shape, 'bpmn:Lane')) {\n    return !newBounds || (newBounds.width >= 130 && newBounds.height >= 60);\n  }\n\n  if (is(shape, 'bpmn:Participant')) {\n    return !newBounds || (newBounds.width >= 250 && newBounds.height >= 50);\n  }\n\n  if (isTextAnnotation(shape)) {\n    return true;\n  }\n\n  if (isGroup(shape)) {\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * Check, whether one side of the relationship\n * is a text annotation.\n */\nfunction isOneTextAnnotation(source, target) {\n\n  var sourceTextAnnotation = isTextAnnotation(source),\n      targetTextAnnotation = isTextAnnotation(target);\n\n  return (\n    (sourceTextAnnotation || targetTextAnnotation) &&\n    (sourceTextAnnotation !== targetTextAnnotation)\n  );\n}\n\n\nfunction canConnectAssociation(source, target) {\n\n  // do not connect connections\n  if (isConnection(source) || isConnection(target)) {\n    return false;\n  }\n\n  // compensation boundary events are exception\n  if (isCompensationBoundary(source) && isForCompensation(target)) {\n    return true;\n  }\n\n  // don't connect parent <-> child\n  if (isParent(target, source) || isParent(source, target)) {\n    return false;\n  }\n\n  // allow connection of associations between <!TextAnnotation> and <TextAnnotation>\n  if (isOneTextAnnotation(source, target)) {\n    return true;\n  }\n\n  // can connect associations where we can connect\n  // data associations, too (!)\n  return !!canConnectDataAssociation(source, target);\n}\n\nfunction canConnectMessageFlow(source, target) {\n\n  // during connect user might move mouse out of canvas\n  // https://github.com/bpmn-io/bpmn-js/issues/1033\n  if (getRootElement(source) && !getRootElement(target)) {\n    return false;\n  }\n\n  return (\n    isMessageFlowSource(source) &&\n    isMessageFlowTarget(target) &&\n    !isSameOrganization(source, target)\n  );\n}\n\nfunction canConnectSequenceFlow(source, target) {\n\n  if (\n    isEventBasedTarget(target) &&\n    target.incoming.length > 0 &&\n    areOutgoingEventBasedGatewayConnections(target.incoming) &&\n    !is(source, 'bpmn:EventBasedGateway')\n  ) {\n    return false;\n  }\n\n  return isSequenceFlowSource(source) &&\n         isSequenceFlowTarget(target) &&\n         isSameScope(source, target) &&\n         !(is(source, 'bpmn:EventBasedGateway') && !isEventBasedTarget(target));\n}\n\n\nfunction canConnectDataAssociation(source, target) {\n\n  if (isAny(source, [ 'bpmn:DataObjectReference', 'bpmn:DataStoreReference' ]) &&\n      isAny(target, [ 'bpmn:Activity', 'bpmn:ThrowEvent' ])) {\n    return { type: 'bpmn:DataInputAssociation' };\n  }\n\n  if (isAny(target, [ 'bpmn:DataObjectReference', 'bpmn:DataStoreReference' ]) &&\n      isAny(source, [ 'bpmn:Activity', 'bpmn:CatchEvent' ])) {\n    return { type: 'bpmn:DataOutputAssociation' };\n  }\n\n  return false;\n}\n\nfunction canInsert(shape, flow, position) {\n\n  if (!flow) {\n    return false;\n  }\n\n  if (Array.isArray(shape)) {\n    if (shape.length !== 1) {\n      return false;\n    }\n\n    shape = shape[0];\n  }\n\n  if (flow.source === shape ||\n      flow.target === shape) {\n    return false;\n  }\n\n  // return true if we can drop on the\n  // underlying flow parent\n  //\n  // at this point we are not really able to talk\n  // about connection rules (yet)\n\n  return (\n    isAny(flow, [ 'bpmn:SequenceFlow', 'bpmn:MessageFlow' ]) &&\n    !isLabel(flow) &&\n    is(shape, 'bpmn:FlowNode') &&\n    !is(shape, 'bpmn:BoundaryEvent') &&\n    canDrop(shape, flow.parent, position));\n}\n\nfunction includes(elements, element) {\n  return (elements && element) && elements.indexOf(element) !== -1;\n}\n\nfunction canCopy(elements, element) {\n  if (isLabel(element)) {\n    return true;\n  }\n\n  if (is(element, 'bpmn:Lane') && !includes(elements, element.parent)) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction isOutgoingEventBasedGatewayConnection(connection) {\n\n  if (connection && connection.source) {\n    return is(connection.source, 'bpmn:EventBasedGateway');\n  }\n}\n\nfunction areOutgoingEventBasedGatewayConnections(connections) {\n  connections = connections || [];\n\n  return connections.some(isOutgoingEventBasedGatewayConnection);\n}\n\nfunction getRootElement(element) {\n  return getParent(element, 'bpmn:Process') || getParent(element, 'bpmn:Collaboration');\n}\n","import RulesModule from 'diagram-js/lib/features/rules';\n\nimport BpmnRules from './BpmnRules';\n\nexport default {\n  __depends__: [\n    RulesModule\n  ],\n  __init__: [ 'bpmnRules' ],\n  bpmnRules: [ 'type', BpmnRules ]\n};\n","import inherits from 'inherits';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n\n/**\n * An abstract provider that allows modelers to implement a custom\n * ordering of diagram elements on the canvas.\n *\n * It makes sure that the order is always preserved during element\n * creation and move operations.\n *\n * In order to use this behavior, inherit from it and override\n * the method {@link OrderingProvider#getOrdering}.\n *\n * @example\n *\n * ```javascript\n * function CustomOrderingProvider(eventBus) {\n *   OrderingProvider.call(this, eventBus);\n *\n *   this.getOrdering = function(element, newParent) {\n *     // always insert elements at the front\n *     // when moving\n *     return {\n *       index: 0,\n *       parent: newParent\n *     };\n *   };\n * }\n * ```\n *\n * @param {EventBus} eventBus\n */\nexport default function OrderingProvider(eventBus) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  var self = this;\n\n  this.preExecute([ 'shape.create', 'connection.create' ], function(event) {\n\n    var context = event.context,\n        element = context.shape || context.connection,\n        parent = context.parent;\n\n    var ordering = self.getOrdering(element, parent);\n\n    if (ordering) {\n\n      if (ordering.parent !== undefined) {\n        context.parent = ordering.parent;\n      }\n\n      context.parentIndex = ordering.index;\n    }\n  });\n\n  this.preExecute([ 'shape.move', 'connection.move' ], function(event) {\n\n    var context = event.context,\n        element = context.shape || context.connection,\n        parent = context.newParent || element.parent;\n\n    var ordering = self.getOrdering(element, parent);\n\n    if (ordering) {\n\n      if (ordering.parent !== undefined) {\n        context.newParent = ordering.parent;\n      }\n\n      context.newParentIndex = ordering.index;\n    }\n  });\n}\n\n/**\n * Return a custom ordering of the element, both in terms\n * of parent element and index in the new parent.\n *\n * Implementors of this method must return an object with\n * `parent` _and_ `index` in it.\n *\n * @param {djs.model.Base} element\n * @param {djs.model.Shape} newParent\n *\n * @return {Object} ordering descriptor\n */\nOrderingProvider.prototype.getOrdering = function(element, newParent) {\n  return null;\n};\n\ninherits(OrderingProvider, CommandInterceptor);","import inherits from 'inherits';\n\nimport OrderingProvider from 'diagram-js/lib/features/ordering/OrderingProvider';\n\nimport {\n  isAny\n} from '../modeling/util/ModelingUtil';\n\nimport {\n  findIndex,\n  find\n} from 'min-dash';\n\n\n/**\n * a simple ordering provider that makes sure:\n *\n * (0) labels and groups are rendered always on top\n * (1) elements are ordered by a {level} property\n */\nexport default function BpmnOrderingProvider(eventBus, canvas, translate) {\n\n  OrderingProvider.call(this, eventBus);\n\n  var orders = [\n    { type: 'bpmn:SubProcess', order: { level: 6 } },\n    {\n      type: 'bpmn:SequenceFlow',\n      order: {\n        level: 3,\n        containers: [\n          'bpmn:Participant',\n          'bpmn:FlowElementsContainer'\n        ]\n      }\n    },\n\n    // handle DataAssociation(s) like message flows and render them always on top\n    {\n      type: 'bpmn:DataAssociation',\n      order: {\n        level: 9,\n        containers: [\n          'bpmn:Collaboration',\n          'bpmn:Process'\n        ]\n      }\n    },\n    {\n      type: 'bpmn:MessageFlow', order: {\n        level: 9,\n        containers: [ 'bpmn:Collaboration' ]\n      }\n    },\n    {\n      type: 'bpmn:Association',\n      order: {\n        level: 6,\n        containers: [\n          'bpmn:Participant',\n          'bpmn:FlowElementsContainer',\n          'bpmn:Collaboration'\n        ]\n      }\n    },\n    { type: 'bpmn:BoundaryEvent', order: { level: 8 } },\n    {\n      type: 'bpmn:Group',\n      order: {\n        level: 10,\n        containers: [\n          'bpmn:Collaboration',\n          'bpmn:Process'\n        ]\n      }\n    },\n    { type: 'bpmn:FlowElement', order: { level: 5 } },\n    { type: 'bpmn:Participant', order: { level: -2 } },\n    { type: 'bpmn:Lane', order: { level: -1 } }\n  ];\n\n  function computeOrder(element) {\n    if (element.labelTarget) {\n      return { level: 10 };\n    }\n\n    var entry = find(orders, function(o) {\n      return isAny(element, [ o.type ]);\n    });\n\n    return entry && entry.order || { level: 1 };\n  }\n\n  function getOrder(element) {\n\n    var order = element.order;\n\n    if (!order) {\n      element.order = order = computeOrder(element);\n    }\n\n    return order;\n  }\n\n  function findActualParent(element, newParent, containers) {\n\n    var actualParent = newParent;\n\n    while (actualParent) {\n\n      if (isAny(actualParent, containers)) {\n        break;\n      }\n\n      actualParent = actualParent.parent;\n    }\n\n    if (!actualParent) {\n      throw new Error(translate('no parent for {element} in {parent}', {\n        element: element.id,\n        parent: newParent.id\n      }));\n    }\n\n    return actualParent;\n  }\n\n  this.getOrdering = function(element, newParent) {\n\n    // render labels always on top\n    if (element.labelTarget) {\n      return {\n        parent: canvas.getRootElement(),\n        index: -1\n      };\n    }\n\n    var elementOrder = getOrder(element);\n\n\n    if (elementOrder.containers) {\n      newParent = findActualParent(element, newParent, elementOrder.containers);\n    }\n\n\n    var currentIndex = newParent.children.indexOf(element);\n\n    var insertIndex = findIndex(newParent.children, function(child) {\n\n      // do not compare with labels, they are created\n      // in the wrong order (right after elements) during import and\n      // mess up the positioning.\n      if (!element.labelTarget && child.labelTarget) {\n        return false;\n      }\n\n      return elementOrder.level < getOrder(child).level;\n    });\n\n\n    // if the element is already in the child list at\n    // a smaller index, we need to adjust the insert index.\n    // this takes into account that the element is being removed\n    // before being re-inserted\n    if (insertIndex !== -1) {\n      if (currentIndex !== -1 && currentIndex < insertIndex) {\n        insertIndex -= 1;\n      }\n    }\n\n    return {\n      index: insertIndex,\n      parent: newParent\n    };\n  };\n}\n\nBpmnOrderingProvider.$inject = [ 'eventBus', 'canvas', 'translate' ];\n\ninherits(BpmnOrderingProvider, OrderingProvider);","import translate from 'diagram-js/lib/i18n/translate';\n\nimport BpmnOrderingProvider from './BpmnOrderingProvider';\n\nexport default {\n  __depends__: [\n    translate\n  ],\n  __init__: [ 'bpmnOrderingProvider' ],\n  bpmnOrderingProvider: [ 'type', BpmnOrderingProvider ]\n};","import {\n  uniqueBy,\n  isArray\n} from 'min-dash';\n\n\n/**\n * A service that offers un- and redoable execution of commands.\n *\n * The command stack is responsible for executing modeling actions\n * in a un- and redoable manner. To do this it delegates the actual\n * command execution to {@link CommandHandler}s.\n *\n * Command handlers provide {@link CommandHandler#execute(ctx)} and\n * {@link CommandHandler#revert(ctx)} methods to un- and redo a command\n * identified by a command context.\n *\n *\n * ## Life-Cycle events\n *\n * In the process the command stack fires a number of life-cycle events\n * that other components to participate in the command execution.\n *\n *    * preExecute\n *    * preExecuted\n *    * execute\n *    * executed\n *    * postExecute\n *    * postExecuted\n *    * revert\n *    * reverted\n *\n * A special event is used for validating, whether a command can be\n * performed prior to its execution.\n *\n *    * canExecute\n *\n * Each of the events is fired as `commandStack.{eventName}` and\n * `commandStack.{commandName}.{eventName}`, respectively. This gives\n * components fine grained control on where to hook into.\n *\n * The event object fired transports `command`, the name of the\n * command and `context`, the command context.\n *\n *\n * ## Creating Command Handlers\n *\n * Command handlers should provide the {@link CommandHandler#execute(ctx)}\n * and {@link CommandHandler#revert(ctx)} methods to implement\n * redoing and undoing of a command.\n *\n * A command handler _must_ ensure undo is performed properly in order\n * not to break the undo chain. It must also return the shapes that\n * got changed during the `execute` and `revert` operations.\n *\n * Command handlers may execute other modeling operations (and thus\n * commands) in their `preExecute` and `postExecute` phases. The command\n * stack will properly group all commands together into a logical unit\n * that may be re- and undone atomically.\n *\n * Command handlers must not execute other commands from within their\n * core implementation (`execute`, `revert`).\n *\n *\n * ## Change Tracking\n *\n * During the execution of the CommandStack it will keep track of all\n * elements that have been touched during the command's execution.\n *\n * At the end of the CommandStack execution it will notify interested\n * components via an 'elements.changed' event with all the dirty\n * elements.\n *\n * The event can be picked up by components that are interested in the fact\n * that elements have been changed. One use case for this is updating\n * their graphical representation after moving / resizing or deletion.\n *\n * @see CommandHandler\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function CommandStack(eventBus, injector) {\n\n  /**\n   * A map of all registered command handlers.\n   *\n   * @type {Object}\n   */\n  this._handlerMap = {};\n\n  /**\n   * A stack containing all re/undoable actions on the diagram\n   *\n   * @type {Array<Object>}\n   */\n  this._stack = [];\n\n  /**\n   * The current index on the stack\n   *\n   * @type {Number}\n   */\n  this._stackIdx = -1;\n\n  /**\n   * Current active commandStack execution\n   *\n   * @type {Object}\n   */\n  this._currentExecution = {\n    actions: [],\n    dirty: []\n  };\n\n\n  this._injector = injector;\n  this._eventBus = eventBus;\n\n  this._uid = 1;\n\n  eventBus.on([\n    'diagram.destroy',\n    'diagram.clear'\n  ], function() {\n    this.clear(false);\n  }, this);\n}\n\nCommandStack.$inject = [ 'eventBus', 'injector' ];\n\n\n/**\n * Execute a command\n *\n * @param {String} command the command to execute\n * @param {Object} context the environment to execute the command in\n */\nCommandStack.prototype.execute = function(command, context) {\n  if (!command) {\n    throw new Error('command required');\n  }\n\n  var action = { command: command, context: context };\n\n  this._pushAction(action);\n  this._internalExecute(action);\n  this._popAction(action);\n};\n\n\n/**\n * Ask whether a given command can be executed.\n *\n * Implementors may hook into the mechanism on two ways:\n *\n *   * in event listeners:\n *\n *     Users may prevent the execution via an event listener.\n *     It must prevent the default action for `commandStack.(<command>.)canExecute` events.\n *\n *   * in command handlers:\n *\n *     If the method {@link CommandHandler#canExecute} is implemented in a handler\n *     it will be called to figure out whether the execution is allowed.\n *\n * @param  {String} command the command to execute\n * @param  {Object} context the environment to execute the command in\n *\n * @return {Boolean} true if the command can be executed\n */\nCommandStack.prototype.canExecute = function(command, context) {\n\n  var action = { command: command, context: context };\n\n  var handler = this._getHandler(command);\n\n  var result = this._fire(command, 'canExecute', action);\n\n  // handler#canExecute will only be called if no listener\n  // decided on a result already\n  if (result === undefined) {\n    if (!handler) {\n      return false;\n    }\n\n    if (handler.canExecute) {\n      result = handler.canExecute(context);\n    }\n  }\n\n  return result;\n};\n\n\n/**\n * Clear the command stack, erasing all undo / redo history\n */\nCommandStack.prototype.clear = function(emit) {\n  this._stack.length = 0;\n  this._stackIdx = -1;\n\n  if (emit !== false) {\n    this._fire('changed');\n  }\n};\n\n\n/**\n * Undo last command(s)\n */\nCommandStack.prototype.undo = function() {\n  var action = this._getUndoAction(),\n      next;\n\n  if (action) {\n    this._pushAction(action);\n\n    while (action) {\n      this._internalUndo(action);\n      next = this._getUndoAction();\n\n      if (!next || next.id !== action.id) {\n        break;\n      }\n\n      action = next;\n    }\n\n    this._popAction();\n  }\n};\n\n\n/**\n * Redo last command(s)\n */\nCommandStack.prototype.redo = function() {\n  var action = this._getRedoAction(),\n      next;\n\n  if (action) {\n    this._pushAction(action);\n\n    while (action) {\n      this._internalExecute(action, true);\n      next = this._getRedoAction();\n\n      if (!next || next.id !== action.id) {\n        break;\n      }\n\n      action = next;\n    }\n\n    this._popAction();\n  }\n};\n\n\n/**\n * Register a handler instance with the command stack\n *\n * @param {String} command\n * @param {CommandHandler} handler\n */\nCommandStack.prototype.register = function(command, handler) {\n  this._setHandler(command, handler);\n};\n\n\n/**\n * Register a handler type with the command stack\n * by instantiating it and injecting its dependencies.\n *\n * @param {String} command\n * @param {Function} a constructor for a {@link CommandHandler}\n */\nCommandStack.prototype.registerHandler = function(command, handlerCls) {\n\n  if (!command || !handlerCls) {\n    throw new Error('command and handlerCls must be defined');\n  }\n\n  var handler = this._injector.instantiate(handlerCls);\n  this.register(command, handler);\n};\n\nCommandStack.prototype.canUndo = function() {\n  return !!this._getUndoAction();\n};\n\nCommandStack.prototype.canRedo = function() {\n  return !!this._getRedoAction();\n};\n\n// stack access  //////////////////////\n\nCommandStack.prototype._getRedoAction = function() {\n  return this._stack[this._stackIdx + 1];\n};\n\n\nCommandStack.prototype._getUndoAction = function() {\n  return this._stack[this._stackIdx];\n};\n\n\n// internal functionality //////////////////////\n\nCommandStack.prototype._internalUndo = function(action) {\n  var self = this;\n\n  var command = action.command,\n      context = action.context;\n\n  var handler = this._getHandler(command);\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(function() {\n    self._fire(command, 'revert', action);\n\n    if (handler.revert) {\n      self._markDirty(handler.revert(context));\n    }\n\n    self._revertedAction(action);\n\n    self._fire(command, 'reverted', action);\n  });\n};\n\n\nCommandStack.prototype._fire = function(command, qualifier, event) {\n  if (arguments.length < 3) {\n    event = qualifier;\n    qualifier = null;\n  }\n\n  var names = qualifier ? [ command + '.' + qualifier, qualifier ] : [ command ],\n      i, name, result;\n\n  event = this._eventBus.createEvent(event);\n\n  for (i = 0; (name = names[i]); i++) {\n    result = this._eventBus.fire('commandStack.' + name, event);\n\n    if (event.cancelBubble) {\n      break;\n    }\n  }\n\n  return result;\n};\n\nCommandStack.prototype._createId = function() {\n  return this._uid++;\n};\n\nCommandStack.prototype._atomicDo = function(fn) {\n\n  var execution = this._currentExecution;\n\n  execution.atomic = true;\n\n  try {\n    fn();\n  } finally {\n    execution.atomic = false;\n  }\n};\n\nCommandStack.prototype._internalExecute = function(action, redo) {\n  var self = this;\n\n  var command = action.command,\n      context = action.context;\n\n  var handler = this._getHandler(command);\n\n  if (!handler) {\n    throw new Error('no command handler registered for <' + command + '>');\n  }\n\n  this._pushAction(action);\n\n  if (!redo) {\n    this._fire(command, 'preExecute', action);\n\n    if (handler.preExecute) {\n      handler.preExecute(context);\n    }\n\n    this._fire(command, 'preExecuted', action);\n  }\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(function() {\n\n    self._fire(command, 'execute', action);\n\n    if (handler.execute) {\n\n      // actual execute + mark return results as dirty\n      self._markDirty(handler.execute(context));\n    }\n\n    // log to stack\n    self._executedAction(action, redo);\n\n    self._fire(command, 'executed', action);\n  });\n\n  if (!redo) {\n    this._fire(command, 'postExecute', action);\n\n    if (handler.postExecute) {\n      handler.postExecute(context);\n    }\n\n    this._fire(command, 'postExecuted', action);\n  }\n\n  this._popAction(action);\n};\n\n\nCommandStack.prototype._pushAction = function(action) {\n\n  var execution = this._currentExecution,\n      actions = execution.actions;\n\n  var baseAction = actions[0];\n\n  if (execution.atomic) {\n    throw new Error('illegal invocation in <execute> or <revert> phase (action: ' + action.command + ')');\n  }\n\n  if (!action.id) {\n    action.id = (baseAction && baseAction.id) || this._createId();\n  }\n\n  actions.push(action);\n};\n\n\nCommandStack.prototype._popAction = function() {\n  var execution = this._currentExecution,\n      actions = execution.actions,\n      dirty = execution.dirty;\n\n  actions.pop();\n\n  if (!actions.length) {\n    this._eventBus.fire('elements.changed', { elements: uniqueBy('id', dirty.reverse()) });\n\n    dirty.length = 0;\n\n    this._fire('changed');\n  }\n};\n\n\nCommandStack.prototype._markDirty = function(elements) {\n  var execution = this._currentExecution;\n\n  if (!elements) {\n    return;\n  }\n\n  elements = isArray(elements) ? elements : [ elements ];\n\n  execution.dirty = execution.dirty.concat(elements);\n};\n\n\nCommandStack.prototype._executedAction = function(action, redo) {\n  var stackIdx = ++this._stackIdx;\n\n  if (!redo) {\n    this._stack.splice(stackIdx, this._stack.length, action);\n  }\n};\n\n\nCommandStack.prototype._revertedAction = function(action) {\n  this._stackIdx--;\n};\n\n\nCommandStack.prototype._getHandler = function(command) {\n  return this._handlerMap[command];\n};\n\nCommandStack.prototype._setHandler = function(command, handler) {\n  if (!command || !handler) {\n    throw new Error('command and handler required');\n  }\n\n  if (this._handlerMap[command]) {\n    throw new Error('overriding handler for command <' + command + '>');\n  }\n\n  this._handlerMap[command] = handler;\n};\n","import CommandStack from './CommandStack';\n\nexport default {\n  commandStack: [ 'type', CommandStack ]\n};\n","import {\n  isString,\n  assign,\n  forEach\n} from 'min-dash';\n\nimport {\n  domify,\n  attr as domAttr,\n  classes as domClasses,\n  remove as domRemove,\n  delegate as domDelegate\n} from 'min-dom';\n\nimport Ids from '../../util/IdGenerator';\n\n// document wide unique tooltip ids\nvar ids = new Ids('tt');\n\n\nfunction createRoot(parentNode) {\n  var root = domify(\n    '<div class=\"djs-tooltip-container\" style=\"position: absolute; width: 0; height: 0;\" />'\n  );\n\n  parentNode.insertBefore(root, parentNode.firstChild);\n\n  return root;\n}\n\n\nfunction setPosition(el, x, y) {\n  assign(el.style, { left: x + 'px', top: y + 'px' });\n}\n\nfunction setVisible(el, visible) {\n  el.style.display = visible === false ? 'none' : '';\n}\n\n\nvar tooltipClass = 'djs-tooltip',\n    tooltipSelector = '.' + tooltipClass;\n\n/**\n * A service that allows users to render tool tips on the diagram.\n *\n * The tooltip service will take care of updating the tooltip positioning\n * during navigation + zooming.\n *\n * @example\n *\n * ```javascript\n *\n * // add a pink badge on the top left of the shape\n * tooltips.add({\n *   position: {\n *     x: 50,\n *     y: 100\n *   },\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>'\n * });\n *\n * // or with optional life span\n * tooltips.add({\n *   position: {\n *     top: -5,\n *     left: -5\n *   },\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>',\n *   ttl: 2000\n * });\n *\n * // remove a tool tip\n * var id = tooltips.add(...);\n * tooltips.remove(id);\n * ```\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function Tooltips(eventBus, canvas) {\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n\n  this._ids = ids;\n\n  this._tooltipDefaults = {\n    show: {\n      minZoom: 0.7,\n      maxZoom: 5.0\n    }\n  };\n\n  /**\n   * Mapping tooltipId -> tooltip\n   */\n  this._tooltips = {};\n\n  // root html element for all tooltips\n  this._tooltipRoot = createRoot(canvas.getContainer());\n\n\n  var self = this;\n\n  domDelegate.bind(this._tooltipRoot, tooltipSelector, 'mousedown', function(event) {\n    event.stopPropagation();\n  });\n\n  domDelegate.bind(this._tooltipRoot, tooltipSelector, 'mouseover', function(event) {\n    self.trigger('mouseover', event);\n  });\n\n  domDelegate.bind(this._tooltipRoot, tooltipSelector, 'mouseout', function(event) {\n    self.trigger('mouseout', event);\n  });\n\n  this._init();\n}\n\n\nTooltips.$inject = [ 'eventBus', 'canvas' ];\n\n\n/**\n * Adds a HTML tooltip to the diagram\n *\n * @param {Object}               tooltip   the tooltip configuration\n *\n * @param {String|DOMElement}    tooltip.html                 html element to use as an tooltip\n * @param {Object}               [tooltip.show]               show configuration\n * @param {Number}               [tooltip.show.minZoom]       minimal zoom level to show the tooltip\n * @param {Number}               [tooltip.show.maxZoom]       maximum zoom level to show the tooltip\n * @param {Object}               tooltip.position             where to attach the tooltip\n * @param {Number}               [tooltip.position.left]      relative to element bbox left attachment\n * @param {Number}               [tooltip.position.top]       relative to element bbox top attachment\n * @param {Number}               [tooltip.position.bottom]    relative to element bbox bottom attachment\n * @param {Number}               [tooltip.position.right]     relative to element bbox right attachment\n * @param {Number}               [tooltip.timeout=-1]\n *\n * @return {String}              id that may be used to reference the tooltip for update or removal\n */\nTooltips.prototype.add = function(tooltip) {\n\n  if (!tooltip.position) {\n    throw new Error('must specifiy tooltip position');\n  }\n\n  if (!tooltip.html) {\n    throw new Error('must specifiy tooltip html');\n  }\n\n  var id = this._ids.next();\n\n  tooltip = assign({}, this._tooltipDefaults, tooltip, {\n    id: id\n  });\n\n  this._addTooltip(tooltip);\n\n  if (tooltip.timeout) {\n    this.setTimeout(tooltip);\n  }\n\n  return id;\n};\n\nTooltips.prototype.trigger = function(action, event) {\n\n  var node = event.delegateTarget || event.target;\n\n  var tooltip = this.get(domAttr(node, 'data-tooltip-id'));\n\n  if (!tooltip) {\n    return;\n  }\n\n  if (action === 'mouseover' && tooltip.timeout) {\n    this.clearTimeout(tooltip);\n  }\n\n  if (action === 'mouseout' && tooltip.timeout) {\n\n    // cut timeout after mouse out\n    tooltip.timeout = 1000;\n\n    this.setTimeout(tooltip);\n  }\n};\n\n/**\n * Get a tooltip with the given id\n *\n * @param {String} id\n */\nTooltips.prototype.get = function(id) {\n\n  if (typeof id !== 'string') {\n    id = id.id;\n  }\n\n  return this._tooltips[id];\n};\n\nTooltips.prototype.clearTimeout = function(tooltip) {\n\n  tooltip = this.get(tooltip);\n\n  if (!tooltip) {\n    return;\n  }\n\n  var removeTimer = tooltip.removeTimer;\n\n  if (removeTimer) {\n    clearTimeout(removeTimer);\n    tooltip.removeTimer = null;\n  }\n};\n\nTooltips.prototype.setTimeout = function(tooltip) {\n\n  tooltip = this.get(tooltip);\n\n  if (!tooltip) {\n    return;\n  }\n\n  this.clearTimeout(tooltip);\n\n  var self = this;\n\n  tooltip.removeTimer = setTimeout(function() {\n    self.remove(tooltip);\n  }, tooltip.timeout);\n};\n\n/**\n * Remove an tooltip with the given id\n *\n * @param {String} id\n */\nTooltips.prototype.remove = function(id) {\n\n  var tooltip = this.get(id);\n\n  if (tooltip) {\n    domRemove(tooltip.html);\n    domRemove(tooltip.htmlContainer);\n\n    delete tooltip.htmlContainer;\n\n    delete this._tooltips[tooltip.id];\n  }\n};\n\n\nTooltips.prototype.show = function() {\n  setVisible(this._tooltipRoot);\n};\n\n\nTooltips.prototype.hide = function() {\n  setVisible(this._tooltipRoot, false);\n};\n\n\nTooltips.prototype._updateRoot = function(viewbox) {\n  var a = viewbox.scale || 1;\n  var d = viewbox.scale || 1;\n\n  var matrix = 'matrix(' + a + ',0,0,' + d + ',' + (-1 * viewbox.x * a) + ',' + (-1 * viewbox.y * d) + ')';\n\n  this._tooltipRoot.style.transform = matrix;\n  this._tooltipRoot.style['-ms-transform'] = matrix;\n};\n\n\nTooltips.prototype._addTooltip = function(tooltip) {\n\n  var id = tooltip.id,\n      html = tooltip.html,\n      htmlContainer,\n      tooltipRoot = this._tooltipRoot;\n\n  // unwrap jquery (for those who need it)\n  if (html.get && html.constructor.prototype.jquery) {\n    html = html.get(0);\n  }\n\n  // create proper html elements from\n  // tooltip HTML strings\n  if (isString(html)) {\n    html = domify(html);\n  }\n\n  htmlContainer = domify('<div data-tooltip-id=\"' + id + '\" class=\"' + tooltipClass + '\" style=\"position: absolute\">');\n\n  htmlContainer.appendChild(html);\n\n  if (tooltip.type) {\n    domClasses(htmlContainer).add('djs-tooltip-' + tooltip.type);\n  }\n\n  if (tooltip.className) {\n    domClasses(htmlContainer).add(tooltip.className);\n  }\n\n  tooltip.htmlContainer = htmlContainer;\n\n  tooltipRoot.appendChild(htmlContainer);\n\n  this._tooltips[id] = tooltip;\n\n  this._updateTooltip(tooltip);\n};\n\n\nTooltips.prototype._updateTooltip = function(tooltip) {\n\n  var position = tooltip.position,\n      htmlContainer = tooltip.htmlContainer;\n\n  // update overlay html based on tooltip x, y\n\n  setPosition(htmlContainer, position.x, position.y);\n};\n\n\nTooltips.prototype._updateTooltipVisibilty = function(viewbox) {\n\n  forEach(this._tooltips, function(tooltip) {\n    var show = tooltip.show,\n        htmlContainer = tooltip.htmlContainer,\n        visible = true;\n\n    if (show) {\n      if (show.minZoom > viewbox.scale ||\n          show.maxZoom < viewbox.scale) {\n        visible = false;\n      }\n\n      setVisible(htmlContainer, visible);\n    }\n  });\n};\n\nTooltips.prototype._init = function() {\n\n  var self = this;\n\n  // scroll/zoom integration\n\n  function updateViewbox(viewbox) {\n    self._updateRoot(viewbox);\n    self._updateTooltipVisibilty(viewbox);\n\n    self.show();\n  }\n\n  this._eventBus.on('canvas.viewbox.changing', function(event) {\n    self.hide();\n  });\n\n  this._eventBus.on('canvas.viewbox.changed', function(event) {\n    updateViewbox(event.viewbox);\n  });\n};\n","import Tooltips from './Tooltips';\n\nexport default {\n  __init__: [ 'tooltips' ],\n  tooltips: [ 'type', Tooltips ]\n};","/**\n * Remove from the beginning of a collection until it is empty.\n *\n * This is a null-safe operation that ensures elements\n * are being removed from the given collection until the\n * collection is empty.\n *\n * The implementation deals with the fact that a remove operation\n * may touch, i.e. remove multiple elements in the collection\n * at a time.\n *\n * @param {Array<Object>} [collection]\n * @param {Function} removeFn\n *\n * @return {Array<Object>} the cleared collection\n */\nexport function saveClear(collection, removeFn) {\n\n  if (typeof removeFn !== 'function') {\n    throw new Error('removeFn iterator must be a function');\n  }\n\n  if (!collection) {\n    return;\n  }\n\n  var e;\n\n  while ((e = collection[0])) {\n    removeFn(e);\n  }\n\n  return collection;\n}\n","import {\n  forEach,\n  filter\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nvar LOW_PRIORITY = 250,\n    HIGH_PRIORITY = 1400;\n\nimport {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../util/Collections';\n\nimport { saveClear } from '../../util/Removal';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n\n/**\n * A handler that makes sure labels are properly moved with\n * their label targets.\n *\n * @param {didi.Injector} injector\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function LabelSupport(injector, eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var movePreview = injector.get('movePreview', false);\n\n  // remove labels from the collection that are being\n  // moved with other elements anyway\n  eventBus.on('shape.move.start', HIGH_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        validatedShapes = context.validatedShapes;\n\n    context.shapes = removeLabels(shapes);\n    context.validatedShapes = removeLabels(validatedShapes);\n  });\n\n  // add labels to visual's group\n  movePreview && eventBus.on('shape.move.start', LOW_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes;\n\n    var labels = [];\n\n    forEach(shapes, function(element) {\n\n      forEach(element.labels, function(label) {\n\n        if (!label.hidden && context.shapes.indexOf(label) === -1) {\n          labels.push(label);\n        }\n\n        if (element.labelTarget) {\n          labels.push(element);\n        }\n      });\n    });\n\n    forEach(labels, function(label) {\n      movePreview.makeDraggable(context, label, true);\n    });\n\n  });\n\n  // add all labels to move closure\n  this.preExecuted('elements.move', HIGH_PRIORITY, function(e) {\n    var context = e.context,\n        closure = context.closure,\n        enclosedElements = closure.enclosedElements;\n\n    var enclosedLabels = [];\n\n    // find labels that are not part of\n    // move closure yet and add them\n    forEach(enclosedElements, function(element) {\n      forEach(element.labels, function(label) {\n\n        if (!enclosedElements[label.id]) {\n          enclosedLabels.push(label);\n        }\n      });\n    });\n\n    closure.addAll(enclosedLabels);\n  });\n\n\n  this.preExecute([\n    'connection.delete',\n    'shape.delete'\n  ], function(e) {\n\n    var context = e.context,\n        element = context.connection || context.shape;\n\n    saveClear(element.labels, function(label) {\n      modeling.removeShape(label, { nested: true });\n    });\n  });\n\n\n  this.execute('shape.delete', function(e) {\n\n    var context = e.context,\n        shape = context.shape,\n        labelTarget = shape.labelTarget;\n\n    // unset labelTarget\n    if (labelTarget) {\n      context.labelTargetIndex = collectionIdx(labelTarget.labels, shape);\n      context.labelTarget = labelTarget;\n\n      shape.labelTarget = null;\n    }\n  });\n\n  this.revert('shape.delete', function(e) {\n\n    var context = e.context,\n        shape = context.shape,\n        labelTarget = context.labelTarget,\n        labelTargetIndex = context.labelTargetIndex;\n\n    // restore labelTarget\n    if (labelTarget) {\n      collectionAdd(labelTarget.labels, shape, labelTargetIndex);\n\n      shape.labelTarget = labelTarget;\n    }\n  });\n\n}\n\ninherits(LabelSupport, CommandInterceptor);\n\nLabelSupport.$inject = [\n  'injector',\n  'eventBus',\n  'modeling'\n];\n\n\n/**\n * Return a filtered list of elements that do not\n * contain attached elements with hosts being part\n * of the selection.\n *\n * @param  {Array<djs.model.Base>} elements\n *\n * @return {Array<djs.model.Base>} filtered\n */\nfunction removeLabels(elements) {\n\n  return filter(elements, function(element) {\n\n    // filter out labels that are move together\n    // with their label targets\n    return elements.indexOf(element.labelTarget) === -1;\n  });\n}\n","import LabelSupport from './LabelSupport';\n\nexport default {\n  __init__: [ 'labelSupport'],\n  labelSupport: [ 'type', LabelSupport ]\n};\n","import {\n  flatten,\n  filter,\n  forEach,\n  groupBy,\n  map,\n  unionBy\n} from 'min-dash';\n\nimport { saveClear } from '../../util/Removal';\n\nimport { getNewAttachShapeDelta } from '../../util/AttachUtil';\n\nimport inherits from 'inherits';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\nvar LOW_PRIORITY = 251,\n    HIGH_PRIORITY = 1401;\n\nvar MARKER_ATTACH = 'attach-ok';\n\n\n/**\n * Adds the notion of attached elements to the modeler.\n *\n * Optionally depends on `diagram-js/lib/features/move` to render\n * the attached elements during move preview.\n *\n * Optionally depends on `diagram-js/lib/features/label-support`\n * to render attached labels during move preview.\n *\n * @param {didi.Injector} injector\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {Rules} rules\n * @param {Modeling} modeling\n */\nexport default function AttachSupport(injector, eventBus, canvas, rules, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var movePreview = injector.get('movePreview', false);\n\n\n  // remove all the attached elements from the shapes to be validated\n  // add all the attached shapes to the overall list of moved shapes\n  eventBus.on('shape.move.start', HIGH_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        validatedShapes = context.validatedShapes;\n\n    context.shapes = addAttached(shapes);\n\n    context.validatedShapes = removeAttached(validatedShapes);\n  });\n\n  // add attachers to the visual's group\n  movePreview && eventBus.on('shape.move.start', LOW_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        attachers = getAttachers(shapes);\n\n    forEach(attachers, function(attacher) {\n      movePreview.makeDraggable(context, attacher, true);\n\n      forEach(attacher.labels, function(label) {\n        movePreview.makeDraggable(context, label, true);\n      });\n    });\n  });\n\n  // add attach-ok marker to current host\n  movePreview && eventBus.on('shape.move.start', function(event) {\n    var context = event.context,\n        shapes = context.shapes;\n\n    if (shapes.length !== 1) {\n      return;\n    }\n\n    var shape = shapes[0];\n\n    var host = shape.host;\n\n    if (host) {\n      canvas.addMarker(host, MARKER_ATTACH);\n\n      eventBus.once([\n        'shape.move.out',\n        'shape.move.cleanup'\n      ], function() {\n        canvas.removeMarker(host, MARKER_ATTACH);\n      });\n    }\n  });\n\n  // add all attachers to move closure\n  this.preExecuted('elements.move', HIGH_PRIORITY, function(e) {\n    var context = e.context,\n        closure = context.closure,\n        shapes = context.shapes,\n        attachers = getAttachers(shapes);\n\n    forEach(attachers, function(attacher) {\n      closure.add(attacher, closure.topLevel[attacher.host.id]);\n    });\n  });\n\n  // perform the attaching after shapes are done moving\n  this.postExecuted('elements.move', function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        newHost = context.newHost,\n        attachers;\n\n    // only single elements can be attached\n    // multiply elements can be detached\n    if (newHost && shapes.length !== 1) {\n      return;\n    }\n\n    if (newHost) {\n      attachers = shapes;\n    } else {\n\n      // find attachers moved without host\n      attachers = filter(shapes, function(shape) {\n        var host = shape.host;\n\n        return isAttacher(shape) && !includes(shapes, host);\n      });\n    }\n\n    forEach(attachers, function(attacher) {\n      modeling.updateAttachment(attacher, newHost);\n    });\n  });\n\n  // ensure invalid attachment connections are removed\n  this.postExecuted('elements.move', function(e) {\n\n    var shapes = e.context.shapes;\n\n    forEach(shapes, function(shape) {\n\n      forEach(shape.attachers, function(attacher) {\n\n        // remove invalid outgoing connections\n        forEach(attacher.outgoing.slice(), function(connection) {\n          var allowed = rules.allowed('connection.reconnect', {\n            connection: connection,\n            source: connection.source,\n            target: connection.target\n          });\n\n          if (!allowed) {\n            modeling.removeConnection(connection);\n          }\n        });\n\n        // remove invalid incoming connections\n        forEach(attacher.incoming.slice(), function(connection) {\n          var allowed = rules.allowed('connection.reconnect', {\n            connection: connection,\n            source: connection.source,\n            target: connection.target\n          });\n\n          if (!allowed) {\n            modeling.removeConnection(connection);\n          }\n        });\n      });\n    });\n  });\n\n  this.postExecute('shape.create', function(e) {\n    var context = e.context,\n        shape = context.shape,\n        host = context.host;\n\n    if (host) {\n      modeling.updateAttachment(shape, host);\n    }\n  });\n\n  // update attachments if the host is replaced\n  this.postExecute('shape.replace', function(e) {\n\n    var context = e.context,\n        oldShape = context.oldShape,\n        newShape = context.newShape;\n\n    // move the attachers to the new host\n    saveClear(oldShape.attachers, function(attacher) {\n      var allowed = rules.allowed('elements.move', {\n        target: newShape,\n        shapes: [attacher]\n      });\n\n      if (allowed === 'attach') {\n        modeling.updateAttachment(attacher, newShape);\n      } else {\n        modeling.removeShape(attacher);\n      }\n    });\n\n    // move attachers if new host has different size\n    if (newShape.attachers.length) {\n\n      forEach(newShape.attachers, function(attacher) {\n        var delta = getNewAttachShapeDelta(attacher, oldShape, newShape);\n        modeling.moveShape(attacher, delta, attacher.parent);\n      });\n    }\n\n  });\n\n  // move shape on host resize\n  this.postExecute('shape.resize', function(event) {\n    var context = event.context,\n        shape = context.shape,\n        oldBounds = context.oldBounds,\n        newBounds = context.newBounds,\n        attachers = shape.attachers,\n        hints = context.hints || {};\n\n    if (hints.attachSupport === false) {\n      return;\n    }\n\n    forEach(attachers, function(attacher) {\n      var delta = getNewAttachShapeDelta(attacher, oldBounds, newBounds);\n\n      modeling.moveShape(attacher, delta, attacher.parent);\n\n      forEach(attacher.labels, function(label) {\n        modeling.moveShape(label, delta, label.parent);\n      });\n    });\n  });\n\n  // remove attachments\n  this.preExecute('shape.delete', function(event) {\n\n    var shape = event.context.shape;\n\n    saveClear(shape.attachers, function(attacher) {\n      modeling.removeShape(attacher);\n    });\n\n    if (shape.host) {\n      modeling.updateAttachment(shape, null);\n    }\n  });\n}\n\ninherits(AttachSupport, CommandInterceptor);\n\nAttachSupport.$inject = [\n  'injector',\n  'eventBus',\n  'canvas',\n  'rules',\n  'modeling'\n];\n\n\n/**\n * Return attachers of the given shapes\n *\n * @param {Array<djs.model.Base>} shapes\n * @return {Array<djs.model.Base>}\n */\nfunction getAttachers(shapes) {\n  return flatten(map(shapes, function(s) {\n    return s.attachers || [];\n  }));\n}\n\n/**\n * Return a combined list of elements and\n * attachers.\n *\n * @param {Array<djs.model.Base>} elements\n * @return {Array<djs.model.Base>} filtered\n */\nfunction addAttached(elements) {\n  var attachers = getAttachers(elements);\n\n  return unionBy('id', elements, attachers);\n}\n\n/**\n * Return a filtered list of elements that do not\n * contain attached elements with hosts being part\n * of the selection.\n *\n * @param  {Array<djs.model.Base>} elements\n *\n * @return {Array<djs.model.Base>} filtered\n */\nfunction removeAttached(elements) {\n\n  var ids = groupBy(elements, 'id');\n\n  return filter(elements, function(element) {\n    while (element) {\n\n      // host in selection\n      if (element.host && ids[element.host.id]) {\n        return false;\n      }\n\n      element = element.parent;\n    }\n\n    return true;\n  });\n}\n\nfunction isAttacher(shape) {\n  return !!shape.host;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}","import RulesModule from '../rules';\n\nimport AttachSupport from './AttachSupport';\n\nexport default {\n  __depends__: [\n    RulesModule\n  ],\n  __init__: [ 'attachSupport' ],\n  attachSupport: [ 'type', AttachSupport ]\n};\n","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  closest as domClosest\n} from 'min-dom';\n\nvar LOW_PRIORITY = 250;\n\n/**\n * The tool manager acts as middle-man between the available tool's and the Palette,\n * it takes care of making sure that the correct active state is set.\n *\n * @param  {Object}    eventBus\n * @param  {Object}    dragging\n */\nexport default function ToolManager(eventBus, dragging) {\n  this._eventBus = eventBus;\n  this._dragging = dragging;\n\n  this._tools = [];\n  this._active = null;\n}\n\nToolManager.$inject = [ 'eventBus', 'dragging' ];\n\nToolManager.prototype.registerTool = function(name, events) {\n  var tools = this._tools;\n\n  if (!events) {\n    throw new Error('A tool has to be registered with it\\'s \"events\"');\n  }\n\n  tools.push(name);\n\n  this.bindEvents(name, events);\n};\n\nToolManager.prototype.isActive = function(tool) {\n  return tool && this._active === tool;\n};\n\nToolManager.prototype.length = function(tool) {\n  return this._tools.length;\n};\n\nToolManager.prototype.setActive = function(tool) {\n  var eventBus = this._eventBus;\n\n  if (this._active !== tool) {\n    this._active = tool;\n\n    eventBus.fire('tool-manager.update', { tool: tool });\n  }\n};\n\nToolManager.prototype.bindEvents = function(name, events) {\n  var eventBus = this._eventBus,\n      dragging = this._dragging;\n\n  var eventsToRegister = [];\n\n  eventBus.on(events.tool + '.init', function(event) {\n    var context = event.context;\n\n    // Active tools that want to reactivate themselves must do this explicitly\n    if (!context.reactivate && this.isActive(name)) {\n      this.setActive(null);\n\n      dragging.cancel();\n      return;\n    }\n\n    this.setActive(name);\n\n  }, this);\n\n  // Todo[ricardo]: add test cases\n  forEach(events, function(event) {\n    eventsToRegister.push(event + '.ended');\n    eventsToRegister.push(event + '.canceled');\n  });\n\n  eventBus.on(eventsToRegister, LOW_PRIORITY, function(event) {\n    var originalEvent = event.originalEvent;\n\n    // We defer the de-activation of the tool to the .activate phase,\n    // so we're able to check if we want to toggle off the current\n    // active tool or switch to a new one\n    if (!this._active) {\n      return;\n    }\n\n    if (originalEvent && domClosest(originalEvent.target, '.group[data-group=\"tools\"]')) {\n      return;\n    }\n\n    this.setActive(null);\n  }, this);\n};\n","import DraggingModule from '../dragging';\n\nimport ToolManager from './ToolManager';\n\nexport default {\n  __depends__: [\n    DraggingModule\n  ],\n  __init__: [ 'toolManager' ],\n  toolManager: [ 'type', ToolManager ]\n};\n","import { forEach } from 'min-dash';\n\n/**\n * Return direction given axis and delta.\n *\n * @param {string} axis\n * @param {number} delta\n *\n * @return {string}\n */\nexport function getDirection(axis, delta) {\n\n  if (axis === 'x') {\n    if (delta > 0) {\n      return 'e';\n    }\n\n    if (delta < 0) {\n      return 'w';\n    }\n  }\n\n  if (axis === 'y') {\n    if (delta > 0) {\n      return 's';\n    }\n\n    if (delta < 0) {\n      return 'n';\n    }\n  }\n\n  return null;\n}\n\n/**\n * Returns connections whose waypoints are to be updated. Waypoints are to be updated if start\n * or end is to be moved or resized.\n *\n * @param {Array<djs.model.Shape} movingShapes\n * @param {Array<djs.model.Shape} resizingShapes\n *\n * @returns {Array<djs.model.Connection>}\n */\nexport function getWaypointsUpdatingConnections(movingShapes, resizingShapes) {\n  var waypointsUpdatingConnections = [];\n\n  forEach(movingShapes, function(shape) {\n    var incoming = shape.incoming,\n        outgoing = shape.outgoing;\n\n    forEach(incoming.concat(outgoing), function(connection) {\n      var source = connection.source,\n          target = connection.target;\n\n      if (includes(movingShapes, source) ||\n        includes(movingShapes, target) ||\n        includes(resizingShapes, source) ||\n        includes(resizingShapes, target)) {\n\n        if (!includes(waypointsUpdatingConnections, connection)) {\n          waypointsUpdatingConnections.push(connection);\n        }\n      }\n    });\n  });\n\n  return waypointsUpdatingConnections;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}\n\n/**\n * Resize bounds.\n *\n * @param {Object} bounds\n * @param {number} bounds.x\n * @param {number} bounds.y\n * @param {number} bounds.width\n * @param {number} bounds.height\n * @param {string} direction\n * @param {Object} delta\n * @param {number} delta.x\n * @param {number} delta.y\n *\n * @return {Object}\n */\nexport function resizeBounds(bounds, direction, delta) {\n  var x = bounds.x,\n      y = bounds.y,\n      width = bounds.width,\n      height = bounds.height,\n      dx = delta.x,\n      dy = delta.y;\n\n  switch (direction) {\n  case 'n':\n    return {\n      x: x,\n      y: y + dy,\n      width: width,\n      height: height - dy\n    };\n  case 's':\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height + dy\n    };\n  case 'w':\n    return {\n      x: x + dx,\n      y: y,\n      width: width - dx,\n      height: height\n    };\n  case 'e':\n    return {\n      x: x,\n      y: y,\n      width: width + dx,\n      height: height\n    };\n  default:\n    throw new Error('unknown direction: ' + direction);\n  }\n}","import {\n  assign,\n  filter,\n  forEach,\n  isNumber\n} from 'min-dash';\n\nimport { asTRBL } from '../../layout/LayoutUtil';\n\nimport { getBBox } from '../../util/Elements';\n\nimport { getDirection } from './SpaceUtil';\n\nimport { hasPrimaryModifier } from '../../util/Mouse';\n\nimport { set as setCursor } from '../../util/Cursor';\n\nimport { selfAndAllChildren } from '../../util/Elements';\n\nvar abs = Math.abs,\n    round = Math.round;\n\nvar AXIS_TO_DIMENSION = {\n  x: 'width',\n  y: 'height'\n};\n\nvar CURSOR_CROSSHAIR = 'crosshair';\n\nvar DIRECTION_TO_TRBL = {\n  n: 'top',\n  w: 'left',\n  s: 'bottom',\n  e: 'right'\n};\n\nvar HIGH_PRIORITY = 1500;\n\nvar DIRECTION_TO_OPPOSITE = {\n  n: 's',\n  w: 'e',\n  s: 'n',\n  e: 'w'\n};\n\nvar PADDING = 20;\n\n\n/**\n * Add or remove space by moving and resizing elements.\n *\n * @param {Canvas} canvas\n * @param {Dragging} dragging\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {Rules} rules\n * @param {toolManager} toolManager\n */\nexport default function SpaceTool(canvas, dragging, eventBus, modeling, rules, toolManager) {\n  this._canvas = canvas;\n  this._dragging = dragging;\n  this._eventBus = eventBus;\n  this._modeling = modeling;\n  this._rules = rules;\n  this._toolManager = toolManager;\n\n  var self = this;\n\n  toolManager.registerTool('space', {\n    tool: 'spaceTool.selection',\n    dragging: 'spaceTool'\n  });\n\n  eventBus.on('spaceTool.selection.end', function(event) {\n    eventBus.once('spaceTool.selection.ended', function() {\n      self.activateMakeSpace(event.originalEvent);\n    });\n  });\n\n  eventBus.on('spaceTool.move', HIGH_PRIORITY , function(event) {\n    var context = event.context,\n        initialized = context.initialized;\n\n    if (!initialized) {\n      initialized = context.initialized = self.init(event, context);\n    }\n\n    if (initialized) {\n      ensureConstraints(event);\n    }\n  });\n\n  eventBus.on('spaceTool.end', function(event) {\n    var context = event.context,\n        axis = context.axis,\n        direction = context.direction,\n        movingShapes = context.movingShapes,\n        resizingShapes = context.resizingShapes,\n        start = context.start;\n\n    if (!context.initialized) {\n      return;\n    }\n\n    ensureConstraints(event);\n\n    var delta = {\n      x: 0,\n      y: 0\n    };\n\n    delta[ axis ] = round(event[ 'd' + axis ]);\n\n    self.makeSpace(movingShapes, resizingShapes, delta, direction, start);\n\n    eventBus.once('spaceTool.ended', function(event) {\n\n      // activate space tool selection after make space\n      self.activateSelection(event.originalEvent, true, true);\n    });\n  });\n}\n\nSpaceTool.$inject = [\n  'canvas',\n  'dragging',\n  'eventBus',\n  'modeling',\n  'rules',\n  'toolManager'\n];\n\n/**\n * Activate space tool selection.\n *\n * @param {Object} event\n * @param {boolean} autoActivate\n */\nSpaceTool.prototype.activateSelection = function(event, autoActivate, reactivate) {\n  this._dragging.init(event, 'spaceTool.selection', {\n    autoActivate: autoActivate,\n    cursor: CURSOR_CROSSHAIR,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    },\n    trapClick: false\n  });\n};\n\n/**\n * Activate space tool make space.\n *\n * @param  {MouseEvent} event\n */\nSpaceTool.prototype.activateMakeSpace = function(event) {\n  this._dragging.init(event, 'spaceTool', {\n    autoActivate: true,\n    cursor: CURSOR_CROSSHAIR,\n    data: {\n      context: {}\n    }\n  });\n};\n\n/**\n * Make space.\n *\n * @param  {Array<djs.model.Shape>} movingShapes\n * @param  {Array<djs.model.Shape>} resizingShapes\n * @param  {Object} delta\n * @param  {number} delta.x\n * @param  {number} delta.y\n * @param  {string} direction\n * @param  {number} start\n */\nSpaceTool.prototype.makeSpace = function(movingShapes, resizingShapes, delta, direction, start) {\n  return this._modeling.createSpace(movingShapes, resizingShapes, delta, direction, start);\n};\n\n/**\n * Initialize make space and return true if that was successful.\n *\n * @param {Object} event\n * @param {Object} context\n *\n * @return {boolean}\n */\nSpaceTool.prototype.init = function(event, context) {\n  var axis = abs(event.dx) > abs(event.dy) ? 'x' : 'y',\n      delta = event[ 'd' + axis ],\n      start = event[ axis ] - delta;\n\n  if (abs(delta) < 5) {\n    return false;\n  }\n\n  // invert delta to remove space when moving left\n  if (delta < 0) {\n    delta *= -1;\n  }\n\n  // invert delta to add/remove space when removing/adding space if modifier key is pressed\n  if (hasPrimaryModifier(event)) {\n    delta *= -1;\n  }\n\n  var direction = getDirection(axis, delta);\n\n  var root = this._canvas.getRootElement();\n\n  var children = selfAndAllChildren(root, true);\n\n  var elements = this.calculateAdjustments(children, axis, delta, start);\n\n  var minDimensions = this._eventBus.fire('spaceTool.getMinDimensions', {\n    shapes: elements.resizingShapes\n  });\n\n  var spaceToolConstraints = getSpaceToolConstraints(elements, axis, direction, start, minDimensions);\n\n  assign(\n    context,\n    elements,\n    {\n      axis: axis,\n      direction: direction,\n      spaceToolConstraints: spaceToolConstraints,\n      start: start\n    }\n  );\n\n  setCursor('resize-' + (axis === 'x' ? 'ew' : 'ns'));\n\n  return true;\n};\n\n/**\n * Get elements to be moved and resized.\n *\n * @param  {Array<djs.model.Shape>} elements\n * @param  {string} axis\n * @param  {number} delta\n * @param  {number} start\n *\n * @return {Object}\n */\nSpaceTool.prototype.calculateAdjustments = function(elements, axis, delta, start) {\n  var rules = this._rules;\n\n  var movingShapes = [],\n      resizingShapes = [];\n\n  forEach(elements, function(element) {\n    if (!element.parent || isConnection(element)) {\n      return;\n    }\n\n    var shapeStart = element[ axis ],\n        shapeEnd = shapeStart + element[ AXIS_TO_DIMENSION[ axis ] ];\n\n    // shape to be moved\n    if ((delta > 0 && shapeStart > start) || (delta < 0 && shapeEnd < start)) {\n      return movingShapes.push(element);\n    }\n\n    // shape to be resized\n    if (shapeStart < start &&\n      shapeEnd > start &&\n      rules.allowed('shape.resize', { shape: element })\n    ) {\n\n      return resizingShapes.push(element);\n    }\n  });\n\n  return {\n    movingShapes: movingShapes,\n    resizingShapes: resizingShapes\n  };\n};\n\nSpaceTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.activateSelection();\n  }\n};\n\nSpaceTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^spaceTool/.test(context.prefix);\n};\n\n// helpers //////////\n\nfunction addPadding(trbl) {\n  return {\n    top: trbl.top - PADDING,\n    right: trbl.right + PADDING,\n    bottom: trbl.bottom + PADDING,\n    left: trbl.left - PADDING\n  };\n}\n\nfunction ensureConstraints(event) {\n  var context = event.context,\n      spaceToolConstraints = context.spaceToolConstraints;\n\n  if (!spaceToolConstraints) {\n    return;\n  }\n\n  var x, y;\n\n  if (spaceToolConstraints.left) {\n    x = Math.max(event.x, spaceToolConstraints.left);\n\n    event.dx = event.dx + x - event.x;\n    event.x = x;\n  }\n\n  if (spaceToolConstraints.right) {\n    x = Math.min(event.x, spaceToolConstraints.right);\n\n    event.dx = event.dx + x - event.x;\n    event.x = x;\n  }\n\n  if (spaceToolConstraints.top) {\n    y = Math.max(event.y, spaceToolConstraints.top);\n\n    event.dy = event.dy + y - event.y;\n    event.y = y;\n  }\n\n  if (spaceToolConstraints.bottom) {\n    y = Math.min(event.y, spaceToolConstraints.bottom);\n\n    event.dy = event.dy + y - event.y;\n    event.y = y;\n  }\n}\n\nfunction getSpaceToolConstraints(elements, axis, direction, start, minDimensions) {\n  var movingShapes = elements.movingShapes,\n      resizingShapes = elements.resizingShapes;\n\n  if (!resizingShapes.length) {\n    return;\n  }\n\n  var spaceToolConstraints = {},\n      min,\n      max;\n\n  forEach(resizingShapes, function(resizingShape) {\n    var resizingShapeBBox = asTRBL(resizingShape);\n\n    // find children that are not moving or resizing\n    var nonMovingResizingChildren = filter(resizingShape.children, function(child) {\n      return !isConnection(child) &&\n        !isLabel(child) &&\n        !includes(movingShapes, child) &&\n        !includes(resizingShapes, child);\n    });\n\n    // find children that are moving\n    var movingChildren = filter(resizingShape.children, function(child) {\n      return !isConnection(child) && !isLabel(child) && includes(movingShapes, child);\n    });\n\n    var minOrMax,\n        nonMovingResizingChildrenBBox,\n        movingChildrenBBox;\n\n    if (nonMovingResizingChildren.length) {\n      nonMovingResizingChildrenBBox = addPadding(asTRBL(getBBox(nonMovingResizingChildren)));\n\n      minOrMax = start -\n        resizingShapeBBox[ DIRECTION_TO_TRBL[ direction ] ] +\n        nonMovingResizingChildrenBBox[ DIRECTION_TO_TRBL[ direction ] ];\n\n      if (direction === 'n') {\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n\n    if (movingChildren.length) {\n      movingChildrenBBox = addPadding(asTRBL(getBBox(movingChildren)));\n\n      minOrMax = start -\n        movingChildrenBBox[ DIRECTION_TO_TRBL[ DIRECTION_TO_OPPOSITE[ direction ] ] ] +\n        resizingShapeBBox[ DIRECTION_TO_TRBL[ DIRECTION_TO_OPPOSITE[ direction ] ] ];\n\n      if (direction === 'n') {\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n\n    var resizingShapeMinDimensions = minDimensions && minDimensions[ resizingShape.id ];\n\n    if (resizingShapeMinDimensions) {\n      if (direction === 'n') {\n        minOrMax = start +\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] -\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        minOrMax = start +\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] -\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        minOrMax = start -\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] +\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        minOrMax = start -\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] +\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n  });\n\n  return spaceToolConstraints;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}","import {\n  forEach\n} from 'min-dash';\n\nvar MARKER_DRAGGING = 'djs-dragging',\n    MARKER_RESIZING = 'djs-resizing';\n\nvar LOW_PRIORITY = 250;\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\nvar max = Math.max;\n\n\n/**\n * Provides previews for selecting/moving/resizing shapes when creating/removing space.\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n * @param {Canvas} canvas\n * @param {Styles} styles\n */\nexport default function SpaceToolPreview(\n    eventBus, elementRegistry, canvas,\n    styles, previewSupport) {\n\n  function addPreviewGfx(collection, dragGroup) {\n    forEach(collection, function(element) {\n      previewSupport.addDragger(element, dragGroup);\n\n      canvas.addMarker(element, MARKER_DRAGGING);\n    });\n  }\n\n  // add crosshair\n  eventBus.on('spaceTool.selection.start', function(event) {\n    var space = canvas.getLayer('space'),\n        context = event.context;\n\n    var orientation = {\n      x: 'M 0,-10000 L 0,10000',\n      y: 'M -10000,0 L 10000,0'\n    };\n\n    var crosshairGroup = svgCreate('g');\n    svgAttr(crosshairGroup, styles.cls('djs-crosshair-group', [ 'no-events' ]));\n\n    svgAppend(space, crosshairGroup);\n\n    // horizontal path\n    var pathX = svgCreate('path');\n    svgAttr(pathX, 'd', orientation.x);\n    svgClasses(pathX).add('djs-crosshair');\n\n    svgAppend(crosshairGroup, pathX);\n\n    // vertical path\n    var pathY = svgCreate('path');\n    svgAttr(pathY, 'd', orientation.y);\n    svgClasses(pathY).add('djs-crosshair');\n\n    svgAppend(crosshairGroup, pathY);\n\n    context.crosshairGroup = crosshairGroup;\n  });\n\n  // update crosshair\n  eventBus.on('spaceTool.selection.move', function(event) {\n    var crosshairGroup = event.context.crosshairGroup;\n\n    translate(crosshairGroup, event.x, event.y);\n  });\n\n  // remove crosshair\n  eventBus.on('spaceTool.selection.cleanup', function(event) {\n    var context = event.context,\n        crosshairGroup = context.crosshairGroup;\n\n    if (crosshairGroup) {\n      svgRemove(crosshairGroup);\n    }\n  });\n\n  // add and update move/resize previews\n  eventBus.on('spaceTool.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        line = context.line,\n        axis = context.axis,\n        movingShapes = context.movingShapes,\n        resizingShapes = context.resizingShapes;\n\n    if (!context.initialized) {\n      return;\n    }\n\n    if (!context.dragGroup) {\n      var spaceLayer = canvas.getLayer('space');\n\n      line = svgCreate('path');\n      svgAttr(line, 'd', 'M0,0 L0,0');\n      svgClasses(line).add('djs-crosshair');\n\n      svgAppend(spaceLayer, line);\n\n      context.line = line;\n\n      var dragGroup = svgCreate('g');\n      svgAttr(dragGroup, styles.cls('djs-drag-group', [ 'no-events' ]));\n\n      svgAppend(canvas.getDefaultLayer(), dragGroup);\n\n      // shapes\n      addPreviewGfx(movingShapes, dragGroup);\n\n      // connections\n      var movingConnections = context.movingConnections = elementRegistry.filter(function(element) {\n        var sourceIsMoving = false;\n\n        forEach(movingShapes, function(shape) {\n          forEach(shape.outgoing, function(connection) {\n            if (element === connection) {\n              sourceIsMoving = true;\n            }\n          });\n        });\n\n        var targetIsMoving = false;\n\n        forEach(movingShapes, function(shape) {\n          forEach(shape.incoming, function(connection) {\n            if (element === connection) {\n              targetIsMoving = true;\n            }\n          });\n        });\n\n        var sourceIsResizing = false;\n\n        forEach(resizingShapes, function(shape) {\n          forEach(shape.outgoing, function(connection) {\n            if (element === connection) {\n              sourceIsResizing = true;\n            }\n          });\n        });\n\n        var targetIsResizing = false;\n\n        forEach(resizingShapes, function(shape) {\n          forEach(shape.incoming, function(connection) {\n            if (element === connection) {\n              targetIsResizing = true;\n            }\n          });\n        });\n\n        return isConnection(element)\n          && (sourceIsMoving || sourceIsResizing)\n          && (targetIsMoving || targetIsResizing);\n      });\n\n\n      addPreviewGfx(movingConnections, dragGroup);\n\n      context.dragGroup = dragGroup;\n    }\n\n    if (!context.frameGroup) {\n      var frameGroup = svgCreate('g');\n      svgAttr(frameGroup, styles.cls('djs-frame-group', [ 'no-events' ]));\n\n      svgAppend(canvas.getDefaultLayer(), frameGroup);\n\n      var frames = [];\n\n      forEach(resizingShapes, function(shape) {\n        var frame = previewSupport.addFrame(shape, frameGroup);\n\n        var initialBounds = frame.getBBox();\n\n        frames.push({\n          element: frame,\n          initialBounds: initialBounds\n        });\n\n        canvas.addMarker(shape, MARKER_RESIZING);\n      });\n\n      context.frameGroup = frameGroup;\n      context.frames = frames;\n    }\n\n    var orientation = {\n      x: 'M' + event.x + ', -10000 L' + event.x + ', 10000',\n      y: 'M -10000, ' + event.y + ' L 10000, ' + event.y\n    };\n\n    svgAttr(line, { d: orientation[ axis ] });\n\n    var opposite = { x: 'y', y: 'x' };\n    var delta = { x: event.dx, y: event.dy };\n    delta[ opposite[ context.axis ] ] = 0;\n\n    // update move previews\n    translate(context.dragGroup, delta.x, delta.y);\n\n    // update resize previews\n    forEach(context.frames, function(frame) {\n      var element = frame.element,\n          initialBounds = frame.initialBounds,\n          width,\n          height;\n\n      if (context.direction === 'e') {\n        svgAttr(element, {\n          width: max(initialBounds.width + delta.x, 5)\n        });\n      } else {\n        width = max(initialBounds.width - delta.x, 5);\n\n        svgAttr(element, {\n          width: width,\n          x: initialBounds.x + initialBounds.width - width\n        });\n      }\n\n      if (context.direction === 's') {\n        svgAttr(element, {\n          height: max(initialBounds.height + delta.y, 5)\n        });\n      } else {\n        height = max(initialBounds.height - delta.y, 5);\n\n        svgAttr(element, {\n          height: height,\n          y: initialBounds.y + initialBounds.height - height\n        });\n      }\n    });\n\n  });\n\n  // remove move/resize previews\n  eventBus.on('spaceTool.cleanup', function(event) {\n\n    var context = event.context,\n        movingShapes = context.movingShapes,\n        movingConnections = context.movingConnections,\n        resizingShapes = context.resizingShapes,\n        line = context.line,\n        dragGroup = context.dragGroup,\n        frameGroup = context.frameGroup;\n\n    // moving shapes\n    forEach(movingShapes, function(shape) {\n      canvas.removeMarker(shape, MARKER_DRAGGING);\n    });\n\n    // moving connections\n    forEach(movingConnections, function(connection) {\n      canvas.removeMarker(connection, MARKER_DRAGGING);\n    });\n\n    if (dragGroup) {\n      svgRemove(line);\n      svgRemove(dragGroup);\n    }\n\n    forEach(resizingShapes, function(shape) {\n      canvas.removeMarker(shape, MARKER_RESIZING);\n    });\n\n    if (frameGroup) {\n      svgRemove(frameGroup);\n    }\n  });\n}\n\nSpaceToolPreview.$inject = [\n  'eventBus',\n  'elementRegistry',\n  'canvas',\n  'styles',\n  'previewSupport'\n];\n\n\n// helpers //////////////////////\n\n/**\n * Checks if an element is a connection.\n */\nfunction isConnection(element) {\n  return element.waypoints;\n}\n","import DraggingModule from '../dragging';\nimport RulesModule from '../rules';\nimport ToolManagerModule from '../tool-manager';\nimport PreviewSupportModule from '../preview-support';\n\nimport SpaceTool from './SpaceTool';\nimport SpaceToolPreview from './SpaceToolPreview';\n\nexport default {\n  __init__: ['spaceToolPreview'],\n  __depends__: [\n    DraggingModule,\n    RulesModule,\n    ToolManagerModule,\n    PreviewSupportModule\n  ],\n  spaceTool: ['type', SpaceTool ],\n  spaceToolPreview: ['type', SpaceToolPreview ]\n};\n","import {\n  map,\n  assign,\n  pick\n} from 'min-dash';\n\nimport {\n  isAny\n} from './util/ModelingUtil';\n\nimport {\n  is\n} from '../../util/ModelUtil';\n\n\nexport default function BpmnFactory(moddle) {\n  this._model = moddle;\n}\n\nBpmnFactory.$inject = [ 'moddle' ];\n\n\nBpmnFactory.prototype._needsId = function(element) {\n  return isAny(element, [\n    'bpmn:RootElement',\n    'bpmn:FlowElement',\n    'bpmn:MessageFlow',\n    'bpmn:DataAssociation',\n    'bpmn:Artifact',\n    'bpmn:Participant',\n    'bpmn:Lane',\n    'bpmn:LaneSet',\n    'bpmn:Process',\n    'bpmn:Collaboration',\n    'bpmndi:BPMNShape',\n    'bpmndi:BPMNEdge',\n    'bpmndi:BPMNDiagram',\n    'bpmndi:BPMNPlane',\n    'bpmn:Property',\n    'bpmn:CategoryValue'\n  ]);\n};\n\nBpmnFactory.prototype._ensureId = function(element) {\n\n  // generate semantic ids for elements\n  // bpmn:SequenceFlow -> SequenceFlow_ID\n  var prefix;\n\n  if (is(element, 'bpmn:Activity')) {\n    prefix = 'Activity';\n  } else if (is(element, 'bpmn:Event')) {\n    prefix = 'Event';\n  } else if (is(element, 'bpmn:Gateway')) {\n    prefix = 'Gateway';\n  } else if (is(element, 'bpmn:FlowElement')) {\n    prefix = 'Flow';\n  } else {\n    prefix = (element.$type || '').replace(/^[^:]*:/g, '');\n  }\n\n  prefix += '_';\n\n  if (!element.id && this._needsId(element)) {\n    element.id = this._model.ids.nextPrefixed(prefix, element);\n  }\n};\n\n\nBpmnFactory.prototype.create = function(type, attrs) {\n  var element = this._model.create(type, attrs || {});\n\n  this._ensureId(element);\n\n  return element;\n};\n\n\nBpmnFactory.prototype.createDiLabel = function() {\n  return this.create('bpmndi:BPMNLabel', {\n    bounds: this.createDiBounds()\n  });\n};\n\n\nBpmnFactory.prototype.createDiShape = function(semantic, bounds, attrs) {\n\n  return this.create('bpmndi:BPMNShape', assign({\n    bpmnElement: semantic,\n    bounds: this.createDiBounds(bounds)\n  }, attrs));\n};\n\n\nBpmnFactory.prototype.createDiBounds = function(bounds) {\n  return this.create('dc:Bounds', bounds);\n};\n\n\nBpmnFactory.prototype.createDiWaypoints = function(waypoints) {\n  var self = this;\n\n  return map(waypoints, function(pos) {\n    return self.createDiWaypoint(pos);\n  });\n};\n\nBpmnFactory.prototype.createDiWaypoint = function(point) {\n  return this.create('dc:Point', pick(point, [ 'x', 'y' ]));\n};\n\n\nBpmnFactory.prototype.createDiEdge = function(semantic, waypoints, attrs) {\n  return this.create('bpmndi:BPMNEdge', assign({\n    bpmnElement: semantic\n  }, attrs));\n};\n\nBpmnFactory.prototype.createDiPlane = function(semantic) {\n  return this.create('bpmndi:BPMNPlane', {\n    bpmnElement: semantic\n  });\n};","import {\n  assign,\n  forEach\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport {\n  remove as collectionRemove,\n  add as collectionAdd\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  Label\n} from 'diagram-js/lib/model';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  isAny\n} from './util/ModelingUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\n/**\n * A handler responsible for updating the underlying BPMN 2.0 XML + DI\n * once changes on the diagram happen\n */\nexport default function BpmnUpdater(\n    eventBus, bpmnFactory, connectionDocking,\n    translate) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this._bpmnFactory = bpmnFactory;\n  this._translate = translate;\n\n  var self = this;\n\n\n\n  // connection cropping //////////////////////\n\n  // crop connection ends during create/update\n  function cropConnection(e) {\n    var context = e.context,\n        hints = context.hints || {},\n        connection;\n\n    if (!context.cropped && hints.createElementsBehavior !== false) {\n      connection = context.connection;\n      connection.waypoints = connectionDocking.getCroppedWaypoints(connection);\n      context.cropped = true;\n    }\n  }\n\n  this.executed([\n    'connection.layout',\n    'connection.create'\n  ], cropConnection);\n\n  this.reverted([ 'connection.layout' ], function(e) {\n    delete e.context.cropped;\n  });\n\n\n\n  // BPMN + DI update //////////////////////\n\n\n  // update parent\n  function updateParent(e) {\n    var context = e.context;\n\n    self.updateParent(context.shape || context.connection, context.oldParent);\n  }\n\n  function reverseUpdateParent(e) {\n    var context = e.context;\n\n    var element = context.shape || context.connection,\n\n        // oldParent is the (old) new parent, because we are undoing\n        oldParent = context.parent || context.newParent;\n\n    self.updateParent(element, oldParent);\n  }\n\n  this.executed([\n    'shape.move',\n    'shape.create',\n    'shape.delete',\n    'connection.create',\n    'connection.move',\n    'connection.delete'\n  ], ifBpmn(updateParent));\n\n  this.reverted([\n    'shape.move',\n    'shape.create',\n    'shape.delete',\n    'connection.create',\n    'connection.move',\n    'connection.delete'\n  ], ifBpmn(reverseUpdateParent));\n\n  /*\n   * ## Updating Parent\n   *\n   * When morphing a Process into a Collaboration or vice-versa,\n   * make sure that both the *semantic* and *di* parent of each element\n   * is updated.\n   *\n   */\n  function updateRoot(event) {\n    var context = event.context,\n        oldRoot = context.oldRoot,\n        children = oldRoot.children;\n\n    forEach(children, function(child) {\n      if (is(child, 'bpmn:BaseElement')) {\n        self.updateParent(child);\n      }\n    });\n  }\n\n  this.executed([ 'canvas.updateRoot' ], updateRoot);\n  this.reverted([ 'canvas.updateRoot' ], updateRoot);\n\n\n  // update bounds\n  function updateBounds(e) {\n    var shape = e.context.shape;\n\n    if (!is(shape, 'bpmn:BaseElement')) {\n      return;\n    }\n\n    self.updateBounds(shape);\n  }\n\n  this.executed([ 'shape.move', 'shape.create', 'shape.resize' ], ifBpmn(function(event) {\n\n    // exclude labels because they're handled separately during shape.changed\n    if (event.context.shape.type === 'label') {\n      return;\n    }\n\n    updateBounds(event);\n  }));\n\n  this.reverted([ 'shape.move', 'shape.create', 'shape.resize' ], ifBpmn(function(event) {\n\n    // exclude labels because they're handled separately during shape.changed\n    if (event.context.shape.type === 'label') {\n      return;\n    }\n\n    updateBounds(event);\n  }));\n\n  // Handle labels separately. This is necessary, because the label bounds have to be updated\n  // every time its shape changes, not only on move, create and resize.\n  eventBus.on('shape.changed', function(event) {\n    if (event.element.type === 'label') {\n      updateBounds({ context: { shape: event.element } });\n    }\n  });\n\n  // attach / detach connection\n  function updateConnection(e) {\n    self.updateConnection(e.context);\n  }\n\n  this.executed([\n    'connection.create',\n    'connection.move',\n    'connection.delete',\n    'connection.reconnect'\n  ], ifBpmn(updateConnection));\n\n  this.reverted([\n    'connection.create',\n    'connection.move',\n    'connection.delete',\n    'connection.reconnect'\n  ], ifBpmn(updateConnection));\n\n\n  // update waypoints\n  function updateConnectionWaypoints(e) {\n    self.updateConnectionWaypoints(e.context.connection);\n  }\n\n  this.executed([\n    'connection.layout',\n    'connection.move',\n    'connection.updateWaypoints',\n  ], ifBpmn(updateConnectionWaypoints));\n\n  this.reverted([\n    'connection.layout',\n    'connection.move',\n    'connection.updateWaypoints',\n  ], ifBpmn(updateConnectionWaypoints));\n\n  // update conditional/default flows\n  this.executed('connection.reconnect', ifBpmn(function(event) {\n    var context = event.context,\n        connection = context.connection,\n        oldSource = context.oldSource,\n        newSource = context.newSource,\n        connectionBo = getBusinessObject(connection),\n        oldSourceBo = getBusinessObject(oldSource),\n        newSourceBo = getBusinessObject(newSource);\n\n    // remove condition from connection on reconnect to new source\n    // if new source can NOT have condional sequence flow\n    if (connectionBo.conditionExpression && !isAny(newSourceBo, [\n      'bpmn:Activity',\n      'bpmn:ExclusiveGateway',\n      'bpmn:InclusiveGateway'\n    ])) {\n      context.oldConditionExpression = connectionBo.conditionExpression;\n\n      delete connectionBo.conditionExpression;\n    }\n\n    // remove default from old source flow on reconnect to new source\n    // if source changed\n    if (oldSource !== newSource && oldSourceBo.default === connectionBo) {\n      context.oldDefault = oldSourceBo.default;\n\n      delete oldSourceBo.default;\n    }\n  }));\n\n  this.reverted('connection.reconnect', ifBpmn(function(event) {\n    var context = event.context,\n        connection = context.connection,\n        oldSource = context.oldSource,\n        newSource = context.newSource,\n        connectionBo = getBusinessObject(connection),\n        oldSourceBo = getBusinessObject(oldSource),\n        newSourceBo = getBusinessObject(newSource);\n\n    // add condition to connection on revert reconnect to new source\n    if (context.oldConditionExpression) {\n      connectionBo.conditionExpression = context.oldConditionExpression;\n    }\n\n    // add default to old source on revert reconnect to new source\n    if (context.oldDefault) {\n      oldSourceBo.default = context.oldDefault;\n\n      delete newSourceBo.default;\n    }\n  }));\n\n  // update attachments\n  function updateAttachment(e) {\n    self.updateAttachment(e.context);\n  }\n\n  this.executed([ 'element.updateAttachment' ], ifBpmn(updateAttachment));\n  this.reverted([ 'element.updateAttachment' ], ifBpmn(updateAttachment));\n}\n\ninherits(BpmnUpdater, CommandInterceptor);\n\nBpmnUpdater.$inject = [\n  'eventBus',\n  'bpmnFactory',\n  'connectionDocking',\n  'translate'\n];\n\n\n// implementation //////////////////////\n\nBpmnUpdater.prototype.updateAttachment = function(context) {\n\n  var shape = context.shape,\n      businessObject = shape.businessObject,\n      host = shape.host;\n\n  businessObject.attachedToRef = host && host.businessObject;\n};\n\nBpmnUpdater.prototype.updateParent = function(element, oldParent) {\n\n  // do not update BPMN 2.0 label parent\n  if (element instanceof Label) {\n    return;\n  }\n\n  // data stores in collaborations are handled separately by DataStoreBehavior\n  if (is(element, 'bpmn:DataStoreReference') &&\n      element.parent &&\n      is(element.parent, 'bpmn:Collaboration')) {\n    return;\n  }\n\n  var parentShape = element.parent;\n\n  var businessObject = element.businessObject,\n      parentBusinessObject = parentShape && parentShape.businessObject,\n      parentDi = parentBusinessObject && parentBusinessObject.di;\n\n  if (is(element, 'bpmn:FlowNode')) {\n    this.updateFlowNodeRefs(businessObject, parentBusinessObject, oldParent && oldParent.businessObject);\n  }\n\n  if (is(element, 'bpmn:DataOutputAssociation')) {\n    if (element.source) {\n      parentBusinessObject = element.source.businessObject;\n    } else {\n      parentBusinessObject = null;\n    }\n  }\n\n  if (is(element, 'bpmn:DataInputAssociation')) {\n    if (element.target) {\n      parentBusinessObject = element.target.businessObject;\n    } else {\n      parentBusinessObject = null;\n    }\n  }\n\n  this.updateSemanticParent(businessObject, parentBusinessObject);\n\n  if (is(element, 'bpmn:DataObjectReference') && businessObject.dataObjectRef) {\n    this.updateSemanticParent(businessObject.dataObjectRef, parentBusinessObject);\n  }\n\n  this.updateDiParent(businessObject.di, parentDi);\n};\n\n\nBpmnUpdater.prototype.updateBounds = function(shape) {\n\n  var di = shape.businessObject.di;\n\n  var target = (shape instanceof Label) ? this._getLabel(di) : di;\n\n  var bounds = target.bounds;\n\n  if (!bounds) {\n    bounds = this._bpmnFactory.createDiBounds();\n    target.set('bounds', bounds);\n  }\n\n  assign(bounds, {\n    x: shape.x,\n    y: shape.y,\n    width: shape.width,\n    height: shape.height\n  });\n};\n\nBpmnUpdater.prototype.updateFlowNodeRefs = function(businessObject, newContainment, oldContainment) {\n\n  if (oldContainment === newContainment) {\n    return;\n  }\n\n  var oldRefs, newRefs;\n\n  if (is (oldContainment, 'bpmn:Lane')) {\n    oldRefs = oldContainment.get('flowNodeRef');\n    collectionRemove(oldRefs, businessObject);\n  }\n\n  if (is(newContainment, 'bpmn:Lane')) {\n    newRefs = newContainment.get('flowNodeRef');\n    collectionAdd(newRefs, businessObject);\n  }\n};\n\n\n// update existing sourceElement and targetElement di information\nBpmnUpdater.prototype.updateDiConnection = function(di, newSource, newTarget) {\n\n  if (di.sourceElement && di.sourceElement.bpmnElement !== newSource) {\n    di.sourceElement = newSource && newSource.di;\n  }\n\n  if (di.targetElement && di.targetElement.bpmnElement !== newTarget) {\n    di.targetElement = newTarget && newTarget.di;\n  }\n\n};\n\n\nBpmnUpdater.prototype.updateDiParent = function(di, parentDi) {\n\n  if (parentDi && !is(parentDi, 'bpmndi:BPMNPlane')) {\n    parentDi = parentDi.$parent;\n  }\n\n  if (di.$parent === parentDi) {\n    return;\n  }\n\n  var planeElements = (parentDi || di.$parent).get('planeElement');\n\n  if (parentDi) {\n    planeElements.push(di);\n    di.$parent = parentDi;\n  } else {\n    collectionRemove(planeElements, di);\n    di.$parent = null;\n  }\n};\n\nfunction getDefinitions(element) {\n  while (element && !is(element, 'bpmn:Definitions')) {\n    element = element.$parent;\n  }\n\n  return element;\n}\n\nBpmnUpdater.prototype.getLaneSet = function(container) {\n\n  var laneSet, laneSets;\n\n  // bpmn:Lane\n  if (is(container, 'bpmn:Lane')) {\n    laneSet = container.childLaneSet;\n\n    if (!laneSet) {\n      laneSet = this._bpmnFactory.create('bpmn:LaneSet');\n      container.childLaneSet = laneSet;\n      laneSet.$parent = container;\n    }\n\n    return laneSet;\n  }\n\n  // bpmn:Participant\n  if (is(container, 'bpmn:Participant')) {\n    container = container.processRef;\n  }\n\n  // bpmn:FlowElementsContainer\n  laneSets = container.get('laneSets');\n  laneSet = laneSets[0];\n\n  if (!laneSet) {\n    laneSet = this._bpmnFactory.create('bpmn:LaneSet');\n    laneSet.$parent = container;\n    laneSets.push(laneSet);\n  }\n\n  return laneSet;\n};\n\nBpmnUpdater.prototype.updateSemanticParent = function(businessObject, newParent, visualParent) {\n\n  var containment,\n      translate = this._translate;\n\n  if (businessObject.$parent === newParent) {\n    return;\n  }\n\n  if (is(businessObject, 'bpmn:DataInput') || is(businessObject, 'bpmn:DataOutput')) {\n\n    if (is(newParent, 'bpmn:Participant') && 'processRef' in newParent) {\n      newParent = newParent.processRef;\n    }\n\n    // already in correct ioSpecification\n    if ('ioSpecification' in newParent && newParent.ioSpecification === businessObject.$parent) {\n      return;\n    }\n  }\n\n  if (is(businessObject, 'bpmn:Lane')) {\n\n    if (newParent) {\n      newParent = this.getLaneSet(newParent);\n    }\n\n    containment = 'lanes';\n  } else\n\n  if (is(businessObject, 'bpmn:FlowElement')) {\n\n    if (newParent) {\n\n      if (is(newParent, 'bpmn:Participant')) {\n        newParent = newParent.processRef;\n      } else\n\n      if (is(newParent, 'bpmn:Lane')) {\n        do {\n\n          // unwrap Lane -> LaneSet -> (Lane | FlowElementsContainer)\n          newParent = newParent.$parent.$parent;\n        } while (is(newParent, 'bpmn:Lane'));\n\n      }\n    }\n\n    containment = 'flowElements';\n\n  } else\n\n  if (is(businessObject, 'bpmn:Artifact')) {\n\n    while (newParent &&\n           !is(newParent, 'bpmn:Process') &&\n           !is(newParent, 'bpmn:SubProcess') &&\n           !is(newParent, 'bpmn:Collaboration')) {\n\n      if (is(newParent, 'bpmn:Participant')) {\n        newParent = newParent.processRef;\n        break;\n      } else {\n        newParent = newParent.$parent;\n      }\n    }\n\n    containment = 'artifacts';\n  } else\n\n  if (is(businessObject, 'bpmn:MessageFlow')) {\n    containment = 'messageFlows';\n\n  } else\n\n  if (is(businessObject, 'bpmn:Participant')) {\n    containment = 'participants';\n\n    // make sure the participants process is properly attached / detached\n    // from the XML document\n\n    var process = businessObject.processRef,\n        definitions;\n\n    if (process) {\n      definitions = getDefinitions(businessObject.$parent || newParent);\n\n      if (businessObject.$parent) {\n        collectionRemove(definitions.get('rootElements'), process);\n        process.$parent = null;\n      }\n\n      if (newParent) {\n        collectionAdd(definitions.get('rootElements'), process);\n        process.$parent = definitions;\n      }\n    }\n  } else\n\n  if (is(businessObject, 'bpmn:DataOutputAssociation')) {\n    containment = 'dataOutputAssociations';\n  } else\n\n  if (is(businessObject, 'bpmn:DataInputAssociation')) {\n    containment = 'dataInputAssociations';\n  }\n\n  if (!containment) {\n    throw new Error(translate(\n      'no parent for {element} in {parent}',\n      {\n        element: businessObject.id,\n        parent: newParent.id\n      }\n    ));\n  }\n\n  var children;\n\n  if (businessObject.$parent) {\n\n    // remove from old parent\n    children = businessObject.$parent.get(containment);\n    collectionRemove(children, businessObject);\n  }\n\n  if (!newParent) {\n    businessObject.$parent = null;\n  } else {\n\n    // add to new parent\n    children = newParent.get(containment);\n    children.push(businessObject);\n    businessObject.$parent = newParent;\n  }\n\n  if (visualParent) {\n    var diChildren = visualParent.get(containment);\n\n    collectionRemove(children, businessObject);\n\n    if (newParent) {\n\n      if (!diChildren) {\n        diChildren = [];\n        newParent.set(containment, diChildren);\n      }\n\n      diChildren.push(businessObject);\n    }\n  }\n};\n\n\nBpmnUpdater.prototype.updateConnectionWaypoints = function(connection) {\n  connection.businessObject.di.set('waypoint', this._bpmnFactory.createDiWaypoints(connection.waypoints));\n};\n\n\nBpmnUpdater.prototype.updateConnection = function(context) {\n\n  var connection = context.connection,\n      businessObject = getBusinessObject(connection),\n      newSource = getBusinessObject(connection.source),\n      newTarget = getBusinessObject(connection.target),\n      visualParent;\n\n  if (!is(businessObject, 'bpmn:DataAssociation')) {\n\n    var inverseSet = is(businessObject, 'bpmn:SequenceFlow');\n\n    if (businessObject.sourceRef !== newSource) {\n      if (inverseSet) {\n        collectionRemove(businessObject.sourceRef && businessObject.sourceRef.get('outgoing'), businessObject);\n\n        if (newSource && newSource.get('outgoing')) {\n          newSource.get('outgoing').push(businessObject);\n        }\n      }\n\n      businessObject.sourceRef = newSource;\n    }\n\n    if (businessObject.targetRef !== newTarget) {\n      if (inverseSet) {\n        collectionRemove(businessObject.targetRef && businessObject.targetRef.get('incoming'), businessObject);\n\n        if (newTarget && newTarget.get('incoming')) {\n          newTarget.get('incoming').push(businessObject);\n        }\n      }\n\n      businessObject.targetRef = newTarget;\n    }\n  } else\n\n  if (is(businessObject, 'bpmn:DataInputAssociation')) {\n\n    // handle obnoxious isMsome sourceRef\n    businessObject.get('sourceRef')[0] = newSource;\n\n    visualParent = context.parent || context.newParent || newTarget;\n\n    this.updateSemanticParent(businessObject, newTarget, visualParent);\n  } else\n\n  if (is(businessObject, 'bpmn:DataOutputAssociation')) {\n    visualParent = context.parent || context.newParent || newSource;\n\n    this.updateSemanticParent(businessObject, newSource, visualParent);\n\n    // targetRef = new target\n    businessObject.targetRef = newTarget;\n  }\n\n  this.updateConnectionWaypoints(connection);\n\n  this.updateDiConnection(businessObject.di, newSource, newTarget);\n};\n\n\n// helpers //////////////////////\n\nBpmnUpdater.prototype._getLabel = function(di) {\n  if (!di.label) {\n    di.label = this._bpmnFactory.createDiLabel();\n  }\n\n  return di.label;\n};\n\n\n/**\n * Make sure the event listener is only called\n * if the touched element is a BPMN element.\n *\n * @param  {Function} fn\n * @return {Function} guarded function\n */\nfunction ifBpmn(fn) {\n\n  return function(event) {\n\n    var context = event.context,\n        element = context.shape || context.connection;\n\n    if (is(element, 'bpmn:BaseElement')) {\n      fn(event);\n    }\n  };\n}\n","import {\n  assign,\n  forEach,\n  isObject\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport { is } from '../../util/ModelUtil';\n\nimport {\n  isExpanded\n} from '../../util/DiUtil';\n\nimport BaseElementFactory from 'diagram-js/lib/core/ElementFactory';\n\nimport {\n  DEFAULT_LABEL_SIZE\n} from '../../util/LabelUtil';\n\n\n/**\n * A bpmn-aware factory for diagram-js shapes\n */\nexport default function ElementFactory(bpmnFactory, moddle, translate) {\n  BaseElementFactory.call(this);\n\n  this._bpmnFactory = bpmnFactory;\n  this._moddle = moddle;\n  this._translate = translate;\n}\n\ninherits(ElementFactory, BaseElementFactory);\n\nElementFactory.$inject = [\n  'bpmnFactory',\n  'moddle',\n  'translate'\n];\n\nElementFactory.prototype.baseCreate = BaseElementFactory.prototype.create;\n\nElementFactory.prototype.create = function(elementType, attrs) {\n\n  // no special magic for labels,\n  // we assume their businessObjects have already been created\n  // and wired via attrs\n  if (elementType === 'label') {\n    return this.baseCreate(elementType, assign({ type: 'label' }, DEFAULT_LABEL_SIZE, attrs));\n  }\n\n  return this.createBpmnElement(elementType, attrs);\n};\n\nElementFactory.prototype.createBpmnElement = function(elementType, attrs) {\n  var size,\n      translate = this._translate;\n\n  attrs = attrs || {};\n\n  var businessObject = attrs.businessObject;\n\n  if (!businessObject) {\n    if (!attrs.type) {\n      throw new Error(translate('no shape type specified'));\n    }\n\n    businessObject = this._bpmnFactory.create(attrs.type);\n  }\n\n  if (!businessObject.di) {\n    if (elementType === 'root') {\n      businessObject.di = this._bpmnFactory.createDiPlane(businessObject, [], {\n        id: businessObject.id + '_di'\n      });\n    } else\n    if (elementType === 'connection') {\n      businessObject.di = this._bpmnFactory.createDiEdge(businessObject, [], {\n        id: businessObject.id + '_di'\n      });\n    } else {\n      businessObject.di = this._bpmnFactory.createDiShape(businessObject, {}, {\n        id: businessObject.id + '_di'\n      });\n    }\n  }\n\n  if (is(businessObject, 'bpmn:Group')) {\n    attrs = assign({\n      isFrame: true\n    }, attrs);\n  }\n\n  if (attrs.di) {\n    assign(businessObject.di, attrs.di);\n\n    delete attrs.di;\n  }\n\n  applyAttributes(businessObject, attrs, [\n    'processRef',\n    'isInterrupting',\n    'associationDirection',\n    'isForCompensation'\n  ]);\n\n  if (attrs.isExpanded) {\n    applyAttribute(businessObject.di, attrs, 'isExpanded');\n  }\n\n  if (is(businessObject, 'bpmn:ExclusiveGateway')) {\n    businessObject.di.isMarkerVisible = true;\n  }\n\n  var eventDefinitions,\n      newEventDefinition;\n\n  if (attrs.eventDefinitionType) {\n    eventDefinitions = businessObject.get('eventDefinitions') || [];\n    newEventDefinition = this._bpmnFactory.create(attrs.eventDefinitionType);\n\n    if (attrs.eventDefinitionType === 'bpmn:ConditionalEventDefinition') {\n      newEventDefinition.condition = this._bpmnFactory.create('bpmn:FormalExpression');\n    }\n\n    eventDefinitions.push(newEventDefinition);\n\n    newEventDefinition.$parent = businessObject;\n    businessObject.eventDefinitions = eventDefinitions;\n\n    delete attrs.eventDefinitionType;\n  }\n\n  size = this._getDefaultSize(businessObject);\n\n  attrs = assign({\n    businessObject: businessObject,\n    id: businessObject.id\n  }, size, attrs);\n\n  return this.baseCreate(elementType, attrs);\n};\n\n\nElementFactory.prototype._getDefaultSize = function(semantic) {\n\n  if (is(semantic, 'bpmn:SubProcess')) {\n\n    if (isExpanded(semantic)) {\n      return { width: 350, height: 200 };\n    } else {\n      return { width: 100, height: 80 };\n    }\n  }\n\n  if (is(semantic, 'bpmn:Task')) {\n    return { width: 100, height: 80 };\n  }\n\n  if (is(semantic, 'bpmn:Gateway')) {\n    return { width: 50, height: 50 };\n  }\n\n  if (is(semantic, 'bpmn:Event')) {\n    return { width: 36, height: 36 };\n  }\n\n  if (is(semantic, 'bpmn:Participant')) {\n    if (isExpanded(semantic)) {\n      return { width: 600, height: 250 };\n    } else {\n      return { width: 400, height: 60 };\n    }\n  }\n\n  if (is(semantic, 'bpmn:Lane')) {\n    return { width: 400, height: 100 };\n  }\n\n  if (is(semantic, 'bpmn:DataObjectReference')) {\n    return { width: 36, height: 50 };\n  }\n\n  if (is(semantic, 'bpmn:DataStoreReference')) {\n    return { width: 50, height: 50 };\n  }\n\n  if (is(semantic, 'bpmn:TextAnnotation')) {\n    return { width: 100, height: 30 };\n  }\n\n  if (is(semantic, 'bpmn:Group')) {\n    return { width: 300, height: 300 };\n  }\n\n  return { width: 100, height: 80 };\n};\n\n\n/**\n * Create participant.\n *\n * @param {boolean|Object} [attrs] attrs\n *\n * @returns {djs.model.Shape}\n */\nElementFactory.prototype.createParticipantShape = function(attrs) {\n\n  if (!isObject(attrs)) {\n    attrs = { isExpanded: attrs };\n  }\n\n  attrs = assign({ type: 'bpmn:Participant' }, attrs || {});\n\n  // participants are expanded by default\n  if (attrs.isExpanded !== false) {\n    attrs.processRef = this._bpmnFactory.create('bpmn:Process');\n  }\n\n  return this.createShape(attrs);\n};\n\n\n// helpers //////////////////////\n\n/**\n * Apply attributes from a map to the given element,\n * remove attribute from the map on application.\n *\n * @param {Base} element\n * @param {Object} attrs (in/out map of attributes)\n * @param {Array<String>} attributeNames name of attributes to apply\n */\nfunction applyAttributes(element, attrs, attributeNames) {\n\n  forEach(attributeNames, function(property) {\n    if (attrs[property] !== undefined) {\n      applyAttribute(element, attrs, property);\n    }\n  });\n}\n\n/**\n * Apply named property to element and drain it from the attrs\n * collection.\n *\n * @param {Base} element\n * @param {Object} attrs (in/out map of attributes)\n * @param {String} attributeName to apply\n */\nfunction applyAttribute(element, attrs, attributeName) {\n  element[attributeName] = attrs[attributeName];\n\n  delete attrs[attributeName];\n}","import { forEach } from 'min-dash';\n\n/**\n * A handler that align elements in a certain way.\n *\n */\nexport default function AlignElements(modeling, canvas) {\n  this._modeling = modeling;\n  this._canvas = canvas;\n}\n\nAlignElements.$inject = [ 'modeling', 'canvas' ];\n\n\nAlignElements.prototype.preExecute = function(context) {\n  var modeling = this._modeling;\n\n  var elements = context.elements,\n      alignment = context.alignment;\n\n\n  forEach(elements, function(element) {\n    var delta = {\n      x: 0,\n      y: 0\n    };\n\n    if (alignment.left) {\n      delta.x = alignment.left - element.x;\n\n    } else if (alignment.right) {\n      delta.x = (alignment.right - element.width) - element.x;\n\n    } else if (alignment.center) {\n      delta.x = (alignment.center - Math.round(element.width / 2)) - element.x;\n\n    } else if (alignment.top) {\n      delta.y = alignment.top - element.y;\n\n    } else if (alignment.bottom) {\n      delta.y = (alignment.bottom - element.height) - element.y;\n\n    } else if (alignment.middle) {\n      delta.y = (alignment.middle - Math.round(element.height / 2)) - element.y;\n    }\n\n    modeling.moveElements([ element ], delta, element.parent);\n  });\n};\n\nAlignElements.prototype.postExecute = function(context) {\n\n};\n","import { some } from 'min-dash';\n\n\n/**\n * A handler that implements reversible appending of shapes\n * to a source shape.\n *\n * @param {canvas} Canvas\n * @param {elementFactory} ElementFactory\n * @param {modeling} Modeling\n */\nexport default function AppendShapeHandler(modeling) {\n  this._modeling = modeling;\n}\n\nAppendShapeHandler.$inject = [ 'modeling' ];\n\n\n// api //////////////////////\n\n\n/**\n * Creates a new shape\n *\n * @param {Object} context\n * @param {ElementDescriptor} context.shape the new shape\n * @param {ElementDescriptor} context.source the source object\n * @param {ElementDescriptor} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nAppendShapeHandler.prototype.preExecute = function(context) {\n\n  var source = context.source;\n\n  if (!source) {\n    throw new Error('source required');\n  }\n\n  var target = context.target || source.parent,\n      shape = context.shape;\n\n  shape = context.shape =\n    this._modeling.createShape(\n      shape,\n      context.position,\n      target, { attach: context.attach });\n\n  context.shape = shape;\n};\n\nAppendShapeHandler.prototype.postExecute = function(context) {\n  var parent = context.connectionParent || context.shape.parent;\n\n  if (!existsConnection(context.source, context.shape)) {\n\n    // create connection\n    this._modeling.connect(context.source, context.shape, context.connection, parent);\n  }\n};\n\n\nfunction existsConnection(source, target) {\n  return some(source.outgoing, function(c) {\n    return c.target === target;\n  });\n}","export default function CreateConnectionHandler(canvas, layouter) {\n  this._canvas = canvas;\n  this._layouter = layouter;\n}\n\nCreateConnectionHandler.$inject = [ 'canvas', 'layouter' ];\n\n\n// api //////////////////////\n\n\n/**\n * Appends a shape to a target shape\n *\n * @param {Object} context\n * @param {djs.element.Base} context.source the source object\n * @param {djs.element.Base} context.target the parent object\n * @param {Point} context.position position of the new element\n */\nCreateConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      source = context.source,\n      target = context.target,\n      parent = context.parent,\n      parentIndex = context.parentIndex,\n      hints = context.hints;\n\n  if (!source || !target) {\n    throw new Error('source and target required');\n  }\n\n  if (!parent) {\n    throw new Error('parent required');\n  }\n\n  connection.source = source;\n  connection.target = target;\n\n  if (!connection.waypoints) {\n    connection.waypoints = this._layouter.layoutConnection(connection, hints);\n  }\n\n  // add connection\n  this._canvas.addConnection(connection, parent, parentIndex);\n\n  return connection;\n};\n\nCreateConnectionHandler.prototype.revert = function(context) {\n  var connection = context.connection;\n\n  this._canvas.removeConnection(connection);\n\n  connection.source = null;\n  connection.target = null;\n\n  return connection;\n};","import {\r\n  assign,\r\n  forEach,\r\n  isNumber,\r\n  map,\r\n  pick,\r\n  values\r\n} from 'min-dash';\r\n\r\nimport {\r\n  getBBox,\r\n  getParents\r\n} from '../../../util/Elements';\r\n\r\nvar round = Math.round;\r\n\r\nexport default function CreateElementsHandler(modeling) {\r\n  this._modeling = modeling;\r\n}\r\n\r\nCreateElementsHandler.$inject = [\r\n  'modeling'\r\n];\r\n\r\nCreateElementsHandler.prototype.preExecute = function(context) {\r\n  var elements = context.elements,\r\n      parent = context.parent,\r\n      parentIndex = context.parentIndex,\r\n      position = context.position,\r\n      hints = context.hints;\r\n\r\n  var modeling = this._modeling;\r\n\r\n  // make sure each element has x and y\r\n  forEach(elements, function(element) {\r\n    if (!isNumber(element.x)) {\r\n      element.x = 0;\r\n    }\r\n\r\n    if (!isNumber(element.y)) {\r\n      element.y = 0;\r\n    }\r\n  });\r\n\r\n  var bbox = getBBox(elements);\r\n\r\n  // center elements around position\r\n  forEach(elements, function(element) {\r\n    if (isConnection(element)) {\r\n      element.waypoints = map(element.waypoints, function(waypoint) {\r\n        return {\r\n          x: round(waypoint.x - bbox.x - bbox.width / 2 + position.x),\r\n          y: round(waypoint.y - bbox.y - bbox.height / 2 + position.y)\r\n        };\r\n      });\r\n    }\r\n\r\n    assign(element, {\r\n      x: round(element.x - bbox.x - bbox.width / 2 + position.x),\r\n      y: round(element.y - bbox.y - bbox.height / 2 + position.y)\r\n    });\r\n  });\r\n\r\n  var parents = getParents(elements);\r\n\r\n  var cache = {};\r\n\r\n  forEach(elements, function(element) {\r\n    if (isConnection(element)) {\r\n      cache[ element.id ] = isNumber(parentIndex) ?\r\n        modeling.createConnection(\r\n          cache[ element.source.id ],\r\n          cache[ element.target.id ],\r\n          parentIndex,\r\n          element,\r\n          element.parent || parent,\r\n          hints\r\n        ) :\r\n        modeling.createConnection(\r\n          cache[ element.source.id ],\r\n          cache[ element.target.id ],\r\n          element,\r\n          element.parent || parent,\r\n          hints\r\n        );\r\n\r\n      return;\r\n    }\r\n\r\n    var createShapeHints = assign({}, hints);\r\n\r\n    if (parents.indexOf(element) === -1) {\r\n      createShapeHints.autoResize = false;\r\n    }\r\n\r\n    cache[ element.id ] = isNumber(parentIndex) ?\r\n      modeling.createShape(\r\n        element,\r\n        pick(element, [ 'x', 'y', 'width', 'height' ]),\r\n        element.parent || parent,\r\n        parentIndex,\r\n        createShapeHints\r\n      ) :\r\n      modeling.createShape(\r\n        element,\r\n        pick(element, [ 'x', 'y', 'width', 'height' ]),\r\n        element.parent || parent,\r\n        createShapeHints\r\n      );\r\n  });\r\n\r\n  context.elements = values(cache);\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction isConnection(element) {\r\n  return !!element.waypoints;\r\n}","import { assign } from 'min-dash';\n\nvar round = Math.round;\n\n\n/**\n * A handler that implements reversible addition of shapes.\n *\n * @param {canvas} Canvas\n */\nexport default function CreateShapeHandler(canvas) {\n  this._canvas = canvas;\n}\n\nCreateShapeHandler.$inject = [ 'canvas' ];\n\n\n// api //////////////////////\n\n\n/**\n * Appends a shape to a target shape\n *\n * @param {Object} context\n * @param {djs.model.Base} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nCreateShapeHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      positionOrBounds = context.position,\n      parent = context.parent,\n      parentIndex = context.parentIndex;\n\n  if (!parent) {\n    throw new Error('parent required');\n  }\n\n  if (!positionOrBounds) {\n    throw new Error('position required');\n  }\n\n  // (1) add at event center position _or_ at given bounds\n  if (positionOrBounds.width !== undefined) {\n    assign(shape, positionOrBounds);\n  } else {\n    assign(shape, {\n      x: positionOrBounds.x - round(shape.width / 2),\n      y: positionOrBounds.y - round(shape.height / 2)\n    });\n  }\n\n  // (2) add to canvas\n  this._canvas.addShape(shape, parent, parentIndex);\n\n  return shape;\n};\n\n\n/**\n * Undo append by removing the shape\n */\nCreateShapeHandler.prototype.revert = function(context) {\n\n  var shape = context.shape;\n\n  // (3) remove form canvas\n  this._canvas.removeShape(shape);\n\n  return shape;\n};","import inherits from 'inherits';\n\nimport CreateShapeHandler from './CreateShapeHandler';\n\n\n/**\n * A handler that attaches a label to a given target shape.\n *\n * @param {Canvas} canvas\n */\nexport default function CreateLabelHandler(canvas) {\n  CreateShapeHandler.call(this, canvas);\n}\n\ninherits(CreateLabelHandler, CreateShapeHandler);\n\nCreateLabelHandler.$inject = [ 'canvas' ];\n\n\n// api //////////////////////\n\n\nvar originalExecute = CreateShapeHandler.prototype.execute;\n\n/**\n * Appends a label to a target shape.\n *\n * @method CreateLabelHandler#execute\n *\n * @param {Object} context\n * @param {ElementDescriptor} context.target the element the label is attached to\n * @param {ElementDescriptor} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nCreateLabelHandler.prototype.execute = function(context) {\n\n  var label = context.shape;\n\n  ensureValidDimensions(label);\n\n  label.labelTarget = context.labelTarget;\n\n  return originalExecute.call(this, context);\n};\n\nvar originalRevert = CreateShapeHandler.prototype.revert;\n\n/**\n * Undo append by removing the shape\n */\nCreateLabelHandler.prototype.revert = function(context) {\n  context.shape.labelTarget = null;\n\n  return originalRevert.call(this, context);\n};\n\n\n// helpers //////////////////////\n\nfunction ensureValidDimensions(label) {\n\n  // make sure a label has valid { width, height } dimensions\n  [ 'width', 'height' ].forEach(function(prop) {\n    if (typeof label[prop] === 'undefined') {\n      label[prop] = 0;\n    }\n  });\n}","import {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../../util/Collections';\n\n\n/**\n * A handler that implements reversible deletion of Connections.\n */\nexport default function DeleteConnectionHandler(canvas, modeling) {\n  this._canvas = canvas;\n  this._modeling = modeling;\n}\n\nDeleteConnectionHandler.$inject = [\n  'canvas',\n  'modeling'\n];\n\n\nDeleteConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      parent = connection.parent;\n\n  context.parent = parent;\n\n  // remember containment\n  context.parentIndex = collectionIdx(parent.children, connection);\n\n  context.source = connection.source;\n  context.target = connection.target;\n\n  this._canvas.removeConnection(connection);\n\n  connection.source = null;\n  connection.target = null;\n\n  return connection;\n};\n\n/**\n * Command revert implementation.\n */\nDeleteConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      parent = context.parent,\n      parentIndex = context.parentIndex;\n\n  connection.source = context.source;\n  connection.target = context.target;\n\n  // restore containment\n  collectionAdd(parent.children, connection, parentIndex);\n\n  this._canvas.addConnection(connection, parent);\n\n  return connection;\n};\n","import { forEach } from 'min-dash';\n\n\nexport default function DeleteElementsHandler(modeling, elementRegistry) {\n  this._modeling = modeling;\n  this._elementRegistry = elementRegistry;\n}\n\nDeleteElementsHandler.$inject = [\n  'modeling',\n  'elementRegistry'\n];\n\n\nDeleteElementsHandler.prototype.postExecute = function(context) {\n\n  var modeling = this._modeling,\n      elementRegistry = this._elementRegistry,\n      elements = context.elements;\n\n  forEach(elements, function(element) {\n\n    // element may have been removed with previous\n    // remove operations already (e.g. in case of nesting)\n    if (!elementRegistry.get(element.id)) {\n      return;\n    }\n\n    if (element.waypoints) {\n      modeling.removeConnection(element);\n    } else {\n      modeling.removeShape(element);\n    }\n  });\n};","import {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../../util/Collections';\n\nimport { saveClear } from '../../../util/Removal';\n\n\n/**\n * A handler that implements reversible deletion of shapes.\n *\n */\nexport default function DeleteShapeHandler(canvas, modeling) {\n  this._canvas = canvas;\n  this._modeling = modeling;\n}\n\nDeleteShapeHandler.$inject = [ 'canvas', 'modeling' ];\n\n\n/**\n * - Remove connections\n * - Remove all direct children\n */\nDeleteShapeHandler.prototype.preExecute = function(context) {\n\n  var modeling = this._modeling;\n\n  var shape = context.shape;\n\n  // remove connections\n  saveClear(shape.incoming, function(connection) {\n\n    // To make sure that the connection isn't removed twice\n    // For example if a container is removed\n    modeling.removeConnection(connection, { nested: true });\n  });\n\n  saveClear(shape.outgoing, function(connection) {\n    modeling.removeConnection(connection, { nested: true });\n  });\n\n  // remove child shapes and connections\n  saveClear(shape.children, function(child) {\n    if (isConnection(child)) {\n      modeling.removeConnection(child, { nested: true });\n    } else {\n      modeling.removeShape(child, { nested: true });\n    }\n  });\n};\n\n/**\n * Remove shape and remember the parent\n */\nDeleteShapeHandler.prototype.execute = function(context) {\n  var canvas = this._canvas;\n\n  var shape = context.shape,\n      oldParent = shape.parent;\n\n  context.oldParent = oldParent;\n\n  // remove containment\n  context.oldParentIndex = collectionIdx(oldParent.children, shape);\n\n  // remove shape\n  canvas.removeShape(shape);\n\n  return shape;\n};\n\n\n/**\n * Command revert implementation\n */\nDeleteShapeHandler.prototype.revert = function(context) {\n\n  var canvas = this._canvas;\n\n  var shape = context.shape,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex;\n\n  // restore containment\n  collectionAdd(oldParent.children, shape, oldParentIndex);\n\n  canvas.addShape(shape, oldParent);\n\n  return shape;\n};\n\nfunction isConnection(element) {\n  return element.waypoints;\n}\n","import {\n  forEach,\n  sortBy\n} from 'min-dash';\n\n\n/**\n * A handler that distributes elements evenly.\n */\nexport default function DistributeElements(modeling) {\n  this._modeling = modeling;\n}\n\nDistributeElements.$inject = [ 'modeling' ];\n\nvar OFF_AXIS = {\n  x: 'y',\n  y: 'x'\n};\n\nDistributeElements.prototype.preExecute = function(context) {\n  var modeling = this._modeling;\n\n  var groups = context.groups,\n      axis = context.axis,\n      dimension = context.dimension;\n\n  function updateRange(group, element) {\n    group.range.min = Math.min(element[axis], group.range.min);\n    group.range.max = Math.max(element[axis] + element[dimension], group.range.max);\n  }\n\n  function center(element) {\n    return element[axis] + element[dimension] / 2;\n  }\n\n  function lastIdx(arr) {\n    return arr.length - 1;\n  }\n\n  function rangeDiff(range) {\n    return range.max - range.min;\n  }\n\n  function centerElement(refCenter, element) {\n    var delta = { y: 0 };\n\n    delta[axis] = refCenter - center(element);\n\n    if (delta[axis]) {\n\n      delta[OFF_AXIS[axis]] = 0;\n\n      modeling.moveElements([ element ], delta, element.parent);\n    }\n  }\n\n  var firstGroup = groups[0],\n      lastGroupIdx = lastIdx(groups),\n      lastGroup = groups[ lastGroupIdx ];\n\n  var margin,\n      spaceInBetween,\n      groupsSize = 0; // the size of each range\n\n  forEach(groups, function(group, idx) {\n    var sortedElements,\n        refElem,\n        refCenter;\n\n    if (group.elements.length < 2) {\n      if (idx && idx !== groups.length - 1) {\n        updateRange(group, group.elements[0]);\n\n        groupsSize += rangeDiff(group.range);\n      }\n      return;\n    }\n\n    sortedElements = sortBy(group.elements, axis);\n\n    refElem = sortedElements[0];\n\n    if (idx === lastGroupIdx) {\n      refElem = sortedElements[lastIdx(sortedElements)];\n    }\n\n    refCenter = center(refElem);\n\n    // wanna update the ranges after the shapes have been centered\n    group.range = null;\n\n    forEach(sortedElements, function(element) {\n\n      centerElement(refCenter, element);\n\n      if (group.range === null) {\n        group.range = {\n          min: element[axis],\n          max: element[axis] + element[dimension]\n        };\n\n        return;\n      }\n\n      // update group's range after centering the range elements\n      updateRange(group, element);\n    });\n\n    if (idx && idx !== groups.length - 1) {\n      groupsSize += rangeDiff(group.range);\n    }\n  });\n\n  spaceInBetween = Math.abs(lastGroup.range.min - firstGroup.range.max);\n\n  margin = Math.round((spaceInBetween - groupsSize) / (groups.length - 1));\n\n  if (margin < groups.length - 1) {\n    return;\n  }\n\n  forEach(groups, function(group, groupIdx) {\n    var delta = {},\n        prevGroup;\n\n    if (group === firstGroup || group === lastGroup) {\n      return;\n    }\n\n    prevGroup = groups[groupIdx - 1];\n\n    group.range.max = 0;\n\n    forEach(group.elements, function(element, idx) {\n      delta[OFF_AXIS[axis]] = 0;\n      delta[axis] = (prevGroup.range.max - element[axis]) + margin;\n\n      if (group.range.min !== element[axis]) {\n        delta[axis] += element[axis] - group.range.min;\n      }\n\n      if (delta[axis]) {\n        modeling.moveElements([ element ], delta, element.parent);\n      }\n\n      group.range.max = Math.max(element[axis] + element[dimension], idx ? group.range.max : 0);\n    });\n  });\n};\n\nDistributeElements.prototype.postExecute = function(context) {\n\n};\n","import { assign } from 'min-dash';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function LayoutConnectionHandler(layouter, canvas) {\n  this._layouter = layouter;\n  this._canvas = canvas;\n}\n\nLayoutConnectionHandler.$inject = [ 'layouter', 'canvas' ];\n\nLayoutConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection;\n\n  var oldWaypoints = connection.waypoints;\n\n  assign(context, {\n    oldWaypoints: oldWaypoints\n  });\n\n  connection.waypoints = this._layouter.layoutConnection(connection, context.hints);\n\n  return connection;\n};\n\nLayoutConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection;\n\n  connection.waypoints = context.oldWaypoints;\n\n  return connection;\n};\n","import { forEach } from 'min-dash';\n\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\n\n/**\n * A handler that implements reversible moving of connections.\n *\n * The handler differs from the layout connection handler in a sense\n * that it preserves the connection layout.\n */\nexport default function MoveConnectionHandler() { }\n\n\nMoveConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      delta = context.delta;\n\n  var newParent = context.newParent || connection.parent,\n      newParentIndex = context.newParentIndex,\n      oldParent = connection.parent;\n\n  // save old parent in context\n  context.oldParent = oldParent;\n  context.oldParentIndex = collectionRemove(oldParent.children, connection);\n\n  // add to new parent at position\n  collectionAdd(newParent.children, connection, newParentIndex);\n\n  // update parent\n  connection.parent = newParent;\n\n  // update waypoint positions\n  forEach(connection.waypoints, function(p) {\n    p.x += delta.x;\n    p.y += delta.y;\n\n    if (p.original) {\n      p.original.x += delta.x;\n      p.original.y += delta.y;\n    }\n  });\n\n  return connection;\n};\n\nMoveConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      newParent = connection.parent,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex,\n      delta = context.delta;\n\n  // remove from newParent\n  collectionRemove(newParent.children, connection);\n\n  // restore previous location in old parent\n  collectionAdd(oldParent.children, connection, oldParentIndex);\n\n  // restore parent\n  connection.parent = oldParent;\n\n  // revert to old waypoint positions\n  forEach(connection.waypoints, function(p) {\n    p.x -= delta.x;\n    p.y -= delta.y;\n\n    if (p.original) {\n      p.original.x -= delta.x;\n      p.original.y -= delta.y;\n    }\n  });\n\n  return connection;\n};","import {\n  getNewAttachPoint\n} from '../../../../util/AttachUtil';\n\n\nexport function getResizedSourceAnchor(connection, shape, oldBounds) {\n\n  var waypoints = safeGetWaypoints(connection),\n      oldAnchor = waypoints[0];\n\n  return getNewAttachPoint(oldAnchor.original || oldAnchor, oldBounds, shape);\n}\n\n\nexport function getResizedTargetAnchor(connection, shape, oldBounds) {\n\n  var waypoints = safeGetWaypoints(connection),\n      oldAnchor = waypoints[waypoints.length - 1];\n\n  return getNewAttachPoint(oldAnchor.original || oldAnchor, oldBounds, shape);\n}\n\n\nexport function getMovedSourceAnchor(connection, source, moveDelta) {\n  return getResizedSourceAnchor(connection, source, substractPosition(source, moveDelta));\n}\n\n\nexport function getMovedTargetAnchor(connection, target, moveDelta) {\n  return getResizedTargetAnchor(connection, target, substractPosition(target, moveDelta));\n}\n\n\n// helpers //////////////////////\n\nfunction substractPosition(bounds, delta) {\n  return {\n    x: bounds.x - delta.x,\n    y: bounds.y - delta.y,\n    width: bounds.width,\n    height: bounds.height\n  };\n}\n\n\n/**\n * Return waypoints of given connection; throw if non exists (should not happen!!).\n *\n * @param {Connection} connection\n *\n * @return {Array<Point>}\n */\nfunction safeGetWaypoints(connection) {\n\n  var waypoints = connection.waypoints;\n\n  if (!waypoints.length) {\n    throw new Error('connection#' + connection.id + ': no waypoints');\n  }\n\n  return waypoints;\n}\n","import {\n  assign\n} from 'min-dash';\n\nimport {\n  getClosure\n} from '../../../../util/Elements';\n\n\nexport default function MoveClosure() {\n\n  this.allShapes = {};\n  this.allConnections = {};\n\n  this.enclosedElements = {};\n  this.enclosedConnections = {};\n\n  this.topLevel = {};\n}\n\n\nMoveClosure.prototype.add = function(element, isTopLevel) {\n  return this.addAll([ element ], isTopLevel);\n};\n\n\nMoveClosure.prototype.addAll = function(elements, isTopLevel) {\n\n  var newClosure = getClosure(elements, !!isTopLevel, this);\n\n  assign(this, newClosure);\n\n  return this;\n};","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  getMovedSourceAnchor,\n  getMovedTargetAnchor\n} from './AnchorsHelper';\n\nimport MoveClosure from './MoveClosure';\n\n\n/**\n * A helper that is able to carry out serialized move\n * operations on multiple elements.\n *\n * @param {Modeling} modeling\n */\nexport default function MoveHelper(modeling) {\n  this._modeling = modeling;\n}\n\n/**\n * Move the specified elements and all children by the given delta.\n *\n * This moves all enclosed connections, too and layouts all affected\n * external connections.\n *\n * @param  {Array<djs.model.Base>} elements\n * @param  {Point} delta\n * @param  {djs.model.Base} newParent applied to the first level of shapes\n *\n * @return {Array<djs.model.Base>} list of touched elements\n */\nMoveHelper.prototype.moveRecursive = function(elements, delta, newParent) {\n  if (!elements) {\n    return [];\n  } else {\n    return this.moveClosure(this.getClosure(elements), delta, newParent);\n  }\n};\n\n/**\n * Move the given closure of elmements.\n *\n * @param {Object} closure\n * @param {Point} delta\n * @param {djs.model.Base} [newParent]\n * @param {djs.model.Base} [newHost]\n */\nMoveHelper.prototype.moveClosure = function(closure, delta, newParent, newHost, primaryShape) {\n  var modeling = this._modeling;\n\n  var allShapes = closure.allShapes,\n      allConnections = closure.allConnections,\n      enclosedConnections = closure.enclosedConnections,\n      topLevel = closure.topLevel,\n      keepParent = false;\n\n  if (primaryShape && primaryShape.parent === newParent) {\n    keepParent = true;\n  }\n\n  // move all shapes\n  forEach(allShapes, function(shape) {\n\n    // move the element according to the given delta\n    modeling.moveShape(shape, delta, topLevel[shape.id] && !keepParent && newParent, {\n      recurse: false,\n      layout: false\n    });\n  });\n\n  // move all child connections / layout external connections\n  forEach(allConnections, function(c) {\n\n    var sourceMoved = !!allShapes[c.source.id],\n        targetMoved = !!allShapes[c.target.id];\n\n    if (enclosedConnections[c.id] && sourceMoved && targetMoved) {\n      modeling.moveConnection(c, delta, topLevel[c.id] && !keepParent && newParent);\n    } else {\n      modeling.layoutConnection(c, {\n        connectionStart: sourceMoved && getMovedSourceAnchor(c, c.source, delta),\n        connectionEnd: targetMoved && getMovedTargetAnchor(c, c.target, delta)\n      });\n    }\n  });\n};\n\n/**\n * Returns the closure for the selected elements\n *\n * @param  {Array<djs.model.Base>} elements\n * @return {MoveClosure} closure\n */\nMoveHelper.prototype.getClosure = function(elements) {\n  return new MoveClosure().addAll(elements, true);\n};","import MoveHelper from './helper/MoveHelper';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function MoveElementsHandler(modeling) {\n  this._helper = new MoveHelper(modeling);\n}\n\nMoveElementsHandler.$inject = [ 'modeling' ];\n\nMoveElementsHandler.prototype.preExecute = function(context) {\n  context.closure = this._helper.getClosure(context.shapes);\n};\n\nMoveElementsHandler.prototype.postExecute = function(context) {\n\n  var hints = context.hints,\n      primaryShape;\n\n  if (hints && hints.primaryShape) {\n    primaryShape = hints.primaryShape;\n    hints.oldParent = primaryShape.parent;\n  }\n\n  this._helper.moveClosure(\n    context.closure,\n    context.delta,\n    context.newParent,\n    context.newHost,\n    primaryShape\n  );\n};","import {\n  assign,\n  forEach,\n  pick\n} from 'min-dash';\n\nimport MoveHelper from './helper/MoveHelper';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\nimport {\n  getMovedSourceAnchor,\n  getMovedTargetAnchor\n} from './helper/AnchorsHelper';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function MoveShapeHandler(modeling) {\n  this._modeling = modeling;\n\n  this._helper = new MoveHelper(modeling);\n}\n\nMoveShapeHandler.$inject = [ 'modeling' ];\n\n\nMoveShapeHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      delta = context.delta,\n      newParent = context.newParent || shape.parent,\n      newParentIndex = context.newParentIndex,\n      oldParent = shape.parent;\n\n  context.oldBounds = pick(shape, [ 'x', 'y', 'width', 'height']);\n\n  // save old parent in context\n  context.oldParent = oldParent;\n  context.oldParentIndex = collectionRemove(oldParent.children, shape);\n\n  // add to new parent at position\n  collectionAdd(newParent.children, shape, newParentIndex);\n\n  // update shape parent + position\n  assign(shape, {\n    parent: newParent,\n    x: shape.x + delta.x,\n    y: shape.y + delta.y\n  });\n\n  return shape;\n};\n\nMoveShapeHandler.prototype.postExecute = function(context) {\n\n  var shape = context.shape,\n      delta = context.delta,\n      hints = context.hints;\n\n  var modeling = this._modeling;\n\n  if (hints.layout !== false) {\n\n    forEach(shape.incoming, function(c) {\n      modeling.layoutConnection(c, {\n        connectionEnd: getMovedTargetAnchor(c, shape, delta)\n      });\n    });\n\n    forEach(shape.outgoing, function(c) {\n      modeling.layoutConnection(c, {\n        connectionStart: getMovedSourceAnchor(c, shape, delta)\n      });\n    });\n  }\n\n  if (hints.recurse !== false) {\n    this.moveChildren(context);\n  }\n};\n\nMoveShapeHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex,\n      delta = context.delta;\n\n  // restore previous location in old parent\n  collectionAdd(oldParent.children, shape, oldParentIndex);\n\n  // revert to old position and parent\n  assign(shape, {\n    parent: oldParent,\n    x: shape.x - delta.x,\n    y: shape.y - delta.y\n  });\n\n  return shape;\n};\n\nMoveShapeHandler.prototype.moveChildren = function(context) {\n\n  var delta = context.delta,\n      shape = context.shape;\n\n  this._helper.moveRecursive(shape.children, delta, null);\n};\n\nMoveShapeHandler.prototype.getNewParent = function(context) {\n  return context.newParent || context.shape.parent;\n};\n","import { isArray } from 'min-dash';\n\n\n/**\n * Reconnect connection handler\n */\nexport default function ReconnectConnectionHandler(modeling) {\n  this._modeling = modeling;\n}\n\nReconnectConnectionHandler.$inject = [ 'modeling' ];\n\nReconnectConnectionHandler.prototype.execute = function(context) {\n  var newSource = context.newSource,\n      newTarget = context.newTarget,\n      connection = context.connection,\n      dockingOrPoints = context.dockingOrPoints;\n\n  if (!newSource && !newTarget) {\n    throw new Error('newSource or newTarget required');\n  }\n\n  if (isArray(dockingOrPoints)) {\n    context.oldWaypoints = connection.waypoints;\n    connection.waypoints = dockingOrPoints;\n  }\n\n  if (newSource) {\n    context.oldSource = connection.source;\n    connection.source = newSource;\n  }\n\n  if (newTarget) {\n    context.oldTarget = connection.target;\n    connection.target = newTarget;\n  }\n\n  return connection;\n};\n\nReconnectConnectionHandler.prototype.postExecute = function(context) {\n  var connection = context.connection,\n      newSource = context.newSource,\n      newTarget = context.newTarget,\n      dockingOrPoints = context.dockingOrPoints,\n      hints = context.hints || {};\n\n  if (hints.layoutConnection === false) {\n    return;\n  }\n\n  var layoutConnectionHints = {};\n\n  if (newSource && (!newTarget || hints.docking === 'source')) {\n    layoutConnectionHints.connectionStart = getDocking(isArray(dockingOrPoints) ? dockingOrPoints[ 0 ] : dockingOrPoints);\n  }\n\n  if (newTarget && (!newSource || hints.docking === 'target')) {\n    layoutConnectionHints.connectionEnd = getDocking(isArray(dockingOrPoints) ? dockingOrPoints[ dockingOrPoints.length - 1 ] : dockingOrPoints);\n  }\n\n  if (hints.newWaypoints) {\n    layoutConnectionHints.waypoints = hints.newWaypoints;\n  }\n\n  this._modeling.layoutConnection(connection, layoutConnectionHints);\n};\n\nReconnectConnectionHandler.prototype.revert = function(context) {\n  var oldSource = context.oldSource,\n      oldTarget = context.oldTarget,\n      oldWaypoints = context.oldWaypoints,\n      connection = context.connection;\n\n  if (oldSource) {\n    connection.source = oldSource;\n  }\n\n  if (oldTarget) {\n    connection.target = oldTarget;\n  }\n\n  if (oldWaypoints) {\n    connection.waypoints = oldWaypoints;\n  }\n\n  return connection;\n};\n\n\n\n// helpers //////////\n\nfunction getDocking(point) {\n  return point.original || point;\n}","import { forEach } from 'min-dash';\n\nimport {\n  getResizedSourceAnchor,\n  getResizedTargetAnchor\n} from './helper/AnchorsHelper';\n\n/**\n * Replace shape by adding new shape and removing old shape. Incoming and outgoing connections will\n * be kept if possible.\n *\n * @class\n * @constructor\n *\n * @param {Modeling} modeling\n * @param {Rules} rules\n */\nexport default function ReplaceShapeHandler(modeling, rules) {\n  this._modeling = modeling;\n  this._rules = rules;\n}\n\nReplaceShapeHandler.$inject = [ 'modeling', 'rules' ];\n\n\n/**\n * Add new shape.\n *\n * @param {Object} context\n * @param {djs.model.Shape} context.oldShape\n * @param {Object} context.newData\n * @param {string} context.newData.type\n * @param {number} context.newData.x\n * @param {number} context.newData.y\n * @param {Object} [hints]\n */\nReplaceShapeHandler.prototype.preExecute = function(context) {\n  var self = this,\n      modeling = this._modeling,\n      rules = this._rules;\n\n  var oldShape = context.oldShape,\n      newData = context.newData,\n      hints = context.hints || {},\n      newShape;\n\n  function canReconnect(source, target, connection) {\n    return rules.allowed('connection.reconnect', {\n      connection: connection,\n      source: source,\n      target: target\n    });\n  }\n\n  // (1) add new shape at given position\n  var position = {\n    x: newData.x,\n    y: newData.y\n  };\n\n  var oldBounds = {\n    x: oldShape.x,\n    y: oldShape.y,\n    width: oldShape.width,\n    height: oldShape.height\n  };\n\n  newShape = context.newShape =\n    context.newShape ||\n    self.createShape(newData, position, oldShape.parent, hints);\n\n  // (2) update host\n  if (oldShape.host) {\n    modeling.updateAttachment(newShape, oldShape.host);\n  }\n\n  // (3) adopt all children from old shape\n  var children;\n\n  if (hints.moveChildren !== false) {\n    children = oldShape.children.slice();\n\n    modeling.moveElements(children, { x: 0, y: 0 }, newShape, hints);\n  }\n\n  // (4) reconnect connections to new shape if possible\n  var incoming = oldShape.incoming.slice(),\n      outgoing = oldShape.outgoing.slice();\n\n  forEach(incoming, function(connection) {\n    var source = connection.source,\n        allowed = canReconnect(source, newShape, connection);\n\n    if (allowed) {\n      self.reconnectEnd(\n        connection, newShape,\n        getResizedTargetAnchor(connection, newShape, oldBounds),\n        hints\n      );\n    }\n  });\n\n  forEach(outgoing, function(connection) {\n    var target = connection.target,\n        allowed = canReconnect(newShape, target, connection);\n\n    if (allowed) {\n      self.reconnectStart(\n        connection, newShape,\n        getResizedSourceAnchor(connection, newShape, oldBounds),\n        hints\n      );\n    }\n  });\n};\n\n\n/**\n * Remove old shape.\n */\nReplaceShapeHandler.prototype.postExecute = function(context) {\n  var oldShape = context.oldShape;\n\n  this._modeling.removeShape(oldShape);\n};\n\n\nReplaceShapeHandler.prototype.execute = function(context) {};\n\n\nReplaceShapeHandler.prototype.revert = function(context) {};\n\n\nReplaceShapeHandler.prototype.createShape = function(shape, position, target, hints) {\n  return this._modeling.createShape(shape, position, target, hints);\n};\n\n\nReplaceShapeHandler.prototype.reconnectStart = function(connection, newSource, dockingPoint, hints) {\n  this._modeling.reconnectStart(connection, newSource, dockingPoint, hints);\n};\n\n\nReplaceShapeHandler.prototype.reconnectEnd = function(connection, newTarget, dockingPoint, hints) {\n  this._modeling.reconnectEnd(connection, newTarget, dockingPoint, hints);\n};\n","import {\n  assign,\n  forEach\n} from 'min-dash';\n\nimport {\n  getResizedSourceAnchor,\n  getResizedTargetAnchor\n} from './helper/AnchorsHelper';\n\n\n/**\n * A handler that implements reversible resizing of shapes.\n *\n * @param {Modeling} modeling\n */\nexport default function ResizeShapeHandler(modeling) {\n  this._modeling = modeling;\n}\n\nResizeShapeHandler.$inject = [ 'modeling' ];\n\n/**\n * {\n *   shape: {....}\n *   newBounds: {\n *     width:  20,\n *     height: 40,\n *     x:       5,\n *     y:      10\n *   }\n *\n * }\n */\nResizeShapeHandler.prototype.execute = function(context) {\n  var shape = context.shape,\n      newBounds = context.newBounds,\n      minBounds = context.minBounds;\n\n  if (newBounds.x === undefined || newBounds.y === undefined ||\n      newBounds.width === undefined || newBounds.height === undefined) {\n    throw new Error('newBounds must have {x, y, width, height} properties');\n  }\n\n  if (minBounds && (newBounds.width < minBounds.width\n    || newBounds.height < minBounds.height)) {\n    throw new Error('width and height cannot be less than minimum height and width');\n  } else if (!minBounds\n    && newBounds.width < 10 || newBounds.height < 10) {\n    throw new Error('width and height cannot be less than 10px');\n  }\n\n  // save old bbox in context\n  context.oldBounds = {\n    width:  shape.width,\n    height: shape.height,\n    x:      shape.x,\n    y:      shape.y\n  };\n\n  // update shape\n  assign(shape, {\n    width:  newBounds.width,\n    height: newBounds.height,\n    x:      newBounds.x,\n    y:      newBounds.y\n  });\n\n  return shape;\n};\n\nResizeShapeHandler.prototype.postExecute = function(context) {\n  var modeling = this._modeling;\n\n  var shape = context.shape,\n      oldBounds = context.oldBounds,\n      hints = context.hints || {};\n\n  if (hints.layout === false) {\n    return;\n  }\n\n  forEach(shape.incoming, function(c) {\n    modeling.layoutConnection(c, {\n      connectionEnd: getResizedTargetAnchor(c, shape, oldBounds)\n    });\n  });\n\n  forEach(shape.outgoing, function(c) {\n    modeling.layoutConnection(c, {\n      connectionStart: getResizedSourceAnchor(c, shape, oldBounds)\n    });\n  });\n\n};\n\nResizeShapeHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldBounds = context.oldBounds;\n\n  // restore previous bbox\n  assign(shape, {\n    width:  oldBounds.width,\n    height: oldBounds.height,\n    x:      oldBounds.x,\n    y:      oldBounds.y\n  });\n\n  return shape;\n};\n","import {\n  assign,\n  forEach,\n  map\n} from 'min-dash';\n\nimport {\n  getWaypointsUpdatingConnections,\n  resizeBounds\n} from '../../space-tool/SpaceUtil';\n\n\n/**\n * Add or remove space by moving and resizing shapes and updating connection waypoints.\n */\nexport default function SpaceToolHandler(modeling) {\n  this._modeling = modeling;\n}\n\nSpaceToolHandler.$inject = [ 'modeling' ];\n\nSpaceToolHandler.prototype.preExecute = function(context) {\n  var delta = context.delta,\n      direction = context.direction,\n      movingShapes = context.movingShapes,\n      resizingShapes = context.resizingShapes,\n      start = context.start;\n\n  // (1) move shapes\n  this.moveShapes(movingShapes, delta);\n\n  // (2) resize shapes\n  this.resizeShapes(resizingShapes, delta, direction);\n\n  // (3) update connection waypoints\n  this.updateConnectionWaypoints(\n    getWaypointsUpdatingConnections(movingShapes, resizingShapes),\n    delta,\n    direction,\n    start,\n    movingShapes,\n    resizingShapes\n  );\n};\n\nSpaceToolHandler.prototype.execute = function() {};\nSpaceToolHandler.prototype.revert = function() {};\n\nSpaceToolHandler.prototype.moveShapes = function(shapes, delta) {\n  var self = this;\n\n  forEach(shapes, function(element) {\n    self._modeling.moveShape(element, delta, null, {\n      autoResize: false,\n      layout: false,\n      recurse: false\n    });\n  });\n};\n\nSpaceToolHandler.prototype.resizeShapes = function(shapes, delta, direction) {\n  var self = this;\n\n  forEach(shapes, function(shape) {\n    var newBounds = resizeBounds(shape, direction, delta);\n\n    self._modeling.resizeShape(shape, newBounds, null, {\n      attachSupport: false,\n      autoResize: false,\n      layout: false\n    });\n  });\n};\n\nSpaceToolHandler.prototype.updateConnectionWaypoints = function(\n    connections,\n    delta,\n    direction,\n    start,\n    movingShapes,\n    resizingShapes\n) {\n  var self = this;\n\n  forEach(connections, function(connection) {\n    var source = connection.source,\n        target = connection.target,\n        waypoints = copyWaypoints(connection);\n\n    var axis = getAxisFromDirection(direction);\n\n    // move waypoints\n    waypoints = map(waypoints, function(waypoint, index) {\n      var isFirstWaypoint = index === 0,\n          isLastWaypoint = index === waypoints.length - 1;\n\n      // do NOT move first/last waypoint if source/target NOT moving or resizing\n      if ((isFirstWaypoint && !includes(movingShapes.concat(resizingShapes), source)) ||\n        (isLastWaypoint && !includes(movingShapes.concat(resizingShapes), target))) {\n\n        return waypoint;\n      }\n\n      if ((waypoint[ axis ] > start && /e|s/.test(direction)) ||\n        (waypoint[ axis ] < start) && /n|w/.test(direction)) {\n\n        // move waypoint\n        waypoint[ axis ] = waypoint[ axis ] + delta[ axis ];\n      }\n\n      if (waypoint.original) {\n        if ((waypoint.original[ axis ] > start && /e|s/.test(direction)) ||\n          (waypoint.original[ axis ] < start) && /n|w/.test(direction)) {\n\n          // move waypoint original\n          waypoint.original[ axis ] = waypoint.original[ axis ] + delta[ axis ];\n        }\n      }\n\n      return waypoint;\n    });\n\n    self._modeling.updateWaypoints(connection, waypoints, {\n      labelBehavior: false\n    });\n  });\n};\n\n\n// helpers //////////\n\nfunction copyWaypoint(waypoint) {\n  return assign({}, waypoint);\n}\n\nfunction copyWaypoints(connection) {\n  return map(connection.waypoints, function(waypoint) {\n\n    waypoint = copyWaypoint(waypoint);\n\n    if (waypoint.original) {\n      waypoint.original = copyWaypoint(waypoint.original);\n    }\n\n    return waypoint;\n  });\n}\n\nfunction getAxisFromDirection(direction) {\n  switch (direction) {\n  case 'n':\n    return 'y';\n  case 'w':\n    return 'x';\n  case 's':\n    return 'y';\n  case 'e':\n    return 'x';\n  }\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}","import {\n  assign,\n  forEach\n} from 'min-dash';\n\n/**\n * A handler that toggles the collapsed state of an element\n * and the visibility of all its children.\n *\n * @param {Modeling} modeling\n */\nexport default function ToggleShapeCollapseHandler(modeling) {\n  this._modeling = modeling;\n}\n\nToggleShapeCollapseHandler.$inject = [ 'modeling' ];\n\n\nToggleShapeCollapseHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      children = shape.children;\n\n  // recursively remember previous visibility of children\n  context.oldChildrenVisibility = getElementsVisibilityRecursive(children);\n\n  // toggle state\n  shape.collapsed = !shape.collapsed;\n\n  // recursively hide/show children\n  var result = setHiddenRecursive(children, shape.collapsed);\n\n  return [shape].concat(result);\n};\n\n\nToggleShapeCollapseHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldChildrenVisibility = context.oldChildrenVisibility;\n\n  var children = shape.children;\n\n  // recursively set old visability of children\n  var result = restoreVisibilityRecursive(children, oldChildrenVisibility);\n\n  // retoggle state\n  shape.collapsed = !shape.collapsed;\n\n  return [shape].concat(result);\n};\n\n\n// helpers //////////////////////\n\n/**\n * Return a map { elementId -> hiddenState}.\n *\n * @param {Array<djs.model.Shape>} elements\n *\n * @return {Object}\n */\nfunction getElementsVisibilityRecursive(elements) {\n\n  var result = {};\n\n  forEach(elements, function(element) {\n    result[element.id] = element.hidden;\n\n    if (element.children) {\n      result = assign({}, result, getElementsVisibilityRecursive(element.children));\n    }\n  });\n\n  return result;\n}\n\n\nfunction setHiddenRecursive(elements, newHidden) {\n  var result = [];\n  forEach(elements, function(element) {\n    element.hidden = newHidden;\n\n    result = result.concat(element);\n\n    if (element.children) {\n      result = result.concat(setHiddenRecursive(element.children, element.collapsed || newHidden));\n    }\n  });\n\n  return result;\n}\n\nfunction restoreVisibilityRecursive(elements, lastState) {\n  var result = [];\n  forEach(elements, function(element) {\n    element.hidden = lastState[element.id];\n\n    result = result.concat(element);\n\n    if (element.children) {\n      result = result.concat(restoreVisibilityRecursive(element.children, lastState));\n    }\n  });\n\n  return result;\n}\n","import {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\n/**\n * A handler that implements reversible attaching/detaching of shapes.\n */\nexport default function UpdateAttachmentHandler(modeling) {\n  this._modeling = modeling;\n}\n\nUpdateAttachmentHandler.$inject = [ 'modeling' ];\n\n\nUpdateAttachmentHandler.prototype.execute = function(context) {\n  var shape = context.shape,\n      newHost = context.newHost,\n      oldHost = shape.host;\n\n  // (0) detach from old host\n  context.oldHost = oldHost;\n  context.attacherIdx = removeAttacher(oldHost, shape);\n\n  // (1) attach to new host\n  addAttacher(newHost, shape);\n\n  // (2) update host\n  shape.host = newHost;\n\n  return shape;\n};\n\nUpdateAttachmentHandler.prototype.revert = function(context) {\n  var shape = context.shape,\n      newHost = context.newHost,\n      oldHost = context.oldHost,\n      attacherIdx = context.attacherIdx;\n\n  // (2) update host\n  shape.host = oldHost;\n\n  // (1) attach to new host\n  removeAttacher(newHost, shape);\n\n  // (0) detach from old host\n  addAttacher(oldHost, shape, attacherIdx);\n\n  return shape;\n};\n\n\nfunction removeAttacher(host, attacher) {\n\n  // remove attacher from host\n  return collectionRemove(host && host.attachers, attacher);\n}\n\nfunction addAttacher(host, attacher, idx) {\n\n  if (!host) {\n    return;\n  }\n\n  var attachers = host.attachers;\n\n  if (!attachers) {\n    host.attachers = attachers = [];\n  }\n\n  collectionAdd(attachers, attacher, idx);\n}\n","export default function UpdateWaypointsHandler() { }\n\nUpdateWaypointsHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      newWaypoints = context.newWaypoints;\n\n  context.oldWaypoints = connection.waypoints;\n\n  connection.waypoints = newWaypoints;\n\n  return connection;\n};\n\nUpdateWaypointsHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      oldWaypoints = context.oldWaypoints;\n\n  connection.waypoints = oldWaypoints;\n\n  return connection;\n};","import {\n  assign,\n  forEach,\n  isArray\n} from 'min-dash';\n\nimport {\n  Base\n} from '../../model';\n\nimport AlignElementsHandler from './cmd/AlignElementsHandler';\nimport AppendShapeHandler from './cmd/AppendShapeHandler';\nimport CreateConnectionHandler from './cmd/CreateConnectionHandler';\nimport CreateElementsHandler from './cmd/CreateElementsHandler';\nimport CreateLabelHandler from './cmd/CreateLabelHandler';\nimport CreateShapeHandler from './cmd/CreateShapeHandler';\nimport DeleteConnectionHandler from './cmd/DeleteConnectionHandler';\nimport DeleteElementsHandler from './cmd/DeleteElementsHandler';\nimport DeleteShapeHandler from './cmd/DeleteShapeHandler';\nimport DistributeElementsHandler from './cmd/DistributeElementsHandler';\nimport LayoutConnectionHandler from './cmd/LayoutConnectionHandler';\nimport MoveConnectionHandler from './cmd/MoveConnectionHandler';\nimport MoveElementsHandler from './cmd/MoveElementsHandler';\nimport MoveShapeHandler from './cmd/MoveShapeHandler';\nimport ReconnectConnectionHandler from './cmd/ReconnectConnectionHandler';\nimport ReplaceShapeHandler from './cmd/ReplaceShapeHandler';\nimport ResizeShapeHandler from './cmd/ResizeShapeHandler';\nimport SpaceToolHandler from './cmd/SpaceToolHandler';\nimport ToggleShapeCollapseHandler from './cmd/ToggleShapeCollapseHandler';\nimport UpdateAttachmentHandler from './cmd/UpdateAttachmentHandler';\nimport UpdateWaypointsHandler from './cmd/UpdateWaypointsHandler';\n\n\n/**\n * The basic modeling entry point.\n *\n * @param {EventBus} eventBus\n * @param {ElementFactory} elementFactory\n * @param {CommandStack} commandStack\n */\nexport default function Modeling(eventBus, elementFactory, commandStack) {\n  this._eventBus = eventBus;\n  this._elementFactory = elementFactory;\n  this._commandStack = commandStack;\n\n  var self = this;\n\n  eventBus.on('diagram.init', function() {\n\n    // register modeling handlers\n    self.registerHandlers(commandStack);\n  });\n}\n\nModeling.$inject = [ 'eventBus', 'elementFactory', 'commandStack' ];\n\n\nModeling.prototype.getHandlers = function() {\n  return {\n    'shape.append': AppendShapeHandler,\n    'shape.create': CreateShapeHandler,\n    'shape.delete': DeleteShapeHandler,\n    'shape.move': MoveShapeHandler,\n    'shape.resize': ResizeShapeHandler,\n    'shape.replace': ReplaceShapeHandler,\n    'shape.toggleCollapse': ToggleShapeCollapseHandler,\n\n    'spaceTool': SpaceToolHandler,\n\n    'label.create': CreateLabelHandler,\n\n    'connection.create': CreateConnectionHandler,\n    'connection.delete': DeleteConnectionHandler,\n    'connection.move': MoveConnectionHandler,\n    'connection.layout': LayoutConnectionHandler,\n\n    'connection.updateWaypoints': UpdateWaypointsHandler,\n\n    'connection.reconnect': ReconnectConnectionHandler,\n\n    'elements.create': CreateElementsHandler,\n    'elements.move': MoveElementsHandler,\n    'elements.delete': DeleteElementsHandler,\n\n    'elements.distribute': DistributeElementsHandler,\n    'elements.align': AlignElementsHandler,\n\n    'element.updateAttachment': UpdateAttachmentHandler\n  };\n};\n\n/**\n * Register handlers with the command stack\n *\n * @param {CommandStack} commandStack\n */\nModeling.prototype.registerHandlers = function(commandStack) {\n  forEach(this.getHandlers(), function(handler, id) {\n    commandStack.registerHandler(id, handler);\n  });\n};\n\n\n// modeling helpers //////////////////////\n\nModeling.prototype.moveShape = function(shape, delta, newParent, newParentIndex, hints) {\n\n  if (typeof newParentIndex === 'object') {\n    hints = newParentIndex;\n    newParentIndex = null;\n  }\n\n  var context = {\n    shape: shape,\n    delta:  delta,\n    newParent: newParent,\n    newParentIndex: newParentIndex,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.move', context);\n};\n\n\n/**\n * Update the attachment of the given shape.\n *\n * @param {djs.mode.Base} shape\n * @param {djs.model.Base} [newHost]\n */\nModeling.prototype.updateAttachment = function(shape, newHost) {\n  var context = {\n    shape: shape,\n    newHost: newHost\n  };\n\n  this._commandStack.execute('element.updateAttachment', context);\n};\n\n\n/**\n * Move a number of shapes to a new target, either setting it as\n * the new parent or attaching it.\n *\n * @param {Array<djs.mode.Base>} shapes\n * @param {Point} delta\n * @param {djs.model.Base} [target]\n * @param {Object} [hints]\n * @param {Boolean} [hints.attach=false]\n */\nModeling.prototype.moveElements = function(shapes, delta, target, hints) {\n\n  hints = hints || {};\n\n  var attach = hints.attach;\n\n  var newParent = target,\n      newHost;\n\n  if (attach === true) {\n    newHost = target;\n    newParent = target.parent;\n  } else\n\n  if (attach === false) {\n    newHost = null;\n  }\n\n  var context = {\n    shapes: shapes,\n    delta: delta,\n    newParent: newParent,\n    newHost: newHost,\n    hints: hints\n  };\n\n  this._commandStack.execute('elements.move', context);\n};\n\n\nModeling.prototype.moveConnection = function(connection, delta, newParent, newParentIndex, hints) {\n\n  if (typeof newParentIndex === 'object') {\n    hints = newParentIndex;\n    newParentIndex = undefined;\n  }\n\n  var context = {\n    connection: connection,\n    delta: delta,\n    newParent: newParent,\n    newParentIndex: newParentIndex,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.move', context);\n};\n\n\nModeling.prototype.layoutConnection = function(connection, hints) {\n  var context = {\n    connection: connection,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.layout', context);\n};\n\n\n/**\n * Create connection.\n *\n * @param {djs.model.Base} source\n * @param {djs.model.Base} target\n * @param {Number} [parentIndex]\n * @param {Object|djs.model.Connection} connection\n * @param {djs.model.Base} parent\n * @param {Object} hints\n *\n * @return {djs.model.Connection} the created connection.\n */\nModeling.prototype.createConnection = function(source, target, parentIndex, connection, parent, hints) {\n\n  if (typeof parentIndex === 'object') {\n    hints = parent;\n    parent = connection;\n    connection = parentIndex;\n    parentIndex = undefined;\n  }\n\n  connection = this._create('connection', connection);\n\n  var context = {\n    source: source,\n    target: target,\n    parent: parent,\n    parentIndex: parentIndex,\n    connection: connection,\n    hints: hints\n  };\n\n  this._commandStack.execute('connection.create', context);\n\n  return context.connection;\n};\n\n\n/**\n * Create a shape at the specified position.\n *\n * @param {djs.model.Shape|Object} shape\n * @param {Point} position\n * @param {djs.model.Shape|djs.model.Root} target\n * @param {Number} [parentIndex] position in parents children list\n * @param {Object} [hints]\n * @param {Boolean} [hints.attach] whether to attach to target or become a child\n *\n * @return {djs.model.Shape} the created shape\n */\nModeling.prototype.createShape = function(shape, position, target, parentIndex, hints) {\n\n  if (typeof parentIndex !== 'number') {\n    hints = parentIndex;\n    parentIndex = undefined;\n  }\n\n  hints = hints || {};\n\n  var attach = hints.attach,\n      parent,\n      host;\n\n  shape = this._create('shape', shape);\n\n  if (attach) {\n    parent = target.parent;\n    host = target;\n  } else {\n    parent = target;\n  }\n\n  var context = {\n    position: position,\n    shape: shape,\n    parent: parent,\n    parentIndex: parentIndex,\n    host: host,\n    hints: hints\n  };\n\n  this._commandStack.execute('shape.create', context);\n\n  return context.shape;\n};\n\n\nModeling.prototype.createElements = function(elements, position, parent, parentIndex, hints) {\n  if (!isArray(elements)) {\n    elements = [ elements ];\n  }\n\n  if (typeof parentIndex !== 'number') {\n    hints = parentIndex;\n    parentIndex = undefined;\n  }\n\n  hints = hints || {};\n\n  var context = {\n    position: position,\n    elements: elements,\n    parent: parent,\n    parentIndex: parentIndex,\n    hints: hints\n  };\n\n  this._commandStack.execute('elements.create', context);\n\n  return context.elements;\n};\n\n\nModeling.prototype.createLabel = function(labelTarget, position, label, parent) {\n\n  label = this._create('label', label);\n\n  var context = {\n    labelTarget: labelTarget,\n    position: position,\n    parent: parent || labelTarget.parent,\n    shape: label\n  };\n\n  this._commandStack.execute('label.create', context);\n\n  return context.shape;\n};\n\n\n/**\n * Append shape to given source, drawing a connection\n * between source and the newly created shape.\n *\n * @param {djs.model.Shape} source\n * @param {djs.model.Shape|Object} shape\n * @param {Point} position\n * @param {djs.model.Shape} target\n * @param {Object} [hints]\n * @param {Boolean} [hints.attach]\n * @param {djs.model.Connection|Object} [hints.connection]\n * @param {djs.model.Base} [hints.connectionParent]\n *\n * @return {djs.model.Shape} the newly created shape\n */\nModeling.prototype.appendShape = function(source, shape, position, target, hints) {\n\n  hints = hints || {};\n\n  shape = this._create('shape', shape);\n\n  var context = {\n    source: source,\n    position: position,\n    target: target,\n    shape: shape,\n    connection: hints.connection,\n    connectionParent: hints.connectionParent,\n    attach: hints.attach\n  };\n\n  this._commandStack.execute('shape.append', context);\n\n  return context.shape;\n};\n\n\nModeling.prototype.removeElements = function(elements) {\n  var context = {\n    elements: elements\n  };\n\n  this._commandStack.execute('elements.delete', context);\n};\n\n\nModeling.prototype.distributeElements = function(groups, axis, dimension) {\n  var context = {\n    groups: groups,\n    axis: axis,\n    dimension: dimension\n  };\n\n  this._commandStack.execute('elements.distribute', context);\n};\n\n\nModeling.prototype.removeShape = function(shape, hints) {\n  var context = {\n    shape: shape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.delete', context);\n};\n\n\nModeling.prototype.removeConnection = function(connection, hints) {\n  var context = {\n    connection: connection,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.delete', context);\n};\n\nModeling.prototype.replaceShape = function(oldShape, newShape, hints) {\n  var context = {\n    oldShape: oldShape,\n    newData: newShape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.replace', context);\n\n  return context.newShape;\n};\n\nModeling.prototype.alignElements = function(elements, alignment) {\n  var context = {\n    elements: elements,\n    alignment: alignment\n  };\n\n  this._commandStack.execute('elements.align', context);\n};\n\nModeling.prototype.resizeShape = function(shape, newBounds, minBounds, hints) {\n  var context = {\n    shape: shape,\n    newBounds: newBounds,\n    minBounds: minBounds,\n    hints: hints\n  };\n\n  this._commandStack.execute('shape.resize', context);\n};\n\nModeling.prototype.createSpace = function(movingShapes, resizingShapes, delta, direction, start) {\n  var context = {\n    delta: delta,\n    direction: direction,\n    movingShapes: movingShapes,\n    resizingShapes: resizingShapes,\n    start: start\n  };\n\n  this._commandStack.execute('spaceTool', context);\n};\n\nModeling.prototype.updateWaypoints = function(connection, newWaypoints, hints) {\n  var context = {\n    connection: connection,\n    newWaypoints: newWaypoints,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.updateWaypoints', context);\n};\n\nModeling.prototype.reconnect = function(connection, source, target, dockingOrPoints, hints) {\n  var context = {\n    connection: connection,\n    newSource: source,\n    newTarget: target,\n    dockingOrPoints: dockingOrPoints,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.reconnect', context);\n};\n\nModeling.prototype.reconnectStart = function(connection, newSource, dockingOrPoints, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  this.reconnect(connection, newSource, connection.target, dockingOrPoints, assign(hints, {\n    docking: 'source'\n  }));\n};\n\nModeling.prototype.reconnectEnd = function(connection, newTarget, dockingOrPoints, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  this.reconnect(connection, connection.source, newTarget, dockingOrPoints, assign(hints, {\n    docking: 'target'\n  }));\n};\n\nModeling.prototype.connect = function(source, target, attrs, hints) {\n  return this.createConnection(source, target, attrs || {}, source.parent, hints);\n};\n\nModeling.prototype._create = function(type, attrs) {\n  if (attrs instanceof Base) {\n    return attrs;\n  } else {\n    return this._elementFactory.create(type, attrs);\n  }\n};\n\nModeling.prototype.toggleCollapse = function(shape, hints) {\n  var context = {\n    shape: shape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.toggleCollapse', context);\n};\n","import {\n  reduce,\n  keys,\n  forEach,\n  assign\n} from 'min-dash';\n\nimport {\n  getBusinessObject\n} from '../../../util/ModelUtil';\n\nvar DEFAULT_FLOW = 'default',\n    ID = 'id',\n    DI = 'di';\n\nvar NULL_DIMENSIONS = {\n  width: 0,\n  height: 0\n};\n\n/**\n * A handler that implements a BPMN 2.0 property update.\n *\n * This should be used to set simple properties on elements with\n * an underlying BPMN business object.\n *\n * Use respective diagram-js provided handlers if you would\n * like to perform automated modeling.\n */\nexport default function UpdatePropertiesHandler(\n    elementRegistry, moddle, translate,\n    modeling, textRenderer) {\n\n  this._elementRegistry = elementRegistry;\n  this._moddle = moddle;\n  this._translate = translate;\n  this._modeling = modeling;\n  this._textRenderer = textRenderer;\n}\n\nUpdatePropertiesHandler.$inject = [\n  'elementRegistry',\n  'moddle',\n  'translate',\n  'modeling',\n  'textRenderer'\n];\n\n\n// api //////////////////////\n\n/**\n * Updates a BPMN element with a list of new properties\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element the element to update\n * @param {Object} context.properties a list of properties to set on the element's\n *                                    businessObject (the BPMN model element)\n *\n * @return {Array<djs.model.Base>} the updated element\n */\nUpdatePropertiesHandler.prototype.execute = function(context) {\n\n  var element = context.element,\n      changed = [ element ],\n      translate = this._translate;\n\n  if (!element) {\n    throw new Error(translate('element required'));\n  }\n\n  var elementRegistry = this._elementRegistry,\n      ids = this._moddle.ids;\n\n  var businessObject = element.businessObject,\n      properties = unwrapBusinessObjects(context.properties),\n      oldProperties = context.oldProperties || getProperties(businessObject, properties);\n\n  if (isIdChange(properties, businessObject)) {\n    ids.unclaim(businessObject[ID]);\n\n    elementRegistry.updateId(element, properties[ID]);\n\n    ids.claim(properties[ID], businessObject);\n  }\n\n  // correctly indicate visual changes on default flow updates\n  if (DEFAULT_FLOW in properties) {\n\n    if (properties[DEFAULT_FLOW]) {\n      changed.push(elementRegistry.get(properties[DEFAULT_FLOW].id));\n    }\n\n    if (businessObject[DEFAULT_FLOW]) {\n      changed.push(elementRegistry.get(businessObject[DEFAULT_FLOW].id));\n    }\n  }\n\n  // update properties\n  setProperties(businessObject, properties);\n\n  // store old values\n  context.oldProperties = oldProperties;\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n\nUpdatePropertiesHandler.prototype.postExecute = function(context) {\n  var element = context.element,\n      label = element.label;\n\n  var text = label && getBusinessObject(label).name;\n\n  if (!text) {\n    return;\n  }\n\n  // get layouted text bounds and resize external\n  // external label accordingly\n  var newLabelBounds = this._textRenderer.getExternalLabelBounds(label, text);\n\n  this._modeling.resizeShape(label, newLabelBounds, NULL_DIMENSIONS);\n};\n\n/**\n * Reverts the update on a BPMN elements properties.\n *\n * @param  {Object} context\n *\n * @return {djs.model.Base} the updated element\n */\nUpdatePropertiesHandler.prototype.revert = function(context) {\n\n  var element = context.element,\n      properties = context.properties,\n      oldProperties = context.oldProperties,\n      businessObject = element.businessObject,\n      elementRegistry = this._elementRegistry,\n      ids = this._moddle.ids;\n\n  // update properties\n  setProperties(businessObject, oldProperties);\n\n  if (isIdChange(properties, businessObject)) {\n    ids.unclaim(properties[ID]);\n\n    elementRegistry.updateId(element, oldProperties[ID]);\n\n    ids.claim(oldProperties[ID], businessObject);\n  }\n\n  return context.changed;\n};\n\n\nfunction isIdChange(properties, businessObject) {\n  return ID in properties && properties[ID] !== businessObject[ID];\n}\n\n\nfunction getProperties(businessObject, properties) {\n  var propertyNames = keys(properties);\n\n  return reduce(propertyNames, function(result, key) {\n\n    // handle DI separately\n    if (key !== DI) {\n      result[key] = businessObject.get(key);\n    } else {\n      result[key] = getDiProperties(businessObject.di, keys(properties.di));\n    }\n\n    return result;\n  }, {});\n}\n\n\nfunction getDiProperties(di, propertyNames) {\n  return reduce(propertyNames, function(result, key) {\n    result[key] = di.get(key);\n\n    return result;\n  }, {});\n}\n\n\nfunction setProperties(businessObject, properties) {\n  forEach(properties, function(value, key) {\n\n    if (key !== DI) {\n      businessObject.set(key, value);\n    } else {\n\n      // only update, if businessObject.di exists\n      if (businessObject.di) {\n        setDiProperties(businessObject.di, value);\n      }\n    }\n  });\n}\n\n\nfunction setDiProperties(di, properties) {\n  forEach(properties, function(value, key) {\n    di.set(key, value);\n  });\n}\n\n\nvar referencePropertyNames = [ 'default' ];\n\n/**\n * Make sure we unwrap the actual business object\n * behind diagram element that may have been\n * passed as arguments.\n *\n * @param  {Object} properties\n *\n * @return {Object} unwrappedProps\n */\nfunction unwrapBusinessObjects(properties) {\n\n  var unwrappedProps = assign({}, properties);\n\n  referencePropertyNames.forEach(function(name) {\n    if (name in properties) {\n      unwrappedProps[name] = getBusinessObject(unwrappedProps[name]);\n    }\n  });\n\n  return unwrappedProps;\n}","import {\n  add as collectionAdd,\n  remove as collectionRemove\n} from 'diagram-js/lib/util/Collections';\n\n\nexport default function UpdateCanvasRootHandler(canvas, modeling) {\n  this._canvas = canvas;\n  this._modeling = modeling;\n}\n\nUpdateCanvasRootHandler.$inject = [\n  'canvas',\n  'modeling'\n];\n\n\nUpdateCanvasRootHandler.prototype.execute = function(context) {\n\n  var canvas = this._canvas;\n\n  var newRoot = context.newRoot,\n      newRootBusinessObject = newRoot.businessObject,\n      oldRoot = canvas.getRootElement(),\n      oldRootBusinessObject = oldRoot.businessObject,\n      bpmnDefinitions = oldRootBusinessObject.$parent,\n      diPlane = oldRootBusinessObject.di;\n\n  // (1) replace process old <> new root\n  canvas.setRootElement(newRoot, true);\n\n  // (2) update root elements\n  collectionAdd(bpmnDefinitions.rootElements, newRootBusinessObject);\n  newRootBusinessObject.$parent = bpmnDefinitions;\n\n  collectionRemove(bpmnDefinitions.rootElements, oldRootBusinessObject);\n  oldRootBusinessObject.$parent = null;\n\n  // (3) wire di\n  oldRootBusinessObject.di = null;\n\n  diPlane.bpmnElement = newRootBusinessObject;\n  newRootBusinessObject.di = diPlane;\n\n  context.oldRoot = oldRoot;\n\n  // TODO(nikku): return changed elements?\n  // return [ newRoot, oldRoot ];\n};\n\n\nUpdateCanvasRootHandler.prototype.revert = function(context) {\n\n  var canvas = this._canvas;\n\n  var newRoot = context.newRoot,\n      newRootBusinessObject = newRoot.businessObject,\n      oldRoot = context.oldRoot,\n      oldRootBusinessObject = oldRoot.businessObject,\n      bpmnDefinitions = newRootBusinessObject.$parent,\n      diPlane = newRootBusinessObject.di;\n\n  // (1) replace process old <> new root\n  canvas.setRootElement(oldRoot, true);\n\n  // (2) update root elements\n  collectionRemove(bpmnDefinitions.rootElements, newRootBusinessObject);\n  newRootBusinessObject.$parent = null;\n\n  collectionAdd(bpmnDefinitions.rootElements, oldRootBusinessObject);\n  oldRootBusinessObject.$parent = bpmnDefinitions;\n\n  // (3) wire di\n  newRootBusinessObject.di = null;\n\n  diPlane.bpmnElement = oldRootBusinessObject;\n  oldRootBusinessObject.di = diPlane;\n\n  // TODO(nikku): return changed elements?\n  // return [ newRoot, oldRoot ];\n};","import {\n  filter\n} from 'min-dash';\n\nimport {\n  eachElement\n} from 'diagram-js/lib/util/Elements';\n\nimport {\n  getLanesRoot,\n  getChildLanes,\n  LANE_INDENTATION\n} from '../util/LaneUtil';\n\n\n/**\n * A handler that allows us to add a new lane\n * above or below an existing one.\n *\n * @param {Modeling} modeling\n */\nexport default function AddLaneHandler(modeling, spaceTool) {\n  this._modeling = modeling;\n  this._spaceTool = spaceTool;\n}\n\nAddLaneHandler.$inject = [\n  'modeling',\n  'spaceTool'\n];\n\n\nAddLaneHandler.prototype.preExecute = function(context) {\n\n  var spaceTool = this._spaceTool,\n      modeling = this._modeling;\n\n  var shape = context.shape,\n      location = context.location;\n\n  var lanesRoot = getLanesRoot(shape);\n\n  var isRoot = lanesRoot === shape,\n      laneParent = isRoot ? shape : shape.parent;\n\n  var existingChildLanes = getChildLanes(laneParent);\n\n  // (0) add a lane if we currently got none and are adding to root\n  if (!existingChildLanes.length) {\n    modeling.createShape({ type: 'bpmn:Lane' }, {\n      x: shape.x + LANE_INDENTATION,\n      y: shape.y,\n      width: shape.width - LANE_INDENTATION,\n      height: shape.height\n    }, laneParent);\n  }\n\n  // (1) collect affected elements to create necessary space\n  var allAffected = [];\n\n  eachElement(lanesRoot, function(element) {\n    allAffected.push(element);\n\n    if (element === shape) {\n      return [];\n    }\n\n    return filter(element.children, function(c) {\n      return c !== shape;\n    });\n  });\n\n  var offset = location === 'top' ? -120 : 120,\n      lanePosition = location === 'top' ? shape.y : shape.y + shape.height,\n      spacePos = lanePosition + (location === 'top' ? 10 : -10),\n      direction = location === 'top' ? 'n' : 's';\n\n  var adjustments = spaceTool.calculateAdjustments(allAffected, 'y', offset, spacePos);\n\n  spaceTool.makeSpace(adjustments.movingShapes, adjustments.resizingShapes, { x: 0, y: offset }, direction);\n\n  // (2) create new lane at open space\n  context.newLane = modeling.createShape({ type: 'bpmn:Lane' }, {\n    x: shape.x + (isRoot ? LANE_INDENTATION : 0),\n    y: lanePosition - (location === 'top' ? 120 : 0),\n    width: shape.width - (isRoot ? LANE_INDENTATION : 0),\n    height: 120\n  }, laneParent);\n};\n","import {\n  getChildLanes,\n  LANE_INDENTATION\n} from '../util/LaneUtil';\n\n\n/**\n * A handler that splits a lane into a number of sub-lanes,\n * creating new sub lanes, if necessary.\n *\n * @param {Modeling} modeling\n */\nexport default function SplitLaneHandler(modeling, translate) {\n  this._modeling = modeling;\n  this._translate = translate;\n}\n\nSplitLaneHandler.$inject = [\n  'modeling',\n  'translate'\n];\n\n\nSplitLaneHandler.prototype.preExecute = function(context) {\n\n  var modeling = this._modeling,\n      translate = this._translate;\n\n  var shape = context.shape,\n      newLanesCount = context.count;\n\n  var childLanes = getChildLanes(shape),\n      existingLanesCount = childLanes.length;\n\n  if (existingLanesCount > newLanesCount) {\n    throw new Error(translate('more than {count} child lanes', { count: newLanesCount }));\n  }\n\n  var newLanesHeight = Math.round(shape.height / newLanesCount);\n\n  // Iterate from top to bottom in child lane order,\n  // resizing existing lanes and creating new ones\n  // so that they split the parent proportionally.\n  //\n  // Due to rounding related errors, the bottom lane\n  // needs to take up all the remaining space.\n  var laneY,\n      laneHeight,\n      laneBounds,\n      newLaneAttrs,\n      idx;\n\n  for (idx = 0; idx < newLanesCount; idx++) {\n\n    laneY = shape.y + idx * newLanesHeight;\n\n    // if bottom lane\n    if (idx === newLanesCount - 1) {\n      laneHeight = shape.height - (newLanesHeight * idx);\n    } else {\n      laneHeight = newLanesHeight;\n    }\n\n    laneBounds = {\n      x: shape.x + LANE_INDENTATION,\n      y: laneY,\n      width: shape.width - LANE_INDENTATION,\n      height: laneHeight\n    };\n\n    if (idx < existingLanesCount) {\n\n      // resize existing lane\n      modeling.resizeShape(childLanes[idx], laneBounds);\n    } else {\n\n      // create a new lane at position\n      newLaneAttrs = {\n        type: 'bpmn:Lane'\n      };\n\n      modeling.createShape(newLaneAttrs, laneBounds, shape);\n    }\n  }\n};\n","import { is } from '../../../util/ModelUtil';\n\nimport {\n  getLanesRoot,\n  computeLanesResize\n} from '../util/LaneUtil';\n\nimport {\n  eachElement\n} from 'diagram-js/lib/util/Elements';\n\nimport {\n  asTRBL\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  substractTRBL\n} from 'diagram-js/lib/features/resize/ResizeUtil';\n\n\n/**\n * A handler that resizes a lane.\n *\n * @param {Modeling} modeling\n */\nexport default function ResizeLaneHandler(modeling, spaceTool) {\n  this._modeling = modeling;\n  this._spaceTool = spaceTool;\n}\n\nResizeLaneHandler.$inject = [\n  'modeling',\n  'spaceTool'\n];\n\n\nResizeLaneHandler.prototype.preExecute = function(context) {\n\n  var shape = context.shape,\n      newBounds = context.newBounds,\n      balanced = context.balanced;\n\n  if (balanced !== false) {\n    this.resizeBalanced(shape, newBounds);\n  } else {\n    this.resizeSpace(shape, newBounds);\n  }\n};\n\n\n/**\n * Resize balanced, adjusting next / previous lane sizes.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n */\nResizeLaneHandler.prototype.resizeBalanced = function(shape, newBounds) {\n\n  var modeling = this._modeling;\n\n  var resizeNeeded = computeLanesResize(shape, newBounds);\n\n  // resize the lane\n  modeling.resizeShape(shape, newBounds);\n\n  // resize other lanes as needed\n  resizeNeeded.forEach(function(r) {\n    modeling.resizeShape(r.shape, r.newBounds);\n  });\n};\n\n\n/**\n * Resize, making actual space and moving below / above elements.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n */\nResizeLaneHandler.prototype.resizeSpace = function(shape, newBounds) {\n  var spaceTool = this._spaceTool;\n\n  var shapeTrbl = asTRBL(shape),\n      newTrbl = asTRBL(newBounds);\n\n  var trblDiff = substractTRBL(newTrbl, shapeTrbl);\n\n  var lanesRoot = getLanesRoot(shape);\n\n  var allAffected = [],\n      allLanes = [];\n\n  eachElement(lanesRoot, function(element) {\n    allAffected.push(element);\n\n    if (is(element, 'bpmn:Lane') || is(element, 'bpmn:Participant')) {\n      allLanes.push(element);\n    }\n\n    return element.children;\n  });\n\n  var change,\n      spacePos,\n      direction,\n      offset,\n      adjustments;\n\n  if (trblDiff.bottom || trblDiff.top) {\n\n    change = trblDiff.bottom || trblDiff.top;\n    spacePos = shape.y + (trblDiff.bottom ? shape.height : 0) + (trblDiff.bottom ? -10 : 10);\n    direction = trblDiff.bottom ? 's' : 'n';\n\n    offset = trblDiff.top > 0 || trblDiff.bottom < 0 ? -change : change;\n\n    adjustments = spaceTool.calculateAdjustments(allAffected, 'y', offset, spacePos);\n\n    spaceTool.makeSpace(adjustments.movingShapes, adjustments.resizingShapes, { x: 0, y: change }, direction);\n  }\n\n\n  if (trblDiff.left || trblDiff.right) {\n\n    change = trblDiff.right || trblDiff.left;\n    spacePos = shape.x + (trblDiff.right ? shape.width : 0) + (trblDiff.right ? -10 : 100);\n    direction = trblDiff.right ? 'e' : 'w';\n\n    offset = trblDiff.left > 0 || trblDiff.right < 0 ? -change : change;\n\n    adjustments = spaceTool.calculateAdjustments(allLanes, 'x', offset, spacePos);\n\n    spaceTool.makeSpace(adjustments.movingShapes, adjustments.resizingShapes, { x: change, y: 0 }, direction);\n  }\n};","import {\n  collectLanes,\n  getLanesRoot\n} from '../util/LaneUtil';\n\nimport {\n  is\n} from '../../../util/ModelUtil';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  asTRBL\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nvar FLOW_NODE_REFS_ATTR = 'flowNodeRef',\n    LANES_ATTR = 'lanes';\n\n\n/**\n * A handler that updates lane refs on changed elements\n */\nexport default function UpdateFlowNodeRefsHandler(elementRegistry) {\n  this._elementRegistry = elementRegistry;\n}\n\nUpdateFlowNodeRefsHandler.$inject = [\n  'elementRegistry'\n];\n\n\nUpdateFlowNodeRefsHandler.prototype.computeUpdates = function(flowNodeShapes, laneShapes) {\n\n  var handledNodes = [];\n\n  var updates = [];\n\n  var participantCache = {};\n\n  var allFlowNodeShapes = [];\n\n  function isInLaneShape(element, laneShape) {\n\n    var laneTrbl = asTRBL(laneShape);\n\n    var elementMid = {\n      x: element.x + element.width / 2,\n      y: element.y + element.height / 2\n    };\n\n    return elementMid.x > laneTrbl.left &&\n           elementMid.x < laneTrbl.right &&\n           elementMid.y > laneTrbl.top &&\n           elementMid.y < laneTrbl.bottom;\n  }\n\n  function addFlowNodeShape(flowNodeShape) {\n    if (handledNodes.indexOf(flowNodeShape) === -1) {\n      allFlowNodeShapes.push(flowNodeShape);\n      handledNodes.push(flowNodeShape);\n    }\n  }\n\n  function getAllLaneShapes(flowNodeShape) {\n\n    var root = getLanesRoot(flowNodeShape);\n\n    if (!participantCache[root.id]) {\n      participantCache[root.id] = collectLanes(root);\n    }\n\n    return participantCache[root.id];\n  }\n\n  function getNewLanes(flowNodeShape) {\n    if (!flowNodeShape.parent) {\n      return [];\n    }\n\n    var allLaneShapes = getAllLaneShapes(flowNodeShape);\n\n    return allLaneShapes.filter(function(l) {\n      return isInLaneShape(flowNodeShape, l);\n    }).map(function(shape) {\n      return shape.businessObject;\n    });\n  }\n\n  laneShapes.forEach(function(laneShape) {\n    var root = getLanesRoot(laneShape);\n\n    if (!root || handledNodes.indexOf(root) !== -1) {\n      return;\n    }\n\n    var children = root.children.filter(function(c) {\n      return is(c, 'bpmn:FlowNode');\n    });\n\n    children.forEach(addFlowNodeShape);\n\n    handledNodes.push(root);\n  });\n\n  flowNodeShapes.forEach(addFlowNodeShape);\n\n\n  allFlowNodeShapes.forEach(function(flowNodeShape) {\n\n    var flowNode = flowNodeShape.businessObject;\n\n    var lanes = flowNode.get(LANES_ATTR),\n        remove = lanes.slice(),\n        add = getNewLanes(flowNodeShape);\n\n    updates.push({ flowNode: flowNode, remove: remove, add: add });\n  });\n\n  laneShapes.forEach(function(laneShape) {\n\n    var lane = laneShape.businessObject;\n\n    // lane got removed XX-)\n    if (!laneShape.parent) {\n      lane.get(FLOW_NODE_REFS_ATTR).forEach(function(flowNode) {\n        updates.push({ flowNode: flowNode, remove: [ lane ], add: [] });\n      });\n    }\n  });\n\n  return updates;\n};\n\nUpdateFlowNodeRefsHandler.prototype.execute = function(context) {\n\n  var updates = context.updates;\n\n  if (!updates) {\n    updates = context.updates = this.computeUpdates(context.flowNodeShapes, context.laneShapes);\n  }\n\n\n  updates.forEach(function(update) {\n\n    var flowNode = update.flowNode,\n        lanes = flowNode.get(LANES_ATTR);\n\n    // unwire old\n    update.remove.forEach(function(oldLane) {\n      collectionRemove(lanes, oldLane);\n      collectionRemove(oldLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n\n    // wire new\n    update.add.forEach(function(newLane) {\n      collectionAdd(lanes, newLane);\n      collectionAdd(newLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n  });\n\n  // TODO(nikku): return changed elements\n  // return [ ... ];\n};\n\n\nUpdateFlowNodeRefsHandler.prototype.revert = function(context) {\n\n  var updates = context.updates;\n\n  updates.forEach(function(update) {\n\n    var flowNode = update.flowNode,\n        lanes = flowNode.get(LANES_ATTR);\n\n    // unwire new\n    update.add.forEach(function(newLane) {\n      collectionRemove(lanes, newLane);\n      collectionRemove(newLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n\n    // wire old\n    update.remove.forEach(function(oldLane) {\n      collectionAdd(lanes, oldLane);\n      collectionAdd(oldLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n  });\n\n  // TODO(nikku): return changed elements\n  // return [ ... ];\n};\n","export default function IdClaimHandler(moddle) {\n  this._moddle = moddle;\n}\n\nIdClaimHandler.$inject = [ 'moddle' ];\n\n\nIdClaimHandler.prototype.execute = function(context) {\n  var ids = this._moddle.ids,\n      id = context.id,\n      element = context.element,\n      claiming = context.claiming;\n\n  if (claiming) {\n    ids.claim(id, element);\n  } else {\n    ids.unclaim(id);\n  }\n};\n\n/**\n * Command revert implementation.\n */\nIdClaimHandler.prototype.revert = function(context) {\n  var ids = this._moddle.ids,\n      id = context.id,\n      element = context.element,\n      claiming = context.claiming;\n\n  if (claiming) {\n    ids.unclaim(id);\n  } else {\n    ids.claim(id, element);\n  }\n};\n\n","import {\r\n  assign,\r\n  forEach\r\n} from 'min-dash';\r\n\r\n\r\nvar DEFAULT_COLORS = {\r\n  fill: undefined,\r\n  stroke: undefined\r\n};\r\n\r\n\r\nexport default function SetColorHandler(commandStack) {\r\n  this._commandStack = commandStack;\r\n}\r\n\r\nSetColorHandler.$inject = [\r\n  'commandStack'\r\n];\r\n\r\n\r\nSetColorHandler.prototype.postExecute = function(context) {\r\n  var elements = context.elements,\r\n      colors = context.colors || DEFAULT_COLORS;\r\n\r\n  var self = this;\r\n\r\n  var di = {};\r\n\r\n  if ('fill' in colors) {\r\n    assign(di, { fill: colors.fill });\r\n  }\r\n\r\n  if ('stroke' in colors) {\r\n    assign(di, { stroke: colors.stroke });\r\n  }\r\n\r\n  forEach(elements, function(element) {\r\n\r\n    self._commandStack.execute('element.updateProperties', {\r\n      element: element,\r\n      properties: {\r\n        di: di\r\n      }\r\n    });\r\n  });\r\n\r\n};","import {\n  setLabel,\n  getLabel\n} from '../LabelUtil';\n\nimport {\n  getExternalLabelMid,\n  isLabelExternal,\n  hasExternalLabel,\n  isLabel\n} from '../../../util/LabelUtil';\n\nimport {\n  is\n} from '../../../util/ModelUtil';\n\nvar NULL_DIMENSIONS = {\n  width: 0,\n  height: 0\n};\n\n\n/**\n * A handler that updates the text of a BPMN element.\n */\nexport default function UpdateLabelHandler(modeling, textRenderer) {\n\n  /**\n   * Set the label and return the changed elements.\n   *\n   * Element parameter can be label itself or connection (i.e. sequence flow).\n   *\n   * @param {djs.model.Base} element\n   * @param {String} text\n   */\n  function setText(element, text) {\n\n    // external label if present\n    var label = element.label || element;\n\n    var labelTarget = element.labelTarget || element;\n\n    setLabel(label, text, labelTarget !== label);\n\n    return [ label, labelTarget ];\n  }\n\n  function preExecute(ctx) {\n    var element = ctx.element,\n        businessObject = element.businessObject,\n        newLabel = ctx.newLabel;\n\n    if (!isLabel(element)\n        && isLabelExternal(element)\n        && !hasExternalLabel(element)\n        && !isEmptyText(newLabel)) {\n\n      // create label\n      var paddingTop = 7;\n\n      var labelCenter = getExternalLabelMid(element);\n\n      labelCenter = {\n        x: labelCenter.x,\n        y: labelCenter.y + paddingTop\n      };\n\n      modeling.createLabel(element, labelCenter, {\n        id: businessObject.id + '_label',\n        businessObject: businessObject\n      });\n    }\n  }\n\n  function execute(ctx) {\n    ctx.oldLabel = getLabel(ctx.element);\n    return setText(ctx.element, ctx.newLabel);\n  }\n\n  function revert(ctx) {\n    return setText(ctx.element, ctx.oldLabel);\n  }\n\n  function postExecute(ctx) {\n    var element = ctx.element,\n        label = element.label || element,\n        newLabel = ctx.newLabel,\n        newBounds = ctx.newBounds,\n        hints = ctx.hints || {};\n\n    if (isLabel(label) && isEmptyText(newLabel)) {\n\n      if (hints.removeShape !== false) {\n        modeling.removeShape(label, { unsetLabel: false });\n      }\n\n      return;\n    }\n\n    // ignore internal labels for elements except text annotations\n    if (!isLabelExternal(element) && !is(element, 'bpmn:TextAnnotation')) {\n      return;\n    }\n\n    var text = getLabel(label);\n\n    // don't resize without text\n    if (!text) {\n      return;\n    }\n\n    // resize element based on label _or_ pre-defined bounds\n    if (typeof newBounds === 'undefined') {\n      newBounds = textRenderer.getExternalLabelBounds(label, text);\n    }\n\n    // setting newBounds to false or _null_ will\n    // disable the postExecute resize operation\n    if (newBounds) {\n      modeling.resizeShape(label, newBounds, NULL_DIMENSIONS);\n    }\n  }\n\n  // API\n\n  this.preExecute = preExecute;\n  this.execute = execute;\n  this.revert = revert;\n  this.postExecute = postExecute;\n}\n\nUpdateLabelHandler.$inject = [\n  'modeling',\n  'textRenderer'\n];\n\n\n// helpers ///////////////////////\n\nfunction isEmptyText(label) {\n  return !label || !label.trim();\n}","import inherits from 'inherits';\n\nimport BaseModeling from 'diagram-js/lib/features/modeling/Modeling';\n\nimport UpdatePropertiesHandler from './cmd/UpdatePropertiesHandler';\nimport UpdateCanvasRootHandler from './cmd/UpdateCanvasRootHandler';\nimport AddLaneHandler from './cmd/AddLaneHandler';\nimport SplitLaneHandler from './cmd/SplitLaneHandler';\nimport ResizeLaneHandler from './cmd/ResizeLaneHandler';\nimport UpdateFlowNodeRefsHandler from './cmd/UpdateFlowNodeRefsHandler';\nimport IdClaimHandler from './cmd/IdClaimHandler';\nimport SetColorHandler from './cmd/SetColorHandler';\n\nimport UpdateLabelHandler from '../label-editing/cmd/UpdateLabelHandler';\n\n\n/**\n * BPMN 2.0 modeling features activator\n *\n * @param {EventBus} eventBus\n * @param {ElementFactory} elementFactory\n * @param {CommandStack} commandStack\n * @param {BpmnRules} bpmnRules\n */\nexport default function Modeling(\n    eventBus, elementFactory, commandStack,\n    bpmnRules) {\n\n  BaseModeling.call(this, eventBus, elementFactory, commandStack);\n\n  this._bpmnRules = bpmnRules;\n}\n\ninherits(Modeling, BaseModeling);\n\nModeling.$inject = [\n  'eventBus',\n  'elementFactory',\n  'commandStack',\n  'bpmnRules'\n];\n\n\nModeling.prototype.getHandlers = function() {\n  var handlers = BaseModeling.prototype.getHandlers.call(this);\n\n  handlers['element.updateProperties'] = UpdatePropertiesHandler;\n  handlers['canvas.updateRoot'] = UpdateCanvasRootHandler;\n  handlers['lane.add'] = AddLaneHandler;\n  handlers['lane.resize'] = ResizeLaneHandler;\n  handlers['lane.split'] = SplitLaneHandler;\n  handlers['lane.updateRefs'] = UpdateFlowNodeRefsHandler;\n  handlers['id.updateClaim'] = IdClaimHandler;\n  handlers['element.setColor'] = SetColorHandler;\n  handlers['element.updateLabel'] = UpdateLabelHandler;\n\n  return handlers;\n};\n\n\nModeling.prototype.updateLabel = function(element, newLabel, newBounds, hints) {\n  this._commandStack.execute('element.updateLabel', {\n    element: element,\n    newLabel: newLabel,\n    newBounds: newBounds,\n    hints: hints || {}\n  });\n};\n\n\nModeling.prototype.connect = function(source, target, attrs, hints) {\n\n  var bpmnRules = this._bpmnRules;\n\n  if (!attrs) {\n    attrs = bpmnRules.canConnect(source, target);\n  }\n\n  if (!attrs) {\n    return;\n  }\n\n  return this.createConnection(source, target, attrs, source.parent, hints);\n};\n\n\nModeling.prototype.updateProperties = function(element, properties) {\n  this._commandStack.execute('element.updateProperties', {\n    element: element,\n    properties: properties\n  });\n};\n\nModeling.prototype.resizeLane = function(laneShape, newBounds, balanced) {\n  this._commandStack.execute('lane.resize', {\n    shape: laneShape,\n    newBounds: newBounds,\n    balanced: balanced\n  });\n};\n\nModeling.prototype.addLane = function(targetLaneShape, location) {\n  var context = {\n    shape: targetLaneShape,\n    location: location\n  };\n\n  this._commandStack.execute('lane.add', context);\n\n  return context.newLane;\n};\n\nModeling.prototype.splitLane = function(targetLane, count) {\n  this._commandStack.execute('lane.split', {\n    shape: targetLane,\n    count: count\n  });\n};\n\n/**\n * Transform the current diagram into a collaboration.\n *\n * @return {djs.model.Root} the new root element\n */\nModeling.prototype.makeCollaboration = function() {\n\n  var collaborationElement = this._create('root', {\n    type: 'bpmn:Collaboration'\n  });\n\n  var context = {\n    newRoot: collaborationElement\n  };\n\n  this._commandStack.execute('canvas.updateRoot', context);\n\n  return collaborationElement;\n};\n\nModeling.prototype.updateLaneRefs = function(flowNodeShapes, laneShapes) {\n\n  this._commandStack.execute('lane.updateRefs', {\n    flowNodeShapes: flowNodeShapes,\n    laneShapes: laneShapes\n  });\n};\n\n/**\n * Transform the current diagram into a process.\n *\n * @return {djs.model.Root} the new root element\n */\nModeling.prototype.makeProcess = function() {\n\n  var processElement = this._create('root', {\n    type: 'bpmn:Process'\n  });\n\n  var context = {\n    newRoot: processElement\n  };\n\n  this._commandStack.execute('canvas.updateRoot', context);\n};\n\n\nModeling.prototype.claimId = function(id, moddleElement) {\n  this._commandStack.execute('id.updateClaim', {\n    id: id,\n    element: moddleElement,\n    claiming: true\n  });\n};\n\n\nModeling.prototype.unclaimId = function(id, moddleElement) {\n  this._commandStack.execute('id.updateClaim', {\n    id: id,\n    element: moddleElement\n  });\n};\n\nModeling.prototype.setColor = function(elements, colors) {\n  if (!elements.length) {\n    elements = [ elements ];\n  }\n\n  this._commandStack.execute('element.setColor', {\n    elements: elements,\n    colors: colors\n  });\n};\n","import {\n  getMid\n} from './LayoutUtil';\n\n\n/**\n * A base connection layouter implementation\n * that layouts the connection by directly connecting\n * mid(source) + mid(target).\n */\nexport default function BaseLayouter() {}\n\n\n/**\n * Return the new layouted waypoints for the given connection.\n *\n * The connection passed is still unchanged; you may figure out about\n * the new connection start / end via the layout hints provided.\n *\n * @param {djs.model.Connection} connection\n * @param {Object} [hints]\n * @param {Point} [hints.connectionStart]\n * @param {Point} [hints.connectionEnd]\n * @param {Point} [hints.source]\n * @param {Point} [hints.target]\n *\n * @return {Array<Point>} the layouted connection waypoints\n */\nBaseLayouter.prototype.layoutConnection = function(connection, hints) {\n\n  hints = hints || {};\n\n  return [\n    hints.connectionStart || getMid(hints.source || connection.source),\n    hints.connectionEnd || getMid(hints.target || connection.target)\n  ];\n};\n","import {\n  assign,\n  find,\n  isArray,\n  without\n} from 'min-dash';\n\nimport {\n  getOrientation,\n  getMid\n} from './LayoutUtil';\n\nimport {\n  pointInRect,\n  pointDistance,\n  pointsAligned,\n  pointsOnLine\n} from '../util/Geometry';\n\nvar MIN_SEGMENT_LENGTH = 20,\n    POINT_ORIENTATION_PADDING = 5;\n\nvar round = Math.round;\n\nvar INTERSECTION_THRESHOLD = 20,\n    ORIENTATION_THRESHOLD = {\n      'h:h': 20,\n      'v:v': 20,\n      'h:v': -10,\n      'v:h': -10\n    };\n\nfunction needsTurn(orientation, startDirection) {\n  return !{\n    t: /top/,\n    r: /right/,\n    b: /bottom/,\n    l: /left/,\n    h: /./,\n    v: /./\n  }[startDirection].test(orientation);\n}\n\nfunction canLayoutStraight(direction, targetOrientation) {\n  return {\n    t: /top/,\n    r: /right/,\n    b: /bottom/,\n    l: /left/,\n    h: /left|right/,\n    v: /top|bottom/\n  }[direction].test(targetOrientation);\n}\n\nfunction getSegmentBendpoints(a, b, directions) {\n  var orientation = getOrientation(b, a, POINT_ORIENTATION_PADDING);\n\n  var startDirection = directions.split(':')[0];\n\n  var xmid = round((b.x - a.x) / 2 + a.x),\n      ymid = round((b.y - a.y) / 2 + a.y);\n\n  var segmentEnd, segmentDirections;\n\n  var layoutStraight = canLayoutStraight(startDirection, orientation),\n      layoutHorizontal = /h|r|l/.test(startDirection),\n      layoutTurn = false;\n\n  var turnNextDirections = false;\n\n  if (layoutStraight) {\n    segmentEnd = layoutHorizontal ? { x: xmid, y: a.y } : { x: a.x, y: ymid };\n\n    segmentDirections = layoutHorizontal ? 'h:h' : 'v:v';\n  } else {\n    layoutTurn = needsTurn(orientation, startDirection);\n\n    segmentDirections = layoutHorizontal ? 'h:v' : 'v:h';\n\n    if (layoutTurn) {\n\n      if (layoutHorizontal) {\n        turnNextDirections = ymid === a.y;\n\n        segmentEnd = {\n          x: a.x + MIN_SEGMENT_LENGTH * (/l/.test(startDirection) ? -1 : 1),\n          y: turnNextDirections ? ymid + MIN_SEGMENT_LENGTH : ymid\n        };\n      } else {\n        turnNextDirections = xmid === a.x;\n\n        segmentEnd = {\n          x: turnNextDirections ? xmid + MIN_SEGMENT_LENGTH : xmid,\n          y: a.y + MIN_SEGMENT_LENGTH * (/t/.test(startDirection) ? -1 : 1)\n        };\n      }\n\n    } else {\n      segmentEnd = {\n        x: xmid,\n        y: ymid\n      };\n    }\n  }\n\n  return {\n    waypoints: getBendpoints(a, segmentEnd, segmentDirections).concat(segmentEnd),\n    directions:  segmentDirections,\n    turnNextDirections: turnNextDirections\n  };\n}\n\nfunction getStartSegment(a, b, directions) {\n  return getSegmentBendpoints(a, b, directions);\n}\n\nfunction getEndSegment(a, b, directions) {\n  var invertedSegment = getSegmentBendpoints(b, a, invertDirections(directions));\n\n  return {\n    waypoints: invertedSegment.waypoints.slice().reverse(),\n    directions: invertDirections(invertedSegment.directions),\n    turnNextDirections: invertedSegment.turnNextDirections\n  };\n}\n\nfunction getMidSegment(startSegment, endSegment) {\n\n  var startDirection = startSegment.directions.split(':')[1],\n      endDirection = endSegment.directions.split(':')[0];\n\n  if (startSegment.turnNextDirections) {\n    startDirection = startDirection == 'h' ? 'v' : 'h';\n  }\n\n  if (endSegment.turnNextDirections) {\n    endDirection = endDirection == 'h' ? 'v' : 'h';\n  }\n\n  var directions = startDirection + ':' + endDirection;\n\n  var bendpoints = getBendpoints(\n    startSegment.waypoints[startSegment.waypoints.length - 1],\n    endSegment.waypoints[0],\n    directions\n  );\n\n  return {\n    waypoints: bendpoints,\n    directions: directions\n  };\n}\n\nfunction invertDirections(directions) {\n  return directions.split(':').reverse().join(':');\n}\n\n/**\n * Handle simple layouts with maximum two bendpoints.\n */\nfunction getSimpleBendpoints(a, b, directions) {\n\n  var xmid = round((b.x - a.x) / 2 + a.x),\n      ymid = round((b.y - a.y) / 2 + a.y);\n\n  // one point, right or left from a\n  if (directions === 'h:v') {\n    return [ { x: b.x, y: a.y } ];\n  }\n\n  // one point, above or below a\n  if (directions === 'v:h') {\n    return [ { x: a.x, y: b.y } ];\n  }\n\n  // vertical segment between a and b\n  if (directions === 'h:h') {\n    return [\n      { x: xmid, y: a.y },\n      { x: xmid, y: b.y }\n    ];\n  }\n\n  // horizontal segment between a and b\n  if (directions === 'v:v') {\n    return [\n      { x: a.x, y: ymid },\n      { x: b.x, y: ymid }\n    ];\n  }\n\n  throw new Error('invalid directions: can only handle varians of [hv]:[hv]');\n}\n\n\n/**\n * Returns the mid points for a manhattan connection between two points.\n *\n * @example h:h (horizontal:horizontal)\n *\n * [a]----[x]\n *         |\n *        [x]----[b]\n *\n * @example h:v (horizontal:vertical)\n *\n * [a]----[x]\n *         |\n *        [b]\n *\n * @example h:r (horizontal:right)\n *\n * [a]----[x]\n *         |\n *    [b]-[x]\n *\n * @param  {Point} a\n * @param  {Point} b\n * @param  {String} directions\n *\n * @return {Array<Point>}\n */\nfunction getBendpoints(a, b, directions) {\n  directions = directions || 'h:h';\n\n  if (!isValidDirections(directions)) {\n    throw new Error(\n      'unknown directions: <' + directions + '>: ' +\n      'must be specified as <start>:<end> ' +\n      'with start/end in { h,v,t,r,b,l }'\n    );\n  }\n\n  // compute explicit directions, involving trbl dockings\n  // using a three segmented layouting algorithm\n  if (isExplicitDirections(directions)) {\n    var startSegment = getStartSegment(a, b, directions),\n        endSegment = getEndSegment(a, b, directions),\n        midSegment = getMidSegment(startSegment, endSegment);\n\n    return [].concat(\n      startSegment.waypoints,\n      midSegment.waypoints,\n      endSegment.waypoints\n    );\n  }\n\n  // handle simple [hv]:[hv] cases that can be easily computed\n  return getSimpleBendpoints(a, b, directions);\n}\n\n/**\n * Create a connection between the two points according\n * to the manhattan layout (only horizontal and vertical) edges.\n *\n * @param {Point} a\n * @param {Point} b\n *\n * @param {String} [directions='h:h'] specifies manhattan directions for each point as {adirection}:{bdirection}.\n                   A directionfor a point is either `h` (horizontal) or `v` (vertical)\n *\n * @return {Array<Point>}\n */\nexport function connectPoints(a, b, directions) {\n\n  var points = getBendpoints(a, b, directions);\n\n  points.unshift(a);\n  points.push(b);\n\n  return withoutRedundantPoints(points);\n}\n\n\n/**\n * Connect two rectangles using a manhattan layouted connection.\n *\n * @param {Bounds} source source rectangle\n * @param {Bounds} target target rectangle\n * @param {Point} [start] source docking\n * @param {Point} [end] target docking\n *\n * @param {Object} [hints]\n * @param {String} [hints.preserveDocking=source] preserve docking on selected side\n * @param {Array<String>} [hints.preferredLayouts]\n * @param {Point|Boolean} [hints.connectionStart] whether the start changed\n * @param {Point|Boolean} [hints.connectionEnd] whether the end changed\n *\n * @return {Array<Point>} connection points\n */\nexport function connectRectangles(source, target, start, end, hints) {\n\n  var preferredLayouts = hints && hints.preferredLayouts || [];\n\n  var preferredLayout = without(preferredLayouts, 'straight')[0] || 'h:h';\n\n  var threshold = ORIENTATION_THRESHOLD[preferredLayout] || 0;\n\n  var orientation = getOrientation(source, target, threshold);\n\n  var directions = getDirections(orientation, preferredLayout);\n\n  start = start || getMid(source);\n  end = end || getMid(target);\n\n  var directionSplit = directions.split(':');\n\n  // compute actual docking points for start / end\n  // this ensures we properly layout only parts of the\n  // connection that lies in between the two rectangles\n  var startDocking = getDockingPoint(start, source, directionSplit[0], invertOrientation(orientation)),\n      endDocking = getDockingPoint(end, target, directionSplit[1], orientation);\n\n  return connectPoints(startDocking, endDocking, directions);\n}\n\n\n/**\n * Repair the connection between two rectangles, of which one has been updated.\n *\n * @param {Bounds} source\n * @param {Bounds} target\n * @param {Point} [start]\n * @param {Point} [end]\n * @param {Array<Point>} [waypoints]\n * @param {Object} [hints]\n * @param {Array<String>} [hints.preferredLayouts] list of preferred layouts\n * @param {Boolean} [hints.connectionStart]\n * @param {Boolean} [hints.connectionEnd]\n *\n * @return {Array<Point>} repaired waypoints\n */\nexport function repairConnection(source, target, start, end, waypoints, hints) {\n\n  if (isArray(start)) {\n    waypoints = start;\n    hints = end;\n\n    start = getMid(source);\n    end = getMid(target);\n  }\n\n  hints = assign({ preferredLayouts: [] }, hints);\n  waypoints = waypoints || [];\n\n  var preferredLayouts = hints.preferredLayouts,\n      preferStraight = preferredLayouts.indexOf('straight') !== -1,\n      repairedWaypoints;\n\n  // just layout non-existing or simple connections\n  // attempt to render straight lines, if required\n\n  // attempt to layout a straight line\n  repairedWaypoints = preferStraight && tryLayoutStraight(source, target, start, end, hints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // try to layout from end\n  repairedWaypoints = hints.connectionEnd && tryRepairConnectionEnd(target, source, end, waypoints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // try to layout from start\n  repairedWaypoints = hints.connectionStart && tryRepairConnectionStart(source, target, start, waypoints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // or whether nothing seems to have changed\n  if (!hints.connectionStart && !hints.connectionEnd && waypoints && waypoints.length) {\n    return waypoints;\n  }\n\n  // simply reconnect if nothing else worked\n  return connectRectangles(source, target, start, end, hints);\n}\n\n\nfunction inRange(a, start, end) {\n  return a >= start && a <= end;\n}\n\nfunction isInRange(axis, a, b) {\n  var size = {\n    x: 'width',\n    y: 'height'\n  };\n\n  return inRange(a[axis], b[axis], b[axis] + b[size[axis]]);\n}\n\n/**\n * Layout a straight connection\n *\n * @param {Bounds} source\n * @param {Bounds} target\n * @param {Point} start\n * @param {Point} end\n * @param {Object} [hints]\n *\n * @return {Array<Point>|null} waypoints if straight layout worked\n */\nexport function tryLayoutStraight(source, target, start, end, hints) {\n  var axis = {},\n      primaryAxis,\n      orientation;\n\n  orientation = getOrientation(source, target);\n\n  // only layout a straight connection if shapes are\n  // horizontally or vertically aligned\n  if (!/^(top|bottom|left|right)$/.test(orientation)) {\n    return null;\n  }\n\n  if (/top|bottom/.test(orientation)) {\n    primaryAxis = 'x';\n  }\n\n  if (/left|right/.test(orientation)) {\n    primaryAxis = 'y';\n  }\n\n  if (hints.preserveDocking === 'target') {\n\n    if (!isInRange(primaryAxis, end, source)) {\n      return null;\n    }\n\n    axis[primaryAxis] = end[primaryAxis];\n\n    return [\n      {\n        x: axis.x !== undefined ? axis.x : start.x,\n        y: axis.y !== undefined ? axis.y : start.y,\n        original: {\n          x: axis.x !== undefined ? axis.x : start.x,\n          y: axis.y !== undefined ? axis.y : start.y\n        }\n      },\n      {\n        x: end.x,\n        y: end.y\n      }\n    ];\n\n  } else {\n\n    if (!isInRange(primaryAxis, start, target)) {\n      return null;\n    }\n\n    axis[primaryAxis] = start[primaryAxis];\n\n    return [\n      {\n        x: start.x,\n        y: start.y\n      },\n      {\n        x: axis.x !== undefined ? axis.x : end.x,\n        y: axis.y !== undefined ? axis.y : end.y,\n        original: {\n          x: axis.x !== undefined ? axis.x : end.x,\n          y: axis.y !== undefined ? axis.y : end.y\n        }\n      }\n    ];\n  }\n\n}\n\n/**\n * Repair a connection from start.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>|null} the repaired points between the two rectangles\n */\nfunction tryRepairConnectionStart(moved, other, newDocking, points) {\n  return _tryRepairConnectionSide(moved, other, newDocking, points);\n}\n\n/**\n * Repair a connection from end.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>|null} the repaired points between the two rectangles\n */\nfunction tryRepairConnectionEnd(moved, other, newDocking, points) {\n  var waypoints = points.slice().reverse();\n\n  waypoints = _tryRepairConnectionSide(moved, other, newDocking, waypoints);\n\n  return waypoints ? waypoints.reverse() : null;\n}\n\n/**\n * Repair a connection from one side that moved.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>} the repaired points between the two rectangles\n */\nfunction _tryRepairConnectionSide(moved, other, newDocking, points) {\n\n  function needsRelayout(points) {\n    if (points.length < 3) {\n      return true;\n    }\n\n    if (points.length > 4) {\n      return false;\n    }\n\n    // relayout if two points overlap\n    // this is most likely due to\n    return !!find(points, function(p, idx) {\n      var q = points[idx - 1];\n\n      return q && pointDistance(p, q) < 3;\n    });\n  }\n\n  function repairBendpoint(candidate, oldPeer, newPeer) {\n\n    var alignment = pointsAligned(oldPeer, candidate);\n\n    switch (alignment) {\n    case 'v':\n\n      // repair horizontal alignment\n      return { x: newPeer.x, y: candidate.y };\n    case 'h':\n\n      // repair vertical alignment\n      return { x: candidate.x, y: newPeer.y };\n    }\n\n    return { x: candidate.x, y: candidate. y };\n  }\n\n  function removeOverlapping(points, a, b) {\n    var i;\n\n    for (i = points.length - 2; i !== 0; i--) {\n\n      // intersects (?) break, remove all bendpoints up to this one and relayout\n      if (pointInRect(points[i], a, INTERSECTION_THRESHOLD) ||\n          pointInRect(points[i], b, INTERSECTION_THRESHOLD)) {\n\n        // return sliced old connection\n        return points.slice(i);\n      }\n    }\n\n    return points;\n  }\n\n  // (0) only repair what has layoutable bendpoints\n\n  // (1) if only one bendpoint and on shape moved onto other shapes axis\n  //     (horizontally / vertically), relayout\n\n  if (needsRelayout(points)) {\n    return null;\n  }\n\n  var oldDocking = points[0],\n      newPoints = points.slice(),\n      slicedPoints;\n\n  // (2) repair only last line segment and only if it was layouted before\n\n  newPoints[0] = newDocking;\n  newPoints[1] = repairBendpoint(newPoints[1], oldDocking, newDocking);\n\n\n  // (3) if shape intersects with any bendpoint after repair,\n  //     remove all segments up to this bendpoint and repair from there\n  slicedPoints = removeOverlapping(newPoints, moved, other);\n\n  if (slicedPoints !== newPoints) {\n    newPoints = _tryRepairConnectionSide(moved, other, newDocking, slicedPoints);\n  }\n\n  // (4) do NOT repair if repaired bendpoints are aligned\n  if (newPoints && pointsAligned(newPoints)) {\n    return null;\n  }\n\n  return newPoints;\n}\n\n\n/**\n * Returns the manhattan directions connecting two rectangles\n * with the given orientation.\n *\n * Will always return the default layout, if it is specific\n * regarding sides already (trbl).\n *\n * @example\n *\n * getDirections('top'); // -> 'v:v'\n * getDirections('intersect'); // -> 't:t'\n *\n * getDirections('top-right', 'v:h'); // -> 'v:h'\n * getDirections('top-right', 'h:h'); // -> 'h:h'\n *\n *\n * @param {String} orientation\n * @param {String} defaultLayout\n *\n * @return {String}\n */\nfunction getDirections(orientation, defaultLayout) {\n\n  // don't override specific trbl directions\n  if (isExplicitDirections(defaultLayout)) {\n    return defaultLayout;\n  }\n\n  switch (orientation) {\n  case 'intersect':\n    return 't:t';\n\n  case 'top':\n  case 'bottom':\n    return 'v:v';\n\n  case 'left':\n  case 'right':\n    return 'h:h';\n\n  // 'top-left'\n  // 'top-right'\n  // 'bottom-left'\n  // 'bottom-right'\n  default:\n    return defaultLayout;\n  }\n}\n\nfunction isValidDirections(directions) {\n  return directions && /^h|v|t|r|b|l:h|v|t|r|b|l$/.test(directions);\n}\n\nfunction isExplicitDirections(directions) {\n  return directions && /t|r|b|l/.test(directions);\n}\n\nfunction invertOrientation(orientation) {\n  return {\n    'top': 'bottom',\n    'bottom': 'top',\n    'left': 'right',\n    'right': 'left',\n    'top-left': 'bottom-right',\n    'bottom-right': 'top-left',\n    'top-right': 'bottom-left',\n    'bottom-left': 'top-right',\n  }[orientation];\n}\n\nfunction getDockingPoint(point, rectangle, dockingDirection, targetOrientation) {\n\n  // ensure we end up with a specific docking direction\n  // based on the targetOrientation, if <h|v> is being passed\n\n  if (dockingDirection === 'h') {\n    dockingDirection = /left/.test(targetOrientation) ? 'l' : 'r';\n  }\n\n  if (dockingDirection === 'v') {\n    dockingDirection = /top/.test(targetOrientation) ? 't' : 'b';\n  }\n\n  if (dockingDirection === 't') {\n    return { original: point, x: point.x, y: rectangle.y };\n  }\n\n  if (dockingDirection === 'r') {\n    return { original: point, x: rectangle.x + rectangle.width, y: point.y };\n  }\n\n  if (dockingDirection === 'b') {\n    return { original: point, x: point.x, y: rectangle.y + rectangle.height };\n  }\n\n  if (dockingDirection === 'l') {\n    return { original: point, x: rectangle.x, y: point.y };\n  }\n\n  throw new Error('unexpected dockingDirection: <' + dockingDirection + '>');\n}\n\n\n/**\n * Return list of waypoints with redundant ones filtered out.\n *\n * @example\n *\n * Original points:\n *\n *   [x] ----- [x] ------ [x]\n *                         |\n *                        [x] ----- [x] - [x]\n *\n * Filtered:\n *\n *   [x] ---------------- [x]\n *                         |\n *                        [x] ----------- [x]\n *\n * @param  {Array<Point>} waypoints\n *\n * @return {Array<Point>}\n */\nexport function withoutRedundantPoints(waypoints) {\n  return waypoints.reduce(function(points, p, idx) {\n\n    var previous = points[points.length - 1],\n        next = waypoints[idx + 1];\n\n    if (!pointsOnLine(previous, next, p, 0)) {\n      points.push(p);\n    }\n\n    return points;\n  }, []);\n}\n","import inherits from 'inherits';\n\nimport {\n  assign\n} from 'min-dash';\n\nimport BaseLayouter from 'diagram-js/lib/layout/BaseLayouter';\n\nimport {\n  repairConnection,\n  withoutRedundantPoints\n} from 'diagram-js/lib/layout/ManhattanLayout';\n\nimport {\n  getMid,\n  getOrientation\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  isExpanded\n} from '../../util/DiUtil';\n\nimport { is } from '../../util/ModelUtil';\n\nvar ATTACH_ORIENTATION_PADDING = -10,\n    BOUNDARY_TO_HOST_THRESHOLD = 40;\n\nvar oppositeOrientationMapping = {\n  'top': 'bottom',\n  'top-right': 'bottom-left',\n  'top-left': 'bottom-right',\n  'right': 'left',\n  'bottom': 'top',\n  'bottom-right': 'top-left',\n  'bottom-left': 'top-right',\n  'left': 'right'\n};\n\nvar orientationDirectionMapping = {\n  top: 't',\n  right: 'r',\n  bottom: 'b',\n  left: 'l'\n};\n\n\nexport default function BpmnLayouter() {}\n\ninherits(BpmnLayouter, BaseLayouter);\n\n\nBpmnLayouter.prototype.layoutConnection = function(connection, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  var source = hints.source || connection.source,\n      target = hints.target || connection.target,\n      waypoints = hints.waypoints || connection.waypoints,\n      connectionStart = hints.connectionStart,\n      connectionEnd = hints.connectionEnd;\n\n  var manhattanOptions,\n      updatedWaypoints;\n\n  if (!connectionStart) {\n    connectionStart = getConnectionDocking(waypoints && waypoints[ 0 ], source);\n  }\n\n  if (!connectionEnd) {\n    connectionEnd = getConnectionDocking(waypoints && waypoints[ waypoints.length - 1 ], target);\n  }\n\n  // TODO(nikku): support vertical modeling\n  // and invert preferredLayouts accordingly\n\n  if (is(connection, 'bpmn:Association') ||\n      is(connection, 'bpmn:DataAssociation')) {\n\n    if (waypoints && !isCompensationAssociation(source, target)) {\n      return [].concat([ connectionStart ], waypoints.slice(1, -1), [ connectionEnd ]);\n    }\n  }\n\n  if (is(connection, 'bpmn:MessageFlow')) {\n    manhattanOptions = getMessageFlowManhattanOptions(source, target);\n  } else if (is(connection, 'bpmn:SequenceFlow') || isCompensationAssociation(source, target)) {\n\n    // layout all connection between flow elements h:h, except for\n    // (1) outgoing of boundary events -> layout based on attach orientation and target orientation\n    // (2) incoming/outgoing of gateways -> v:h for outgoing, h:v for incoming\n    // (3) loops\n    if (source === target) {\n      manhattanOptions = {\n        preferredLayouts: getLoopPreferredLayout(source, connection)\n      };\n    } else if (is(source, 'bpmn:BoundaryEvent')) {\n      manhattanOptions = {\n        preferredLayouts: getBoundaryEventPreferredLayouts(source, target, connectionEnd)\n      };\n    } else if (is(source, 'bpmn:Gateway')) {\n      manhattanOptions = {\n        preferredLayouts: [ 'v:h' ]\n      };\n    } else if (is(target, 'bpmn:Gateway')) {\n      manhattanOptions = {\n        preferredLayouts: [ 'h:v' ]\n      };\n    } else {\n      manhattanOptions = {\n        preferredLayouts: [ 'h:h' ]\n      };\n    }\n  }\n\n  if (manhattanOptions) {\n    manhattanOptions = assign(manhattanOptions, hints);\n\n    updatedWaypoints = withoutRedundantPoints(repairConnection(\n      source,\n      target,\n      connectionStart,\n      connectionEnd,\n      waypoints,\n      manhattanOptions\n    ));\n  }\n\n  return updatedWaypoints || [ connectionStart, connectionEnd ];\n};\n\n\n// helpers //////////\n\nfunction getAttachOrientation(attachedElement) {\n  var hostElement = attachedElement.host;\n\n  return getOrientation(getMid(attachedElement), hostElement, ATTACH_ORIENTATION_PADDING);\n}\n\nfunction getMessageFlowManhattanOptions(source, target) {\n  return {\n    preferredLayouts: [ 'straight', 'v:v' ],\n    preserveDocking: getMessageFlowPreserveDocking(source, target)\n  };\n}\n\nfunction getMessageFlowPreserveDocking(source, target) {\n\n  // (1) docking element connected to participant has precedence\n  if (is(target, 'bpmn:Participant')) {\n    return 'source';\n  }\n\n  if (is(source, 'bpmn:Participant')) {\n    return 'target';\n  }\n\n  // (2) docking element connected to expanded sub-process has precedence\n  if (isExpandedSubProcess(target)) {\n    return 'source';\n  }\n\n  if (isExpandedSubProcess(source)) {\n    return 'target';\n  }\n\n  // (3) docking event has precedence\n  if (is(target, 'bpmn:Event')) {\n    return 'target';\n  }\n\n  if (is(source, 'bpmn:Event')) {\n    return 'source';\n  }\n\n  return null;\n}\n\nfunction getConnectionDocking(point, shape) {\n  return point ? (point.original || point) : getMid(shape);\n}\n\nfunction isCompensationAssociation(source, target) {\n  return is(target, 'bpmn:Activity') &&\n    is(source, 'bpmn:BoundaryEvent') &&\n    target.businessObject.isForCompensation;\n}\n\nfunction isExpandedSubProcess(element) {\n  return is(element, 'bpmn:SubProcess') && isExpanded(element);\n}\n\nfunction isSame(a, b) {\n  return a === b;\n}\n\nfunction isAnyOrientation(orientation, orientations) {\n  return orientations.indexOf(orientation) !== -1;\n}\n\nfunction getHorizontalOrientation(orientation) {\n  var matches = /right|left/.exec(orientation);\n\n  return matches && matches[0];\n}\n\nfunction getVerticalOrientation(orientation) {\n  var matches = /top|bottom/.exec(orientation);\n\n  return matches && matches[0];\n}\n\nfunction isOppositeOrientation(a, b) {\n  return oppositeOrientationMapping[a] === b;\n}\n\nfunction isOppositeHorizontalOrientation(a, b) {\n  var horizontalOrientation = getHorizontalOrientation(a);\n\n  var oppositeHorizontalOrientation = oppositeOrientationMapping[horizontalOrientation];\n\n  return b.indexOf(oppositeHorizontalOrientation) !== -1;\n}\n\nfunction isOppositeVerticalOrientation(a, b) {\n  var verticalOrientation = getVerticalOrientation(a);\n\n  var oppositeVerticalOrientation = oppositeOrientationMapping[verticalOrientation];\n\n  return b.indexOf(oppositeVerticalOrientation) !== -1;\n}\n\nfunction isHorizontalOrientation(orientation) {\n  return orientation === 'right' || orientation === 'left';\n}\n\nfunction getLoopPreferredLayout(source, connection) {\n  var waypoints = connection.waypoints;\n\n  var orientation = waypoints && waypoints.length && getOrientation(waypoints[0], source);\n\n  if (orientation === 'top') {\n    return [ 't:r' ];\n  } else if (orientation === 'right') {\n    return [ 'r:b' ];\n  } else if (orientation === 'left') {\n    return [ 'l:t' ];\n  }\n\n  return [ 'b:l' ];\n}\n\nfunction getBoundaryEventPreferredLayouts(source, target, end) {\n  var sourceMid = getMid(source),\n      targetMid = getMid(target),\n      attachOrientation = getAttachOrientation(source),\n      sourceLayout,\n      targetLayout;\n\n  var isLoop = isSame(source.host, target);\n\n  var attachedToSide = isAnyOrientation(attachOrientation, [ 'top', 'right', 'bottom', 'left' ]);\n\n  var targetOrientation = getOrientation(targetMid, sourceMid, {\n    x: source.width / 2 + target.width / 2,\n    y: source.height / 2 + target.height / 2\n  });\n\n  if (isLoop) {\n    return getBoundaryEventLoopLayout(attachOrientation, attachedToSide, source, target, end);\n  }\n\n  // source layout\n  sourceLayout = getBoundaryEventSourceLayout(attachOrientation, targetOrientation, attachedToSide);\n\n  // target layout\n  targetLayout = getBoundaryEventTargetLayout(attachOrientation, targetOrientation, attachedToSide);\n\n  return [ sourceLayout + ':' + targetLayout ];\n}\n\nfunction getBoundaryEventLoopLayout(attachOrientation, attachedToSide, source, target, end) {\n  var orientation = attachedToSide ? attachOrientation : getVerticalOrientation(attachOrientation),\n      sourceLayout = orientationDirectionMapping[ orientation ],\n      targetLayout;\n\n  if (attachedToSide) {\n    if (isHorizontalOrientation(attachOrientation)) {\n      targetLayout = shouldConnectToSameSide('y', source, target, end) ? 'h' : 'b';\n    } else {\n      targetLayout = shouldConnectToSameSide('x', source, target, end) ? 'v' : 'l';\n    }\n  } else {\n    targetLayout = 'v';\n  }\n\n  return [ sourceLayout + ':' + targetLayout ];\n}\n\nfunction shouldConnectToSameSide(axis, source, target, end) {\n  var threshold = BOUNDARY_TO_HOST_THRESHOLD;\n\n  return !(\n    areCloseOnAxis(axis, end, target, threshold) ||\n    areCloseOnAxis(axis, end, {\n      x: target.x + target.width,\n      y: target.y + target.height\n    }, threshold) ||\n    areCloseOnAxis(axis, end, getMid(source), threshold)\n  );\n}\n\nfunction areCloseOnAxis(axis, a, b, threshold) {\n  return Math.abs(a[ axis ] - b[ axis ]) < threshold;\n}\n\nfunction getBoundaryEventSourceLayout(attachOrientation, targetOrientation, attachedToSide) {\n\n  // attached to either top, right, bottom or left side\n  if (attachedToSide) {\n    return orientationDirectionMapping[ attachOrientation ];\n  }\n\n  // attached to either top-right, top-left, bottom-right or bottom-left corner\n\n  // same vertical or opposite horizontal orientation\n  if (isSame(\n    getVerticalOrientation(attachOrientation), getVerticalOrientation(targetOrientation)\n  ) || isOppositeOrientation(\n    getHorizontalOrientation(attachOrientation), getHorizontalOrientation(targetOrientation)\n  )) {\n    return orientationDirectionMapping[ getVerticalOrientation(attachOrientation) ];\n  }\n\n  // fallback\n  return orientationDirectionMapping[ getHorizontalOrientation(attachOrientation) ];\n}\n\nfunction getBoundaryEventTargetLayout(attachOrientation, targetOrientation, attachedToSide) {\n\n  // attached to either top, right, bottom or left side\n  if (attachedToSide) {\n    if (isHorizontalOrientation(attachOrientation)) {\n\n      // orientation is right or left\n\n      // opposite horizontal orientation or same orientation\n      if (\n        isOppositeHorizontalOrientation(attachOrientation, targetOrientation) ||\n        isSame(attachOrientation, targetOrientation)\n      ) {\n        return 'h';\n      }\n\n      // fallback\n      return 'v';\n    } else {\n\n      // orientation is top or bottom\n\n      // opposite vertical orientation or same orientation\n      if (\n        isOppositeVerticalOrientation(attachOrientation, targetOrientation) ||\n        isSame(attachOrientation, targetOrientation)\n      ) {\n        return 'v';\n      }\n\n      // fallback\n      return 'h';\n    }\n  }\n\n  // attached to either top-right, top-left, bottom-right or bottom-left corner\n\n  // orientation is right, left\n  // or same vertical orientation but also right or left\n  if (isHorizontalOrientation(targetOrientation) ||\n    (isSame(getVerticalOrientation(attachOrientation), getVerticalOrientation(targetOrientation)) &&\n      getHorizontalOrientation(targetOrientation))) {\n    return 'h';\n  } else {\n    return 'v';\n  }\n}\n","import {\n  assign\n} from 'min-dash';\n\nimport {\n  getElementLineIntersection\n} from './LayoutUtil';\n\n\nfunction dockingToPoint(docking) {\n\n  // use the dockings actual point and\n  // retain the original docking\n  return assign({ original: docking.point.original || docking.point }, docking.actual);\n}\n\n\n/**\n * A {@link ConnectionDocking} that crops connection waypoints based on\n * the path(s) of the connection source and target.\n *\n * @param {djs.core.ElementRegistry} elementRegistry\n */\nexport default function CroppingConnectionDocking(elementRegistry, graphicsFactory) {\n  this._elementRegistry = elementRegistry;\n  this._graphicsFactory = graphicsFactory;\n}\n\nCroppingConnectionDocking.$inject = [ 'elementRegistry', 'graphicsFactory' ];\n\n\n/**\n * @inheritDoc ConnectionDocking#getCroppedWaypoints\n */\nCroppingConnectionDocking.prototype.getCroppedWaypoints = function(connection, source, target) {\n\n  source = source || connection.source;\n  target = target || connection.target;\n\n  var sourceDocking = this.getDockingPoint(connection, source, true),\n      targetDocking = this.getDockingPoint(connection, target);\n\n  var croppedWaypoints = connection.waypoints.slice(sourceDocking.idx + 1, targetDocking.idx);\n\n  croppedWaypoints.unshift(dockingToPoint(sourceDocking));\n  croppedWaypoints.push(dockingToPoint(targetDocking));\n\n  return croppedWaypoints;\n};\n\n/**\n * Return the connection docking point on the specified shape\n *\n * @inheritDoc ConnectionDocking#getDockingPoint\n */\nCroppingConnectionDocking.prototype.getDockingPoint = function(connection, shape, dockStart) {\n\n  var waypoints = connection.waypoints,\n      dockingIdx,\n      dockingPoint,\n      croppedPoint;\n\n  dockingIdx = dockStart ? 0 : waypoints.length - 1;\n  dockingPoint = waypoints[dockingIdx];\n\n  croppedPoint = this._getIntersection(shape, connection, dockStart);\n\n  return {\n    point: dockingPoint,\n    actual: croppedPoint || dockingPoint,\n    idx: dockingIdx\n  };\n};\n\n\n// helpers //////////////////////\n\nCroppingConnectionDocking.prototype._getIntersection = function(shape, connection, takeFirst) {\n\n  var shapePath = this._getShapePath(shape),\n      connectionPath = this._getConnectionPath(connection);\n\n  return getElementLineIntersection(shapePath, connectionPath, takeFirst);\n};\n\nCroppingConnectionDocking.prototype._getConnectionPath = function(connection) {\n  return this._graphicsFactory.getConnectionPath(connection);\n};\n\nCroppingConnectionDocking.prototype._getShapePath = function(shape) {\n  return this._graphicsFactory.getShapePath(shape);\n};\n\nCroppingConnectionDocking.prototype._getGfx = function(element) {\n  return this._elementRegistry.getGraphics(element);\n};\n","import BehaviorModule from './behavior';\nimport RulesModule from '../rules';\nimport OrderingModule from '../ordering';\nimport ReplaceModule from '../replace';\n\nimport CommandModule from 'diagram-js/lib/command';\nimport TooltipsModule from 'diagram-js/lib/features/tooltips';\nimport LabelSupportModule from 'diagram-js/lib/features/label-support';\nimport AttachSupportModule from 'diagram-js/lib/features/attach-support';\nimport SelectionModule from 'diagram-js/lib/features/selection';\nimport ChangeSupportModule from 'diagram-js/lib/features/change-support';\nimport SpaceToolModule from 'diagram-js/lib/features/space-tool';\n\nimport BpmnFactory from './BpmnFactory';\nimport BpmnUpdater from './BpmnUpdater';\nimport ElementFactory from './ElementFactory';\nimport Modeling from './Modeling';\nimport BpmnLayouter from './BpmnLayouter';\nimport CroppingConnectionDocking from 'diagram-js/lib/layout/CroppingConnectionDocking';\n\n\nexport default {\n  __init__: [\n    'modeling',\n    'bpmnUpdater'\n  ],\n  __depends__: [\n    BehaviorModule,\n    RulesModule,\n    OrderingModule,\n    ReplaceModule,\n    CommandModule,\n    TooltipsModule,\n    LabelSupportModule,\n    AttachSupportModule,\n    SelectionModule,\n    ChangeSupportModule,\n    SpaceToolModule\n  ],\n  bpmnFactory: [ 'type', BpmnFactory ],\n  bpmnUpdater: [ 'type', BpmnUpdater ],\n  elementFactory: [ 'type', ElementFactory ],\n  modeling: [ 'type', Modeling ],\n  layouter: [ 'type', BpmnLayouter ],\n  connectionDocking: [ 'type', CroppingConnectionDocking ]\n};","import {\n  assign,\n  filter,\n  groupBy,\n  isObject\n} from 'min-dash';\n\nvar LOW_PRIORITY = 500,\n    MEDIUM_PRIORITY = 1250,\n    HIGH_PRIORITY = 1500;\n\nimport { getOriginal as getOriginalEvent } from '../../util/Event';\n\nvar round = Math.round;\n\nfunction mid(element) {\n  return {\n    x: element.x + round(element.width / 2),\n    y: element.y + round(element.height / 2)\n  };\n}\n\n/**\n * A plugin that makes shapes draggable / droppable.\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {Modeling} modeling\n * @param {Selection} selection\n * @param {Rules} rules\n */\nexport default function MoveEvents(\n    eventBus, dragging, modeling,\n    selection, rules) {\n\n  // rules\n\n  function canMove(shapes, delta, position, target) {\n\n    return rules.allowed('elements.move', {\n      shapes: shapes,\n      delta: delta,\n      position: position,\n      target: target\n    });\n  }\n\n\n  // move events\n\n  // assign a high priority to this handler to setup the environment\n  // others may hook up later, e.g. at default priority and modify\n  // the move environment.\n  //\n  // This sets up the context with\n  //\n  // * shape: the primary shape being moved\n  // * shapes: a list of shapes to be moved\n  // * validatedShapes: a list of shapes that are being checked\n  //                    against the rules before and during move\n  //\n  eventBus.on('shape.move.start', HIGH_PRIORITY, function(event) {\n\n    var context = event.context,\n        shape = event.shape,\n        shapes = selection.get().slice();\n\n    // move only single shape if the dragged element\n    // is not part of the current selection\n    if (shapes.indexOf(shape) === -1) {\n      shapes = [ shape ];\n    }\n\n    // ensure we remove nested elements in the collection\n    // and add attachers for a proper dragger\n    shapes = removeNested(shapes);\n\n    // attach shapes to drag context\n    assign(context, {\n      shapes: shapes,\n      validatedShapes: shapes,\n      shape: shape\n    });\n  });\n\n\n  // assign a high priority to this handler to setup the environment\n  // others may hook up later, e.g. at default priority and modify\n  // the move environment\n  //\n  eventBus.on('shape.move.start', MEDIUM_PRIORITY, function(event) {\n\n    var context = event.context,\n        validatedShapes = context.validatedShapes,\n        canExecute;\n\n    canExecute = context.canExecute = canMove(validatedShapes);\n\n    // check if we can move the elements\n    if (!canExecute) {\n      return false;\n    }\n  });\n\n  // assign a low priority to this handler\n  // to let others modify the move event before we update\n  // the context\n  //\n  eventBus.on('shape.move.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        validatedShapes = context.validatedShapes,\n        hover = event.hover,\n        delta = { x: event.dx, y: event.dy },\n        position = { x: event.x, y: event.y },\n        canExecute;\n\n    // check if we can move the elements\n    canExecute = canMove(validatedShapes, delta, position, hover);\n\n    context.delta = delta;\n    context.canExecute = canExecute;\n\n    // simply ignore move over\n    if (canExecute === null) {\n      context.target = null;\n\n      return;\n    }\n\n    context.target = hover;\n  });\n\n  eventBus.on('shape.move.end', function(event) {\n\n    var context = event.context;\n\n    var delta = context.delta,\n        canExecute = context.canExecute,\n        isAttach = canExecute === 'attach',\n        shapes = context.shapes;\n\n    if (canExecute === false) {\n      return false;\n    }\n\n    // ensure we have actual pixel values deltas\n    // (important when zoom level was > 1 during move)\n    delta.x = round(delta.x);\n    delta.y = round(delta.y);\n\n    if (delta.x === 0 && delta.y === 0) {\n\n      // didn't move\n      return;\n    }\n\n    modeling.moveElements(shapes, delta, context.target, {\n      primaryShape: context.shape,\n      attach: isAttach\n    });\n  });\n\n\n  // move activation\n\n  eventBus.on('element.mousedown', function(event) {\n\n    var originalEvent = getOriginalEvent(event);\n\n    if (!originalEvent) {\n      throw new Error('must supply DOM mousedown event');\n    }\n\n    return start(originalEvent, event.element);\n  });\n\n  /**\n   * Start move.\n   *\n   * @param {MouseEvent} event\n   * @param {djs.model.Shape} shape\n   * @param {boolean} [activate]\n   * @param {Object} [context]\n   */\n  function start(event, element, activate, context) {\n    if (isObject(activate)) {\n      context = activate;\n      activate = false;\n    }\n\n    // do not move connections or the root element\n    if (element.waypoints || !element.parent) {\n      return;\n    }\n\n    var referencePoint = mid(element);\n\n    dragging.init(event, referencePoint, 'shape.move', {\n      cursor: 'grabbing',\n      autoActivate: activate,\n      data: {\n        shape: element,\n        context: context || {}\n      }\n    });\n\n    // we've handled the event\n    return true;\n  }\n\n  // API\n\n  this.start = start;\n}\n\nMoveEvents.$inject = [\n  'eventBus',\n  'dragging',\n  'modeling',\n  'selection',\n  'rules'\n];\n\n\n/**\n * Return a filtered list of elements that do not contain\n * those nested into others.\n *\n * @param  {Array<djs.model.Base>} elements\n *\n * @return {Array<djs.model.Base>} filtered\n */\nfunction removeNested(elements) {\n\n  var ids = groupBy(elements, 'id');\n\n  return filter(elements, function(element) {\n    while ((element = element.parent)) {\n\n      // parent in selection\n      if (ids[element.id]) {\n        return false;\n      }\n    }\n\n    return true;\n  });\n}\n","import {\n  flatten,\n  forEach,\n  filter,\n  find,\n  groupBy,\n  map,\n  matchPattern,\n  size\n} from 'min-dash';\n\nimport {\n  selfAndAllChildren\n} from '../../util/Elements';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport { translate } from '../../util/SvgTransformUtil';\n\nvar LOW_PRIORITY = 499;\n\nvar MARKER_DRAGGING = 'djs-dragging',\n    MARKER_OK = 'drop-ok',\n    MARKER_NOT_OK = 'drop-not-ok',\n    MARKER_NEW_PARENT = 'new-parent',\n    MARKER_ATTACH = 'attach-ok';\n\n\n/**\n * Provides previews for moving shapes when moving.\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n * @param {Canvas} canvas\n * @param {Styles} styles\n */\nexport default function MovePreview(\n    eventBus, canvas, styles, previewSupport) {\n\n  function getVisualDragShapes(shapes) {\n    var elements = getAllDraggedElements(shapes);\n\n    var filteredElements = removeEdges(elements);\n\n    return filteredElements;\n  }\n\n  function getAllDraggedElements(shapes) {\n    var allShapes = selfAndAllChildren(shapes, true);\n\n    var allConnections = map(allShapes, function(shape) {\n      return (shape.incoming || []).concat(shape.outgoing || []);\n    });\n\n    return flatten(allShapes.concat(allConnections));\n  }\n\n  /**\n   * Sets drop marker on an element.\n   */\n  function setMarker(element, marker) {\n\n    [ MARKER_ATTACH, MARKER_OK, MARKER_NOT_OK, MARKER_NEW_PARENT ].forEach(function(m) {\n\n      if (m === marker) {\n        canvas.addMarker(element, m);\n      } else {\n        canvas.removeMarker(element, m);\n      }\n    });\n  }\n\n  /**\n   * Make an element draggable.\n   *\n   * @param {Object} context\n   * @param {djs.model.Base} element\n   * @param {Boolean} addMarker\n   */\n  function makeDraggable(context, element, addMarker) {\n\n    previewSupport.addDragger(element, context.dragGroup);\n\n    if (addMarker) {\n      canvas.addMarker(element, MARKER_DRAGGING);\n    }\n\n    if (context.allDraggedElements) {\n      context.allDraggedElements.push(element);\n    } else {\n      context.allDraggedElements = [ element ];\n    }\n  }\n\n  // assign a low priority to this handler\n  // to let others modify the move context before\n  // we draw things\n  eventBus.on('shape.move.start', LOW_PRIORITY, function(event) {\n    var context = event.context,\n        dragShapes = context.shapes,\n        allDraggedElements = context.allDraggedElements;\n\n    var visuallyDraggedShapes = getVisualDragShapes(dragShapes);\n\n    if (!context.dragGroup) {\n      var dragGroup = svgCreate('g');\n\n      svgAttr(dragGroup, styles.cls('djs-drag-group', [ 'no-events' ]));\n\n      var defaultLayer = canvas.getDefaultLayer();\n\n      svgAppend(defaultLayer, dragGroup);\n\n      context.dragGroup = dragGroup;\n    }\n\n    // add previews\n    visuallyDraggedShapes.forEach(function(shape) {\n      previewSupport.addDragger(shape, context.dragGroup);\n    });\n\n    // cache all dragged elements / gfx\n    // so that we can quickly undo their state changes later\n    if (!allDraggedElements) {\n      allDraggedElements = getAllDraggedElements(dragShapes);\n    } else {\n      allDraggedElements = flatten([\n        allDraggedElements,\n        getAllDraggedElements(dragShapes)\n      ]);\n    }\n\n    // add dragging marker\n    forEach(allDraggedElements, function(e) {\n      canvas.addMarker(e, MARKER_DRAGGING);\n    });\n\n    context.allDraggedElements = allDraggedElements;\n\n    // determine, if any of the dragged elements have different parents\n    context.differentParents = haveDifferentParents(dragShapes);\n  });\n\n  // update previews\n  eventBus.on('shape.move.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        dragGroup = context.dragGroup,\n        target = context.target,\n        parent = context.shape.parent,\n        canExecute = context.canExecute;\n\n    if (target) {\n      if (canExecute === 'attach') {\n        setMarker(target, MARKER_ATTACH);\n      } else if (context.canExecute && target && target.id !== parent.id) {\n        setMarker(target, MARKER_NEW_PARENT);\n      } else {\n        setMarker(target, context.canExecute ? MARKER_OK : MARKER_NOT_OK);\n      }\n    }\n\n    translate(dragGroup, event.dx, event.dy);\n  });\n\n  eventBus.on([ 'shape.move.out', 'shape.move.cleanup' ], function(event) {\n    var context = event.context,\n        target = context.target;\n\n    if (target) {\n      setMarker(target, null);\n    }\n  });\n\n  // remove previews\n  eventBus.on('shape.move.cleanup', function(event) {\n\n    var context = event.context,\n        allDraggedElements = context.allDraggedElements,\n        dragGroup = context.dragGroup;\n\n\n    // remove dragging marker\n    forEach(allDraggedElements, function(e) {\n      canvas.removeMarker(e, MARKER_DRAGGING);\n    });\n\n    if (dragGroup) {\n      svgRemove(dragGroup);\n    }\n  });\n\n\n  // API //////////////////////\n\n  /**\n   * Make an element draggable.\n   *\n   * @param {Object} context\n   * @param {djs.model.Base} element\n   * @param {Boolean} addMarker\n   */\n  this.makeDraggable = makeDraggable;\n}\n\nMovePreview.$inject = [\n  'eventBus',\n  'canvas',\n  'styles',\n  'previewSupport'\n];\n\n\n// helpers //////////////////////\n\n/**\n * returns elements minus all connections\n * where source or target is not elements\n */\nfunction removeEdges(elements) {\n\n  var filteredElements = filter(elements, function(element) {\n\n    if (!isConnection(element)) {\n      return true;\n    } else {\n\n      return (\n        find(elements, matchPattern({ id: element.source.id })) &&\n        find(elements, matchPattern({ id: element.target.id }))\n      );\n    }\n  });\n\n  return filteredElements;\n}\n\nfunction haveDifferentParents(elements) {\n  return size(groupBy(elements, function(e) { return e.parent && e.parent.id; })) !== 1;\n}\n\n/**\n * Checks if an element is a connection.\n */\nfunction isConnection(element) {\n  return element.waypoints;\n}\n","import InteractionEventsModule from '../interaction-events';\nimport SelectionModule from '../selection';\nimport OutlineModule from '../outline';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport PreviewSupportModule from '../preview-support';\n\nimport Move from './Move';\nimport MovePreview from './MovePreview';\n\nexport default {\n  __depends__: [\n    InteractionEventsModule,\n    SelectionModule,\n    OutlineModule,\n    RulesModule,\n    DraggingModule,\n    PreviewSupportModule\n  ],\n  __init__: [\n    'move',\n    'movePreview'\n  ],\n  move: [ 'type', Move ],\n  movePreview: [ 'type', MovePreview ]\n};\n","import {\n  isArray,\n  isFunction,\n  forEach\n} from 'min-dash';\n\nimport {\n  domify,\n  query as domQuery,\n  attr as domAttr,\n  clear as domClear,\n  classes as domClasses,\n  matches as domMatches,\n  delegate as domDelegate,\n  event as domEvent\n} from 'min-dom';\n\n\nvar TOGGLE_SELECTOR = '.djs-palette-toggle',\n    ENTRY_SELECTOR = '.entry',\n    ELEMENT_SELECTOR = TOGGLE_SELECTOR + ', ' + ENTRY_SELECTOR;\n\nvar PALETTE_OPEN_CLS = 'open',\n    PALETTE_TWO_COLUMN_CLS = 'two-column';\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A palette containing modeling elements.\n */\nexport default function Palette(eventBus, canvas) {\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n\n  var self = this;\n\n  eventBus.on('tool-manager.update', function(event) {\n    var tool = event.tool;\n\n    self.updateToolHighlight(tool);\n  });\n\n  eventBus.on('i18n.changed', function() {\n    self._update();\n  });\n\n  eventBus.on('diagram.init', function() {\n\n    self._diagramInitialized = true;\n\n    self._rebuild();\n  });\n}\n\nPalette.$inject = [ 'eventBus', 'canvas' ];\n\n\n/**\n * Register a provider with the palette\n *\n * @param  {Number} [priority=1000]\n * @param  {PaletteProvider} provider\n *\n * @example\n * const paletteProvider = {\n *   getPaletteEntries: function() {\n *     return function(entries) {\n *       return {\n *         ...entries,\n *         'entry-1': {\n *           label: 'My Entry',\n *           action: function() { alert(\"I have been clicked!\"); }\n *         }\n *       };\n *     }\n *   }\n * };\n *\n * palette.registerProvider(800, paletteProvider);\n */\nPalette.prototype.registerProvider = function(priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on('palette.getProviders', priority, function(event) {\n    event.providers.push(provider);\n  });\n\n  this._rebuild();\n};\n\n\n/**\n * Returns the palette entries\n *\n * @return {Object<string, PaletteEntryDescriptor>} map of entries\n */\nPalette.prototype.getEntries = function() {\n  var providers = this._getProviders();\n\n  return providers.reduce(addPaletteEntries, {});\n};\n\nPalette.prototype._rebuild = function() {\n\n  if (!this._diagramInitialized) {\n    return;\n  }\n\n  var providers = this._getProviders();\n\n  if (!providers.length) {\n    return;\n  }\n\n  if (!this._container) {\n    this._init();\n  }\n\n  this._update();\n};\n\n/**\n * Initialize\n */\nPalette.prototype._init = function() {\n\n  var self = this;\n\n  var eventBus = this._eventBus;\n\n  var parentContainer = this._getParentContainer();\n\n  var container = this._container = domify(Palette.HTML_MARKUP);\n\n  parentContainer.appendChild(container);\n\n  domDelegate.bind(container, ELEMENT_SELECTOR, 'click', function(event) {\n\n    var target = event.delegateTarget;\n\n    if (domMatches(target, TOGGLE_SELECTOR)) {\n      return self.toggle();\n    }\n\n    self.trigger('click', event);\n  });\n\n  // prevent drag propagation\n  domEvent.bind(container, 'mousedown', function(event) {\n    event.stopPropagation();\n  });\n\n  // prevent drag propagation\n  domDelegate.bind(container, ENTRY_SELECTOR, 'dragstart', function(event) {\n    self.trigger('dragstart', event);\n  });\n\n  eventBus.on('canvas.resized', this._layoutChanged, this);\n\n  eventBus.fire('palette.create', {\n    container: container\n  });\n};\n\nPalette.prototype._getProviders = function(id) {\n\n  var event = this._eventBus.createEvent({\n    type: 'palette.getProviders',\n    providers: []\n  });\n\n  this._eventBus.fire(event);\n\n  return event.providers;\n};\n\n/**\n * Update palette state.\n *\n * @param  {Object} [state] { open, twoColumn }\n */\nPalette.prototype._toggleState = function(state) {\n\n  state = state || {};\n\n  var parent = this._getParentContainer(),\n      container = this._container;\n\n  var eventBus = this._eventBus;\n\n  var twoColumn;\n\n  var cls = domClasses(container);\n\n  if ('twoColumn' in state) {\n    twoColumn = state.twoColumn;\n  } else {\n    twoColumn = this._needsCollapse(parent.clientHeight, this._entries || {});\n  }\n\n  // always update two column\n  cls.toggle(PALETTE_TWO_COLUMN_CLS, twoColumn);\n\n  if ('open' in state) {\n    cls.toggle(PALETTE_OPEN_CLS, state.open);\n  }\n\n  eventBus.fire('palette.changed', {\n    twoColumn: twoColumn,\n    open: this.isOpen()\n  });\n};\n\nPalette.prototype._update = function() {\n\n  var entriesContainer = domQuery('.djs-palette-entries', this._container),\n      entries = this._entries = this.getEntries();\n\n  domClear(entriesContainer);\n\n  forEach(entries, function(entry, id) {\n\n    var grouping = entry.group || 'default';\n\n    var container = domQuery('[data-group=' + grouping + ']', entriesContainer);\n    if (!container) {\n      container = domify('<div class=\"group\" data-group=\"' + grouping + '\"></div>');\n      entriesContainer.appendChild(container);\n    }\n\n    var html = entry.html || (\n      entry.separator ?\n        '<hr class=\"separator\" />' :\n        '<div class=\"entry\" draggable=\"true\"></div>');\n\n\n    var control = domify(html);\n    container.appendChild(control);\n\n    if (!entry.separator) {\n      domAttr(control, 'data-action', id);\n\n      if (entry.title) {\n        domAttr(control, 'title', entry.title);\n      }\n\n      if (entry.className) {\n        addClasses(control, entry.className);\n      }\n\n      if (entry.imageUrl) {\n        control.appendChild(domify('<img src=\"' + entry.imageUrl + '\">'));\n      }\n    }\n  });\n\n  // open after update\n  this.open();\n};\n\n\n/**\n * Trigger an action available on the palette\n *\n * @param  {String} action\n * @param  {Event} event\n */\nPalette.prototype.trigger = function(action, event, autoActivate) {\n  var entries = this._entries,\n      entry,\n      handler,\n      originalEvent,\n      button = event.delegateTarget || event.target;\n\n  if (!button) {\n    return event.preventDefault();\n  }\n\n  entry = entries[domAttr(button, 'data-action')];\n\n  // when user clicks on the palette and not on an action\n  if (!entry) {\n    return;\n  }\n\n  handler = entry.action;\n\n  originalEvent = event.originalEvent || event;\n\n  // simple action (via callback function)\n  if (isFunction(handler)) {\n    if (action === 'click') {\n      handler(originalEvent, autoActivate);\n    }\n  } else {\n    if (handler[action]) {\n      handler[action](originalEvent, autoActivate);\n    }\n  }\n\n  // silence other actions\n  event.preventDefault();\n};\n\nPalette.prototype._layoutChanged = function() {\n  this._toggleState({});\n};\n\n/**\n * Do we need to collapse to two columns?\n *\n * @param {Number} availableHeight\n * @param {Object} entries\n *\n * @return {Boolean}\n */\nPalette.prototype._needsCollapse = function(availableHeight, entries) {\n\n  // top margin + bottom toggle + bottom margin\n  // implementors must override this method if they\n  // change the palette styles\n  var margin = 20 + 10 + 20;\n\n  var entriesHeight = Object.keys(entries).length * 46;\n\n  return availableHeight < entriesHeight + margin;\n};\n\n/**\n * Close the palette\n */\nPalette.prototype.close = function() {\n\n  this._toggleState({\n    open: false,\n    twoColumn: false\n  });\n};\n\n\n/**\n * Open the palette\n */\nPalette.prototype.open = function() {\n  this._toggleState({ open: true });\n};\n\n\nPalette.prototype.toggle = function(open) {\n  if (this.isOpen()) {\n    this.close();\n  } else {\n    this.open();\n  }\n};\n\nPalette.prototype.isActiveTool = function(tool) {\n  return tool && this._activeTool === tool;\n};\n\nPalette.prototype.updateToolHighlight = function(name) {\n  var entriesContainer,\n      toolsContainer;\n\n  if (!this._toolsContainer) {\n    entriesContainer = domQuery('.djs-palette-entries', this._container);\n\n    this._toolsContainer = domQuery('[data-group=tools]', entriesContainer);\n  }\n\n  toolsContainer = this._toolsContainer;\n\n  forEach(toolsContainer.children, function(tool) {\n    var actionName = tool.getAttribute('data-action');\n\n    if (!actionName) {\n      return;\n    }\n\n    var toolClasses = domClasses(tool);\n\n    actionName = actionName.replace('-tool', '');\n\n    if (toolClasses.contains('entry') && actionName === name) {\n      toolClasses.add('highlighted-entry');\n    } else {\n      toolClasses.remove('highlighted-entry');\n    }\n  });\n};\n\n\n/**\n * Return true if the palette is opened.\n *\n * @example\n *\n * palette.open();\n *\n * if (palette.isOpen()) {\n *   // yes, we are open\n * }\n *\n * @return {boolean} true if palette is opened\n */\nPalette.prototype.isOpen = function() {\n  return domClasses(this._container).has(PALETTE_OPEN_CLS);\n};\n\n/**\n * Get container the palette lives in.\n *\n * @return {Element}\n */\nPalette.prototype._getParentContainer = function() {\n  return this._canvas.getContainer();\n};\n\n\n/* markup definition */\n\nPalette.HTML_MARKUP =\n  '<div class=\"djs-palette\">' +\n    '<div class=\"djs-palette-entries\"></div>' +\n    '<div class=\"djs-palette-toggle\"></div>' +\n  '</div>';\n\n\n// helpers //////////////////////\n\nfunction addClasses(element, classNames) {\n\n  var classes = domClasses(element);\n\n  var actualClassNames = isArray(classNames) ? classNames : classNames.split(/\\s+/g);\n  actualClassNames.forEach(function(cls) {\n    classes.add(cls);\n  });\n}\n\nfunction addPaletteEntries(entries, provider) {\n\n  var entriesOrUpdater = provider.getPaletteEntries();\n\n  if (isFunction(entriesOrUpdater)) {\n    return entriesOrUpdater(entries);\n  }\n\n  forEach(entriesOrUpdater, function(entry, id) {\n    entries[id] = entry;\n  });\n\n  return entries;\n}","import Palette from './Palette';\n\nexport default {\n  __init__: [ 'palette' ],\n  palette: [ 'type', Palette ]\n};\n","import { values } from 'min-dash';\n\nimport { getEnclosedElements } from '../../util/Elements';\n\nimport { hasSecondaryModifier } from '../../util/Mouse';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nvar LASSO_TOOL_CURSOR = 'crosshair';\n\n\nexport default function LassoTool(\n    eventBus, canvas, dragging,\n    elementRegistry, selection, toolManager) {\n\n  this._selection = selection;\n  this._dragging = dragging;\n\n  var self = this;\n\n  // lasso visuals implementation\n\n  /**\n  * A helper that realizes the selection box visual\n  */\n  var visuals = {\n\n    create: function(context) {\n      var container = canvas.getDefaultLayer(),\n          frame;\n\n      frame = context.frame = svgCreate('rect');\n      svgAttr(frame, {\n        class: 'djs-lasso-overlay',\n        width:  1,\n        height: 1,\n        x: 0,\n        y: 0\n      });\n\n      svgAppend(container, frame);\n    },\n\n    update: function(context) {\n      var frame = context.frame,\n          bbox = context.bbox;\n\n      svgAttr(frame, {\n        x: bbox.x,\n        y: bbox.y,\n        width: bbox.width,\n        height: bbox.height\n      });\n    },\n\n    remove: function(context) {\n\n      if (context.frame) {\n        svgRemove(context.frame);\n      }\n    }\n  };\n\n  toolManager.registerTool('lasso', {\n    tool: 'lasso.selection',\n    dragging: 'lasso'\n  });\n\n  eventBus.on('lasso.selection.end', function(event) {\n    var target = event.originalEvent.target;\n\n    // only reactive on diagram click\n    // on some occasions, event.hover is not set and we have to check if the target is an svg\n    if (!event.hover && !(target instanceof SVGElement)) {\n      return;\n    }\n\n    eventBus.once('lasso.selection.ended', function() {\n      self.activateLasso(event.originalEvent, true);\n    });\n  });\n\n  // lasso interaction implementation\n\n  eventBus.on('lasso.end', function(event) {\n\n    var bbox = toBBox(event);\n\n    var elements = elementRegistry.filter(function(element) {\n      return element;\n    });\n\n    self.select(elements, bbox);\n  });\n\n  eventBus.on('lasso.start', function(event) {\n\n    var context = event.context;\n\n    context.bbox = toBBox(event);\n    visuals.create(context);\n  });\n\n  eventBus.on('lasso.move', function(event) {\n\n    var context = event.context;\n\n    context.bbox = toBBox(event);\n    visuals.update(context);\n  });\n\n  eventBus.on('lasso.cleanup', function(event) {\n\n    var context = event.context;\n\n    visuals.remove(context);\n  });\n\n\n  // event integration\n\n  eventBus.on('element.mousedown', 1500, function(event) {\n\n    if (hasSecondaryModifier(event)) {\n      self.activateLasso(event.originalEvent);\n\n      // we've handled the event\n      return true;\n    }\n  });\n}\n\nLassoTool.$inject = [\n  'eventBus',\n  'canvas',\n  'dragging',\n  'elementRegistry',\n  'selection',\n  'toolManager'\n];\n\n\nLassoTool.prototype.activateLasso = function(event, autoActivate) {\n\n  this._dragging.init(event, 'lasso', {\n    autoActivate: autoActivate,\n    cursor: LASSO_TOOL_CURSOR,\n    data: {\n      context: {}\n    }\n  });\n};\n\nLassoTool.prototype.activateSelection = function(event) {\n\n  this._dragging.init(event, 'lasso.selection', {\n    trapClick: false,\n    cursor: LASSO_TOOL_CURSOR,\n    data: {\n      context: {}\n    }\n  });\n};\n\nLassoTool.prototype.select = function(elements, bbox) {\n  var selectedElements = getEnclosedElements(elements, bbox);\n\n  this._selection.select(values(selectedElements));\n};\n\nLassoTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.activateSelection();\n  }\n};\n\nLassoTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^lasso/.test(context.prefix);\n};\n\n\n\nfunction toBBox(event) {\n\n  var start = {\n\n    x: event.x - event.dx,\n    y: event.y - event.dy\n  };\n\n  var end = {\n    x: event.x,\n    y: event.y\n  };\n\n  var bbox;\n\n  if ((start.x <= end.x && start.y < end.y) ||\n      (start.x < end.x && start.y <= end.y)) {\n\n    bbox = {\n      x: start.x,\n      y: start.y,\n      width:  end.x - start.x,\n      height: end.y - start.y\n    };\n  } else if ((start.x >= end.x && start.y < end.y) ||\n             (start.x > end.x && start.y <= end.y)) {\n\n    bbox = {\n      x: end.x,\n      y: start.y,\n      width:  start.x - end.x,\n      height: end.y - start.y\n    };\n  } else if ((start.x <= end.x && start.y > end.y) ||\n             (start.x < end.x && start.y >= end.y)) {\n\n    bbox = {\n      x: start.x,\n      y: end.y,\n      width:  end.x - start.x,\n      height: start.y - end.y\n    };\n  } else if ((start.x >= end.x && start.y > end.y) ||\n             (start.x > end.x && start.y >= end.y)) {\n\n    bbox = {\n      x: end.x,\n      y: end.y,\n      width:  start.x - end.x,\n      height: start.y - end.y\n    };\n  } else {\n\n    bbox = {\n      x: end.x,\n      y: end.y,\n      width:  0,\n      height: 0\n    };\n  }\n  return bbox;\n}\n","import ToolManagerModule from '../tool-manager';\n\nimport LassoTool from './LassoTool';\n\nexport default {\n  __depends__: [\n    ToolManagerModule\n  ],\n  __init__: [ 'lassoTool' ],\n  lassoTool: [ 'type', LassoTool ]\n};\n","import { hasPrimaryModifier } from '../../util/Mouse';\n\nimport { isKey } from '../../features/keyboard/KeyboardUtil';\n\nvar HIGH_PRIORITY = 1500;\nvar HAND_CURSOR = 'grab';\n\n\nexport default function HandTool(eventBus, canvas, dragging, injector, toolManager) {\n  this._dragging = dragging;\n\n  var self = this,\n      keyboard = injector.get('keyboard', false);\n\n  toolManager.registerTool('hand', {\n    tool: 'hand',\n    dragging: 'hand.move'\n  });\n\n  eventBus.on('element.mousedown', HIGH_PRIORITY, function(event) {\n    if (hasPrimaryModifier(event)) {\n      this.activateMove(event.originalEvent);\n\n      return false;\n    }\n  }, this);\n\n  keyboard && keyboard.addListener(HIGH_PRIORITY, function(e) {\n    if (!isSpace(e.keyEvent)) {\n      return;\n    }\n\n    if (self.isActive()) {\n      return;\n    }\n\n    function activateMove(event) {\n      self.activateMove(event);\n\n      window.removeEventListener('mousemove', activateMove);\n    }\n\n    window.addEventListener('mousemove', activateMove);\n\n    function deactivateMove(e) {\n      if (!isSpace(e.keyEvent)) {\n        return;\n      }\n\n      window.removeEventListener('mousemove', activateMove);\n\n      keyboard.removeListener(deactivateMove, 'keyboard.keyup');\n\n      dragging.cancel();\n    }\n\n    keyboard.addListener(HIGH_PRIORITY, deactivateMove, 'keyboard.keyup');\n  }, 'keyboard.keydown');\n\n  eventBus.on('hand.end', function(event) {\n    var target = event.originalEvent.target;\n\n    // only reactive on diagram click\n    // on some occasions, event.hover is not set and we have to check if the target is an svg\n    if (!event.hover && !(target instanceof SVGElement)) {\n      return false;\n    }\n\n    eventBus.once('hand.ended', function() {\n      this.activateMove(event.originalEvent, { reactivate: true });\n    }, this);\n\n  }, this);\n\n\n  eventBus.on('hand.move.move', function(event) {\n    var scale = canvas.viewbox().scale;\n\n    canvas.scroll({\n      dx: event.dx * scale,\n      dy: event.dy * scale\n    });\n  });\n\n  eventBus.on('hand.move.end', function(event) {\n    var context = event.context,\n        reactivate = context.reactivate;\n\n    // Don't reactivate if the user is using the keyboard keybinding\n    if (!hasPrimaryModifier(event) && reactivate) {\n\n      eventBus.once('hand.move.ended', function(event) {\n        this.activateHand(event.originalEvent, true, true);\n      }, this);\n\n    }\n\n    return false;\n  }, this);\n\n}\n\nHandTool.$inject = [\n  'eventBus',\n  'canvas',\n  'dragging',\n  'injector',\n  'toolManager'\n];\n\n\nHandTool.prototype.activateMove = function(event, autoActivate, context) {\n  if (typeof autoActivate === 'object') {\n    context = autoActivate;\n    autoActivate = false;\n  }\n\n  this._dragging.init(event, 'hand.move', {\n    autoActivate: autoActivate,\n    cursor: HAND_CURSOR,\n    data: {\n      context: context || {}\n    }\n  });\n};\n\nHandTool.prototype.activateHand = function(event, autoActivate, reactivate) {\n  this._dragging.init(event, 'hand', {\n    trapClick: false,\n    autoActivate: autoActivate,\n    cursor: HAND_CURSOR,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    }\n  });\n};\n\nHandTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.activateHand();\n  }\n};\n\nHandTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  if (context) {\n    return /^(hand|hand\\.move)$/.test(context.prefix);\n  }\n\n  return false;\n};\n\n// helpers //////////\n\nfunction isSpace(keyEvent) {\n  return isKey(' ', keyEvent);\n}","import ToolManagerModule from '../tool-manager';\n\nimport HandTool from './HandTool';\n\nexport default {\n  __depends__: [\n    ToolManagerModule\n  ],\n  __init__: [ 'handTool' ],\n  handTool: [ 'type', HandTool ]\n};\n","var MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok';\n\n/**\n * @class\n * @constructor\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {Connect} connect\n * @param {Canvas} canvas\n * @param {ToolManager} toolManager\n * @param {Rules} rules\n */\nexport default function GlobalConnect(\n    eventBus, dragging, connect,\n    canvas, toolManager, rules) {\n\n  var self = this;\n\n  this._dragging = dragging;\n  this._rules = rules;\n\n  toolManager.registerTool('global-connect', {\n    tool: 'global-connect',\n    dragging: 'global-connect.drag'\n  });\n\n  eventBus.on('global-connect.hover', function(event) {\n    var context = event.context,\n        startTarget = event.hover;\n\n    var canStartConnect = context.canStartConnect = self.canStartConnect(startTarget);\n\n    // simply ignore hover\n    if (canStartConnect === null) {\n      return;\n    }\n\n    context.startTarget = startTarget;\n\n    canvas.addMarker(startTarget, canStartConnect ? MARKER_OK : MARKER_NOT_OK);\n  });\n\n\n  eventBus.on([ 'global-connect.out', 'global-connect.cleanup' ], function(event) {\n    var startTarget = event.context.startTarget,\n        canStartConnect = event.context.canStartConnect;\n\n    if (startTarget) {\n      canvas.removeMarker(startTarget, canStartConnect ? MARKER_OK : MARKER_NOT_OK);\n    }\n  });\n\n\n  eventBus.on([ 'global-connect.ended' ], function(event) {\n    var context = event.context,\n        startTarget = context.startTarget,\n        startPosition = {\n          x: event.x,\n          y: event.y\n        };\n\n    var canStartConnect = self.canStartConnect(startTarget);\n\n    if (!canStartConnect) {\n      return;\n    }\n\n    eventBus.once('element.out', function() {\n      eventBus.once([ 'connect.ended', 'connect.canceled' ], function() {\n        eventBus.fire('global-connect.drag.ended');\n      });\n\n      connect.start(null, startTarget, startPosition);\n    });\n\n    return false;\n  });\n}\n\nGlobalConnect.$inject = [\n  'eventBus',\n  'dragging',\n  'connect',\n  'canvas',\n  'toolManager',\n  'rules'\n];\n\n/**\n * Initiates tool activity.\n */\nGlobalConnect.prototype.start = function(event) {\n  this._dragging.init(event, 'global-connect', {\n    trapClick: false,\n    data: {\n      context: {}\n    }\n  });\n};\n\nGlobalConnect.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.start();\n  }\n};\n\nGlobalConnect.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^global-connect/.test(context.prefix);\n};\n\n/**\n * Check if source shape can initiate connection.\n *\n * @param  {Shape} startTarget\n * @return {Boolean}\n */\nGlobalConnect.prototype.canStartConnect = function(startTarget) {\n  return this._rules.allowed('connection.start', { source: startTarget });\n};\n","import ConnectModule from '../connect';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport ToolManagerModule from '../tool-manager';\n\nimport GlobalConnect from './GlobalConnect';\n\nexport default {\n  __depends__: [\n    ConnectModule,\n    RulesModule,\n    DraggingModule,\n    ToolManagerModule\n  ],\n  globalConnect: [ 'type', GlobalConnect ]\n};\n","import {\n  assign\n} from 'min-dash';\n\n\n/**\n * A palette provider for BPMN 2.0 elements.\n */\nexport default function PaletteProvider(\n    palette, create, elementFactory,\n    spaceTool, lassoTool, handTool,\n    globalConnect, translate) {\n\n  this._palette = palette;\n  this._create = create;\n  this._elementFactory = elementFactory;\n  this._spaceTool = spaceTool;\n  this._lassoTool = lassoTool;\n  this._handTool = handTool;\n  this._globalConnect = globalConnect;\n  this._translate = translate;\n\n  palette.registerProvider(this);\n}\n\nPaletteProvider.$inject = [\n  'palette',\n  'create',\n  'elementFactory',\n  'spaceTool',\n  'lassoTool',\n  'handTool',\n  'globalConnect',\n  'translate'\n];\n\n\nPaletteProvider.prototype.getPaletteEntries = function(element) {\n\n  var actions = {},\n      create = this._create,\n      elementFactory = this._elementFactory,\n      spaceTool = this._spaceTool,\n      lassoTool = this._lassoTool,\n      handTool = this._handTool,\n      globalConnect = this._globalConnect,\n      translate = this._translate;\n\n  function createAction(type, group, className, title, options) {\n\n    function createListener(event) {\n      var shape = elementFactory.createShape(assign({ type: type }, options));\n\n      if (options) {\n        shape.businessObject.di.isExpanded = options.isExpanded;\n      }\n\n      create.start(event, shape);\n    }\n\n    var shortType = type.replace(/^bpmn:/, '');\n\n    return {\n      group: group,\n      className: className,\n      title: title || translate('Create {type}', { type: shortType }),\n      action: {\n        dragstart: createListener,\n        click: createListener\n      }\n    };\n  }\n\n  function createSubprocess(event) {\n    var subProcess = elementFactory.createShape({\n      type: 'bpmn:SubProcess',\n      x: 0,\n      y: 0,\n      isExpanded: true\n    });\n\n    var startEvent = elementFactory.createShape({\n      type: 'bpmn:StartEvent',\n      x: 40,\n      y: 82,\n      parent: subProcess\n    });\n\n    create.start(event, [ subProcess, startEvent ], {\n      hints: {\n        autoSelect: [ startEvent ]\n      }\n    });\n  }\n\n  function createParticipant(event) {\n    create.start(event, elementFactory.createParticipantShape());\n  }\n\n  assign(actions, {\n    'hand-tool': {\n      group: 'tools',\n      className: 'bpmn-icon-hand-tool',\n      title: translate('Activate the hand tool'),\n      action: {\n        click: function(event) {\n          handTool.activateHand(event);\n        }\n      }\n    },\n    'lasso-tool': {\n      group: 'tools',\n      className: 'bpmn-icon-lasso-tool',\n      title: translate('Activate the lasso tool'),\n      action: {\n        click: function(event) {\n          lassoTool.activateSelection(event);\n        }\n      }\n    },\n    'space-tool': {\n      group: 'tools',\n      className: 'bpmn-icon-space-tool',\n      title: translate('Activate the create/remove space tool'),\n      action: {\n        click: function(event) {\n          spaceTool.activateSelection(event);\n        }\n      }\n    },\n    'global-connect-tool': {\n      group: 'tools',\n      className: 'bpmn-icon-connection-multi',\n      title: translate('Activate the global connect tool'),\n      action: {\n        click: function(event) {\n          globalConnect.toggle(event);\n        }\n      }\n    },\n    'tool-separator': {\n      group: 'tools',\n      separator: true\n    },\n    'create.start-event': createAction(\n      'bpmn:StartEvent', 'event', 'bpmn-icon-start-event-none',\n      translate('Create StartEvent')\n    ),\n    'create.intermediate-event': createAction(\n      'bpmn:IntermediateThrowEvent', 'event', 'bpmn-icon-intermediate-event-none',\n      translate('Create Intermediate/Boundary Event')\n    ),\n    'create.end-event': createAction(\n      'bpmn:EndEvent', 'event', 'bpmn-icon-end-event-none',\n      translate('Create EndEvent')\n    ),\n    'create.exclusive-gateway': createAction(\n      'bpmn:ExclusiveGateway', 'gateway', 'bpmn-icon-gateway-none',\n      translate('Create Gateway')\n    ),\n    'create.task': createAction(\n      'bpmn:Task', 'activity', 'bpmn-icon-task',\n      translate('Create Task')\n    ),\n    'create.data-object': createAction(\n      'bpmn:DataObjectReference', 'data-object', 'bpmn-icon-data-object',\n      translate('Create DataObjectReference')\n    ),\n    'create.data-store': createAction(\n      'bpmn:DataStoreReference', 'data-store', 'bpmn-icon-data-store',\n      translate('Create DataStoreReference')\n    ),\n    'create.subprocess-expanded': {\n      group: 'activity',\n      className: 'bpmn-icon-subprocess-expanded',\n      title: translate('Create expanded SubProcess'),\n      action: {\n        dragstart: createSubprocess,\n        click: createSubprocess\n      }\n    },\n    'create.participant-expanded': {\n      group: 'collaboration',\n      className: 'bpmn-icon-participant',\n      title: translate('Create Pool/Participant'),\n      action: {\n        dragstart: createParticipant,\n        click: createParticipant\n      }\n    },\n    'create.group': createAction(\n      'bpmn:Group', 'artifact', 'bpmn-icon-group',\n      translate('Create Group')\n    ),\n  });\n\n  return actions;\n};\n","import PaletteModule from 'diagram-js/lib/features/palette';\nimport CreateModule from 'diagram-js/lib/features/create';\nimport SpaceToolModule from 'diagram-js/lib/features/space-tool';\nimport LassoToolModule from 'diagram-js/lib/features/lasso-tool';\nimport HandToolModule from 'diagram-js/lib/features/hand-tool';\nimport GlobalConnectModule from 'diagram-js/lib/features/global-connect';\nimport translate from 'diagram-js/lib/i18n/translate';\n\nimport PaletteProvider from './PaletteProvider';\n\nexport default {\n  __depends__: [\n    PaletteModule,\n    CreateModule,\n    SpaceToolModule,\n    LassoToolModule,\n    HandToolModule,\n    GlobalConnectModule,\n    translate\n  ],\n  __init__: [ 'paletteProvider' ],\n  paletteProvider: [ 'type', PaletteProvider ]\n};\n","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport inherits from 'inherits';\n\nimport cssEscape from 'css.escape';\n\nimport {\n  assign,\n  forEach\n} from 'min-dash';\n\nimport {\n  query as domQuery\n} from 'min-dom';\n\nimport {\n  attr as svgAttr\n} from 'tiny-svg';\n\nvar LOW_PRIORITY = 250;\n\n\nexport default function BpmnReplacePreview(\n    eventBus, elementRegistry, elementFactory,\n    canvas, previewSupport) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Replace the visuals of all elements in the context which can be replaced\n   *\n   * @param  {Object} context\n   */\n  function replaceVisual(context) {\n\n    var replacements = context.canExecute.replacements;\n\n    forEach(replacements, function(replacement) {\n\n      var id = replacement.oldElementId;\n\n      var newElement = {\n        type: replacement.newElementType\n      };\n\n      // if the visual of the element is already replaced\n      if (context.visualReplacements[id]) {\n        return;\n      }\n\n      var element = elementRegistry.get(id);\n\n      assign(newElement, { x: element.x, y: element.y });\n\n      // create a temporary shape\n      var tempShape = elementFactory.createShape(newElement);\n\n      canvas.addShape(tempShape, element.parent);\n\n      // select the original SVG element related to the element and hide it\n      var gfx = domQuery('[data-element-id=\"' + cssEscape(element.id) + '\"]', context.dragGroup);\n\n      if (gfx) {\n        svgAttr(gfx, { display: 'none' });\n      }\n\n      // clone the gfx of the temporary shape and add it to the drag group\n      var dragger = previewSupport.addDragger(tempShape, context.dragGroup);\n\n      context.visualReplacements[id] = dragger;\n\n      canvas.removeShape(tempShape);\n    });\n  }\n\n  /**\n   * Restore the original visuals of the previously replaced elements\n   *\n   * @param  {Object} context\n   */\n  function restoreVisual(context) {\n\n    var visualReplacements = context.visualReplacements;\n\n    forEach(visualReplacements, function(dragger, id) {\n\n      var originalGfx = domQuery('[data-element-id=\"' + cssEscape(id) + '\"]', context.dragGroup);\n\n      if (originalGfx) {\n        svgAttr(originalGfx, { display: 'inline' });\n      }\n\n      dragger.remove();\n\n      if (visualReplacements[id]) {\n        delete visualReplacements[id];\n      }\n    });\n  }\n\n  eventBus.on('shape.move.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        canExecute = context.canExecute;\n\n    if (!context.visualReplacements) {\n      context.visualReplacements = {};\n    }\n\n    if (canExecute && canExecute.replacements) {\n      replaceVisual(context);\n    } else {\n      restoreVisual(context);\n    }\n  });\n}\n\nBpmnReplacePreview.$inject = [\n  'eventBus',\n  'elementRegistry',\n  'elementFactory',\n  'canvas',\n  'previewSupport'\n];\n\ninherits(BpmnReplacePreview, CommandInterceptor);","import PreviewSupportModule from 'diagram-js/lib/features/preview-support';\n\nimport BpmnReplacePreview from './BpmnReplacePreview';\n\nexport default {\n  __depends__: [\n    PreviewSupportModule\n  ],\n  __init__: [ 'bpmnReplacePreview' ],\n  bpmnReplacePreview: [ 'type', BpmnReplacePreview ]\n};\n","import {\r\n  mid,\r\n  setSnapped\r\n} from 'diagram-js/lib/features/snapping/SnapUtil';\r\n\r\nimport { isCmd } from 'diagram-js/lib/features/keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  getOrientation\r\n} from 'diagram-js/lib/layout/LayoutUtil';\r\n\r\nimport { is } from '../../util/ModelUtil';\r\n\r\nimport { isAny } from '../modeling/util/ModelingUtil';\r\n\r\nimport { some } from 'min-dash';\r\n\r\nvar HIGHER_PRIORITY = 1250;\r\n\r\nvar BOUNDARY_TO_HOST_THRESHOLD = 40;\r\n\r\nvar TARGET_BOUNDS_PADDING = 20,\r\n    TASK_BOUNDS_PADDING = 10;\r\n\r\nvar TARGET_CENTER_PADDING = 20;\r\n\r\nvar AXES = [ 'x', 'y' ];\r\n\r\nvar abs = Math.abs;\r\n\r\n/**\r\n * Snap during connect.\r\n *\r\n * @param {EventBus} eventBus\r\n */\r\nexport default function BpmnConnectSnapping(eventBus) {\r\n  eventBus.on([\r\n    'connect.hover',\r\n    'connect.move',\r\n    'connect.end',\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        canExecute = context.canExecute,\r\n        start = context.start,\r\n        hover = context.hover,\r\n        source = context.source,\r\n        target = context.target;\r\n\r\n    // do NOT snap on CMD\r\n    if (event.originalEvent && isCmd(event.originalEvent)) {\r\n      return;\r\n    }\r\n\r\n    if (!context.initialConnectionStart) {\r\n      context.initialConnectionStart = context.connectionStart;\r\n    }\r\n\r\n    // snap hover\r\n    if (canExecute && hover) {\r\n      snapToShape(event, hover, getTargetBoundsPadding(hover));\r\n    }\r\n\r\n    if (hover && isAnyType(canExecute, [\r\n      'bpmn:Association',\r\n      'bpmn:DataInputAssociation',\r\n      'bpmn:DataOutputAssociation',\r\n      'bpmn:SequenceFlow'\r\n    ])) {\r\n      context.connectionStart = mid(start);\r\n\r\n      // snap hover\r\n      if (isAny(hover, [ 'bpmn:Event', 'bpmn:Gateway' ])) {\r\n        snapToPosition(event, mid(hover));\r\n      }\r\n\r\n      // snap hover\r\n      if (isAny(hover, [ 'bpmn:Task', 'bpmn:SubProcess' ])) {\r\n        snapToTargetMid(event, hover);\r\n      }\r\n\r\n      // snap source and target\r\n      if (is(source, 'bpmn:BoundaryEvent') && target === source.host) {\r\n        snapBoundaryEventLoop(event);\r\n      }\r\n\r\n    } else if (isType(canExecute, 'bpmn:MessageFlow')) {\r\n\r\n      if (is(start, 'bpmn:Event')) {\r\n\r\n        // snap start\r\n        context.connectionStart = mid(start);\r\n      }\r\n\r\n      if (is(hover, 'bpmn:Event')) {\r\n\r\n        // snap hover\r\n        snapToPosition(event, mid(hover));\r\n      }\r\n\r\n    } else {\r\n\r\n      // un-snap source\r\n      context.connectionStart = context.initialConnectionStart;\r\n    }\r\n  });\r\n}\r\n\r\nBpmnConnectSnapping.$inject = [ 'eventBus' ];\r\n\r\n\r\n// helpers //////////\r\n\r\n// snap to target if event in target\r\nfunction snapToShape(event, target, padding) {\r\n  AXES.forEach(function(axis) {\r\n    var dimensionForAxis = getDimensionForAxis(axis, target);\r\n\r\n    if (event[ axis ] < target[ axis ] + padding) {\r\n      setSnapped(event, axis, target[ axis ] + padding);\r\n    } else if (event[ axis ] > target[ axis ] + dimensionForAxis - padding) {\r\n      setSnapped(event, axis, target[ axis ] + dimensionForAxis - padding);\r\n    }\r\n  });\r\n}\r\n\r\n// snap to target mid if event in target mid\r\nfunction snapToTargetMid(event, target) {\r\n  var targetMid = mid(target);\r\n\r\n  AXES.forEach(function(axis) {\r\n    if (isMid(event, target, axis)) {\r\n      setSnapped(event, axis, targetMid[ axis ]);\r\n    }\r\n  });\r\n}\r\n\r\n// snap to prevent loop overlapping boundary event\r\nfunction snapBoundaryEventLoop(event) {\r\n  var context = event.context,\r\n      source = context.source,\r\n      target = context.target;\r\n\r\n  if (isReverse(context)) {\r\n    return;\r\n  }\r\n\r\n  var sourceMid = mid(source),\r\n      orientation = getOrientation(sourceMid, target, -10),\r\n      axes = [];\r\n\r\n  if (/top|bottom/.test(orientation)) {\r\n    axes.push('x');\r\n  }\r\n\r\n  if (/left|right/.test(orientation)) {\r\n    axes.push('y');\r\n  }\r\n\r\n  axes.forEach(function(axis) {\r\n    var coordinate = event[ axis ], newCoordinate;\r\n\r\n    if (abs(coordinate - sourceMid[ axis ]) < BOUNDARY_TO_HOST_THRESHOLD) {\r\n      if (coordinate > sourceMid[ axis ]) {\r\n        newCoordinate = sourceMid[ axis ] + BOUNDARY_TO_HOST_THRESHOLD;\r\n      }\r\n      else {\r\n        newCoordinate = sourceMid[ axis ] - BOUNDARY_TO_HOST_THRESHOLD;\r\n      }\r\n\r\n      setSnapped(event, axis, newCoordinate);\r\n    }\r\n  });\r\n}\r\n\r\nfunction snapToPosition(event, position) {\r\n  setSnapped(event, 'x', position.x);\r\n  setSnapped(event, 'y', position.y);\r\n}\r\n\r\nfunction isType(attrs, type) {\r\n  return attrs && attrs.type === type;\r\n}\r\n\r\nfunction isAnyType(attrs, types) {\r\n  return some(types, function(type) {\r\n    return isType(attrs, type);\r\n  });\r\n}\r\n\r\nfunction getDimensionForAxis(axis, element) {\r\n  return axis === 'x' ? element.width : element.height;\r\n}\r\n\r\nfunction getTargetBoundsPadding(target) {\r\n  if (is(target, 'bpmn:Task')) {\r\n    return TASK_BOUNDS_PADDING;\r\n  } else {\r\n    return TARGET_BOUNDS_PADDING;\r\n  }\r\n}\r\n\r\nfunction isMid(event, target, axis) {\r\n  return event[ axis ] > target[ axis ] + TARGET_CENTER_PADDING\r\n    && event[ axis ] < target[ axis ] + getDimensionForAxis(axis, target) - TARGET_CENTER_PADDING;\r\n}\r\n\r\nfunction isReverse(context) {\r\n  var hover = context.hover,\r\n      source = context.source;\r\n\r\n  return hover && source && hover === source;\r\n}","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  snapTo\n} from './SnapUtil';\n\n\n/**\n * A snap context, containing the (possibly incomplete)\n * mappings of drop targets (to identify the snapping)\n * to computed snap points.\n */\nexport default function SnapContext() {\n\n  /**\n   * Map<String, SnapPoints> mapping drop targets to\n   * a list of possible snappings.\n   *\n   * @type {Object}\n   */\n  this._targets = {};\n\n  /**\n   * Map<String, Point> initial positioning of element\n   * regarding various snap directions.\n   *\n   * @type {Object}\n   */\n  this._snapOrigins = {};\n\n  /**\n   * List of snap locations\n   *\n   * @type {Array<String>}\n   */\n  this._snapLocations = [];\n\n  /**\n   * Map<String, Array<Point>> of default snapping locations\n   *\n   * @type {Object}\n   */\n  this._defaultSnaps = {};\n}\n\n\nSnapContext.prototype.getSnapOrigin = function(snapLocation) {\n  return this._snapOrigins[snapLocation];\n};\n\n\nSnapContext.prototype.setSnapOrigin = function(snapLocation, initialValue) {\n  this._snapOrigins[snapLocation] = initialValue;\n\n  if (this._snapLocations.indexOf(snapLocation) === -1) {\n    this._snapLocations.push(snapLocation);\n  }\n};\n\n\nSnapContext.prototype.addDefaultSnap = function(type, point) {\n\n  var snapValues = this._defaultSnaps[type];\n\n  if (!snapValues) {\n    snapValues = this._defaultSnaps[type] = [];\n  }\n\n  snapValues.push(point);\n};\n\n/**\n * Return a number of initialized snaps, i.e. snap locations such as\n * top-left, mid, bottom-right and so forth.\n *\n * @return {Array<String>} snapLocations\n */\nSnapContext.prototype.getSnapLocations = function() {\n  return this._snapLocations;\n};\n\n/**\n * Set the snap locations for this context.\n *\n * The order of locations determines precedence.\n *\n * @param {Array<String>} snapLocations\n */\nSnapContext.prototype.setSnapLocations = function(snapLocations) {\n  this._snapLocations = snapLocations;\n};\n\n/**\n * Get snap points for a given target\n *\n * @param {Element|String} target\n */\nSnapContext.prototype.pointsForTarget = function(target) {\n\n  var targetId = target.id || target;\n\n  var snapPoints = this._targets[targetId];\n\n  if (!snapPoints) {\n    snapPoints = this._targets[targetId] = new SnapPoints();\n    snapPoints.initDefaults(this._defaultSnaps);\n  }\n\n  return snapPoints;\n};\n\n\n/**\n * Creates the snap points and initializes them with the\n * given default values.\n *\n * @param {Object<String, Array<Point>>} [defaultPoints]\n */\nexport function SnapPoints(defaultSnaps) {\n\n  /**\n   * Map<String, Map<(x|y), Array<Number>>> mapping snap locations,\n   * i.e. top-left, bottom-right, center to actual snap values.\n   *\n   * @type {Object}\n   */\n  this._snapValues = {};\n}\n\nSnapPoints.prototype.add = function(snapLocation, point) {\n\n  var snapValues = this._snapValues[snapLocation];\n\n  if (!snapValues) {\n    snapValues = this._snapValues[snapLocation] = { x: [], y: [] };\n  }\n\n  if (snapValues.x.indexOf(point.x) === -1) {\n    snapValues.x.push(point.x);\n  }\n\n  if (snapValues.y.indexOf(point.y) === -1) {\n    snapValues.y.push(point.y);\n  }\n};\n\n\nSnapPoints.prototype.snap = function(point, snapLocation, axis, tolerance) {\n  var snappingValues = this._snapValues[snapLocation];\n\n  return snappingValues && snapTo(point[axis], snappingValues[axis], tolerance);\n};\n\n/**\n * Initialize a number of default snapping points.\n *\n * @param  {Object} defaultSnaps\n */\nSnapPoints.prototype.initDefaults = function(defaultSnaps) {\n\n  var self = this;\n\n  forEach(defaultSnaps || {}, function(snapPoints, snapLocation) {\n    forEach(snapPoints, function(point) {\n      self.add(snapLocation, point);\n    });\n  });\n};","import SnapContext from './SnapContext';\r\n\r\nimport {\r\n  getChildren,\r\n  isSnapped,\r\n  mid\r\n} from './SnapUtil';\r\n\r\nimport { isCmd } from '../keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  forEach,\r\n  isNumber\r\n} from 'min-dash';\r\n\r\nvar HIGHER_PRIORITY = 1250;\r\n\r\n\r\n/**\r\n * Snap during create and move.\r\n *\r\n * @param {EventBus} elementRegistry\r\n * @param {EventBus} eventBus\r\n * @param {Snapping} snapping\r\n */\r\nexport default function CreateMoveSnapping(elementRegistry, eventBus, snapping) {\r\n  var self = this;\r\n\r\n  this._elementRegistry = elementRegistry;\r\n\r\n  eventBus.on([\r\n    'create.start',\r\n    'shape.move.start'\r\n  ], function(event) {\r\n    self.initSnap(event);\r\n  });\r\n\r\n  eventBus.on([\r\n    'create.move',\r\n    'create.end',\r\n    'shape.move.move',\r\n    'shape.move.end'\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        snapContext = context.snapContext,\r\n        target = context.target;\r\n\r\n    if (event.originalEvent && isCmd(event.originalEvent)) {\r\n      return;\r\n    }\r\n\r\n    if (isSnapped(event) || !target) {\r\n      return;\r\n    }\r\n\r\n    var snapPoints = snapContext.pointsForTarget(target);\r\n\r\n    if (!snapPoints.initialized) {\r\n      snapPoints = self.addSnapTargetPoints(snapPoints, shape, target);\r\n\r\n      snapPoints.initialized = true;\r\n    }\r\n\r\n    snapping.snap(event, snapPoints);\r\n  });\r\n\r\n  eventBus.on([\r\n    'create.cleanup',\r\n    'shape.move.cleanup'\r\n  ], function() {\r\n    snapping.hide();\r\n  });\r\n}\r\n\r\nCreateMoveSnapping.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'snapping'\r\n];\r\n\r\nCreateMoveSnapping.prototype.initSnap = function(event) {\r\n  var elementRegistry = this._elementRegistry;\r\n\r\n  var context = event.context,\r\n      shape = context.shape,\r\n      snapContext = context.snapContext;\r\n\r\n  if (!snapContext) {\r\n    snapContext = context.snapContext = new SnapContext();\r\n  }\r\n\r\n  var shapeMid;\r\n\r\n  if (elementRegistry.get(shape.id)) {\r\n\r\n    // move\r\n    shapeMid = mid(shape, event);\r\n  } else {\r\n\r\n    // create\r\n    shapeMid = {\r\n      x: event.x + mid(shape).x,\r\n      y: event.y + mid(shape).y\r\n    };\r\n  }\r\n\r\n  var shapeTopLeft = {\r\n        x: shapeMid.x - shape.width / 2,\r\n        y: shapeMid.y - shape.height / 2\r\n      },\r\n      shapeBottomRight = {\r\n        x: shapeMid.x + shape.width / 2,\r\n        y: shapeMid.y + shape.height / 2\r\n      };\r\n\r\n  snapContext.setSnapOrigin('mid', {\r\n    x: shapeMid.x - event.x,\r\n    y: shapeMid.y - event.y\r\n  });\r\n\r\n  // snap labels to mid only\r\n  if (isLabel(shape)) {\r\n    return snapContext;\r\n  }\r\n\r\n  snapContext.setSnapOrigin('top-left', {\r\n    x: shapeTopLeft.x - event.x,\r\n    y: shapeTopLeft.y - event.y\r\n  });\r\n\r\n  snapContext.setSnapOrigin('bottom-right', {\r\n    x: shapeBottomRight.x - event.x,\r\n    y: shapeBottomRight.y - event.y\r\n  });\r\n\r\n  return snapContext;\r\n};\r\n\r\nCreateMoveSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target) {\r\n  var snapTargets = this.getSnapTargets(shape, target);\r\n\r\n  forEach(snapTargets, function(snapTarget) {\r\n\r\n    // handle labels\r\n    if (isLabel(snapTarget)) {\r\n\r\n      if (isLabel(shape)) {\r\n        snapPoints.add('mid', mid(snapTarget));\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    // handle connections\r\n    if (isConnection(snapTarget)) {\r\n\r\n      // ignore single segment connections\r\n      if (snapTarget.waypoints.length < 3) {\r\n        return;\r\n      }\r\n\r\n      // ignore first and last waypoint\r\n      var waypoints = snapTarget.waypoints.slice(1, -1);\r\n\r\n      forEach(waypoints, function(waypoint) {\r\n        snapPoints.add('mid', waypoint);\r\n      });\r\n\r\n      return;\r\n    }\r\n\r\n    // handle shapes\r\n    snapPoints.add('mid', mid(snapTarget));\r\n  });\r\n\r\n  if (!isNumber(shape.x) || !isNumber(shape.y)) {\r\n    return snapPoints;\r\n  }\r\n\r\n  // snap to original position when moving\r\n  if (this._elementRegistry.get(shape.id)) {\r\n    snapPoints.add('mid', mid(shape));\r\n  }\r\n\r\n  return snapPoints;\r\n};\r\n\r\nCreateMoveSnapping.prototype.getSnapTargets = function(shape, target) {\r\n  return getChildren(target).filter(function(child) {\r\n    return !isHidden(child);\r\n  });\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction isConnection(element) {\r\n  return !!element.waypoints;\r\n}\r\n\r\nfunction isHidden(element) {\r\n  return !!element.hidden;\r\n}\r\n\r\nfunction isLabel(element) {\r\n  return !!element.labelTarget;\r\n}","import inherits from 'inherits';\n\nimport CreateMoveSnapping from 'diagram-js/lib/features/snapping/CreateMoveSnapping';\n\nimport {\n  isSnapped,\n  setSnapped,\n  topLeft,\n  bottomRight\n} from 'diagram-js/lib/features/snapping/SnapUtil';\n\nimport { isExpanded } from '../../util/DiUtil';\n\nimport { is } from '../../util/ModelUtil';\n\nimport {\n  asTRBL,\n  getMid\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport { getBoundaryAttachment } from './BpmnSnappingUtil';\n\nimport { forEach } from 'min-dash';\n\nvar HIGH_PRIORITY = 1500;\n\n\n/**\n * Snap during create and move.\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function BpmnCreateMoveSnapping(eventBus, injector) {\n  injector.invoke(CreateMoveSnapping, this);\n\n  // creating first participant\n  eventBus.on([ 'create.move', 'create.end' ], HIGH_PRIORITY, setSnappedIfConstrained);\n\n  // snap boundary events\n  eventBus.on([\n    'create.move',\n    'create.end',\n    'shape.move.move',\n    'shape.move.end'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        canExecute = context.canExecute,\n        target = context.target;\n\n    var canAttach = canExecute && (canExecute === 'attach' || canExecute.attach);\n\n    if (canAttach && !isSnapped(event)) {\n      snapBoundaryEvent(event, target);\n    }\n  });\n}\n\ninherits(BpmnCreateMoveSnapping, CreateMoveSnapping);\n\nBpmnCreateMoveSnapping.$inject = [\n  'eventBus',\n  'injector'\n];\n\nBpmnCreateMoveSnapping.prototype.initSnap = function(event) {\n  var snapContext = CreateMoveSnapping.prototype.initSnap.call(this, event);\n\n  var shape = event.shape;\n\n  var isMove = !!this._elementRegistry.get(shape.id);\n\n  // snap to docking points\n  forEach(shape.outgoing, function(connection) {\n    var docking = connection.waypoints[0];\n\n    docking = docking.original || docking;\n\n    snapContext.setSnapOrigin(connection.id + '-docking', getDockingSnapOrigin(docking, isMove, event));\n  });\n\n  forEach(shape.incoming, function(connection) {\n    var docking = connection.waypoints[connection.waypoints.length - 1];\n\n    docking = docking.original || docking;\n\n    snapContext.setSnapOrigin(connection.id + '-docking', getDockingSnapOrigin(docking, isMove, event));\n  });\n\n  if (is(shape, 'bpmn:Participant')) {\n\n    // snap to borders with higher priority\n    snapContext.setSnapLocations([ 'top-left', 'bottom-right', 'mid' ]);\n  }\n\n  return snapContext;\n};\n\nBpmnCreateMoveSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target) {\n  CreateMoveSnapping.prototype.addSnapTargetPoints.call(this, snapPoints, shape, target);\n\n  var snapTargets = this.getSnapTargets(shape, target);\n\n  forEach(snapTargets, function(snapTarget) {\n\n    // handle TRBL alignment\n    //\n    // * with container elements\n    // * with text annotations\n    if (isContainer(snapTarget) || areAll([ shape, snapTarget ], 'bpmn:TextAnnotation')) {\n      snapPoints.add('top-left', topLeft(snapTarget));\n      snapPoints.add('bottom-right', bottomRight(snapTarget));\n    }\n  });\n\n  var elementRegistry = this._elementRegistry;\n\n  // snap to docking points if not create mode\n  forEach(shape.incoming, function(connection) {\n    if (elementRegistry.get(shape.id)) {\n\n      if (!includes(snapTargets, connection.source)) {\n        snapPoints.add('mid', getMid(connection.source));\n      }\n\n      var docking = connection.waypoints[0];\n      snapPoints.add(connection.id + '-docking', docking.original || docking);\n    }\n  });\n\n  forEach(shape.outgoing, function(connection) {\n    if (elementRegistry.get(shape.id)) {\n\n      if (!includes(snapTargets, connection.target)) {\n        snapPoints.add('mid', getMid(connection.target));\n      }\n\n      var docking = connection.waypoints[ connection.waypoints.length - 1 ];\n\n      snapPoints.add(connection.id + '-docking', docking.original || docking);\n    }\n  });\n\n  // add sequence flow parents as snap targets\n  if (is(target, 'bpmn:SequenceFlow')) {\n    snapPoints = this.addSnapTargetPoints(snapPoints, shape, target.parent);\n  }\n\n  return snapPoints;\n};\n\nBpmnCreateMoveSnapping.prototype.getSnapTargets = function(shape, target) {\n  return CreateMoveSnapping.prototype.getSnapTargets.call(this, shape, target)\n    .filter(function(snapTarget) {\n\n      // do not snap to lanes\n      return !is(snapTarget, 'bpmn:Lane');\n    });\n};\n\n// helpers //////////\n\nfunction snapBoundaryEvent(event, target) {\n  var targetTRBL = asTRBL(target);\n\n  var direction = getBoundaryAttachment(event, target);\n\n  var context = event.context,\n      shape = context.shape;\n\n  var offset;\n\n  if (shape.parent) {\n    offset = { x: 0, y: 0 };\n  } else {\n    offset = getMid(shape);\n  }\n\n  if (/top/.test(direction)) {\n    setSnapped(event, 'y', targetTRBL.top - offset.y);\n  } else if (/bottom/.test(direction)) {\n    setSnapped(event, 'y', targetTRBL.bottom - offset.y);\n  }\n\n  if (/left/.test(direction)) {\n    setSnapped(event, 'x', targetTRBL.left - offset.x);\n  } else if (/right/.test(direction)) {\n    setSnapped(event, 'x', targetTRBL.right - offset.x);\n  }\n}\n\nfunction areAll(elements, type) {\n  return elements.every(function(el) {\n    return is(el, type);\n  });\n}\n\nfunction isContainer(element) {\n  if (is(element, 'bpmn:SubProcess') && isExpanded(element)) {\n    return true;\n  }\n\n  return is(element, 'bpmn:Participant');\n}\n\n\nfunction setSnappedIfConstrained(event) {\n  var context = event.context,\n      createConstraints = context.createConstraints;\n\n  if (!createConstraints) {\n    return;\n  }\n\n  var top = createConstraints.top,\n      right = createConstraints.right,\n      bottom = createConstraints.bottom,\n      left = createConstraints.left;\n\n  if ((left && left >= event.x) || (right && right <= event.x)) {\n    setSnapped(event, 'x', event.x);\n  }\n\n  if ((top && top >= event.y) || (bottom && bottom <= event.y)) {\n    setSnapped(event, 'y', event.y);\n  }\n}\n\nfunction includes(array, value) {\n  return array.indexOf(value) !== -1;\n}\n\nfunction getDockingSnapOrigin(docking, isMove, event) {\n  return isMove ? (\n    {\n      x: docking.x - event.x,\n      y: docking.y - event.y\n    }\n  ) : {\n    x: docking.x,\n    y: docking.y\n  };\n}\n","import SnapContext from './SnapContext';\r\n\r\nimport {\r\n  bottomRight,\r\n  getChildren,\r\n  isSnapped,\r\n  setSnapped,\r\n  topLeft,\r\n} from './SnapUtil';\r\n\r\nimport { isCmd } from '../keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  asTRBL,\r\n  getMid\r\n} from '../../layout/LayoutUtil';\r\n\r\nimport { forEach } from 'min-dash';\r\n\r\nvar HIGHER_PRIORITY = 1250;\r\n\r\n\r\n/**\r\n * Snap during resize.\r\n *\r\n * @param {EventBus} eventBus\r\n * @param {Snapping} snapping\r\n */\r\nexport default function ResizeSnapping(eventBus, snapping) {\r\n  var self = this;\r\n\r\n  eventBus.on([ 'resize.start' ], function(event) {\r\n    self.initSnap(event);\r\n  });\r\n\r\n  eventBus.on([\r\n    'resize.move',\r\n    'resize.end',\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        parent = shape.parent,\r\n        direction = context.direction,\r\n        snapContext = context.snapContext;\r\n\r\n    if (event.originalEvent && isCmd(event.originalEvent)) {\r\n      return;\r\n    }\r\n\r\n    if (isSnapped(event)) {\r\n      return;\r\n    }\r\n\r\n    var snapPoints = snapContext.pointsForTarget(parent);\r\n\r\n    if (!snapPoints.initialized) {\r\n      snapPoints = self.addSnapTargetPoints(snapPoints, shape, parent, direction);\r\n\r\n      snapPoints.initialized = true;\r\n    }\r\n\r\n    if (isHorizontal(direction)) {\r\n      setSnapped(event, 'x', event.x);\r\n    }\r\n\r\n    if (isVertical(direction)) {\r\n      setSnapped(event, 'y', event.y);\r\n    }\r\n\r\n    snapping.snap(event, snapPoints);\r\n  });\r\n\r\n  eventBus.on([ 'resize.cleanup' ], function() {\r\n    snapping.hide();\r\n  });\r\n}\r\n\r\nResizeSnapping.prototype.initSnap = function(event) {\r\n  var context = event.context,\r\n      shape = context.shape,\r\n      direction = context.direction,\r\n      snapContext = context.snapContext;\r\n\r\n  if (!snapContext) {\r\n    snapContext = context.snapContext = new SnapContext();\r\n  }\r\n\r\n  var snapOrigin = getSnapOrigin(shape, direction);\r\n\r\n  snapContext.setSnapOrigin('corner', {\r\n    x: snapOrigin.x - event.x,\r\n    y: snapOrigin.y - event.y\r\n  });\r\n\r\n  return snapContext;\r\n};\r\n\r\nResizeSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target, direction) {\r\n  var snapTargets = this.getSnapTargets(shape, target);\r\n\r\n  forEach(snapTargets, function(snapTarget) {\r\n    snapPoints.add('corner', bottomRight(snapTarget));\r\n    snapPoints.add('corner', topLeft(snapTarget));\r\n  });\r\n\r\n  snapPoints.add('corner', getSnapOrigin(shape, direction));\r\n\r\n  return snapPoints;\r\n};\r\n\r\nResizeSnapping.$inject = [\r\n  'eventBus',\r\n  'snapping'\r\n];\r\n\r\nResizeSnapping.prototype.getSnapTargets = function(shape, target) {\r\n  return getChildren(target).filter(function(child) {\r\n    return !isAttached(child, shape)\r\n      && !isConnection(child)\r\n      && !isHidden(child)\r\n      && !isLabel(child);\r\n  });\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction getSnapOrigin(shape, direction) {\r\n  var mid = getMid(shape),\r\n      trbl = asTRBL(shape);\r\n\r\n  var snapOrigin = {\r\n    x: mid.x,\r\n    y: mid.y\r\n  };\r\n\r\n  if (direction.indexOf('n') !== -1) {\r\n    snapOrigin.y = trbl.top;\r\n  } else if (direction.indexOf('s') !== -1) {\r\n    snapOrigin.y = trbl.bottom;\r\n  }\r\n\r\n  if (direction.indexOf('e') !== -1) {\r\n    snapOrigin.x = trbl.right;\r\n  } else if (direction.indexOf('w') !== -1) {\r\n    snapOrigin.x = trbl.left;\r\n  }\r\n\r\n  return snapOrigin;\r\n}\r\n\r\nfunction isAttached(element, host) {\r\n  return element.host === host;\r\n}\r\n\r\nfunction isConnection(element) {\r\n  return !!element.waypoints;\r\n}\r\n\r\nfunction isHidden(element) {\r\n  return !!element.hidden;\r\n}\r\n\r\nfunction isLabel(element) {\r\n  return !!element.labelTarget;\r\n}\r\n\r\nfunction isHorizontal(direction) {\r\n  return direction === 'n' || direction === 's';\r\n}\r\n\r\nfunction isVertical(direction) {\r\n  return direction === 'e' || direction === 'w';\r\n}","import {\n  bind,\n  debounce,\n  forEach,\n  isNumber,\n  isObject\n} from 'min-dash';\n\nimport {\n  isSnapped,\n  setSnapped\n} from './SnapUtil';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate\n} from 'tiny-svg';\n\nvar SNAP_TOLERANCE = 7;\n\nexport var SNAP_LINE_HIDE_DELAY = 1000;\n\n\n/**\n * Generic snapping feature.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function Snapping(canvas) {\n  this._canvas = canvas;\n\n  // delay hide by 1000 seconds since last snap\n  this._asyncHide = debounce(bind(this.hide, this), SNAP_LINE_HIDE_DELAY);\n}\n\nSnapping.$inject = [ 'canvas' ];\n\n/**\n * Snap an event to given snap points.\n *\n * @param {Event} event\n * @param {SnapPoints} snapPoints\n */\nSnapping.prototype.snap = function(event, snapPoints) {\n  var context = event.context,\n      snapContext = context.snapContext,\n      snapLocations = snapContext.getSnapLocations();\n\n  var snapping = {\n    x: isSnapped(event, 'x'),\n    y: isSnapped(event, 'y')\n  };\n\n  forEach(snapLocations, function(location) {\n    var snapOrigin = snapContext.getSnapOrigin(location);\n\n    var snapCurrent = {\n      x: event.x + snapOrigin.x,\n      y: event.y + snapOrigin.y\n    };\n\n    // snap both axis if not snapped already\n    forEach([ 'x', 'y' ], function(axis) {\n      var locationSnapping;\n\n      if (!snapping[axis]) {\n        locationSnapping = snapPoints.snap(snapCurrent, location, axis, SNAP_TOLERANCE);\n\n        if (locationSnapping !== undefined) {\n          snapping[axis] = {\n            value: locationSnapping,\n            originValue: locationSnapping - snapOrigin[axis]\n          };\n        }\n      }\n    });\n\n    // no need to continue snapping\n    if (snapping.x && snapping.y) {\n      return false;\n    }\n  });\n\n  // show snap lines\n  this.showSnapLine('vertical', snapping.x && snapping.x.value);\n  this.showSnapLine('horizontal', snapping.y && snapping.y.value);\n\n  // snap event\n  forEach([ 'x', 'y' ], function(axis) {\n    var axisSnapping = snapping[axis];\n\n    if (isObject(axisSnapping)) {\n      setSnapped(event, axis, axisSnapping.originValue);\n    }\n  });\n};\n\nSnapping.prototype._createLine = function(orientation) {\n  var root = this._canvas.getLayer('snap');\n\n  var line = svgCreate('path');\n\n  svgAttr(line, { d: 'M0,0 L0,0' });\n\n  svgClasses(line).add('djs-snap-line');\n\n  svgAppend(root, line);\n\n  return {\n    update: function(position) {\n\n      if (!isNumber(position)) {\n        svgAttr(line, { display: 'none' });\n      } else {\n        if (orientation === 'horizontal') {\n          svgAttr(line, {\n            d: 'M-100000,' + position + ' L+100000,' + position,\n            display: ''\n          });\n        } else {\n          svgAttr(line, {\n            d: 'M ' + position + ',-100000 L ' + position + ', +100000',\n            display: ''\n          });\n        }\n      }\n    }\n  };\n};\n\nSnapping.prototype._createSnapLines = function() {\n  this._snapLines = {\n    horizontal: this._createLine('horizontal'),\n    vertical: this._createLine('vertical')\n  };\n};\n\nSnapping.prototype.showSnapLine = function(orientation, position) {\n\n  var line = this.getSnapLine(orientation);\n\n  if (line) {\n    line.update(position);\n  }\n\n  this._asyncHide();\n};\n\nSnapping.prototype.getSnapLine = function(orientation) {\n  if (!this._snapLines) {\n    this._createSnapLines();\n  }\n\n  return this._snapLines[orientation];\n};\n\nSnapping.prototype.hide = function() {\n  forEach(this._snapLines, function(snapLine) {\n    snapLine.update();\n  });\n};\n","import CreateMoveSnapping from './CreateMoveSnapping';\nimport ResizeSnapping from './ResizeSnapping';\nimport Snapping from './Snapping';\n\nexport default {\n  __init__: [\n    'createMoveSnapping',\n    'resizeSnapping',\n    'snapping'\n  ],\n  createMoveSnapping: [ 'type', CreateMoveSnapping ],\n  resizeSnapping: [ 'type', ResizeSnapping ],\n  snapping: [ 'type', Snapping ]\n};","import BpmnConnectSnapping from './BpmnConnectSnapping';\nimport BpmnCreateMoveSnapping from './BpmnCreateMoveSnapping';\nimport SnappingModule from 'diagram-js/lib/features/snapping';\n\nexport default {\n  __depends__: [ SnappingModule ],\n  __init__: [\n    'connectSnapping',\n    'createMoveSnapping'\n  ],\n  connectSnapping: [ 'type', BpmnConnectSnapping ],\n  createMoveSnapping: [ 'type', BpmnCreateMoveSnapping ]\n};","import {\n  clear as domClear,\n  delegate as domDelegate,\n  query as domQuery,\n  classes as domClasses,\n  attr as domAttr,\n  domify as domify\n} from 'min-dom';\n\nimport {\n  getBBox as getBoundingBox\n} from '../../util/Elements';\n\nimport {\n  escapeHTML\n} from '../../util/EscapeUtil';\n\n/**\n * Provides searching infrastructure\n */\nexport default function SearchPad(canvas, eventBus, overlays, selection) {\n  this._open = false;\n  this._results = [];\n  this._eventMaps = [];\n\n  this._canvas = canvas;\n  this._eventBus = eventBus;\n  this._overlays = overlays;\n  this._selection = selection;\n\n  // setup elements\n  this._container = domify(SearchPad.BOX_HTML);\n  this._searchInput = domQuery(SearchPad.INPUT_SELECTOR, this._container);\n  this._resultsContainer = domQuery(SearchPad.RESULTS_CONTAINER_SELECTOR, this._container);\n\n  // attach search pad\n  this._canvas.getContainer().appendChild(this._container);\n\n  // cleanup on destroy\n  eventBus.on([ 'canvas.destroy', 'diagram.destroy' ], this.close, this);\n}\n\n\nSearchPad.$inject = [\n  'canvas',\n  'eventBus',\n  'overlays',\n  'selection'\n];\n\n\n/**\n * Binds and keeps track of all event listereners\n */\nSearchPad.prototype._bindEvents = function() {\n  var self = this;\n\n  function listen(el, selector, type, fn) {\n    self._eventMaps.push({\n      el: el,\n      type: type,\n      listener: domDelegate.bind(el, selector, type, fn)\n    });\n  }\n\n  // close search on clicking anywhere outside\n  listen(document, 'html', 'click', function(e) {\n    self.close();\n  });\n\n  // stop event from propagating and closing search\n  // focus on input\n  listen(this._container, SearchPad.INPUT_SELECTOR, 'click', function(e) {\n    e.stopPropagation();\n    e.delegateTarget.focus();\n  });\n\n  // preselect result on hover\n  listen(this._container, SearchPad.RESULT_SELECTOR, 'mouseover', function(e) {\n    e.stopPropagation();\n    self._scrollToNode(e.delegateTarget);\n    self._preselect(e.delegateTarget);\n  });\n\n  // selects desired result on mouse click\n  listen(this._container, SearchPad.RESULT_SELECTOR, 'click', function(e) {\n    e.stopPropagation();\n    self._select(e.delegateTarget);\n  });\n\n  // prevent cursor in input from going left and right when using up/down to\n  // navigate results\n  listen(this._container, SearchPad.INPUT_SELECTOR, 'keydown', function(e) {\n\n    // up\n    if (e.keyCode === 38) {\n      e.preventDefault();\n    }\n\n    // down\n    if (e.keyCode === 40) {\n      e.preventDefault();\n    }\n  });\n\n  // handle keyboard input\n  listen(this._container, SearchPad.INPUT_SELECTOR, 'keyup', function(e) {\n\n    // escape\n    if (e.keyCode === 27) {\n      return self.close();\n    }\n\n    // enter\n    if (e.keyCode === 13) {\n      var selected = self._getCurrentResult();\n\n      return selected ? self._select(selected) : self.close();\n    }\n\n    // up\n    if (e.keyCode === 38) {\n      return self._scrollToDirection(true);\n    }\n\n    // down\n    if (e.keyCode === 40) {\n      return self._scrollToDirection();\n    }\n\n    // left && right\n    // do not search while navigating text input\n    if (e.keyCode === 37 || e.keyCode === 39) {\n      return;\n    }\n\n    // anything else\n    self._search(e.delegateTarget.value);\n  });\n};\n\n\n/**\n * Unbinds all previously established listeners\n */\nSearchPad.prototype._unbindEvents = function() {\n  this._eventMaps.forEach(function(m) {\n    domDelegate.unbind(m.el, m.type, m.listener);\n  });\n};\n\n\n/**\n * Performs a search for the given pattern.\n *\n * @param  {String} pattern\n */\nSearchPad.prototype._search = function(pattern) {\n  var self = this;\n\n  this._clearResults();\n\n  // do not search on empty query\n  if (!pattern || pattern === '') {\n    return;\n  }\n\n  var searchResults = this._searchProvider.find(pattern);\n\n  if (!searchResults.length) {\n    return;\n  }\n\n  // append new results\n  searchResults.forEach(function(result) {\n    var id = result.element.id;\n    var node = self._createResultNode(result, id);\n    self._results[id] = {\n      element: result.element,\n      node: node\n    };\n  });\n\n  // preselect first result\n  var node = domQuery(SearchPad.RESULT_SELECTOR, this._resultsContainer);\n  this._scrollToNode(node);\n  this._preselect(node);\n};\n\n\n/**\n * Navigate to the previous/next result. Defaults to next result.\n * @param  {Boolean} previous\n */\nSearchPad.prototype._scrollToDirection = function(previous) {\n  var selected = this._getCurrentResult();\n  if (!selected) {\n    return;\n  }\n\n  var node = previous ? selected.previousElementSibling : selected.nextElementSibling;\n  if (node) {\n    this._scrollToNode(node);\n    this._preselect(node);\n  }\n};\n\n\n/**\n * Scroll to the node if it is not visible.\n *\n * @param  {Element} node\n */\nSearchPad.prototype._scrollToNode = function(node) {\n  if (!node || node === this._getCurrentResult()) {\n    return;\n  }\n\n  var nodeOffset = node.offsetTop;\n  var containerScroll = this._resultsContainer.scrollTop;\n\n  var bottomScroll = nodeOffset - this._resultsContainer.clientHeight + node.clientHeight;\n\n  if (nodeOffset < containerScroll) {\n    this._resultsContainer.scrollTop = nodeOffset;\n  } else if (containerScroll < bottomScroll) {\n    this._resultsContainer.scrollTop = bottomScroll;\n  }\n};\n\n\n/**\n * Clears all results data.\n */\nSearchPad.prototype._clearResults = function() {\n  domClear(this._resultsContainer);\n\n  this._results = [];\n\n  this._resetOverlay();\n\n  this._eventBus.fire('searchPad.cleared');\n};\n\n\n/**\n * Get currently selected result.\n *\n * @return {Element}\n */\nSearchPad.prototype._getCurrentResult = function() {\n  return domQuery(SearchPad.RESULT_SELECTED_SELECTOR, this._resultsContainer);\n};\n\n\n/**\n * Create result DOM element within results container\n * that corresponds to a search result.\n *\n * 'result' : one of the elements returned by SearchProvider\n * 'id' : id attribute value to assign to the new DOM node\n * return : created DOM element\n *\n * @param  {SearchResult} result\n * @param  {String} id\n * @return {Element}\n */\nSearchPad.prototype._createResultNode = function(result, id) {\n  var node = domify(SearchPad.RESULT_HTML);\n\n  // create only if available\n  if (result.primaryTokens.length > 0) {\n    createInnerTextNode(node, result.primaryTokens, SearchPad.RESULT_PRIMARY_HTML);\n  }\n\n  // secondary tokens (represent element ID) are allways available\n  createInnerTextNode(node, result.secondaryTokens, SearchPad.RESULT_SECONDARY_HTML);\n\n  domAttr(node, SearchPad.RESULT_ID_ATTRIBUTE, id);\n\n  this._resultsContainer.appendChild(node);\n\n  return node;\n};\n\n\n/**\n * Register search element provider.\n *\n * SearchProvider.find - provides search function over own elements\n *  (pattern) => [{ text: <String>, element: <Element>}, ...]\n *\n * @param  {SearchProvider} provider\n */\nSearchPad.prototype.registerProvider = function(provider) {\n  this._searchProvider = provider;\n};\n\n\n/**\n * Open search pad.\n */\nSearchPad.prototype.open = function() {\n  if (!this._searchProvider) {\n    throw new Error('no search provider registered');\n  }\n\n  if (this.isOpen()) {\n    return;\n  }\n\n  this._bindEvents();\n\n  this._open = true;\n\n  domClasses(this._container).add('open');\n\n  this._searchInput.focus();\n\n  this._eventBus.fire('searchPad.opened');\n};\n\n\n/**\n * Close search pad.\n */\nSearchPad.prototype.close = function() {\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._unbindEvents();\n\n  this._open = false;\n\n  domClasses(this._container).remove('open');\n\n  this._clearResults();\n\n  this._searchInput.value = '';\n  this._searchInput.blur();\n\n  this._resetOverlay();\n\n  this._eventBus.fire('searchPad.closed');\n};\n\n\n/**\n * Toggles search pad on/off.\n */\nSearchPad.prototype.toggle = function() {\n  this.isOpen() ? this.close() : this.open();\n};\n\n\n/**\n * Report state of search pad.\n */\nSearchPad.prototype.isOpen = function() {\n  return this._open;\n};\n\n\n/**\n * Preselect result entry.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._preselect = function(node) {\n  var selectedNode = this._getCurrentResult();\n\n  // already selected\n  if (node === selectedNode) {\n    return;\n  }\n\n  // removing preselection from current node\n  if (selectedNode) {\n    domClasses(selectedNode).remove(SearchPad.RESULT_SELECTED_CLASS);\n  }\n\n  var id = domAttr(node, SearchPad.RESULT_ID_ATTRIBUTE);\n  var element = this._results[id].element;\n\n  domClasses(node).add(SearchPad.RESULT_SELECTED_CLASS);\n\n  this._resetOverlay(element);\n\n  this._centerViewbox(element);\n\n  this._selection.select(element);\n\n  this._eventBus.fire('searchPad.preselected', element);\n};\n\n\n/**\n * Select result node.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._select = function(node) {\n  var id = domAttr(node, SearchPad.RESULT_ID_ATTRIBUTE);\n  var element = this._results[id].element;\n\n  this.close();\n\n  this._resetOverlay();\n\n  this._centerViewbox(element);\n\n  this._selection.select(element);\n\n  this._eventBus.fire('searchPad.selected', element);\n};\n\n\n/**\n * Center viewbox on the element middle point.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._centerViewbox = function(element) {\n  var viewbox = this._canvas.viewbox();\n\n  var box = getBoundingBox(element);\n\n  var newViewbox = {\n    x: (box.x + box.width/2) - viewbox.outer.width/2,\n    y: (box.y + box.height/2) - viewbox.outer.height/2,\n    width: viewbox.outer.width,\n    height: viewbox.outer.height\n  };\n\n  this._canvas.viewbox(newViewbox);\n\n  this._canvas.zoom(viewbox.scale);\n};\n\n\n/**\n * Reset overlay removes and, optionally, set\n * overlay to a new element.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._resetOverlay = function(element) {\n  if (this._overlayId) {\n    this._overlays.remove(this._overlayId);\n  }\n\n  if (element) {\n    var box = getBoundingBox(element);\n    var overlay = constructOverlay(box);\n    this._overlayId = this._overlays.add(element, overlay);\n  }\n};\n\n\n/**\n * Construct overlay object for the given bounding box.\n *\n * @param  {BoundingBox} box\n * @return {Object}\n */\nfunction constructOverlay(box) {\n\n  var offset = 6;\n  var w = box.width + offset * 2;\n  var h = box.height + offset * 2;\n\n  var styles = [\n    'width: '+ w +'px',\n    'height: '+ h + 'px'\n  ].join('; ');\n\n  return {\n    position: {\n      bottom: h - offset,\n      right: w - offset\n    },\n    show: true,\n    html: '<div style=\"' + styles + '\" class=\"' + SearchPad.OVERLAY_CLASS + '\"></div>'\n  };\n}\n\n\n/**\n * Creates and appends child node from result tokens and HTML template.\n *\n * @param  {Element} node\n * @param  {Array<Object>} tokens\n * @param  {String} template\n */\nfunction createInnerTextNode(parentNode, tokens, template) {\n  var text = createHtmlText(tokens);\n  var childNode = domify(template);\n  childNode.innerHTML = text;\n  parentNode.appendChild(childNode);\n}\n\n/**\n * Create internal HTML markup from result tokens.\n * Caters for highlighting pattern matched tokens.\n *\n * @param  {Array<Object>} tokens\n * @return {String}\n */\nfunction createHtmlText(tokens) {\n  var htmlText = '';\n\n  tokens.forEach(function(t) {\n    if (t.matched) {\n      htmlText += '<strong class=\"' + SearchPad.RESULT_HIGHLIGHT_CLASS + '\">' + escapeHTML(t.matched) + '</strong>';\n    } else {\n      htmlText += escapeHTML(t.normal);\n    }\n  });\n\n  return htmlText !== '' ? htmlText : null;\n}\n\n\n/**\n * CONSTANTS\n */\nSearchPad.CONTAINER_SELECTOR = '.djs-search-container';\nSearchPad.INPUT_SELECTOR = '.djs-search-input input';\nSearchPad.RESULTS_CONTAINER_SELECTOR = '.djs-search-results';\nSearchPad.RESULT_SELECTOR = '.djs-search-result';\nSearchPad.RESULT_SELECTED_CLASS = 'djs-search-result-selected';\nSearchPad.RESULT_SELECTED_SELECTOR = '.' + SearchPad.RESULT_SELECTED_CLASS;\nSearchPad.RESULT_ID_ATTRIBUTE = 'data-result-id';\nSearchPad.RESULT_HIGHLIGHT_CLASS = 'djs-search-highlight';\nSearchPad.OVERLAY_CLASS = 'djs-search-overlay';\n\nSearchPad.BOX_HTML =\n  '<div class=\"djs-search-container djs-draggable djs-scrollable\">' +\n    '<div class=\"djs-search-input\">' +\n      '<input type=\"text\"/>' +\n    '</div>' +\n    '<div class=\"djs-search-results\"></div>' +\n  '</div>';\n\nSearchPad.RESULT_HTML =\n  '<div class=\"djs-search-result\"></div>';\n\nSearchPad.RESULT_PRIMARY_HTML =\n  '<div class=\"djs-search-result-primary\"></div>';\n\nSearchPad.RESULT_SECONDARY_HTML =\n  '<p class=\"djs-search-result-secondary\"></p>';\n","import OverlaysModule from '../overlays';\nimport SelectionModule from '../selection';\n\nimport SearchPad from './SearchPad';\n\nexport default {\n  __depends__: [\n    OverlaysModule,\n    SelectionModule\n  ],\n  searchPad: [ 'type', SearchPad ]\n};\n","import {\n  map,\n  filter,\n  sortBy\n} from 'min-dash';\n\nimport {\n  getLabel\n} from '../label-editing/LabelUtil';\n\n\n/**\n * Provides ability to search through BPMN elements\n */\nexport default function BpmnSearchProvider(elementRegistry, searchPad, canvas) {\n\n  this._elementRegistry = elementRegistry;\n  this._canvas = canvas;\n\n  searchPad.registerProvider(this);\n}\n\nBpmnSearchProvider.$inject = [\n  'elementRegistry',\n  'searchPad',\n  'canvas'\n];\n\n\n/**\n * Finds all elements that match given pattern\n *\n * <Result> :\n *  {\n *    primaryTokens: <Array<Token>>,\n *    secondaryTokens: <Array<Token>>,\n *    element: <Element>\n *  }\n *\n * <Token> :\n *  {\n *    normal|matched: <String>\n *  }\n *\n * @param  {String} pattern\n * @return {Array<Result>}\n */\nBpmnSearchProvider.prototype.find = function(pattern) {\n  var rootElement = this._canvas.getRootElement();\n\n  var elements = this._elementRegistry.filter(function(element) {\n    if (element.labelTarget) {\n      return false;\n    }\n    return true;\n  });\n\n  // do not include root element\n  elements = filter(elements, function(element) {\n    return element !== rootElement;\n  });\n\n  elements = map(elements, function(element) {\n    return {\n      primaryTokens: matchAndSplit(getLabel(element), pattern),\n      secondaryTokens: matchAndSplit(element.id, pattern),\n      element: element\n    };\n  });\n\n  // exclude non-matched elements\n  elements = filter(elements, function(element) {\n    return hasMatched(element.primaryTokens) || hasMatched(element.secondaryTokens);\n  });\n\n  elements = sortBy(elements, function(element) {\n    return getLabel(element.element) + element.element.id;\n  });\n\n  return elements;\n};\n\n\nfunction hasMatched(tokens) {\n  var matched = filter(tokens, function(t) {\n    return !!t.matched;\n  });\n\n  return matched.length > 0;\n}\n\n\nfunction matchAndSplit(text, pattern) {\n  var tokens = [],\n      originalText = text;\n\n  if (!text) {\n    return tokens;\n  }\n\n  text = text.toLowerCase();\n  pattern = pattern.toLowerCase();\n\n  var i = text.indexOf(pattern);\n\n  if (i > -1) {\n    if (i !== 0) {\n      tokens.push({\n        normal: originalText.substr(0, i)\n      });\n    }\n\n    tokens.push({\n      matched: originalText.substr(i, pattern.length)\n    });\n\n    if (pattern.length + i < text.length) {\n      tokens.push({\n        normal: originalText.substr(pattern.length + i, text.length)\n      });\n    }\n  } else {\n    tokens.push({\n      normal: originalText\n    });\n  }\n\n  return tokens;\n}","import SearchPadModule from 'diagram-js/lib/features/search-pad';\n\nimport BpmnSearchProvider from './BpmnSearchProvider';\n\n\nexport default {\n  __depends__: [\n    SearchPadModule\n  ],\n  __init__: [ 'bpmnSearch'],\n  bpmnSearch: [ 'type', BpmnSearchProvider ]\n};\n","import inherits from 'inherits';\n\nimport BaseModeler from './BaseModeler';\n\nimport Viewer from './Viewer';\nimport NavigatedViewer from './NavigatedViewer';\n\nimport KeyboardMoveModule from 'diagram-js/lib/navigation/keyboard-move';\nimport MoveCanvasModule from 'diagram-js/lib/navigation/movecanvas';\nimport TouchModule from 'diagram-js/lib/navigation/touch';\nimport ZoomScrollModule from 'diagram-js/lib/navigation/zoomscroll';\n\nimport AlignElementsModule from 'diagram-js/lib/features/align-elements';\nimport AutoPlaceModule from './features/auto-place';\nimport AutoResizeModule from './features/auto-resize';\nimport AutoScrollModule from 'diagram-js/lib/features/auto-scroll';\nimport BendpointsModule from 'diagram-js/lib/features/bendpoints';\nimport ConnectModule from 'diagram-js/lib/features/connect';\nimport ConnectionPreviewModule from 'diagram-js/lib/features/connection-preview';\nimport ContextPadModule from './features/context-pad';\nimport CopyPasteModule from './features/copy-paste';\nimport CreateModule from 'diagram-js/lib/features/create';\nimport DistributeElementsModule from './features/distribute-elements';\nimport EditorActionsModule from './features/editor-actions';\nimport GridSnappingModule from './features/grid-snapping';\nimport InteractionEventsModule from './features/interaction-events';\nimport KeyboardModule from './features/keyboard';\nimport KeyboardMoveSelectionModule from 'diagram-js/lib/features/keyboard-move-selection';\nimport LabelEditingModule from './features/label-editing';\nimport ModelingModule from './features/modeling';\nimport MoveModule from 'diagram-js/lib/features/move';\nimport PaletteModule from './features/palette';\nimport ReplacePreviewModule from './features/replace-preview';\nimport ResizeModule from 'diagram-js/lib/features/resize';\nimport SnappingModule from './features/snapping';\nimport SearchModule from './features/search';\n\n\nvar initialDiagram =\n  '<?xml version=\"1.0\" encoding=\"UTF-8\"?>' +\n  '<bpmn:definitions xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" ' +\n                    'xmlns:bpmn=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" ' +\n                    'xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" ' +\n                    'xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\" ' +\n                    'targetNamespace=\"http://bpmn.io/schema/bpmn\" ' +\n                    'id=\"Definitions_1\">' +\n    '<bpmn:process id=\"Process_1\" isExecutable=\"false\">' +\n      '<bpmn:startEvent id=\"StartEvent_1\"/>' +\n    '</bpmn:process>' +\n    '<bpmndi:BPMNDiagram id=\"BPMNDiagram_1\">' +\n      '<bpmndi:BPMNPlane id=\"BPMNPlane_1\" bpmnElement=\"Process_1\">' +\n        '<bpmndi:BPMNShape id=\"_BPMNShape_StartEvent_2\" bpmnElement=\"StartEvent_1\">' +\n          '<dc:Bounds height=\"36.0\" width=\"36.0\" x=\"173.0\" y=\"102.0\"/>' +\n        '</bpmndi:BPMNShape>' +\n      '</bpmndi:BPMNPlane>' +\n    '</bpmndi:BPMNDiagram>' +\n  '</bpmn:definitions>';\n\n\n/**\n * A modeler for BPMN 2.0 diagrams.\n *\n *\n * ## Extending the Modeler\n *\n * In order to extend the viewer pass extension modules to bootstrap via the\n * `additionalModules` option. An extension module is an object that exposes\n * named services.\n *\n * The following example depicts the integration of a simple\n * logging component that integrates with interaction events:\n *\n *\n * ```javascript\n *\n * // logging component\n * function InteractionLogger(eventBus) {\n *   eventBus.on('element.hover', function(event) {\n *     console.log()\n *   })\n * }\n *\n * InteractionLogger.$inject = [ 'eventBus' ]; // minification save\n *\n * // extension module\n * var extensionModule = {\n *   __init__: [ 'interactionLogger' ],\n *   interactionLogger: [ 'type', InteractionLogger ]\n * };\n *\n * // extend the viewer\n * var bpmnModeler = new Modeler({ additionalModules: [ extensionModule ] });\n * bpmnModeler.importXML(...);\n * ```\n *\n *\n * ## Customizing / Replacing Components\n *\n * You can replace individual diagram components by redefining them in override modules.\n * This works for all components, including those defined in the core.\n *\n * Pass in override modules via the `options.additionalModules` flag like this:\n *\n * ```javascript\n * function CustomContextPadProvider(contextPad) {\n *\n *   contextPad.registerProvider(this);\n *\n *   this.getContextPadEntries = function(element) {\n *     // no entries, effectively disable the context pad\n *     return {};\n *   };\n * }\n *\n * CustomContextPadProvider.$inject = [ 'contextPad' ];\n *\n * var overrideModule = {\n *   contextPadProvider: [ 'type', CustomContextPadProvider ]\n * };\n *\n * var bpmnModeler = new Modeler({ additionalModules: [ overrideModule ]});\n * ```\n *\n * @param {Object} [options] configuration options to pass to the viewer\n * @param {DOMElement} [options.container] the container to render the viewer in, defaults to body.\n * @param {String|Number} [options.width] the width of the viewer\n * @param {String|Number} [options.height] the height of the viewer\n * @param {Object} [options.moddleExtensions] extension packages to provide\n * @param {Array<didi.Module>} [options.modules] a list of modules to override the default modules\n * @param {Array<didi.Module>} [options.additionalModules] a list of modules to use with the default modules\n */\nexport default function Modeler(options) {\n  BaseModeler.call(this, options);\n}\n\ninherits(Modeler, BaseModeler);\n\n\nModeler.Viewer = Viewer;\nModeler.NavigatedViewer = NavigatedViewer;\n\n/**\n * Create a new diagram to start modeling.\n *\n * @param {Function} [done]\n */\nModeler.prototype.createDiagram = function(done) {\n  return this.importXML(initialDiagram, done);\n};\n\n\nModeler.prototype._interactionModules = [\n\n  // non-modeling components\n  KeyboardMoveModule,\n  MoveCanvasModule,\n  TouchModule,\n  ZoomScrollModule\n];\n\nModeler.prototype._modelingModules = [\n\n  // modeling components\n  AlignElementsModule,\n  AutoPlaceModule,\n  AutoScrollModule,\n  AutoResizeModule,\n  BendpointsModule,\n  ConnectModule,\n  ConnectionPreviewModule,\n  ContextPadModule,\n  CopyPasteModule,\n  CreateModule,\n  DistributeElementsModule,\n  EditorActionsModule,\n  GridSnappingModule,\n  InteractionEventsModule,\n  KeyboardModule,\n  KeyboardMoveSelectionModule,\n  LabelEditingModule,\n  ModelingModule,\n  MoveModule,\n  PaletteModule,\n  ReplacePreviewModule,\n  ResizeModule,\n  SnappingModule,\n  SearchModule\n];\n\n\n// modules the modeler is composed of\n//\n// - viewer modules\n// - interaction modules\n// - modeling modules\n\nModeler.prototype._modules = [].concat(\n  Viewer.prototype._modules,\n  Modeler.prototype._interactionModules,\n  Modeler.prototype._modelingModules\n);\n","export {\n  default as escapeCSS\n} from 'css.escape';\n\nvar HTML_ESCAPE_MAP = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  '\\'': '&#39;'\n};\n\nexport function escapeHTML(str) {\n  str = '' + str;\n\n  return str && str.replace(/[&<>\"']/g, function(match) {\n    return HTML_ESCAPE_MAP[match];\n  });\n}\n","import { Linter } from 'bpmnlint';\nimport { reduce, groupBy, assign } from 'min-dash';\nimport { domify } from 'min-dom';\nimport { escapeHTML } from 'diagram-js/lib/util/EscapeUtil';\n\nfunction EditorActions(injector, linting) {\n  var editorActions = injector.get('editorActions', false);\n\n  editorActions && editorActions.register({\n    toggleLinting: function() {\n      linting.toggle();\n    }\n  });\n}\n\nEditorActions.$inject = [\n  'injector',\n  'linting'\n];\n\nvar ErrorSvg = \"<svg width=\\\"12\\\" height=\\\"12\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 352 512\\\"><path fill=\\\"currentColor\\\" d=\\\"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z\\\"></path></svg>\";\n\nvar WarningSvg = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"12\\\" height=\\\"12\\\" viewBox=\\\"0 0 512 512\\\"><path fill=\\\"currentColor\\\" d=\\\"M288 328.83c-45.518 0-82.419 34.576-82.419 77.229 0 42.652 36.9 77.229 82.419 77.229 45.518 0 82.419-34.577 82.419-77.23 0-42.652-36.9-77.229-82.419-77.229zM207.439 57.034l11.61 204.348c.544 9.334 8.78 16.64 18.755 16.64h100.392c9.975 0 18.211-7.306 18.754-16.64l11.611-204.348c.587-10.082-7.98-18.56-18.754-18.56H226.192c-10.775 0-19.34 8.478-18.753 18.56z\\\"/></svg>\";\n\nvar SuccessSvg = \"<svg width=\\\"12\\\" height=\\\"12\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\"><path fill=\\\"currentColor\\\" d=\\\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\\\"></path></svg>\";\n\nvar OFFSET_TOP = -7,\r\n    OFFSET_RIGHT = -7;\r\n\r\nvar LOW_PRIORITY = 500;\r\n\r\nvar emptyConfig = {\r\n  resolver: {\r\n    resolveRule: function() {\r\n      return null;\r\n    }\r\n  },\r\n  config: {}\r\n};\r\n\r\nvar stateToIcon = {\r\n  error: ErrorSvg,\r\n  warning: WarningSvg,\r\n  success: SuccessSvg,\r\n  inactive: SuccessSvg\r\n};\r\n\r\nfunction Linting(\r\n    bpmnjs,\r\n    canvas,\r\n    config,\r\n    elementRegistry,\r\n    eventBus,\r\n    overlays,\r\n    translate\r\n) {\r\n  this._bpmnjs = bpmnjs;\r\n  this._canvas = canvas;\r\n  this._elementRegistry = elementRegistry;\r\n  this._eventBus = eventBus;\r\n  this._overlays = overlays;\r\n  this._translate = translate;\r\n\r\n  this._issues = {};\r\n\r\n  this._active = config && config.active || false;\r\n  this._linterConfig = emptyConfig;\r\n\r\n  this._overlayIds = {};\r\n\r\n  var self = this;\r\n\r\n  eventBus.on([\r\n    'import.done',\r\n    'elements.changed',\r\n    'linting.configChanged',\r\n    'linting.toggle'\r\n  ], LOW_PRIORITY, function(e) {\r\n    if (self.isActive()) {\r\n      self.update();\r\n    }\r\n  });\r\n\r\n  eventBus.on('linting.toggle', function(event) {\r\n\r\n    const active = event.active;\r\n\r\n    if (!active) {\r\n      self._clearIssues();\r\n      self._updateButton();\r\n    }\r\n  });\r\n\r\n  eventBus.on('diagram.clear', function() {\r\n    self._clearIssues();\r\n  });\r\n\r\n  var linterConfig = config && config.bpmnlint;\r\n\r\n  linterConfig && eventBus.once('diagram.init', function() {\r\n\r\n    // bail out if config was already provided\r\n    // during initialization of other modules\r\n    if (self.getLinterConfig() !== emptyConfig) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      self.setLinterConfig(linterConfig);\r\n    } catch (err) {\r\n      console.error(\r\n        '[bpmn-js-bpmnlint] Invalid lint rules configured. ' +\r\n        'Please doublecheck your linting.bpmnlint configuration, ' +\r\n        'cf. https://github.com/bpmn-io/bpmn-js-bpmnlint#configure-lint-rules'\r\n      );\r\n    }\r\n  });\r\n\r\n  this._init();\r\n}\r\n\r\nLinting.prototype.setLinterConfig = function(linterConfig) {\r\n\r\n  if (!linterConfig.config || !linterConfig.resolver) {\r\n    throw new Error('Expected linterConfig = { config, resolver }');\r\n  }\r\n\r\n  this._linterConfig = linterConfig;\r\n\r\n  this._eventBus.fire('linting.configChanged');\r\n};\r\n\r\nLinting.prototype.getLinterConfig = function() {\r\n  return this._linterConfig;\r\n};\r\n\r\nLinting.prototype._init = function() {\r\n  this._createButton();\r\n\r\n  this._updateButton();\r\n};\r\n\r\nLinting.prototype.isActive = function() {\r\n  return this._active;\r\n};\r\n\r\nLinting.prototype._formatIssues = function(issues) {\r\n\r\n  const reports = reduce(issues, function(reports, ruleReports, rule) {\r\n\r\n    return reports.concat(ruleReports.map(function(report) {\r\n      report.rule = rule;\r\n\r\n      return report;\r\n    }));\r\n\r\n  }, []);\r\n\r\n  return groupBy(reports, function(report) {\r\n    return report.id;\r\n  });\r\n};\r\n\r\n/**\r\n * Toggle linting on or off.\r\n *\r\n * @param {boolean} [newActive]\r\n *\r\n * @return {boolean} the new active state\r\n */\r\nLinting.prototype.toggle = function(newActive) {\r\n\r\n  newActive = typeof newActive === 'undefined' ? !this.isActive() : newActive;\r\n\r\n  this._setActive(newActive);\r\n\r\n  return newActive;\r\n};\r\n\r\nLinting.prototype._setActive = function(active) {\r\n\r\n  if (this._active === active) {\r\n    return;\r\n  }\r\n\r\n  this._active = active;\r\n\r\n  this._eventBus.fire('linting.toggle', { active: active });\r\n};\r\n\r\n/**\r\n * Update overlays. Always lint and check wether overlays need update or not.\r\n */\r\nLinting.prototype.update = function() {\r\n  var self = this;\r\n\r\n  var definitions = this._bpmnjs.getDefinitions();\r\n\r\n  if (!definitions) {\r\n    return;\r\n  }\r\n\r\n  var lintStart = this._lintStart = Math.random();\r\n\r\n  this.lint().then(function(newIssues) {\r\n\r\n    if (self._lintStart !== lintStart) {\r\n      return;\r\n    }\r\n\r\n    newIssues = self._formatIssues(newIssues);\r\n\r\n    var remove = {},\r\n        update = {},\r\n        add = {};\r\n\r\n    for (var id1 in self._issues) {\r\n      if (!newIssues[id1]) {\r\n        remove[id1] = self._issues[id1];\r\n      }\r\n    }\r\n\r\n    for (var id2 in newIssues) {\r\n      if (!self._issues[id2]) {\r\n        add[id2] = newIssues[id2];\r\n      } else {\r\n        if (newIssues[id2] !== self._issues[id2]) {\r\n          update[id2] = newIssues[id2];\r\n        }\r\n      }\r\n    }\r\n\r\n    remove = assign(remove, update);\r\n    add = assign(add, update);\r\n\r\n    self._clearOverlays();\r\n    self._createIssues(add);\r\n\r\n    self._issues = newIssues;\r\n\r\n    self._updateButton();\r\n\r\n    self._fireComplete(newIssues);\r\n  });\r\n};\r\n\r\nLinting.prototype._fireComplete = function(issues) {\r\n  this._eventBus.fire('linting.completed', { issues: issues });\r\n};\r\n\r\nLinting.prototype._createIssues = function(issues) {\r\n  for (var id in issues) {\r\n    this._createElementIssues(id, issues[id]);\r\n  }\r\n};\r\n\r\n/**\r\n * Create overlays for an elements issues.\r\n *\r\n * @param {string} elementId - Elements ID.\r\n * @param {Array} elementIssues - All element issues including warnings and errors.\r\n */\r\nLinting.prototype._createElementIssues = function(elementId, elementIssues) {\r\n  var element = this._elementRegistry.get(elementId);\r\n\r\n  if (!element) {\r\n    return;\r\n  }\r\n\r\n  var menuPosition;\r\n  var position;\r\n\r\n  if (element === this._canvas.getRootElement()) {\r\n    menuPosition = 'bottom-right';\r\n\r\n    position = {\r\n      top: 20,\r\n      left: 150\r\n    };\r\n  } else {\r\n    menuPosition = 'top-right';\r\n\r\n    position = {\r\n      top: OFFSET_TOP,\r\n      left: OFFSET_RIGHT\r\n    };\r\n  }\r\n\r\n  var issuesByType = groupBy(elementIssues, function(elementIssue) {\r\n    return elementIssue.category;\r\n  });\r\n\r\n  var errors = issuesByType.error,\r\n      warnings = issuesByType.warn;\r\n\r\n  if (!errors && !warnings) {\r\n    return;\r\n  }\r\n\r\n  var $html = domify(\r\n    '<div class=\"bjsl-overlay bjsl-issues-' + menuPosition + '\"></div>'\r\n  );\r\n\r\n  var $icon = errors\r\n    ? domify('<div class=\"bjsl-icon bjsl-icon-error\">' + ErrorSvg + '</div>')\r\n    : domify('<div class=\"bjsl-icon bjsl-icon-warning\">' + WarningSvg + '</div>');\r\n\r\n  var $dropdown = domify('<div class=\"bjsl-dropdown\"></div>');\r\n  var $dropdownContent = domify('<div class=\"bjsl-dropdown-content\"></div>');\r\n  var $issues = domify('<div class=\"bjsl-issues\"></div>');\r\n  var $issueList = domify('<ul></ul>');\r\n\r\n  $html.appendChild($icon);\r\n  $html.appendChild($dropdown);\r\n\r\n  $dropdown.appendChild($dropdownContent);\r\n  $dropdownContent.appendChild($issues);\r\n\r\n  $issues.appendChild($issueList);\r\n\r\n  if (errors) {\r\n    this._addErrors($issueList, errors);\r\n  }\r\n\r\n  if (warnings) {\r\n    this._addWarnings($issueList, warnings);\r\n  }\r\n\r\n  this._overlayIds[elementId] = this._overlays.add(element, 'linting', {\r\n    position: position,\r\n    html: $html,\r\n    scale: {\r\n      min: .9\r\n    }\r\n  });\r\n};\r\n\r\nLinting.prototype._addErrors = function($ul, errors) {\r\n\r\n  var self = this;\r\n\r\n  errors.forEach(function(error) {\r\n    self._addEntry($ul, 'error', error);\r\n  });\r\n};\r\n\r\nLinting.prototype._addWarnings = function($ul, warnings) {\r\n\r\n  var self = this;\r\n\r\n  warnings.forEach(function(error) {\r\n    self._addEntry($ul, 'warning', error);\r\n  });\r\n};\r\n\r\nLinting.prototype._addEntry = function($ul, state, entry) {\r\n\r\n  var rule = entry.rule,\r\n      message = this._translate(entry.message);\r\n\r\n  var icon = stateToIcon[state];\r\n\r\n  var $entry = domify(\r\n    '<li class=\"' + state + '\">' +\r\n      icon +\r\n      '<a title=\"' + escapeHTML(rule) + ': ' + escapeHTML(message) + '\" ' +\r\n         'data-rule=\"' + escapeHTML(rule) + '\" ' +\r\n         'data-message=\"' + escapeHTML(message) + '\"' +\r\n      '>' +\r\n        escapeHTML(message) +\r\n      '</a>' +\r\n    '</li>'\r\n  );\r\n\r\n  $ul.appendChild($entry);\r\n};\r\n\r\nLinting.prototype._clearOverlays = function() {\r\n  this._overlays.remove({ type: 'linting' });\r\n\r\n  this._overlayIds = {};\r\n};\r\n\r\nLinting.prototype._clearIssues = function() {\r\n  this._issues = {};\r\n\r\n  this._clearOverlays();\r\n};\r\n\r\nLinting.prototype._setButtonState = function(state, errors, warnings) {\r\n  var button = this._button;\r\n\r\n  var icon = stateToIcon[state];\r\n\r\n  var html = icon + '<span>' + this._translate('{errors} Errors, {warnings} Warnings', { errors: errors.toString(), warnings: warnings.toString() }) + '</span>';\r\n\r\n  [\r\n    'error',\r\n    'inactive',\r\n    'success',\r\n    'warning'\r\n  ].forEach(function(s) {\r\n    if (state === s) {\r\n      button.classList.add('bjsl-button-' + s);\r\n    } else {\r\n      button.classList.remove('bjsl-button-' + s);\r\n    }\r\n  });\r\n\r\n  button.innerHTML = html;\r\n};\r\n\r\nLinting.prototype._updateButton = function() {\r\n\r\n  if (!this.isActive()) {\r\n    this._setButtonState('inactive', 0, 0);\r\n\r\n    return;\r\n  }\r\n\r\n  var errors = 0,\r\n      warnings = 0;\r\n\r\n  for (var id in this._issues) {\r\n    this._issues[id].forEach(function(issue) {\r\n      if (issue.category === 'error') {\r\n        errors++;\r\n      } else if (issue.category === 'warn') {\r\n        warnings++;\r\n      }\r\n    });\r\n  }\r\n\r\n  var state = (errors && 'error') || (warnings && 'warning') || 'success';\r\n\r\n  this._setButtonState(state, errors, warnings);\r\n};\r\n\r\nLinting.prototype._createButton = function() {\r\n\r\n  var self = this;\r\n\r\n  this._button = domify(\r\n    '<button class=\"bjsl-button bjsl-button-inactive\" title=\"' + this._translate('Toggle linting') + '\"></button>'\r\n  );\r\n\r\n  this._button.addEventListener('click', function() {\r\n    self.toggle();\r\n  });\r\n\r\n  this._canvas.getContainer().appendChild(this._button);\r\n};\r\n\r\nLinting.prototype.lint = function() {\r\n  var definitions = this._bpmnjs.getDefinitions();\r\n\r\n  var linter = new Linter(this._linterConfig);\r\n\r\n  return linter.lint(definitions);\r\n};\r\n\r\nLinting.$inject = [\r\n  'bpmnjs',\r\n  'canvas',\r\n  'config.linting',\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'overlays',\r\n  'translate'\r\n];\n\nvar index = {\r\n  __init__: [ 'linting', 'lintingEditorActions' ],\r\n  linting: [ 'type', Linting ],\r\n  lintingEditorActions: ['type', EditorActions ]\r\n};\n\nexport default index;\n//# sourceMappingURL=index.esm.js.map\n","\nvar cache = {};\n\n/**\n * A resolver that caches rules and configuration as part of the bundle,\n * making them accessible in the browser.\n *\n * @param {Object} cache\n */\nfunction Resolver() {}\n\nResolver.prototype.resolveRule = function(pkg, ruleName) {\n\n  const rule = cache[pkg + '/' + ruleName];\n\n  if (!rule) {\n    throw new Error('cannot resolve rule <' + pkg + '/' + ruleName + '>');\n  }\n\n  return rule;\n};\n\nResolver.prototype.resolveConfig = function(pkg, configName) {\n  throw new Error(\n    'cannot resolve config <' + configName + '> in <' + pkg +'>'\n  );\n};\n\nvar resolver = new Resolver();\n\nvar rules = {\n  \"conditional-flows\": \"error\",\n  \"end-event-required\": \"error\",\n  \"event-sub-process-typed-start-event\": \"error\",\n  \"fake-join\": \"warn\",\n  \"label-required\": \"error\",\n  \"no-complex-gateway\": \"error\",\n  \"no-disconnected\": \"error\",\n  \"no-duplicate-sequence-flows\": \"error\",\n  \"no-gateway-join-fork\": \"error\",\n  \"no-implicit-split\": \"error\",\n  \"no-inclusive-gateway\": \"error\",\n  \"single-blank-start-event\": \"error\",\n  \"single-event-definition\": \"error\",\n  \"start-event-required\": \"error\",\n  \"sub-process-blank-start-event\": \"error\"\n};\n\nvar config = {\n  rules: rules\n};\n\nvar bundle = {\n  resolver: resolver,\n  config: config\n};\n\nexport { resolver, config };\n\nexport default bundle;\n\n\n\nimport rule_0 from 'bpmnlint/rules/conditional-flows';\ncache['bpmnlint/conditional-flows'] = rule_0;\n\nimport rule_1 from 'bpmnlint/rules/end-event-required';\ncache['bpmnlint/end-event-required'] = rule_1;\n\nimport rule_2 from 'bpmnlint/rules/event-sub-process-typed-start-event';\ncache['bpmnlint/event-sub-process-typed-start-event'] = rule_2;\n\nimport rule_3 from 'bpmnlint/rules/fake-join';\ncache['bpmnlint/fake-join'] = rule_3;\n\nimport rule_4 from 'bpmnlint/rules/label-required';\ncache['bpmnlint/label-required'] = rule_4;\n\nimport rule_5 from 'bpmnlint/rules/no-complex-gateway';\ncache['bpmnlint/no-complex-gateway'] = rule_5;\n\nimport rule_6 from 'bpmnlint/rules/no-disconnected';\ncache['bpmnlint/no-disconnected'] = rule_6;\n\nimport rule_7 from 'bpmnlint/rules/no-duplicate-sequence-flows';\ncache['bpmnlint/no-duplicate-sequence-flows'] = rule_7;\n\nimport rule_8 from 'bpmnlint/rules/no-gateway-join-fork';\ncache['bpmnlint/no-gateway-join-fork'] = rule_8;\n\nimport rule_9 from 'bpmnlint/rules/no-implicit-split';\ncache['bpmnlint/no-implicit-split'] = rule_9;\n\nimport rule_10 from 'bpmnlint/rules/no-inclusive-gateway';\ncache['bpmnlint/no-inclusive-gateway'] = rule_10;\n\nimport rule_11 from 'bpmnlint/rules/single-blank-start-event';\ncache['bpmnlint/single-blank-start-event'] = rule_11;\n\nimport rule_12 from 'bpmnlint/rules/single-event-definition';\ncache['bpmnlint/single-event-definition'] = rule_12;\n\nimport rule_13 from 'bpmnlint/rules/start-event-required';\ncache['bpmnlint/start-event-required'] = rule_13;\n\nimport rule_14 from 'bpmnlint/rules/sub-process-blank-start-event';\ncache['bpmnlint/sub-process-blank-start-event'] = rule_14;","<template>\r\n  <div id=\"editor\">\r\n    <el-container>\r\n      <el-header height=\"36px\">\r\n        <el-button-group>\r\n          <el-button\r\n            type=\"primary\"\r\n            size=\"medium\"\r\n            class=\"el-icon-top-left\"\r\n            @click=\"handleImportButton\"\r\n          >\r\n            导入\r\n            <fileLoader id=\"fileLoader\" @loadFile=\"loadBpmnFromFile\" />\r\n          </el-button>\r\n          <el-dropdown>\r\n            <el-button type=\"primary\" size=\"medium\">\r\n              下载\r\n              <i class=\"el-icon-bottom-right\"></i>\r\n            </el-button>\r\n            <el-dropdown-menu slot=\"dropdown\">\r\n              <el-dropdown-item>\r\n                <a @click=\"downloadBpmnToFile\">下载.bpmn文件</a>\r\n              </el-dropdown-item>\r\n              <el-dropdown-item>\r\n                <a @click=\"downloadBpmnToSVG\">下载.svg文件</a>\r\n              </el-dropdown-item>\r\n            </el-dropdown-menu>\r\n          </el-dropdown>\r\n        </el-button-group>\r\n        <el-button-group>\r\n          <el-button\r\n            type=\"primary\"\r\n            size=\"medium\"\r\n            class=\"el-icon-magic-stick\"\r\n            @click=\"textTransform\"\r\n          >NLP</el-button>\r\n        </el-button-group>\r\n        <el-button-group>\r\n          <el-button type=\"primary\" size=\"medium\" @click=\"resetBPMN\">重置</el-button>\r\n          <el-button type=\"primary\" size=\"medium\" @click=\"checkBPMN\">检查</el-button>\r\n          <el-button type=\"primary\" size=\"medium\" @click=\"saveBPMN\">保存</el-button>\r\n        </el-button-group>\r\n      </el-header>\r\n      <el-main>\r\n        <div class=\"bpmnContainer\">\r\n          <div id=\"BpmnCanvas\" ref=\"canvas\"></div>\r\n          <div id=\"BpmnProperties\" ref=\"canvas\"></div>\r\n        </div>\r\n      </el-main>\r\n    </el-container>\r\n  </div>\r\n</template>\r\n\r\n\r\n\r\n<script>\r\nimport BpmnModeler from \"bpmn-js/lib/Modeler\";\r\n//右侧元素属性菜单\r\nimport propertiesPanelModule from 'bpmn-js-properties-panel'\r\nimport propertiesProviderModule from 'bpmn-js-properties-panel/lib/provider/camunda'\r\n//文件导入器\r\nimport fileLoader from \"../components/Editor/fileLoader.vue\";\r\n//验证工具\r\nimport lintModule from \"bpmn-js-bpmnlint\";\r\nimport bpmnlintConfig from \"../bpmn/lint/.bpmnlintrc\";\r\n//空白Bpmn模板\r\nimport BlankStr from \"../bpmn/samples/blank.js\";\r\n\r\nexport default {\r\n  name: \"Editor\",\r\n  data: function() {\r\n    return {\r\n      xmlStr: this.$store.state.BpmnXml,\r\n      isCollapse: false,\r\n      bpmnModeler: null,\r\n      container: null\r\n    };\r\n  },\r\n  components: {\r\n    fileLoader: fileLoader\r\n  },\r\n\r\n  methods: {\r\n    // 初始化函数\r\n    initBpmn: function() {\r\n      this.bpmnModeler = new BpmnModeler({\r\n        container: \"#BpmnCanvas\", //主窗口挂载点\r\n        propertiesPanel: {\r\n          parent: '#BpmnProperties'//右侧属性菜单挂载点\r\n        },\r\n        additionalModules: [\r\n          lintModule,//验证插件\r\n          //右侧属性菜单差插件\r\n          propertiesPanelModule,\r\n          propertiesProviderModule\r\n        ],\r\n        linting: {\r\n          bpmnlint: bpmnlintConfig\r\n          // active: getUrlParam('linting')\r\n        }\r\n      });\r\n      this.bpmnModeler.importXML(this.xmlStr); //载入空白模板\r\n    },\r\n\r\n    // 文件导入\r\n    //通过click()点击调用fileLoader组件，该组件不会显示在页面中\r\n    handleImportButton: function() {\r\n      const element = document.getElementById(\"fileLoader\");\r\n      element.click();\r\n    },\r\n    //组件接收到文件以后，会将字符串返回，发出loadFile事件\r\n    //监听到loadFile事件后，调用loadBpmnFromFile方法将字符串显示到页面\r\n    loadBpmnFromFile: function(bpmnFile) {\r\n      this.xmlStr = bpmnFile;\r\n      this.bpmnModeler.importXML(this.xmlStr);\r\n    },\r\n\r\n    //下载BPMN为.BPMN格式（本质上是xml格式）\r\n    downloadBpmnToFile: function() {\r\n      this.bpmnModeler.saveXML(\r\n        {\r\n          format: true\r\n        },\r\n        (err, xml) => {\r\n          this.download(\"1.bpmn\", xml);\r\n        }\r\n      );\r\n    },\r\n    //下载BPMN为.SVG格式\r\n    downloadBpmnToSVG: function() {\r\n      this.bpmnModeler.saveSVG(\r\n        {\r\n          format: true\r\n        },\r\n        (err, data) => {\r\n          this.download(\"bpmn.svg\", data);\r\n        }\r\n      );\r\n    },\r\n    //下载其实是调用了这个函数进行的，感觉还可以再简写一下\r\n    download: function(filename, text) {\r\n      let element = document.createElement(\"a\");\r\n      element.style.display = \"none\";\r\n      element.setAttribute(\r\n        \"href\",\r\n        \"data:text/plain;charset=utf-8,\" + encodeURIComponent(text)\r\n      );\r\n      element.setAttribute(\"download\", filename);\r\n      document.body.appendChild(element);\r\n      element.click();\r\n      document.body.removeChild(element);\r\n    },\r\n\r\n    //重置\r\n    //当前的this.xmlStr重新替换为空白模板\r\n    resetBPMN: function() {\r\n      this.xmlStr = BlankStr;\r\n      this.bpmnModeler.importXML(this.xmlStr);\r\n    },\r\n\r\n    //保存\r\n    saveBPMN: function() {\r\n      this.bpmnModeler.saveXML(\r\n        {\r\n          format: true\r\n        },\r\n        (err, xml) => {\r\n          this.xmlStr = xml;\r\n          this.$store.dispatch(\"editXml\", this.xmlStr);\r\n        }\r\n      );\r\n    },\r\n\r\n    //检查\r\n    checkBPMN: function() {\r\n      /*使用形式化验证会在底部出现Toggle Lint按钮，检查只需要点击响应的按钮即可*/\r\n      const bjslButton = document.querySelector(\".bjsl-button\");\r\n      bjslButton.click();\r\n    },\r\n    //文本转换\r\n    textTransform: function() {\r\n      const _bpmnModeler = this.bpmnModeler;\r\n      const axios = this.$axios;\r\n      this.$msgbox({\r\n        title: \"NLP\",\r\n        message: \"请输入一段描述业务流程的文字\",\r\n        showInput: true,\r\n        inputType: \"textarea\",\r\n        confirmButtonText: \"生成BPMN\",\r\n        beforeClose: (action, instance, done) => {\r\n          //这个函数在调用接口之前先看一下原理，\r\n          if (action === \"confirm\") {\r\n            instance.confirmButtonLoading = true;\r\n            instance.confirmButtonText = \"执行中...\";\r\n            //在发送前把数据打包，否则后端接收不到\r\n            let _param = new URLSearchParams();\r\n            _param.append(\r\n              \"str\",\r\n              instance.inputValue ? instance.inputValue : \" \"\r\n            );\r\n            // _param.append(\"name\", \"cbaymax\")\r\n\r\n            axios({\r\n              method: \"post\",\r\n              // test url: 'http://123.207.143.93:8081/anything',\r\n              url: \"/api/text2bpmn\",\r\n              data: _param\r\n            })\r\n              .then(res => {\r\n                console.log(res);\r\n                _bpmnModeler.importXML(res.data);\r\n                instance.confirmButtonLoading = false;\r\n                this.$message({\r\n                  type: \"success\",\r\n                  message: \"执行成功\"\r\n                });\r\n                done();\r\n              })\r\n              .catch(err => {\r\n                instance.confirmButtonLoading = false;\r\n                this.$message({\r\n                  type: \"error\",\r\n                  message: err\r\n                });\r\n                done();\r\n              });\r\n          } else {\r\n            this.$message({\r\n              type: \"info\",\r\n              message: \"已取消\"\r\n            });\r\n            done();\r\n          }\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  //生命周期函数 - 组件载入后, Vue 实例挂载到实际的 DOM 操作完成前执行该操作，不能在created()时初始化\r\n  mounted: function() {\r\n    this.initBpmn();\r\n  },\r\n  activated: function() {\r\n    this.xmlStr = this.$store.state.BpmnXml;\r\n    this.bpmnModeler.importXML(this.xmlStr);\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n#editor .el-container {\r\n  position: fixed;\r\n  margin: auto;\r\n  left: 0px;\r\n  right: 0px;\r\n  bottom: 0px;\r\n  height: 90%;\r\n}\r\n\r\n#editor .el-header {\r\n  display: inline-flex;\r\n  height: 40px;\r\n}\r\n\r\n#editor .el-header .el-button-group {\r\n  display: inherit;\r\n}\r\n\r\n#editor .bpmnContainer {\r\n  position: relative;\r\n  margin: auto;\r\n  left: 1px;\r\n  right: 1px;\r\n  bottom: 0px;\r\n  height: 95%;\r\n  border-style: solid;\r\n  border-width: 1px;\r\n}\r\n\r\n#editor #BpmnCanvas {\r\n  /* 主窗口区域 */\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n#editor #BpmnProperties {\r\n  /* 右侧元素属性菜单 */\r\n  position:absolute;\r\n  top:10px;\r\n  right:10px;\r\n  width:300px;\r\n  height:450px;\r\n  overflow-y:scroll;\r\n}\r\n\r\n@import \"~bpmn-js/dist/assets/diagram-js.css\";\r\n@import \"~bpmn-js/dist/assets/bpmn-font/css/bpmn.css\";\r\n@import \"~bpmn-js/dist/assets/bpmn-font/css/bpmn-embedded.css\";\r\n@import \"~bpmn-js-bpmnlint/dist/assets/css/bpmn-js-bpmnlint.css\";\r\n@import '~bpmn-js-properties-panel/dist/assets/bpmn-js-properties-panel.css';\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Editor.vue?vue&type=template&id=4e4a8935&\"\nimport script from \"./Editor.vue?vue&type=script&lang=js&\"\nexport * from \"./Editor.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Editor.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var nativeCreate = require('./_nativeCreate');\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nmodule.exports = hashClear;\n","'use strict';\n\nvar findExtension = require('../Helper').findExtension,\n    findExtensions = require('../Helper').findExtensions;\n\nvar createCamundaProperty = require('../CreateHelper').createCamundaProperty,\n    createInputParameter = require('../CreateHelper').createInputParameter,\n    createOutputParameter = require('../CreateHelper').createOutputParameter,\n    createCamundaIn = require('../CreateHelper').createCamundaIn,\n    createCamundaOut = require('../CreateHelper').createCamundaOut,\n    createCamundaInWithBusinessKey = require('../CreateHelper').createCamundaInWithBusinessKey,\n    createCamundaExecutionListenerScript = require('../CreateHelper').createCamundaExecutionListenerScript,\n    createCamundaFieldInjection = require('../CreateHelper').createCamundaFieldInjection;\n\nvar forEach = require('lodash/forEach');\n\nvar CAMUNDA_SERVICE_TASK_LIKE = [\n  'camunda:class',\n  'camunda:delegateExpression',\n  'camunda:expression'\n];\n\n/**\n * A handler that changes the modeling template of a BPMN element.\n */\nfunction ChangeElementTemplateHandler(modeling, commandStack, bpmnFactory) {\n\n  function getOrCreateExtensionElements(element) {\n\n    var bo = element.businessObject;\n\n    var extensionElements = bo.extensionElements;\n\n    // add extension elements\n    if (!extensionElements) {\n      extensionElements = bpmnFactory.create('bpmn:ExtensionElements', {\n        values: []\n      });\n\n      modeling.updateProperties(element, {\n        extensionElements: extensionElements\n      });\n    }\n\n    return extensionElements;\n  }\n\n  function updateModelerTemplate(element, newTemplate) {\n    modeling.updateProperties(element, {\n      'camunda:modelerTemplate': newTemplate && newTemplate.id\n    });\n  }\n\n  function updateIoMappings(element, newTemplate, context) {\n\n    var newMappings = createInputOutputMappings(newTemplate, bpmnFactory),\n        oldMappings;\n\n    if (!newMappings) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { inputOutput: newMappings }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldMappings = findExtension(element, 'camunda:InputOutput');\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: [ newMappings ],\n        objectsToRemove: oldMappings ? [ oldMappings ] : []\n      });\n    }\n  }\n\n  function updateCamundaField(element, newTemplate, context) {\n\n    var newMappings = createCamundaFieldInjections(newTemplate, bpmnFactory),\n        oldMappings;\n\n    if (!newMappings) {\n      return;\n    }\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { field: newMappings }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldMappings = findExtensions(element, ['camunda:Field']);\n\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: newMappings,\n        objectsToRemove: oldMappings ? oldMappings : []\n      });\n    }\n  }\n\n\n  function updateCamundaProperties(element, newTemplate, context) {\n\n    var newProperties = createCamundaProperties(newTemplate, bpmnFactory),\n        oldProperties;\n\n    if (!newProperties) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { properties: newProperties }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldProperties = findExtension(element, 'camunda:Properties');\n\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: [ newProperties ],\n        objectsToRemove: oldProperties ? [ oldProperties ] : []\n      });\n    }\n  }\n\n  function updateProperties(element, newTemplate, context) {\n\n    var newProperties = createBpmnPropertyUpdates(newTemplate, bpmnFactory);\n\n    var newPropertiesCount = Object.keys(newProperties).length;\n\n    if (!newPropertiesCount) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: newProperties\n      });\n    } else {\n      modeling.updateProperties(element, newProperties);\n    }\n  }\n\n  function updateInOut(element, newTemplate, context) {\n\n    var newInOut = createCamundaInOut(newTemplate, bpmnFactory),\n        oldInOut;\n\n    if (!newInOut) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { inout: newInOut }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldInOut = findExtensions(context, [ 'camunda:In', 'camunda:Out' ]);\n\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: newInOut,\n        objectsToRemove: oldInOut\n      });\n    }\n  }\n\n  function updateExecutionListener(element, newTemplate, context) {\n\n    var newExecutionListeners = createCamundaExecutionListeners(newTemplate, bpmnFactory),\n        oldExecutionsListeners;\n\n    if (!newExecutionListeners.length) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { executionListener: newExecutionListeners }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldExecutionsListeners = findExtensions(context, [ 'camunda:ExecutionListener' ]);\n\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: newExecutionListeners,\n        objectsToRemove: oldExecutionsListeners\n      });\n    }\n  }\n\n  /**\n   * Update / recreate a scoped element.\n   *\n   * @param {djs.model.Base} element the diagram parent element\n   * @param {String} scopeName name of the scope, i.e. camunda:Connector\n   * @param {Object} scopeDefinition\n   */\n  function updateScopeElements(element, scopeName, scopeDefinition) {\n\n    var scopeElement = bpmnFactory.create(scopeName);\n\n    // update camunda:inputOutput\n    updateIoMappings(element, scopeDefinition, scopeElement);\n\n    // update camunda:field\n    updateCamundaField(element, scopeDefinition, scopeElement);\n\n    // update camunda:properties\n    updateCamundaProperties(element, scopeDefinition, scopeElement);\n\n    // update other properties (bpmn:condition, camunda:async, ...)\n    updateProperties(element, scopeDefinition, scopeElement);\n\n    // update camunda:in and camunda:out\n    updateInOut(element, scopeDefinition, scopeElement);\n\n    // update camunda:executionListener\n    updateExecutionListener(element, scopeDefinition, scopeElement);\n\n    var extensionElements = getOrCreateExtensionElements(element);\n    var oldScope = findExtension(extensionElements, scopeName);\n\n    commandStack.execute('properties-panel.update-businessobject-list', {\n      element: element,\n      currentObject: extensionElements,\n      propertyName: 'values',\n      objectsToAdd: [ scopeElement ],\n      objectsToRemove: oldScope ? [ oldScope ] : []\n    });\n  }\n\n  /**\n   * Compose an element template change action, updating all\n   * necessary underlying properties.\n   *\n   * @param {Object} context\n   * @param {Object} context.element\n   * @param {Object} context.oldTemplate\n   * @param {Object} context.newTemplate\n   */\n  this.preExecute = function(context) {\n\n    var element = context.element,\n        newTemplate = context.newTemplate;\n\n    // update camunda:modelerTemplate attribute\n    updateModelerTemplate(element, newTemplate);\n\n    if (newTemplate) {\n\n      // update camunda:inputOutput\n      updateIoMappings(element, newTemplate);\n\n      // update camunda:field\n      updateCamundaField(element, newTemplate);\n\n      // update camunda:properties\n      updateCamundaProperties(element, newTemplate);\n\n      // update other properties (bpmn:condition, camunda:async, ...)\n      updateProperties(element, newTemplate);\n\n      // update camunda:in and camunda:out\n      updateInOut(element, newTemplate);\n\n      // update camunda:executionListener\n      updateExecutionListener(element, newTemplate);\n\n      // loop on scopes properties\n      forEach(newTemplate.scopes, function(scopeDefinition, scopeName) {\n        updateScopeElements(element, scopeName, scopeDefinition);\n      });\n\n    }\n  };\n}\n\nChangeElementTemplateHandler.$inject = [ 'modeling', 'commandStack', 'bpmnFactory' ];\n\nmodule.exports = ChangeElementTemplateHandler;\n\n\n\n// helpers /////////////////////////////\n\nfunction createBpmnPropertyUpdates(template, bpmnFactory) {\n\n  var propertyUpdates = {};\n\n  template.properties.forEach(function(p) {\n\n    var binding = p.binding,\n        bindingTarget = binding.name,\n        propertyValue;\n\n    if (binding.type === 'property') {\n\n      if (bindingTarget === 'conditionExpression') {\n        propertyValue = bpmnFactory.create('bpmn:FormalExpression', {\n          body: p.value,\n          language: binding.scriptFormat\n        });\n      } else {\n        propertyValue = p.value;\n      }\n\n      // assigning camunda:async to true|false\n      // assigning bpmn:conditionExpression to { $type: 'bpmn:FormalExpression', ... }\n      propertyUpdates[bindingTarget] = propertyValue;\n\n      // make sure we unset other \"implementation types\"\n      // when applying a camunda:class template onto a preconfigured\n      // camunda:delegateExpression element\n      if (CAMUNDA_SERVICE_TASK_LIKE.indexOf(bindingTarget) !== -1) {\n        CAMUNDA_SERVICE_TASK_LIKE.forEach(function(prop) {\n          if (prop !== bindingTarget) {\n            propertyUpdates[prop] = undefined;\n          }\n        });\n      }\n    }\n  });\n\n  return propertyUpdates;\n}\n\nfunction createCamundaFieldInjections(template, bpmnFactory) {\n  var injections = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n    if (bindingType === 'camunda:field') {\n      injections.push(createCamundaFieldInjection(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  if (injections.length) {\n    return injections;\n  }\n}\n\nfunction createCamundaProperties(template, bpmnFactory) {\n\n  var properties = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n\n    if (bindingType === 'camunda:property') {\n      properties.push(createCamundaProperty(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  if (properties.length) {\n    return bpmnFactory.create('camunda:Properties', {\n      values: properties\n    });\n  }\n}\n\nfunction createInputOutputMappings(template, bpmnFactory) {\n\n  var inputParameters = [],\n      outputParameters = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n\n    if (bindingType === 'camunda:inputParameter') {\n      inputParameters.push(createInputParameter(\n        binding, p.value, bpmnFactory\n      ));\n    }\n\n    if (bindingType === 'camunda:outputParameter') {\n      outputParameters.push(createOutputParameter(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  // do we need to create new ioMappings (?)\n  if (outputParameters.length || inputParameters.length) {\n    return bpmnFactory.create('camunda:InputOutput', {\n      inputParameters: inputParameters,\n      outputParameters: outputParameters\n    });\n  }\n}\n\nfunction createCamundaInOut(template, bpmnFactory) {\n\n  var inOuts = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n\n    if (bindingType === 'camunda:in') {\n      inOuts.push(createCamundaIn(\n        binding, p.value, bpmnFactory\n      ));\n    } else\n    if (bindingType === 'camunda:out') {\n      inOuts.push(createCamundaOut(\n        binding, p.value, bpmnFactory\n      ));\n    } else\n    if (bindingType === 'camunda:in:businessKey') {\n      inOuts.push(createCamundaInWithBusinessKey(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  return inOuts;\n}\n\n\nfunction createCamundaExecutionListeners(template, bpmnFactory) {\n\n  var executionListener = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n\n    if (bindingType === 'camunda:executionListener') {\n      executionListener.push(createCamundaExecutionListenerScript(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  return executionListener;\n}\n","var toFinite = require('./toFinite');\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\nmodule.exports = toInteger;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar multiInstanceLoopCharacteristics = require('./implementation/MultiInstanceLoopCharacteristics');\n\nvar jobRetryTimeCycle = require('./implementation/JobRetryTimeCycle'),\n    asyncContinuation = require('./implementation/AsyncContinuation');\n\n\nfunction getLoopCharacteristics(element) {\n  var bo = getBusinessObject(element);\n  return bo.loopCharacteristics;\n}\n\n\nfunction ensureMultiInstanceSupported(element) {\n  var loopCharacteristics = getLoopCharacteristics(element);\n  return !!loopCharacteristics && is(loopCharacteristics, 'camunda:Collectable');\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (!ensureMultiInstanceSupported(element)) {\n    return;\n  }\n\n  // multi instance properties\n  group.entries = group.entries.concat(multiInstanceLoopCharacteristics(element, bpmnFactory, translate));\n\n  // async continuation ///////////////////////////////////////////////////////\n  group.entries = group.entries.concat(asyncContinuation(element, bpmnFactory, {\n    getBusinessObject: getLoopCharacteristics,\n    idPrefix: 'multiInstance-',\n    labelPrefix: translate('Multi Instance ')\n  }, translate));\n\n\n  // retry time cycle //////////////////////////////////////////////////////////\n  group.entries = group.entries.concat(jobRetryTimeCycle(element, bpmnFactory, {\n    getBusinessObject: getLoopCharacteristics,\n    idPrefix: 'multiInstance-',\n    labelPrefix: translate('Multi Instance ')\n  }, translate));\n};\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar textBox = function(options, defaultParameters) {\n\n  var resource = defaultParameters,\n      label = options.label || resource.id,\n      canBeShown = !!options.show && typeof options.show === 'function',\n      description = options.description;\n\n  resource.html =\n    '<label for=\"camunda-' + escapeHTML(resource.id) + '\" ' +\n    (canBeShown ? 'data-show=\"isShown\"' : '') +\n    '>' + label + '</label>' +\n    '<div class=\"bpp-field-wrapper\" ' +\n    (canBeShown ? 'data-show=\"isShown\"' : '') +\n    '>' +\n      '<div contenteditable=\"true\" id=\"camunda-' + escapeHTML(resource.id) + '\" ' +\n            'name=\"' + escapeHTML(options.modelProperty) + '\" />' +\n    '</div>';\n\n  // add description below text box entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  if (canBeShown) {\n    resource.isShown = function() {\n      return options.show.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['bpp-textbox'];\n\n  return resource;\n};\n\nmodule.exports = textBox;\n","'use strict';\nvar bind = require('../internals/function-bind-context');\nvar toObject = require('../internals/to-object');\nvar callWithSafeIterationClosing = require('../internals/call-with-safe-iteration-closing');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar toLength = require('../internals/to-length');\nvar createProperty = require('../internals/create-property');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\n// `Array.from` method implementation\n// https://tc39.github.io/ecma262/#sec-array.from\nmodule.exports = function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n  var O = toObject(arrayLike);\n  var C = typeof this == 'function' ? this : Array;\n  var argumentsLength = arguments.length;\n  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;\n  var mapping = mapfn !== undefined;\n  var iteratorMethod = getIteratorMethod(O);\n  var index = 0;\n  var length, result, step, iterator, next, value;\n  if (mapping) mapfn = bind(mapfn, argumentsLength > 2 ? arguments[2] : undefined, 2);\n  // if the target is not iterable or it's an array with the default iterator - use a simple case\n  if (iteratorMethod != undefined && !(C == Array && isArrayIteratorMethod(iteratorMethod))) {\n    iterator = iteratorMethod.call(O);\n    next = iterator.next;\n    result = new C();\n    for (;!(step = next.call(iterator)).done; index++) {\n      value = mapping ? callWithSafeIterationClosing(iterator, mapfn, [step.value, index], true) : step.value;\n      createProperty(result, index, value);\n    }\n  } else {\n    length = toLength(O.length);\n    result = new C(length);\n    for (;length > index; index++) {\n      value = mapping ? mapfn(O[index], index) : O[index];\n      createProperty(result, index, value);\n    }\n  }\n  result.length = index;\n  return result;\n};\n","var getWrapDetails = require('./_getWrapDetails'),\n    insertWrapDetails = require('./_insertWrapDetails'),\n    setToString = require('./_setToString'),\n    updateWrapDetails = require('./_updateWrapDetails');\n\n/**\n * Sets the `toString` method of `wrapper` to mimic the source of `reference`\n * with wrapper details in a comment at the top of the source body.\n *\n * @private\n * @param {Function} wrapper The function to modify.\n * @param {Function} reference The reference function.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @returns {Function} Returns `wrapper`.\n */\nfunction setWrapToString(wrapper, reference, bitmask) {\n  var source = (reference + '');\n  return setToString(wrapper, insertWrapDetails(source, updateWrapDetails(getWrapDetails(source), bitmask)));\n}\n\nmodule.exports = setWrapToString;\n","'use strict';\n\nvar map = require('lodash/map');\n\nvar extensionElementsHelper = require('./ExtensionElementsHelper');\n\n/**\n * Returns true if the attribute 'camunda:asyncBefore' is set\n * to true.\n *\n * @param  {ModdleElement} bo\n *\n * @return {boolean} a boolean value\n */\nfunction isAsyncBefore(bo) {\n  return !!(bo.get('camunda:asyncBefore') || bo.get('camunda:async'));\n}\n\nmodule.exports.isAsyncBefore = isAsyncBefore;\n\n/**\n * Returns true if the attribute 'camunda:asyncAfter' is set\n * to true.\n *\n * @param  {ModdleElement} bo\n *\n * @return {boolean} a boolean value\n */\nfunction isAsyncAfter(bo) {\n  return !!bo.get('camunda:asyncAfter');\n}\n\nmodule.exports.isAsyncAfter = isAsyncAfter;\n\n/**\n * Returns true if the attribute 'camunda:exclusive' is set\n * to true.\n *\n * @param  {ModdleElement} bo\n *\n * @return {boolean} a boolean value\n */\nfunction isExclusive(bo) {\n  return !!bo.get('camunda:exclusive');\n}\n\nmodule.exports.isExclusive = isExclusive;\n\n/**\n * Get first 'camunda:FailedJobRetryTimeCycle' from the business object.\n *\n * @param  {ModdleElement} bo\n *\n * @return {Array<ModdleElement>} a list of 'camunda:FailedJobRetryTimeCycle'\n */\nfunction getFailedJobRetryTimeCycle(bo) {\n  return (extensionElementsHelper.getExtensionElements(bo, 'camunda:FailedJobRetryTimeCycle') || [])[0];\n}\n\nmodule.exports.getFailedJobRetryTimeCycle = getFailedJobRetryTimeCycle;\n\n/**\n * Removes all existing 'camunda:FailedJobRetryTimeCycle' from the business object\n *\n * @param  {ModdleElement} bo\n *\n * @return {Array<ModdleElement>} a list of 'camunda:FailedJobRetryTimeCycle'\n */\nfunction removeFailedJobRetryTimeCycle(bo, element) {\n  var retryTimeCycles = extensionElementsHelper.getExtensionElements(bo, 'camunda:FailedJobRetryTimeCycle');\n  return map(retryTimeCycles, function(cycle) {\n    return extensionElementsHelper.removeEntry(bo, element, cycle);\n  });\n}\n\nmodule.exports.removeFailedJobRetryTimeCycle = removeFailedJobRetryTimeCycle;","var arrayAggregator = require('./_arrayAggregator'),\n    baseAggregator = require('./_baseAggregator'),\n    baseIteratee = require('./_baseIteratee'),\n    isArray = require('./isArray');\n\n/**\n * Creates a function like `_.groupBy`.\n *\n * @private\n * @param {Function} setter The function to set accumulator values.\n * @param {Function} [initializer] The accumulator object initializer.\n * @returns {Function} Returns the new aggregator function.\n */\nfunction createAggregator(setter, initializer) {\n  return function(collection, iteratee) {\n    var func = isArray(collection) ? arrayAggregator : baseAggregator,\n        accumulator = initializer ? initializer() : {};\n\n    return func(collection, setter, baseIteratee(iteratee, 2), accumulator);\n  };\n}\n\nmodule.exports = createAggregator;\n","var arrayEach = require('./_arrayEach'),\n    baseCreate = require('./_baseCreate'),\n    baseForOwn = require('./_baseForOwn'),\n    baseIteratee = require('./_baseIteratee'),\n    getPrototype = require('./_getPrototype'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isFunction = require('./isFunction'),\n    isObject = require('./isObject'),\n    isTypedArray = require('./isTypedArray');\n\n/**\n * An alternative to `_.reduce`; this method transforms `object` to a new\n * `accumulator` object which is the result of running each of its own\n * enumerable string keyed properties thru `iteratee`, with each invocation\n * potentially mutating the `accumulator` object. If `accumulator` is not\n * provided, a new object with the same `[[Prototype]]` will be used. The\n * iteratee is invoked with four arguments: (accumulator, value, key, object).\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @static\n * @memberOf _\n * @since 1.3.0\n * @category Object\n * @param {Object} object The object to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @param {*} [accumulator] The custom accumulator value.\n * @returns {*} Returns the accumulated value.\n * @example\n *\n * _.transform([2, 3, 4], function(result, n) {\n *   result.push(n *= n);\n *   return n % 2 == 0;\n * }, []);\n * // => [4, 9]\n *\n * _.transform({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {\n *   (result[value] || (result[value] = [])).push(key);\n * }, {});\n * // => { '1': ['a', 'c'], '2': ['b'] }\n */\nfunction transform(object, iteratee, accumulator) {\n  var isArr = isArray(object),\n      isArrLike = isArr || isBuffer(object) || isTypedArray(object);\n\n  iteratee = baseIteratee(iteratee, 4);\n  if (accumulator == null) {\n    var Ctor = object && object.constructor;\n    if (isArrLike) {\n      accumulator = isArr ? new Ctor : [];\n    }\n    else if (isObject(object)) {\n      accumulator = isFunction(Ctor) ? baseCreate(getPrototype(object)) : {};\n    }\n    else {\n      accumulator = {};\n    }\n  }\n  (isArrLike ? arrayEach : baseForOwn)(object, function(value, index, object) {\n    return iteratee(accumulator, value, index, object);\n  });\n  return accumulator;\n}\n\nmodule.exports = transform;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var baseFindIndex = require('./_baseFindIndex'),\n    baseIteratee = require('./_baseIteratee'),\n    toInteger = require('./toInteger');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * This method is like `_.find` except that it returns the index of the first\n * element `predicate` returns truthy for instead of the element itself.\n *\n * @static\n * @memberOf _\n * @since 1.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @param {number} [fromIndex=0] The index to search from.\n * @returns {number} Returns the index of the found element, else `-1`.\n * @example\n *\n * var users = [\n *   { 'user': 'barney',  'active': false },\n *   { 'user': 'fred',    'active': false },\n *   { 'user': 'pebbles', 'active': true }\n * ];\n *\n * _.findIndex(users, function(o) { return o.user == 'barney'; });\n * // => 0\n *\n * // The `_.matches` iteratee shorthand.\n * _.findIndex(users, { 'user': 'fred', 'active': false });\n * // => 1\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.findIndex(users, ['active', false]);\n * // => 0\n *\n * // The `_.property` iteratee shorthand.\n * _.findIndex(users, 'active');\n * // => 2\n */\nfunction findIndex(array, predicate, fromIndex) {\n  var length = array == null ? 0 : array.length;\n  if (!length) {\n    return -1;\n  }\n  var index = fromIndex == null ? 0 : toInteger(fromIndex);\n  if (index < 0) {\n    index = nativeMax(length + index, 0);\n  }\n  return baseFindIndex(array, baseIteratee(predicate, 3), index);\n}\n\nmodule.exports = findIndex;\n","'use strict';\n\nvar eventDefinitionReference = require('./EventDefinitionReference'),\n    elementReferenceProperty = require('./ElementReferenceProperty');\n\n\nmodule.exports = function(group, element, bpmnFactory, signalEventDefinition, translate) {\n\n  group.entries = group.entries.concat(eventDefinitionReference(element, signalEventDefinition, bpmnFactory, {\n    label: translate('Signal'),\n    elementName: 'signal',\n    elementType: 'bpmn:Signal',\n    referenceProperty: 'signalRef',\n    newElementIdPrefix: 'Signal_'\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, signalEventDefinition, bpmnFactory, {\n    id: 'signal-element-name',\n    label: translate('Signal Name'),\n    referenceProperty: 'signalRef',\n    modelProperty: 'name',\n    shouldValidate: true\n  }));\n\n};\n","'use strict';\n\nvar forEach = require('lodash/forEach');\n\n/**\n * A handler that implements a BPMN 2.0 property update\n * for business object lists which are not represented in the\n * diagram.\n *\n * This is useful in the context of the properties panel in\n * order to update child elements of elements visible in\n * the diagram.\n *\n * Example: perform an update of a specific event definition\n * of an intermediate event.\n *\n * @class\n * @constructor\n */\nfunction UpdateBusinessObjectListHandler(elementRegistry, bpmnFactory) {\n  this._elementRegistry = elementRegistry;\n  this._bpmnFactory = bpmnFactory;\n}\n\nUpdateBusinessObjectListHandler.$inject = [ 'elementRegistry', 'bpmnFactory' ];\n\nmodule.exports = UpdateBusinessObjectListHandler;\n\nfunction ensureNotNull(prop, name) {\n  if (!prop) {\n    throw new Error(name + 'required');\n  }\n  return prop;\n}\n\n// api /////////////////////////////////////////////\n\n/**\n * Updates a element under a provided parent.\n */\nUpdateBusinessObjectListHandler.prototype.execute = function(context) {\n\n  var currentObject = ensureNotNull(context.currentObject, 'currentObject'),\n      propertyName = ensureNotNull(context.propertyName, 'propertyName'),\n      updatedObjectList = context.updatedObjectList,\n      objectsToRemove = context.objectsToRemove || [],\n      objectsToAdd = context.objectsToAdd || [],\n      changed = [ context.element], // this will not change any diagram-js elements\n      referencePropertyName;\n\n  if (context.referencePropertyName) {\n    referencePropertyName = context.referencePropertyName;\n  }\n\n  var objectList = currentObject[propertyName];\n  // adjust array reference in the parent business object\n  context.previousList = currentObject[propertyName];\n\n  if (updatedObjectList) {\n    currentObject[propertyName] = updatedObjectList;\n  } else {\n    var listCopy = [];\n    // remove all objects which should be removed\n    forEach(objectList, function(object) {\n      if (objectsToRemove.indexOf(object) == -1) {\n        listCopy.push(object);\n      }\n    });\n    // add all objects which should be added\n    listCopy = listCopy.concat(objectsToAdd);\n\n    // set property to new list\n    if (listCopy.length > 0 || !referencePropertyName) {\n\n      // as long as there are elements in the list update the list\n      currentObject[propertyName] = listCopy;\n    } else if (referencePropertyName) {\n\n      // remove the list when it is empty\n      var parentObject = currentObject.$parent;\n      parentObject.set(referencePropertyName, undefined);\n    }\n  }\n\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update\n *\n * @method  CreateBusinessObjectListHandler#revert\n *\n * @param {Object} context\n *\n * @return {djs.mode.Base} the updated element\n */\nUpdateBusinessObjectListHandler.prototype.revert = function(context) {\n\n  var currentObject = context.currentObject,\n      propertyName = context.propertyName,\n      previousList = context.previousList,\n      parentObject = currentObject.$parent;\n\n  if (context.referencePropertyName) {\n    parentObject.set(context.referencePropertyName, currentObject);\n  }\n\n  // remove new element\n  currentObject.set(propertyName, previousList);\n\n  return context.changed;\n};\n","'use strict';\n\nvar ModelUtil = require('bpmn-js/lib/util/ModelUtil'),\n    is = ModelUtil.is,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar extensionElementsHelper = require('./ExtensionElementsHelper'),\n    implementationTypeHelper = require('./ImplementationTypeHelper');\n\nvar InputOutputHelper = {};\n\nmodule.exports = InputOutputHelper;\n\nfunction getElements(bo, type, prop) {\n  var elems = extensionElementsHelper.getExtensionElements(bo, type) || [];\n  return !prop ? elems : (elems[0] || {})[prop] || [];\n}\n\nfunction getParameters(element, prop, insideConnector) {\n  var inputOutput = InputOutputHelper.getInputOutput(element, insideConnector);\n  return (inputOutput && inputOutput.get(prop)) || [];\n}\n\n/**\n * Get a inputOutput from the business object\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {ModdleElement} the inputOutput object\n */\nInputOutputHelper.getInputOutput = function(element, insideConnector) {\n  if (!insideConnector) {\n    var bo = getBusinessObject(element);\n    return (getElements(bo, 'camunda:InputOutput') || [])[0];\n  }\n  var connector = this.getConnector(element);\n  return connector && connector.get('inputOutput');\n};\n\n/**\n * Get a connector from the business object\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement} the connector object\n */\nInputOutputHelper.getConnector = function(element) {\n  var bo = implementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n  return bo && (getElements(bo, 'camunda:Connector') || [])[0];\n};\n\n/**\n * Return all input parameters existing in the business object, and\n * an empty array if none exist.\n *\n * @param  {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {Array} a list of input parameter objects\n */\nInputOutputHelper.getInputParameters = function(element, insideConnector) {\n  return getParameters.apply(this, [ element, 'inputParameters', insideConnector ]);\n};\n\n/**\n * Return all output parameters existing in the business object, and\n * an empty array if none exist.\n *\n * @param  {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {Array} a list of output parameter objects\n */\nInputOutputHelper.getOutputParameters = function(element, insideConnector) {\n  return getParameters.apply(this, [ element, 'outputParameters', insideConnector ]);\n};\n\n/**\n * Get a input parameter from the business object at given index\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n * @param {number} idx\n *\n * @return {ModdleElement} input parameter\n */\nInputOutputHelper.getInputParameter = function(element, insideConnector, idx) {\n  return this.getInputParameters(element, insideConnector)[idx];\n};\n\n/**\n * Get a output parameter from the business object at given index\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n * @param {number} idx\n *\n * @return {ModdleElement} output parameter\n */\nInputOutputHelper.getOutputParameter = function(element, insideConnector, idx) {\n  return this.getOutputParameters(element, insideConnector)[idx];\n};\n\n/**\n * Returns 'true' if the given element supports inputOutput\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {boolean} a boolean value\n */\nInputOutputHelper.isInputOutputSupported = function(element, insideConnector) {\n\n  if (insideConnector) {\n    return true;\n  }\n\n  var bo = getBusinessObject(element);\n\n  return (\n    is(bo, 'bpmn:FlowNode') && !(\n      is(bo, 'bpmn:StartEvent') ||\n      is(bo, 'bpmn:Gateway') ||\n      is(bo, 'bpmn:BoundaryEvent') ||\n      (\n        is(bo, 'bpmn:SubProcess') && bo.get('triggeredByEvent')\n      )\n    )\n  );\n};\n\n/**\n * Returns 'true' if the given element supports output parameters\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {boolean} a boolean value\n */\nInputOutputHelper.areOutputParametersSupported = function(element, insideConnector) {\n  var bo = getBusinessObject(element);\n  return insideConnector || (!is(bo, 'bpmn:EndEvent') && !bo.loopCharacteristics);\n};\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nmodule.exports = stackHas;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    elementReferenceProperty = require('../../../bpmn/parts/implementation/ElementReferenceProperty');\n\nmodule.exports = function(\n    group, element, bpmnFactory, errorEventDefinition,\n    showErrorCodeVariable, showErrorMessageVariable, translate\n) {\n\n\n  var getValue = function(modelProperty) {\n    return function(element) {\n      var modelPropertyValue = errorEventDefinition.get('camunda:' + modelProperty);\n      var value = {};\n\n      value[modelProperty] = modelPropertyValue;\n      return value;\n    };\n  };\n\n  var setValue = function(modelProperty) {\n    return function(element, values) {\n      var props = {};\n\n      props['camunda:' + modelProperty] = values[modelProperty] || undefined;\n\n      return cmdHelper.updateBusinessObject(element, errorEventDefinition, props);\n    };\n  };\n\n\n  group.entries = group.entries.concat(\n    elementReferenceProperty(element, errorEventDefinition, bpmnFactory, {\n      id: 'error-element-message',\n      label: translate('Error Message'),\n      referenceProperty: 'errorRef',\n      modelProperty: 'errorMessage'\n    })\n  );\n\n  if (showErrorCodeVariable) {\n    group.entries.push(entryFactory.textField({\n      id: 'errorCodeVariable',\n      label: translate('Error Code Variable'),\n      modelProperty : 'errorCodeVariable',\n\n      get: getValue('errorCodeVariable'),\n      set: setValue('errorCodeVariable')\n    }));\n  }\n\n  if (showErrorMessageVariable) {\n    group.entries.push(entryFactory.textField({\n      id: 'errorMessageVariable',\n      label: translate('Error Message Variable'),\n      modelProperty: 'errorMessageVariable',\n\n      get: getValue('errorMessageVariable'),\n      set: setValue('errorMessageVariable')\n    }));\n  }\n\n};\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar cmdHelper = require('../helper/CmdHelper');\n\nvar domQuery = require('min-dom').query,\n    domAttr = require('min-dom').attr,\n    domClosest = require('min-dom').closest;\n\nvar filter = require('lodash/filter'),\n    forEach = require('lodash/forEach'),\n    keys = require('lodash/keys');\n\nvar domify = require('min-dom').domify;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\nvar updateSelection = require('selection-update');\n\nvar TABLE_ROW_DIV_SNIPPET = '<div class=\"bpp-field-wrapper bpp-table-row\">';\nvar DELETE_ROW_BUTTON_SNIPPET = '<button class=\"clear\" data-action=\"deleteElement\">' +\n                                  '<span>X</span>' +\n                                '</button>';\n\nfunction createInputRowTemplate(properties, canRemove) {\n  var template = TABLE_ROW_DIV_SNIPPET;\n  template += createInputTemplate(properties, canRemove);\n  template += canRemove ? DELETE_ROW_BUTTON_SNIPPET : '';\n  template += '</div>';\n\n  return template;\n}\n\nfunction createInputTemplate(properties, canRemove) {\n  var columns = properties.length;\n  var template = '';\n  forEach(properties, function(prop) {\n    template += '<input class=\"bpp-table-row-columns-' + columns + ' ' +\n                               (canRemove ? 'bpp-table-row-removable' : '') + '\" ' +\n                       'id=\"camunda-table-row-cell-input-value\" ' +\n                       'type=\"text\" ' +\n                       'name=\"' + escapeHTML(prop) + '\" />';\n  });\n  return template;\n}\n\nfunction createLabelRowTemplate(labels) {\n  var template = TABLE_ROW_DIV_SNIPPET;\n  template += createLabelTemplate(labels);\n  template += '</div>';\n\n  return template;\n}\n\nfunction createLabelTemplate(labels) {\n  var columns = labels.length;\n  var template = '';\n  forEach(labels, function(label) {\n    template += '<label class=\"bpp-table-row-columns-' + columns + '\">' + escapeHTML(label) + '</label>';\n  });\n  return template;\n}\n\nfunction pick(elements, properties) {\n  return (elements || []).map(function(elem) {\n    var newElement = {};\n    forEach(properties, function(prop) {\n      newElement[prop] = elem[prop] || '';\n    });\n    return newElement;\n  });\n}\n\nfunction diff(element, node, values, oldValues, editable) {\n  return filter(values, function(value, idx) {\n    return !valueEqual(element, node, value, oldValues[idx], editable, idx);\n  });\n}\n\nfunction valueEqual(element, node, value, oldValue, editable, idx) {\n  if (value && !oldValue) {\n    return false;\n  }\n  var allKeys = keys(value).concat(keys(oldValue));\n\n  return allKeys.every(function(key) {\n    var n = value[key] || undefined;\n    var o = oldValue[key] || undefined;\n    return !editable(element, node, key, idx) || n === o;\n  });\n}\n\nfunction getEntryNode(node) {\n  return domClosest(node, '[data-entry]', true);\n}\n\nfunction getContainer(node) {\n  return domQuery('div[data-list-entry-container]', node);\n}\n\nfunction getSelection(node) {\n  return {\n    start: node.selectionStart,\n    end: node.selectionEnd\n  };\n}\n\nfunction setSelection(node, selection) {\n  node.selectionStart = selection.start;\n  node.selectionEnd = selection.end;\n}\n\n/**\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {string} options.description\n * @param  {Array<string>} options.modelProperties\n * @param  {Array<string>} options.labels\n * @param  {Function} options.getElements - this callback function must return a list of business object items\n * @param  {Function} options.removeElement\n * @param  {Function} options.addElement\n * @param  {Function} options.updateElement\n * @param  {Function} options.editable\n * @param  {Function} options.setControlValue\n * @param  {Function} options.show\n *\n * @return {Object}\n */\nmodule.exports = function(options) {\n\n  var id = options.id,\n      modelProperties = options.modelProperties,\n      labels = options.labels,\n      description = options.description;\n\n  var labelRow = createLabelRowTemplate(labels);\n\n  var getElements = options.getElements;\n\n  var removeElement = options.removeElement,\n      canRemove = typeof removeElement === 'function';\n\n  var addElement = options.addElement,\n      canAdd = typeof addElement === 'function',\n      addLabel = options.addLabel || 'Add Value';\n\n  var updateElement = options.updateElement,\n      canUpdate = typeof updateElement === 'function';\n\n  var editable = options.editable || function() { return true; },\n      setControlValue = options.setControlValue;\n\n  var show = options.show,\n      canBeShown = typeof show === 'function';\n\n  var elements = function(element, node) {\n    return pick(getElements(element, node), modelProperties);\n  };\n\n  var factory = {\n    id: id,\n    html: (canAdd ?\n      '<div class=\"bpp-table-add-row\" ' + (canBeShown ? 'data-show=\"show\"' : '') + '>' +\n            '<label>' + escapeHTML(addLabel) + '</label>' +\n            '<button class=\"add\" data-action=\"addElement\"><span>+</span></button>' +\n          '</div>' : '') +\n          '<div class=\"bpp-table\" data-show=\"showTable\">' +\n            '<div class=\"bpp-field-wrapper bpp-table-row\">' +\n               labelRow +\n            '</div>' +\n            '<div data-list-entry-container>' +\n            '</div>' +\n          '</div>' +\n\n          // add description below table entry field\n          (description ? entryFieldDescription(description) : ''),\n\n    get: function(element, node) {\n      var boElements = elements(element, node, this.__invalidValues);\n\n      var invalidValues = this.__invalidValues;\n\n      delete this.__invalidValues;\n\n      forEach(invalidValues, function(value, idx) {\n        var element = boElements[idx];\n\n        forEach(modelProperties, function(prop) {\n          element[prop] = value[prop];\n        });\n      });\n\n      return boElements;\n    },\n\n    set: function(element, values, node) {\n      var action = this.__action || {};\n      delete this.__action;\n\n      if (action.id === 'delete-element') {\n        return removeElement(element, node, action.idx);\n      }\n      else if (action.id === 'add-element') {\n        return addElement(element, node);\n      }\n      else if (canUpdate) {\n        var commands = [],\n            valuesToValidate = values;\n\n        if (typeof options.validate !== 'function') {\n          valuesToValidate = diff(element, node, values, elements(element, node), editable);\n        }\n\n        var self = this;\n\n        forEach(valuesToValidate, function(value) {\n          var validationError,\n              idx = values.indexOf(value);\n\n          if (typeof options.validate === 'function') {\n            validationError = options.validate(element, value, node, idx);\n          }\n\n          if (!validationError) {\n            var cmd = updateElement(element, value, node, idx);\n\n            if (cmd) {\n              commands.push(cmd);\n            }\n          } else {\n            // cache invalid value in an object by index as key\n            self.__invalidValues = self.__invalidValues || {};\n            self.__invalidValues[idx] = value;\n\n            // execute a command, which does not do anything\n            commands.push(cmdHelper.updateProperties(element, {}));\n          }\n        });\n\n        return commands;\n      }\n    },\n    createListEntryTemplate: function(value, index, selectBox) {\n      return createInputRowTemplate(modelProperties, canRemove);\n    },\n\n    addElement: function(element, node, event, scopeNode) {\n      var template = domify(createInputRowTemplate(modelProperties, canRemove));\n\n      var container = getContainer(node);\n      container.appendChild(template);\n\n      this.__action = {\n        id: 'add-element'\n      };\n\n      return true;\n    },\n\n    deleteElement: function(element, node, event, scopeNode) {\n      var container = getContainer(node);\n      var rowToDelete = event.delegateTarget.parentNode;\n      var idx = parseInt(domAttr(rowToDelete, 'data-index'), 10);\n\n      container.removeChild(rowToDelete);\n\n      this.__action = {\n        id: 'delete-element',\n        idx: idx\n      };\n\n      return true;\n    },\n\n    editable: function(element, rowNode, input, prop, value, idx) {\n      var entryNode = domClosest(rowNode, '[data-entry]');\n      return editable(element, entryNode, prop, idx);\n    },\n\n    show: function(element, entryNode, node, scopeNode) {\n      entryNode = getEntryNode(entryNode);\n      return show(element, entryNode, node, scopeNode);\n    },\n\n    showTable: function(element, entryNode, node, scopeNode) {\n      entryNode = getEntryNode(entryNode);\n      var elems = elements(element, entryNode);\n      return elems && elems.length && (!canBeShown || show(element, entryNode, node, scopeNode));\n    },\n\n    validateListItem: function(element, value, node, idx) {\n      if (typeof options.validate === 'function') {\n        return options.validate(element, value, node, idx);\n      }\n    }\n\n  };\n\n  // Update/set the selection on the correct position.\n  // It's the same code like for an input value in the PropertiesPanel.js.\n  if (setControlValue) {\n    factory.setControlValue = function(element, rowNode, input, prop, value, idx) {\n      var entryNode = getEntryNode(rowNode);\n\n      var isReadOnly = domAttr(input, 'readonly');\n      var oldValue = input.value;\n\n      var selection;\n\n      // prevents input fields from having the value 'undefined'\n      if (value === undefined) {\n        value = '';\n      }\n\n      // when the attribute 'readonly' exists, ignore the comparison\n      // with 'oldValue' and 'value'\n      if (!!isReadOnly && oldValue === value) {\n        return;\n      }\n\n      // update selection on undo/redo\n      if (document.activeElement === input) {\n        selection = updateSelection(getSelection(input), oldValue, value);\n      }\n\n      setControlValue(element, entryNode, input, prop, value, idx);\n\n      if (selection) {\n        setSelection(input, selection);\n      }\n\n    };\n  }\n\n  return factory;\n\n};\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","/**\n * Gets the argument placeholder value for `func`.\n *\n * @private\n * @param {Function} func The function to inspect.\n * @returns {*} Returns the placeholder value.\n */\nfunction getHolder(func) {\n  var object = func;\n  return object.placeholder;\n}\n\nmodule.exports = getHolder;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","'use strict';\n\nvar ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper');\n\nvar fieldInjection = require('./implementation/FieldInjection');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var bo = ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  var fieldInjectionEntry = fieldInjection(element, bpmnFactory, translate, { businessObject: bo });\n\n  if (fieldInjectionEntry && fieldInjectionEntry.length > 0) {\n    group.entries = group.entries.concat(fieldInjectionEntry);\n  }\n\n};\n","var arrayPush = require('./_arrayPush'),\n    isFlattenable = require('./_isFlattenable');\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseFlatten;\n","var baseIteratee = require('./_baseIteratee'),\n    isArrayLike = require('./isArrayLike'),\n    keys = require('./keys');\n\n/**\n * Creates a `_.find` or `_.findLast` function.\n *\n * @private\n * @param {Function} findIndexFunc The function to find the collection index.\n * @returns {Function} Returns the new find function.\n */\nfunction createFind(findIndexFunc) {\n  return function(collection, predicate, fromIndex) {\n    var iterable = Object(collection);\n    if (!isArrayLike(collection)) {\n      var iteratee = baseIteratee(predicate, 3);\n      collection = keys(collection);\n      predicate = function(key) { return iteratee(iterable[key], key, iterable); };\n    }\n    var index = findIndexFunc(collection, predicate, fromIndex);\n    return index > -1 ? iterable[iteratee ? collection[index] : index] : undefined;\n  };\n}\n\nmodule.exports = createFind;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper'),\n    scriptImplementation = require('./implementation/Script');\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var bo;\n\n  if (is(element, 'bpmn:ScriptTask')) {\n    bo = getBusinessObject(element);\n  }\n\n  if (!bo) {\n    return;\n  }\n\n  var script = scriptImplementation('scriptFormat', 'script', false, translate);\n  group.entries.push({\n    id: 'script-implementation',\n    label: translate('Script'),\n    html: script.template,\n\n    get: function(element) {\n      return script.get(element, bo);\n    },\n\n    set: function(element, values, containerElement) {\n      var properties = script.set(element, values, containerElement);\n\n      return cmdHelper.updateProperties(element, properties);\n    },\n\n    validate: function(element, values) {\n      return script.validate(element, values);\n    },\n\n    script : script,\n\n    cssClasses: ['bpp-textfield']\n\n  });\n\n  group.entries.push(entryFactory.textField({\n    id : 'scriptResultVariable',\n    label : translate('Result Variable'),\n    modelProperty : 'scriptResultVariable',\n\n    get: function(element, propertyName) {\n      var boResultVariable = bo.get('camunda:resultVariable');\n\n      return { scriptResultVariable : boResultVariable };\n    },\n\n    set: function(element, values, containerElement) {\n      return cmdHelper.updateProperties(element, {\n        'camunda:resultVariable': values.scriptResultVariable.length\n          ? values.scriptResultVariable\n          : undefined\n      });\n    }\n\n  }));\n\n};\n","var listCacheClear = require('./_listCacheClear'),\n    listCacheDelete = require('./_listCacheDelete'),\n    listCacheGet = require('./_listCacheGet'),\n    listCacheHas = require('./_listCacheHas'),\n    listCacheSet = require('./_listCacheSet');\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nmodule.exports = ListCache;\n","/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arrayIncludesWith;\n","'use strict';\n// based on https://github.com/bestiejs/punycode.js/blob/master/punycode.js\nvar maxInt = 2147483647; // aka. 0x7FFFFFFF or 2^31-1\nvar base = 36;\nvar tMin = 1;\nvar tMax = 26;\nvar skew = 38;\nvar damp = 700;\nvar initialBias = 72;\nvar initialN = 128; // 0x80\nvar delimiter = '-'; // '\\x2D'\nvar regexNonASCII = /[^\\0-\\u007E]/; // non-ASCII chars\nvar regexSeparators = /[.\\u3002\\uFF0E\\uFF61]/g; // RFC 3490 separators\nvar OVERFLOW_ERROR = 'Overflow: input needs wider integers to process';\nvar baseMinusTMin = base - tMin;\nvar floor = Math.floor;\nvar stringFromCharCode = String.fromCharCode;\n\n/**\n * Creates an array containing the numeric code points of each Unicode\n * character in the string. While JavaScript uses UCS-2 internally,\n * this function will convert a pair of surrogate halves (each of which\n * UCS-2 exposes as separate characters) into a single code point,\n * matching UTF-16.\n */\nvar ucs2decode = function (string) {\n  var output = [];\n  var counter = 0;\n  var length = string.length;\n  while (counter < length) {\n    var value = string.charCodeAt(counter++);\n    if (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n      // It's a high surrogate, and there is a next character.\n      var extra = string.charCodeAt(counter++);\n      if ((extra & 0xFC00) == 0xDC00) { // Low surrogate.\n        output.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n      } else {\n        // It's an unmatched surrogate; only append this code unit, in case the\n        // next code unit is the high surrogate of a surrogate pair.\n        output.push(value);\n        counter--;\n      }\n    } else {\n      output.push(value);\n    }\n  }\n  return output;\n};\n\n/**\n * Converts a digit/integer into a basic code point.\n */\nvar digitToBasic = function (digit) {\n  //  0..25 map to ASCII a..z or A..Z\n  // 26..35 map to ASCII 0..9\n  return digit + 22 + 75 * (digit < 26);\n};\n\n/**\n * Bias adaptation function as per section 3.4 of RFC 3492.\n * https://tools.ietf.org/html/rfc3492#section-3.4\n */\nvar adapt = function (delta, numPoints, firstTime) {\n  var k = 0;\n  delta = firstTime ? floor(delta / damp) : delta >> 1;\n  delta += floor(delta / numPoints);\n  for (; delta > baseMinusTMin * tMax >> 1; k += base) {\n    delta = floor(delta / baseMinusTMin);\n  }\n  return floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n};\n\n/**\n * Converts a string of Unicode symbols (e.g. a domain name label) to a\n * Punycode string of ASCII-only symbols.\n */\n// eslint-disable-next-line  max-statements\nvar encode = function (input) {\n  var output = [];\n\n  // Convert the input in UCS-2 to an array of Unicode code points.\n  input = ucs2decode(input);\n\n  // Cache the length.\n  var inputLength = input.length;\n\n  // Initialize the state.\n  var n = initialN;\n  var delta = 0;\n  var bias = initialBias;\n  var i, currentValue;\n\n  // Handle the basic code points.\n  for (i = 0; i < input.length; i++) {\n    currentValue = input[i];\n    if (currentValue < 0x80) {\n      output.push(stringFromCharCode(currentValue));\n    }\n  }\n\n  var basicLength = output.length; // number of basic code points.\n  var handledCPCount = basicLength; // number of code points that have been handled;\n\n  // Finish the basic string with a delimiter unless it's empty.\n  if (basicLength) {\n    output.push(delimiter);\n  }\n\n  // Main encoding loop:\n  while (handledCPCount < inputLength) {\n    // All non-basic code points < n have been handled already. Find the next larger one:\n    var m = maxInt;\n    for (i = 0; i < input.length; i++) {\n      currentValue = input[i];\n      if (currentValue >= n && currentValue < m) {\n        m = currentValue;\n      }\n    }\n\n    // Increase `delta` enough to advance the decoder's <n,i> state to <m,0>, but guard against overflow.\n    var handledCPCountPlusOne = handledCPCount + 1;\n    if (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n      throw RangeError(OVERFLOW_ERROR);\n    }\n\n    delta += (m - n) * handledCPCountPlusOne;\n    n = m;\n\n    for (i = 0; i < input.length; i++) {\n      currentValue = input[i];\n      if (currentValue < n && ++delta > maxInt) {\n        throw RangeError(OVERFLOW_ERROR);\n      }\n      if (currentValue == n) {\n        // Represent delta as a generalized variable-length integer.\n        var q = delta;\n        for (var k = base; /* no condition */; k += base) {\n          var t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n          if (q < t) break;\n          var qMinusT = q - t;\n          var baseMinusT = base - t;\n          output.push(stringFromCharCode(digitToBasic(t + qMinusT % baseMinusT)));\n          q = floor(qMinusT / baseMinusT);\n        }\n\n        output.push(stringFromCharCode(digitToBasic(q)));\n        bias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n        delta = 0;\n        ++handledCPCount;\n      }\n    }\n\n    ++delta;\n    ++n;\n  }\n  return output.join('');\n};\n\nmodule.exports = function (input) {\n  var encoded = [];\n  var labels = input.toLowerCase().replace(regexSeparators, '\\u002E').split('.');\n  var i, label;\n  for (i = 0; i < labels.length; i++) {\n    label = labels[i];\n    encoded.push(regexNonASCII.test(label) ? 'xn--' + encode(label) : label);\n  }\n  return encoded.join('.');\n};\n","'use strict';\n\n/**\n * The label factory provides a label entry. For the label text\n * it expects either a string provided by the options.labelText\n * parameter or it could be generated programmatically using a\n * function passed as the options.get parameter.\n *\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {string} [options.labelText]\n * @param  {Function} [options.get]\n * @param  {Function} [options.showLabel]\n * @param  {Boolean} [options.divider] adds a divider at the top of the label if true; default: false\n */\nvar label = function(options) {\n  return {\n    id: options.id,\n    html: '<label data-value=\"label\" ' +\n            'data-show=\"showLabel\" ' +\n            'class=\"entry-label' + (options.divider ? ' divider' : '') + '\">' +\n          '</label>',\n    get: function(element, node) {\n      if (typeof options.get === 'function') {\n        return options.get(element, node);\n      }\n      return { label: options.labelText };\n    },\n    showLabel: function(element, node) {\n      if (typeof options.showLabel === 'function') {\n        return options.showLabel(element, node);\n      }\n      return true;\n    }\n  };\n};\n\nmodule.exports = label;\n","var getNative = require('./_getNative');\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nmodule.exports = nativeCreate;\n","var baseCreate = require('./_baseCreate'),\n    baseLodash = require('./_baseLodash');\n\n/** Used as references for the maximum length and index of an array. */\nvar MAX_ARRAY_LENGTH = 4294967295;\n\n/**\n * Creates a lazy wrapper object which wraps `value` to enable lazy evaluation.\n *\n * @private\n * @constructor\n * @param {*} value The value to wrap.\n */\nfunction LazyWrapper(value) {\n  this.__wrapped__ = value;\n  this.__actions__ = [];\n  this.__dir__ = 1;\n  this.__filtered__ = false;\n  this.__iteratees__ = [];\n  this.__takeCount__ = MAX_ARRAY_LENGTH;\n  this.__views__ = [];\n}\n\n// Ensure `LazyWrapper` is an instance of `baseLodash`.\nLazyWrapper.prototype = baseCreate(baseLodash.prototype);\nLazyWrapper.prototype.constructor = LazyWrapper;\n\nmodule.exports = LazyWrapper;\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","var toNumber = require('./toNumber');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308;\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\nmodule.exports = toFinite;\n","var baseIsMatch = require('./_baseIsMatch'),\n    getMatchData = require('./_getMatchData'),\n    matchesStrictComparable = require('./_matchesStrictComparable');\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nmodule.exports = baseMatches;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isAny = require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    escapeHTML = require('../../../Utils').escapeHTML,\n    domQuery = require('min-dom').query,\n    cmdHelper = require('../../../helper/CmdHelper'),\n    elementHelper = require('../../../helper/ElementHelper'),\n    eventDefinitionHelper = require('../../../helper/EventDefinitionHelper'),\n    scriptImplementation = require('./implementation/Script');\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var bo = getBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  var conditionalEventDefinition = eventDefinitionHelper.getConditionalEventDefinition(element);\n\n  if (!(is(element, 'bpmn:SequenceFlow') && isConditionalSource(element.source))\n    && !conditionalEventDefinition) {\n    return;\n  }\n\n  var script = scriptImplementation('language', 'body', true, translate);\n  group.entries.push({\n    id: 'condition',\n    label: translate('Condition'),\n    html: '<div class=\"bpp-row\">' +\n              '<label for=\"cam-condition-type\">'+ escapeHTML(translate('Condition Type')) + '</label>' +\n              '<div class=\"bpp-field-wrapper\">' +\n                '<select id=\"cam-condition-type\" name=\"conditionType\" data-value>' +\n                  '<option value=\"expression\">'+ escapeHTML(translate('Expression')) + '</option>' +\n                  '<option value=\"script\">'+ escapeHTML(translate('Script')) + '</option>' +\n                  '<option value=\"\" selected></option>' +\n                '</select>' +\n              '</div>' +\n            '</div>' +\n\n            // expression\n            '<div class=\"bpp-row\">' +\n              '<label for=\"cam-condition\" data-show=\"isExpression\">' + escapeHTML(translate('Expression')) + '</label>' +\n              '<div class=\"bpp-field-wrapper\" data-show=\"isExpression\">' +\n                '<input id=\"cam-condition\" type=\"text\" name=\"condition\" />' +\n                '<button class=\"clear\" data-action=\"clear\" data-show=\"canClear\">' +\n                  '<span>X</span>' +\n                '</button>' +\n              '</div>' +\n              '<div data-show=\"isScript\">' +\n                script.template +\n              '</div>' +\n            '</div>',\n\n    get: function(element, propertyName) {\n      var conditionalEventDefinition = eventDefinitionHelper.getConditionalEventDefinition(element);\n\n      var conditionExpression = conditionalEventDefinition\n        ? conditionalEventDefinition.condition\n        : bo.conditionExpression;\n\n      var values = {},\n          conditionType = '';\n\n      if (conditionExpression) {\n        var conditionLanguage = conditionExpression.language;\n        if (typeof conditionLanguage !== 'undefined') {\n          conditionType = 'script';\n          values = script.get(element, conditionExpression);\n        } else {\n          conditionType = 'expression';\n          values.condition = conditionExpression.get('body');\n        }\n      }\n\n      values.conditionType = conditionType;\n\n      return values;\n\n    },\n\n    set: function(element, values, containerElement) {\n      var conditionType = values.conditionType;\n      var commands = [];\n\n      var conditionProps = {\n        body: undefined\n      };\n\n      if (conditionType === 'script') {\n        conditionProps = script.set(element, values, containerElement);\n      } else {\n        var condition = values.condition;\n\n        conditionProps.body = condition;\n      }\n\n      var conditionOrConditionExpression;\n\n      if (conditionType) {\n        conditionOrConditionExpression = elementHelper.createElement(\n          'bpmn:FormalExpression',\n          conditionProps,\n          conditionalEventDefinition || bo,\n          bpmnFactory\n        );\n\n        var source = element.source;\n\n        // if default-flow, remove default-property from source\n        if (source && source.businessObject.default === bo) {\n          commands.push(cmdHelper.updateProperties(source, { 'default': undefined }));\n        }\n      }\n\n      var update = conditionalEventDefinition\n        ? { condition: conditionOrConditionExpression }\n        : { conditionExpression: conditionOrConditionExpression };\n\n      commands.push(cmdHelper.updateBusinessObject(element, conditionalEventDefinition || bo, update));\n\n      return commands;\n    },\n\n    validate: function(element, values) {\n      var validationResult = {};\n\n      if (!values.condition && values.conditionType === 'expression') {\n        validationResult.condition = translate('Must provide a value');\n      }\n      else if (values.conditionType === 'script') {\n        validationResult = script.validate(element, values);\n      }\n\n      return validationResult;\n    },\n\n    isExpression: function(element, inputNode) {\n      var conditionType = domQuery('select[name=conditionType]', inputNode);\n      if (conditionType.selectedIndex >= 0) {\n        return conditionType.options[conditionType.selectedIndex].value === 'expression';\n      }\n    },\n\n    isScript: function(element, inputNode) {\n      var conditionType = domQuery('select[name=conditionType]', inputNode);\n      if (conditionType.selectedIndex >= 0) {\n        return conditionType.options[conditionType.selectedIndex].value === 'script';\n      }\n    },\n\n    clear: function(element, inputNode) {\n      // clear text input\n      domQuery('input[name=condition]', inputNode).value='';\n\n      return true;\n    },\n\n    canClear: function(element, inputNode) {\n      var input = domQuery('input[name=condition]', inputNode);\n\n      return input.value !== '';\n    },\n\n    script : script,\n\n    cssClasses: [ 'bpp-textfield' ]\n  });\n};\n\n\n// utilities //////////////////////////\n\nvar CONDITIONAL_SOURCES = [\n  'bpmn:Activity',\n  'bpmn:ExclusiveGateway',\n  'bpmn:InclusiveGateway',\n  'bpmn:ComplexGateway'\n];\n\nfunction isConditionalSource(element) {\n  return isAny(element, CONDITIONAL_SOURCES);\n}\n","var toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `String.prototype.{ codePointAt, at }` methods implementation\nvar createMethod = function (CONVERT_TO_STRING) {\n  return function ($this, pos) {\n    var S = String(requireObjectCoercible($this));\n    var position = toInteger(pos);\n    var size = S.length;\n    var first, second;\n    if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;\n    first = S.charCodeAt(position);\n    return first < 0xD800 || first > 0xDBFF || position + 1 === size\n      || (second = S.charCodeAt(position + 1)) < 0xDC00 || second > 0xDFFF\n        ? CONVERT_TO_STRING ? S.charAt(position) : first\n        : CONVERT_TO_STRING ? S.slice(position, position + 2) : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.codePointAt` method\n  // https://tc39.github.io/ecma262/#sec-string.prototype.codepointat\n  codeAt: createMethod(false),\n  // `String.prototype.at` method\n  // https://github.com/mathiasbynens/String.prototype.at\n  charAt: createMethod(true)\n};\n","var castPath = require('./_castPath'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nmodule.exports = baseGet;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var jobPriorityEntry = entryFactory.textField({\n    id: 'jobPriority',\n    label: translate('Job Priority'),\n    modelProperty: 'jobPriority',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        jobPriority: bo.get('camunda:jobPriority')\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:jobPriority': values.jobPriority || undefined\n      });\n    }\n\n  });\n\n  return [ jobPriorityEntry ];\n\n};\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nmodule.exports = listCacheSet;\n","module.exports = {\n  __depends__: [\n    require('./cmd'),\n    require('diagram-js/lib/i18n/translate').default\n  ],\n  __init__: [\n    'customElementsPropertiesActivator',\n    'elementTemplatesLoader'\n  ],\n  customElementsPropertiesActivator: [ 'type', require('./CustomElementsPropertiesActivator') ],\n  elementTemplates: [ 'type', require('./ElementTemplates') ],\n  elementTemplatesLoader: [ 'type', require('./ElementTemplatesLoader') ]\n};\n","const {\n  is\n} = require('bpmnlint-utils');\n\n/**\n * A rule that verifies that there are no disconnected\n * flow elements, i.e. elements without incoming\n * _or_ outgoing sequence flows\n */\nmodule.exports = function() {\n\n  const keyed = {};\n\n  const outgoingReported = {};\n  const incomingReported = {};\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:SequenceFlow')) {\n      return;\n    }\n\n    const key = flowKey(node);\n\n    if (key in keyed) {\n      reporter.report(node.id, 'SequenceFlow is a duplicate');\n\n      const sourceId = node.sourceRef.id;\n      const targetId = node.targetRef.id;\n\n      console.log(sourceId, targetId);\n\n      if (!outgoingReported[sourceId]) {\n        reporter.report(sourceId, 'Duplicate outgoing sequence flows');\n\n        outgoingReported[sourceId] = true;\n      }\n\n      if (!incomingReported[targetId]) {\n        reporter.report(targetId, 'Duplicate incoming sequence flows');\n\n        incomingReported[targetId] = true;\n      }\n    } else {\n      keyed[key] = node;\n    }\n  }\n\n  return {\n    check\n  };\n\n};\n\n\n// helpers /////////////////\n\nfunction flowKey(flow) {\n  const conditionExpression = flow.conditionExpression;\n\n  const condition = conditionExpression ? conditionExpression.body : '';\n  const source = flow.sourceRef ? flow.sourceRef.id : flow.id;\n  const target = flow.targetRef ? flow.targetRef.id : flow.id;\n\n  return source + '#' + target + '#' + condition;\n}","const {\n  is\n} = require('bpmnlint-utils');\n\n/**\n * A rule that checks that start events inside an event sub-process\n * are typed.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:SubProcess') || !node.triggeredByEvent) {\n      return;\n    }\n\n    const flowElements = node.flowElements || [];\n\n    flowElements.forEach(function(flowElement) {\n\n      if (!is(flowElement, 'bpmn:StartEvent')) {\n        return false;\n      }\n\n      const eventDefinitions = flowElement.eventDefinitions || [];\n\n      if (eventDefinitions.length === 0) {\n        reporter.report(flowElement.id, 'Start event is missing event definition');\n      }\n    });\n  }\n\n  return {\n    check\n  };\n\n};","var assocIndexOf = require('./_assocIndexOf');\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nmodule.exports = listCacheDelete;\n","var composeArgs = require('./_composeArgs'),\n    composeArgsRight = require('./_composeArgsRight'),\n    countHolders = require('./_countHolders'),\n    createCtor = require('./_createCtor'),\n    createRecurry = require('./_createRecurry'),\n    getHolder = require('./_getHolder'),\n    reorder = require('./_reorder'),\n    replaceHolders = require('./_replaceHolders'),\n    root = require('./_root');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_CURRY_RIGHT_FLAG = 16,\n    WRAP_ARY_FLAG = 128,\n    WRAP_FLIP_FLAG = 512;\n\n/**\n * Creates a function that wraps `func` to invoke it with optional `this`\n * binding of `thisArg`, partial application, and currying.\n *\n * @private\n * @param {Function|string} func The function or method name to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {*} [thisArg] The `this` binding of `func`.\n * @param {Array} [partials] The arguments to prepend to those provided to\n *  the new function.\n * @param {Array} [holders] The `partials` placeholder indexes.\n * @param {Array} [partialsRight] The arguments to append to those provided\n *  to the new function.\n * @param {Array} [holdersRight] The `partialsRight` placeholder indexes.\n * @param {Array} [argPos] The argument positions of the new function.\n * @param {number} [ary] The arity cap of `func`.\n * @param {number} [arity] The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createHybrid(func, bitmask, thisArg, partials, holders, partialsRight, holdersRight, argPos, ary, arity) {\n  var isAry = bitmask & WRAP_ARY_FLAG,\n      isBind = bitmask & WRAP_BIND_FLAG,\n      isBindKey = bitmask & WRAP_BIND_KEY_FLAG,\n      isCurried = bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG),\n      isFlip = bitmask & WRAP_FLIP_FLAG,\n      Ctor = isBindKey ? undefined : createCtor(func);\n\n  function wrapper() {\n    var length = arguments.length,\n        args = Array(length),\n        index = length;\n\n    while (index--) {\n      args[index] = arguments[index];\n    }\n    if (isCurried) {\n      var placeholder = getHolder(wrapper),\n          holdersCount = countHolders(args, placeholder);\n    }\n    if (partials) {\n      args = composeArgs(args, partials, holders, isCurried);\n    }\n    if (partialsRight) {\n      args = composeArgsRight(args, partialsRight, holdersRight, isCurried);\n    }\n    length -= holdersCount;\n    if (isCurried && length < arity) {\n      var newHolders = replaceHolders(args, placeholder);\n      return createRecurry(\n        func, bitmask, createHybrid, wrapper.placeholder, thisArg,\n        args, newHolders, argPos, ary, arity - length\n      );\n    }\n    var thisBinding = isBind ? thisArg : this,\n        fn = isBindKey ? thisBinding[func] : func;\n\n    length = args.length;\n    if (argPos) {\n      args = reorder(args, argPos);\n    } else if (isFlip && length > 1) {\n      args.reverse();\n    }\n    if (isAry && ary < length) {\n      args.length = ary;\n    }\n    if (this && this !== root && this instanceof wrapper) {\n      fn = Ctor || createCtor(fn);\n    }\n    return fn.apply(thisBinding, args);\n  }\n  return wrapper;\n}\n\nmodule.exports = createHybrid;\n","var WeakMap = require('./_WeakMap');\n\n/** Used to store function metadata. */\nvar metaMap = WeakMap && new WeakMap;\n\nmodule.exports = metaMap;\n","var arrayEach = require('./_arrayEach'),\n    baseEach = require('./_baseEach'),\n    castFunction = require('./_castFunction'),\n    isArray = require('./isArray');\n\n/**\n * Iterates over elements of `collection` and invokes `iteratee` for each element.\n * The iteratee is invoked with three arguments: (value, index|key, collection).\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n * property are iterated like arrays. To avoid this behavior use `_.forIn`\n * or `_.forOwn` for object iteration.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @alias each\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n * @see _.forEachRight\n * @example\n *\n * _.forEach([1, 2], function(value) {\n *   console.log(value);\n * });\n * // => Logs `1` then `2`.\n *\n * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n */\nfunction forEach(collection, iteratee) {\n  var func = isArray(collection) ? arrayEach : baseEach;\n  return func(collection, castFunction(iteratee));\n}\n\nmodule.exports = forEach;\n","/**\n * Traverse a moddle tree, depth first from top to bottom\n * and call the passed visitor fn.\n *\n * @param {ModdleElement} element\n * @param {Function} fn\n */\nmodule.exports = function traverse(element, fn) {\n  fn(element);\n\n  var descriptor = element.$descriptor;\n\n  if (descriptor.isGeneric) {\n    return;\n  }\n\n  var containedProperties = descriptor.properties.filter(p => {\n    return !p.isAttr && !p.isReference && p.type !== 'String';\n  });\n\n  containedProperties.forEach(p => {\n    if (p.name in element) {\n      const propertyValue = element[p.name];\n\n      if (p.isMany) {\n        propertyValue.forEach(child => {\n          traverse(child, fn);\n        });\n      } else {\n        traverse(propertyValue, fn);\n      }\n    }\n  });\n};\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","'use strict';\r\n\r\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\r\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\r\n\r\nvar tasklist = require('./implementation/Tasklist');\r\n\r\nmodule.exports = function(group, element, bpmnFactory, translate) {\r\n  var businessObject = getBusinessObject(element);\r\n\r\n  if (is(element, 'camunda:Process') ||\r\n      is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\r\n\r\n    group.entries = group.entries.concat(tasklist(element, bpmnFactory, {\r\n      getBusinessObject: function(element) {\r\n        var bo = getBusinessObject(element);\r\n\r\n        if (!is(bo, 'bpmn:Participant')) {\r\n          return bo;\r\n        }\r\n\r\n        return bo.get('processRef');\r\n      }\r\n    }, translate));\r\n\r\n  }\r\n};\r\n","var createBaseFor = require('./_createBaseFor');\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nmodule.exports = baseFor;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\nvar forEach = require('lodash/forEach');\n\nfunction getLinkEventDefinition(element) {\n\n  var bo = getBusinessObject(element);\n\n  var linkEventDefinition = null;\n  if (bo.eventDefinitions) {\n    forEach(bo.eventDefinitions, function(eventDefinition) {\n      if (is(eventDefinition, 'bpmn:LinkEventDefinition')) {\n        linkEventDefinition = eventDefinition;\n      }\n    });\n  }\n\n  return linkEventDefinition;\n}\n\nmodule.exports = function(group, element, translate) {\n  var linkEvents = [ 'bpmn:IntermediateThrowEvent', 'bpmn:IntermediateCatchEvent' ];\n\n  forEach(linkEvents, function(event) {\n    if (is(element, event)) {\n\n      var linkEventDefinition = getLinkEventDefinition(element);\n\n      if (linkEventDefinition) {\n        var entry = entryFactory.textField({\n          id: 'link-event',\n          label: translate('Link Name'),\n          modelProperty: 'link-name'\n        });\n\n        entry.get = function() {\n          return { 'link-name': linkEventDefinition.get('name') };\n        };\n\n        entry.set = function(element, values) {\n          var newProperties = {\n            name: values['link-name']\n          };\n          return cmdHelper.updateBusinessObject(element, linkEventDefinition, newProperties);\n        };\n\n        group.entries.push(entry);\n      }\n    }\n  });\n};\n\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nmodule.exports = constant;\n","'use strict';\n\nvar Validator = require('./Validator');\n\n/**\n * The guy responsible for template loading.\n *\n * Provide the actual templates via the `config.elementTemplates`.\n *\n * That configuration can either be an array of template\n * descriptors or a node style callback to retrieve\n * the templates asynchronously.\n *\n * @param {Array<TemplateDescriptor>|Function} loadTemplates\n * @param {EventBus} eventBus\n * @param {ElementTemplates} elementTemplates\n */\nfunction ElementTemplatesLoader(loadTemplates, eventBus, elementTemplates) {\n  this._loadTemplates = loadTemplates;\n  this._eventBus = eventBus;\n  this._elementTemplates = elementTemplates;\n\n  var self = this;\n\n  eventBus.on('diagram.init', function() {\n    self.reload();\n  });\n}\n\nmodule.exports = ElementTemplatesLoader;\n\nElementTemplatesLoader.$inject = [\n  'config.elementTemplates',\n  'eventBus',\n  'elementTemplates'\n];\n\n\nElementTemplatesLoader.prototype.reload = function() {\n\n  var self = this;\n\n  var loadTemplates = this._loadTemplates;\n\n  // no templates specified\n  if (typeof loadTemplates === 'undefined') {\n    return;\n  }\n\n  // template loader function specified\n  if (typeof loadTemplates === 'function') {\n\n    return loadTemplates(function(err, templates) {\n\n      if (err) {\n        return self.templateErrors([ err ]);\n      }\n\n      self.setTemplates(templates);\n    });\n  }\n\n  // templates array specified\n  if (loadTemplates.length) {\n    return this.setTemplates(loadTemplates);\n  }\n\n};\n\nElementTemplatesLoader.prototype.setTemplates = function(templates) {\n\n  var elementTemplates = this._elementTemplates;\n\n  var validator = new Validator().addAll(templates);\n\n  var errors = validator.getErrors(),\n      validTemplates = validator.getValidTemplates();\n\n  elementTemplates.set(validTemplates);\n\n  if (errors.length) {\n    this.templateErrors(errors);\n  }\n\n  this.templatesChanged();\n};\n\nElementTemplatesLoader.prototype.templatesChanged = function() {\n  this._eventBus.fire('elementTemplates.changed');\n};\n\nElementTemplatesLoader.prototype.templateErrors = function(errors) {\n  this._eventBus.fire('elementTemplates.errors', {\n    errors: errors\n  });\n};","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","'use strict';\n\nvar assign = require('lodash/assign'),\n    find = require('lodash/find');\n\nvar domQuery = require('min-dom').query;\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar selectEntryFactory = require('./SelectEntryFactory'),\n    entryFieldDescription = require('./EntryFieldDescription');\n\n\n/**\n * The combo box is a special implementation of the select entry and adds the option 'custom' to the\n * select box. If 'custom' is selected, an additional text input field is shown which allows to define\n * a custom value.\n *\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {string} options.label\n * @param  {Array<Object>} options.selectOptions list of name/value pairs\n * @param  {string} options.modelProperty\n * @param  {function} options.get\n * @param  {function} options.set\n * @param  {string} [options.customValue] custom select option value (default: 'custom')\n * @param  {string} [options.customName] custom select option name visible in the select box (default: 'custom')\n *\n * @return {Object}\n */\nvar comboBox = function(options) {\n\n  var selectOptions = options.selectOptions,\n      modelProperty = options.modelProperty,\n      customValue = options.customValue || 'custom',\n      customName = options.customName || 'custom ' + modelProperty,\n      description = options.description;\n\n  // check if a value is not a built in value\n  var isCustomValue = function(value) {\n    if (typeof value[modelProperty] === 'undefined') {\n      return false;\n    }\n\n    var isCustom = !find(selectOptions, function(option) {\n      return value[modelProperty] === option.value;\n    });\n\n    return isCustom;\n  };\n\n  var comboOptions = assign({}, options);\n\n  // true if the selected value in the select box is customValue\n  comboOptions.showCustomInput = function(element, node) {\n    var selectBox = domQuery('[data-entry=\"'+ options.id +'\"] select', node.parentNode);\n\n    if (selectBox) {\n      return selectBox.value === customValue;\n    }\n\n    return false;\n  };\n\n  comboOptions.get = function(element, node) {\n    var value = options.get(element, node);\n\n    var modifiedValues = {};\n\n    if (!isCustomValue(value)) {\n      modifiedValues[modelProperty] = value[modelProperty] || '';\n\n      return modifiedValues;\n    }\n\n    modifiedValues[modelProperty] = customValue;\n    modifiedValues['custom-'+modelProperty] = value[modelProperty];\n\n    return modifiedValues;\n  };\n\n  comboOptions.set = function(element, values, node) {\n    var modifiedValues = {};\n\n    // if the custom select option has been selected\n    // take the value from the text input field\n    if (values[modelProperty] === customValue) {\n      modifiedValues[modelProperty] = values['custom-' + modelProperty] || '';\n    }\n    else if (options.emptyParameter && values[modelProperty] === '') {\n      modifiedValues[modelProperty] = undefined;\n    } else {\n      modifiedValues[modelProperty] = values[modelProperty];\n    }\n    return options.set(element, modifiedValues, node);\n  };\n\n  comboOptions.selectOptions.push({ name: customName, value: customValue });\n\n  var comboBoxEntry = assign({}, selectEntryFactory(comboOptions, comboOptions));\n\n  comboBoxEntry.html += '<div class=\"bpp-field-wrapper bpp-combo-input\" ' +\n    'data-show=\"showCustomInput\"' +\n    '>' +\n    '<input id=\"camunda-' + escapeHTML(options.id) + '-input\" type=\"text\" name=\"custom-' +\n      escapeHTML(modelProperty) + '\" ' +\n    ' />' +\n  '</div>';\n\n  // add description below combo box entry field\n  if (description) {\n    comboBoxEntry.html += entryFieldDescription(description);\n  }\n\n  return comboBoxEntry;\n};\n\nmodule.exports = comboBox;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper');\n\nvar externalTaskPriority = require('./implementation/ExternalTaskPriority');\n\nfunction getServiceTaskLikeBusinessObject(element) {\n  var bo = ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n\n  // if the element is not a serviceTaskLike element, fetch the normal business object\n  // This avoids the loss of the process / participant business object\n  if (!bo) {\n    bo = getBusinessObject(element);\n  }\n\n  return bo;\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var bo = getServiceTaskLikeBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  if (is(bo, 'camunda:TaskPriorized') || (is(bo, 'bpmn:Participant')) && bo.get('processRef')) {\n    group.entries = group.entries.concat(externalTaskPriority(element, bpmnFactory, {\n      getBusinessObject: function(element) {\n        if (!is(bo, 'bpmn:Participant')) {\n          return bo;\n        }\n        return bo.get('processRef');\n      }\n    }, translate));\n  }\n};","var Set = require('./_Set'),\n    noop = require('./noop'),\n    setToArray = require('./_setToArray');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\nmodule.exports = createSet;\n","var isObject = require('./isObject');\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nmodule.exports = baseCreate;\n","var baseToString = require('./_baseToString');\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nmodule.exports = toString;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar domQuery = require('min-dom').query,\n    domClosest = require('min-dom').closest,\n    domify = require('min-dom').domify,\n    forEach = require('lodash/forEach');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    utils = require('../../../../Utils'),\n    escapeHTML = utils.escapeHTML;\n\nfunction getSelectBox(node, id) {\n  var currentTab = domClosest(node, 'div.bpp-properties-tab');\n  var query = 'select[name=selectedExtensionElement]' + (id ? '[id=cam-extensionElements-' + id + ']' : '');\n  return domQuery(query, currentTab);\n}\n\nfunction getSelected(node, id) {\n  var selectBox = getSelectBox(node, id);\n  return {\n    value: (selectBox || {}).value,\n    idx: (selectBox || {}).selectedIndex\n  };\n}\n\nfunction generateElementId(prefix) {\n  prefix = prefix + '_';\n  return utils.nextId(prefix);\n}\n\nvar CREATE_EXTENSION_ELEMENT_ACTION = 'create-extension-element',\n    REMOVE_EXTENSION_ELEMENT_ACTION = 'remove-extension-element';\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var id = options.id,\n      prefix = options.prefix || 'elem',\n      label = options.label || id,\n      idGeneration = (options.idGeneration === false) ? options.idGeneration : true,\n      businessObject = options.businessObject || getBusinessObject(element);\n\n  var modelProperty = options.modelProperty || 'id';\n\n  var getElements = options.getExtensionElements;\n\n  var createElement = options.createExtensionElement,\n      canCreate = typeof createElement === 'function';\n\n  var removeElement = options.removeExtensionElement,\n      canRemove = typeof removeElement === 'function';\n\n  var onSelectionChange = options.onSelectionChange;\n\n  var hideElements = options.hideExtensionElements,\n      canBeHidden = typeof hideElements === 'function';\n\n  var setOptionLabelValue = options.setOptionLabelValue;\n\n  var defaultSize = options.size || 5,\n      resizable = options.resizable;\n\n  var reference = options.reference || undefined;\n\n  var selectionChanged = function(element, node, event, scope) {\n    if (typeof onSelectionChange === 'function') {\n      return onSelectionChange(element, node, event, scope);\n    }\n  };\n\n  var createOption = function(value) {\n    return '<option value=\"' + escapeHTML(value) + '\" data-value data-name=\"extensionElementValue\">' + escapeHTML(value) + '</option>';\n  };\n\n  var initSelectionSize = function(selectBox, optionsLength) {\n    if (resizable) {\n      selectBox.size = optionsLength > defaultSize ? optionsLength : defaultSize;\n    }\n  };\n\n  return {\n    id: id,\n    html: '<div class=\"bpp-row bpp-element-list\" ' +\n            (canBeHidden ? 'data-show=\"hideElements\"' : '') + '>' +\n            '<label for=\"cam-extensionElements-' + escapeHTML(id) + '\">' + escapeHTML(label) + '</label>' +\n            '<div class=\"bpp-field-wrapper\">' +\n              '<select id=\"cam-extensionElements-' + escapeHTML(id) + '\"' +\n                      'name=\"selectedExtensionElement\" ' +\n                      'size=\"' + escapeHTML(defaultSize) + '\" ' +\n                      'data-list-entry-container ' +\n                      'data-on-change=\"selectElement\">' +\n              '</select>' +\n              (canCreate ? '<button class=\"add\" ' +\n                                   'id=\"cam-extensionElements-create-' + escapeHTML(id) + '\" ' +\n                                   'data-action=\"createElement\">' +\n                             '<span>+</span>' +\n                           '</button>' : '') +\n              (canRemove ? '<button class=\"clear\" ' +\n                                   'id=\"cam-extensionElements-remove-' + escapeHTML(id) + '\" ' +\n                                   'data-action=\"removeElement\" ' +\n                                   'data-disable=\"disableRemove\">' +\n                             '<span>-</span>' +\n                           '</button>' : '') +\n            '</div>' +\n          '</div>',\n\n    get: function(element, node) {\n      var elements = getElements(element, node);\n\n      var result = [];\n      forEach(elements, function(elem) {\n        result.push({\n          extensionElementValue: elem.get(modelProperty)\n        });\n      });\n\n      var selectBox = getSelectBox(node.parentNode, id);\n      initSelectionSize(selectBox, result.length);\n\n      return result;\n    },\n\n    set: function(element, values, node) {\n      var action = this.__action;\n      delete this.__action;\n\n      businessObject = businessObject || getBusinessObject(element);\n\n      var bo =\n        (reference && businessObject.get(reference))\n          ? businessObject.get(reference)\n          : businessObject;\n\n      var extensionElements = bo.get('extensionElements');\n\n      if (action.id === CREATE_EXTENSION_ELEMENT_ACTION) {\n        var commands = [];\n        if (!extensionElements) {\n          extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n          commands.push(cmdHelper.updateBusinessObject(element, bo, { extensionElements: extensionElements }));\n        }\n        commands.push(createElement(element, extensionElements, action.value, node));\n        return commands;\n\n      }\n      else if (action.id === REMOVE_EXTENSION_ELEMENT_ACTION) {\n        return removeElement(element, extensionElements, action.value, action.idx, node);\n      }\n\n    },\n\n    createListEntryTemplate: function(value, index, selectBox) {\n      initSelectionSize(selectBox, selectBox.options.length + 1);\n      return createOption(value.extensionElementValue);\n    },\n\n    deselect: function(element, node) {\n      var selectBox = getSelectBox(node, id);\n      selectBox.selectedIndex = -1;\n    },\n\n    getSelected: function(element, node) {\n      return getSelected(node, id);\n    },\n\n    setControlValue: function(element, node, option, property, value, idx) {\n      node.value = value;\n\n      if (!setOptionLabelValue) {\n        node.text = value;\n      } else {\n        setOptionLabelValue(element, node, option, property, value, idx);\n      }\n    },\n\n    createElement: function(element, node) {\n      // create option template\n      var generatedId;\n      if (idGeneration) {\n        generatedId = generateElementId(prefix);\n      }\n\n      var selectBox = getSelectBox(node, id);\n      var template = domify(createOption(generatedId));\n\n      // add new empty option as last child element\n      selectBox.appendChild(template);\n\n      // select last child element\n      selectBox.lastChild.selected = 'selected';\n      selectionChanged(element, node);\n\n      // update select box size\n      initSelectionSize(selectBox, selectBox.options.length);\n\n      this.__action = {\n        id: CREATE_EXTENSION_ELEMENT_ACTION,\n        value: generatedId\n      };\n\n      return true;\n    },\n\n    removeElement: function(element, node) {\n      var selection = getSelected(node, id);\n\n      var selectBox = getSelectBox(node, id);\n      selectBox.removeChild(selectBox.options[selection.idx]);\n\n      // update select box size\n      initSelectionSize(selectBox, selectBox.options.length);\n\n      this.__action = {\n        id: REMOVE_EXTENSION_ELEMENT_ACTION,\n        value: selection.value,\n        idx: selection.idx\n      };\n\n      return true;\n    },\n\n    hideElements: function(element, entryNode, node, scopeNode) {\n      return !hideElements(element, entryNode, node, scopeNode);\n    },\n\n    disableRemove: function(element, entryNode, node, scopeNode) {\n      return (getSelected(entryNode, id) || {}).idx < 0;\n    },\n\n    selectElement: selectionChanged\n  };\n\n};\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nmodule.exports = Map;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nmodule.exports = hashHas;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar extensionElementsEntry = require('./ExtensionElements'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    elementHelper = require('../../../../helper/ElementHelper'),\n    ImplementationTypeHelper = require('../../../../helper/ImplementationTypeHelper');\n\n\nfunction getListeners(bo, type) {\n  return bo && extensionElementsHelper.getExtensionElements(bo, type) || [];\n}\n\nvar CAMUNDA_EXECUTION_LISTENER_ELEMENT = 'camunda:ExecutionListener';\nvar CAMUNDA_TASK_LISTENER_ELEMENT = 'camunda:TaskListener';\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var LISTENER_TYPE_LABEL = {\n    class: translate('Java Class'),\n    expression: translate('Expression'),\n    delegateExpression: translate('Delegate Expression'),\n    script: translate('Script')\n  };\n\n  var bo;\n\n  var result = {\n    getSelectedListener: getSelectedListener\n  };\n\n  var entries = result.entries = [];\n\n  var isSequenceFlow = ImplementationTypeHelper.isSequenceFlow(element);\n\n  function getSelectedListener(element, node) {\n    var selection = (executionListenerEntry && executionListenerEntry.getSelected(element, node)) || { idx: -1 };\n\n    var listener = getListeners(bo, CAMUNDA_EXECUTION_LISTENER_ELEMENT)[selection.idx];\n    if (!listener && taskListenerEntry) {\n      selection = taskListenerEntry.getSelected(element, node);\n      listener = getListeners(bo, CAMUNDA_TASK_LISTENER_ELEMENT)[selection.idx];\n    }\n    return listener;\n  }\n\n  var setOptionLabelValue = function(type) {\n    return function(element, node, option, property, value, idx) {\n      var listeners = getListeners(bo, type);\n      var listener = listeners[idx];\n      var listenerType = ImplementationTypeHelper.getImplementationType(listener);\n\n      var event = (listener.get('event')) ? listener.get('event') : '<empty>';\n\n      var label = (event || '*') + ' : ' + (LISTENER_TYPE_LABEL[listenerType] || '');\n\n      option.text = label;\n    };\n  };\n\n  var newElement = function(element, type, initialEvent) {\n    return function(element, extensionElements, value) {\n      var props = {\n        event: initialEvent,\n        class: ''\n      };\n\n      var newElem = elementHelper.createElement(type, props, extensionElements, bpmnFactory);\n\n      return cmdHelper.addElementsTolist(element, extensionElements, 'values', [ newElem ]);\n    };\n  };\n\n  var removeElement = function(element, type) {\n    return function(element, extensionElements, value, idx) {\n      var listeners = getListeners(bo, type);\n      var listener = listeners[idx];\n      if (listener) {\n        return extensionElementsHelper.removeEntry(bo, element, listener);\n      }\n    };\n  };\n\n\n  // Execution Listener\n\n  if (is(element, 'bpmn:FlowElement') || is(element, 'bpmn:Process') || is(element, 'bpmn:Participant')) {\n    bo = getBusinessObject(element);\n    if (is(element, 'bpmn:Participant')) {\n      element = element.processRef;\n      bo = bo.get('processRef');\n    }\n\n    if (bo) {\n\n      var executionListenerEntry = extensionElementsEntry(element, bpmnFactory, {\n        id : 'executionListeners',\n        label : translate('Execution Listener'),\n        modelProperty: 'name',\n        idGeneration: 'false',\n        reference: 'processRef',\n\n        createExtensionElement: newElement(element, CAMUNDA_EXECUTION_LISTENER_ELEMENT, (isSequenceFlow) ? 'take' : 'start'),\n        removeExtensionElement: removeElement(element, CAMUNDA_EXECUTION_LISTENER_ELEMENT),\n\n        getExtensionElements: function(element) {\n          return getListeners(bo, CAMUNDA_EXECUTION_LISTENER_ELEMENT);\n        },\n\n        onSelectionChange: function(element, node, event, scope) {\n          taskListenerEntry && taskListenerEntry.deselect(element, node);\n        },\n\n        setOptionLabelValue: setOptionLabelValue(CAMUNDA_EXECUTION_LISTENER_ELEMENT)\n\n      });\n      entries.push(executionListenerEntry);\n\n    }\n  }\n\n\n  // Task Listener\n\n  if (is(element, 'bpmn:UserTask')) {\n    bo = getBusinessObject(element);\n\n    var taskListenerEntry = extensionElementsEntry(element, bpmnFactory, {\n      id : 'taskListeners',\n      label : translate('Task Listener'),\n      modelProperty: 'name',\n      idGeneration: 'false',\n\n      createExtensionElement: newElement(element, CAMUNDA_TASK_LISTENER_ELEMENT, 'create'),\n      removeExtensionElement: removeElement(element, CAMUNDA_TASK_LISTENER_ELEMENT),\n\n      getExtensionElements: function(element) {\n        return getListeners(bo, CAMUNDA_TASK_LISTENER_ELEMENT);\n      },\n\n      onSelectionChange: function(element, node, event, scope) {\n        executionListenerEntry.deselect(element, node);\n      },\n\n      setOptionLabelValue: setOptionLabelValue(CAMUNDA_TASK_LISTENER_ELEMENT)\n\n    });\n    entries.push(taskListenerEntry);\n  }\n\n  return result;\n\n};\n","'use strict';\n\nvar ChangeElementTemplateHandler = require('./ChangeElementTemplateHandler');\n\nvar getTemplate = require('../Helper').getTemplate,\n    getDefaultTemplate = require('../Helper').getDefaultTemplate;\n\nfunction registerHandlers(commandStack, elementTemplates, eventBus, elementRegistry) {\n  commandStack.registerHandler(\n    'propertiesPanel.camunda.changeTemplate',\n    ChangeElementTemplateHandler\n  );\n\n  // apply default element templates on shape creation\n  eventBus.on([ 'commandStack.shape.create.postExecuted' ], function(context) {\n    applyDefaultTemplate(context.context.shape, elementTemplates, commandStack);\n  });\n\n  // apply default element templates on connection creation\n  eventBus.on([ 'commandStack.connection.create.postExecuted' ], function(context) {\n    applyDefaultTemplate(context.context.connection, elementTemplates, commandStack);\n  });\n}\n\nregisterHandlers.$inject = [ 'commandStack', 'elementTemplates', 'eventBus', 'elementRegistry' ];\n\n\nmodule.exports = {\n  __init__: [ registerHandlers ]\n};\n\n\nfunction applyDefaultTemplate(element, elementTemplates, commandStack) {\n\n  if (!getTemplate(element, elementTemplates)\n      && getDefaultTemplate(element, elementTemplates)) {\n\n    var command = 'propertiesPanel.camunda.changeTemplate';\n    var commandContext = {\n      element: element,\n      newTemplate: getDefaultTemplate(element, elementTemplates)\n    };\n\n    commandStack.execute(command, commandContext);\n  }\n}\n","var mapCacheClear = require('./_mapCacheClear'),\n    mapCacheDelete = require('./_mapCacheDelete'),\n    mapCacheGet = require('./_mapCacheGet'),\n    mapCacheHas = require('./_mapCacheHas'),\n    mapCacheSet = require('./_mapCacheSet');\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nmodule.exports = MapCache;\n","/**\n * Checks whether node is of specific bpmn type.\n *\n * @param {ModdleElement} node\n * @param {String} type\n *\n * @return {Boolean}\n */\nfunction is(node, type) {\n\n  if (type.indexOf(':') === -1) {\n    type = 'bpmn:' + type;\n  }\n\n  return (\n    (typeof node.$instanceOf === 'function')\n      ? node.$instanceOf(type)\n      : node.$type === type\n  );\n}\n\n/**\n * Checks whether node has any of the specified types.\n *\n * @param {ModdleElement} node\n * @param {Array<String>} types\n *\n * @return {Boolean}\n */\nfunction isAny(node, types) {\n  return types.some(function(type) {\n    return is(node, type);\n  });\n}\n\nexport { is, isAny };\n//# sourceMappingURL=index.esm.js.map\n","var Stack = require('./_Stack'),\n    equalArrays = require('./_equalArrays'),\n    equalByTag = require('./_equalByTag'),\n    equalObjects = require('./_equalObjects'),\n    getTag = require('./_getTag'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nmodule.exports = baseIsEqualDeep;\n","'use strict';\n\nvar inputOutput = require('./implementation/InputOutput');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var inputOutputEntry = inputOutput(element, bpmnFactory, {}, translate);\n\n  group.entries = group.entries.concat(inputOutputEntry.entries);\n\n  return {\n    getSelectedParameter: inputOutputEntry.getSelectedParameter\n  };\n\n};\n","var Hash = require('./_Hash'),\n    ListCache = require('./_ListCache'),\n    Map = require('./_Map');\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nmodule.exports = mapCacheClear;\n","'use strict';\n\n/**\n * Calculate the selection update for the given\n * current and new input values.\n *\n * @param {Object} currentSelection as {start, end}\n * @param {String} currentValue\n * @param {String} newValue\n *\n * @return {Object} newSelection as {start, end}\n */\nfunction calculateUpdate(currentSelection, currentValue, newValue) {\n\n  var currentCursor = currentSelection.start,\n      newCursor = currentCursor,\n      diff = newValue.length - currentValue.length,\n      idx;\n\n  var lengthDelta = newValue.length - currentValue.length;\n\n  var currentTail = currentValue.substring(currentCursor);\n\n  // check if we can remove common ending from the equation\n  // to be able to properly detect a selection change for\n  // the following scenarios:\n  //\n  //  * (AAATTT|TF) => (AAAT|TF)\n  //  * (AAAT|TF) =>  (AAATTT|TF)\n  //\n  if (newValue.lastIndexOf(currentTail) === newValue.length - currentTail.length) {\n    currentValue = currentValue.substring(0, currentValue.length - currentTail.length);\n    newValue = newValue.substring(0, newValue.length - currentTail.length);\n  }\n\n  // diff\n  var diff = createDiff(currentValue, newValue);\n\n  if (diff) {\n    if (diff.type === 'remove') {\n      newCursor = diff.newStart;\n    } else {\n      newCursor = diff.newEnd;\n    }\n  }\n\n  return range(newCursor);\n}\n\nmodule.exports = calculateUpdate;\n\n\nfunction createDiff(currentValue, newValue) {\n\n  var insert;\n\n  var l_str, l_char, l_idx = 0,\n      s_str, s_char, s_idx = 0;\n\n  if (newValue.length > currentValue.length) {\n    l_str = newValue;\n    s_str = currentValue;\n  } else {\n    l_str = currentValue;\n    s_str = newValue;\n  }\n\n  // assume there will be only one insert / remove and\n  // detect that _first_ edit operation only\n  while (l_idx < l_str.length) {\n\n    l_char = l_str.charAt(l_idx);\n    s_char = s_str.charAt(s_idx);\n\n    // chars no not equal\n    if (l_char !== s_char) {\n\n      if (!insert) {\n        insert = {\n          l_start: l_idx,\n          s_start: s_idx\n        };\n      }\n\n      l_idx++;\n    }\n\n    // chars equal (again?)\n    else {\n\n      if (insert && !insert.complete) {\n        insert.l_end = l_idx;\n        insert.s_end = s_idx;\n        insert.complete = true;\n      }\n\n      s_idx++;\n      l_idx++;\n    }\n  }\n\n  if (insert && !insert.complete) {\n    insert.complete = true;\n    insert.s_end = s_str.length;\n    insert.l_end = l_str.length;\n  }\n\n  // no diff\n  if (!insert) {\n    return;\n  }\n\n  if (newValue.length > currentValue.length) {\n    return {\n      newStart: insert.l_start,\n      newEnd: insert.l_end,\n      type: 'add'\n    };\n  } else {\n    return {\n      newStart: insert.s_start,\n      newEnd: insert.s_end,\n      type: newValue.length < currentValue.length ? 'remove' : 'replace'\n    };\n  }\n}\n\n/**\n * Utility method for creating a new selection range {start, end} object.\n *\n * @param {Number} start\n * @param {Number} [end]\n *\n * @return {Object} selection range as {start, end}\n */\nfunction range(start, end) {\n  return {\n    start: start,\n    end: end === undefined ? start : end\n  };\n}\n\nmodule.exports.range = range;\n\n\nfunction splitStr(str, position) {\n  return {\n    before: str.substring(0, position),\n    after: str.substring(position)\n  };\n}","var arrayPush = require('./_arrayPush'),\n    isArray = require('./isArray');\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nmodule.exports = baseGetAllKeys;\n","var ListCache = require('./_ListCache'),\n    stackClear = require('./_stackClear'),\n    stackDelete = require('./_stackDelete'),\n    stackGet = require('./_stackGet'),\n    stackHas = require('./_stackHas'),\n    stackSet = require('./_stackSet');\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nmodule.exports = Stack;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nmodule.exports = setCacheAdd;\n","module.exports = {\n  __depends__: [\n    require('./cmd'),\n    require('diagram-js/lib/i18n/translate').default\n  ],\n  __init__: [ 'propertiesPanel' ],\n  propertiesPanel: [ 'type', require('./PropertiesPanel') ]\n};\n","'use strict';\n\nvar inherits = require('inherits');\n\nvar PropertiesActivator = require('../../PropertiesActivator');\n\nvar asyncCapableHelper = require('../../helper/AsyncCapableHelper'),\n    ImplementationTypeHelper = require('../../helper/ImplementationTypeHelper');\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\n// bpmn properties\nvar processProps = require('../bpmn/parts/ProcessProps'),\n    eventProps = require('../bpmn/parts/EventProps'),\n    linkProps = require('../bpmn/parts/LinkProps'),\n    documentationProps = require('../bpmn/parts/DocumentationProps'),\n    idProps = require('../bpmn/parts/IdProps'),\n    nameProps = require('../bpmn/parts/NameProps'),\n    executableProps = require('../bpmn/parts/ExecutableProps');\n\n// camunda properties\nvar serviceTaskDelegateProps = require('./parts/ServiceTaskDelegateProps'),\n    userTaskProps = require('./parts/UserTaskProps'),\n    asynchronousContinuationProps = require('./parts/AsynchronousContinuationProps'),\n    callActivityProps = require('./parts/CallActivityProps'),\n    multiInstanceProps = require('./parts/MultiInstanceLoopProps'),\n    conditionalProps = require('./parts/ConditionalProps'),\n    scriptProps = require('./parts/ScriptTaskProps'),\n    errorProps = require('./parts/ErrorEventProps'),\n    formProps = require('./parts/FormProps'),\n    startEventInitiator = require('./parts/StartEventInitiator'),\n    variableMapping = require('./parts/VariableMappingProps'),\n    versionTag = require('./parts/VersionTagProps');\n\nvar listenerProps = require('./parts/ListenerProps'),\n    listenerDetails = require('./parts/ListenerDetailProps'),\n    listenerFields = require('./parts/ListenerFieldInjectionProps');\n\nvar elementTemplateChooserProps = require('./element-templates/parts/ChooserProps'),\n    elementTemplateCustomProps = require('./element-templates/parts/CustomProps');\n\n// Input/Output\nvar inputOutput = require('./parts/InputOutputProps'),\n    inputOutputParameter = require('./parts/InputOutputParameterProps');\n\n// Connector\nvar connectorDetails = require('./parts/ConnectorDetailProps'),\n    connectorInputOutput = require('./parts/ConnectorInputOutputProps'),\n    connectorInputOutputParameter = require('./parts/ConnectorInputOutputParameterProps');\n\n// properties\nvar properties = require('./parts/PropertiesProps');\n\n// job configuration\nvar jobConfiguration = require('./parts/JobConfigurationProps');\n\n// history time to live\nvar historyTimeToLive = require('./parts/HistoryTimeToLiveProps');\n\n// candidate starter groups/users\nvar candidateStarter = require('./parts/CandidateStarterProps');\n\n// tasklist\nvar tasklist = require('./parts/TasklistProps');\n\n// external task configuration\nvar externalTaskConfiguration = require('./parts/ExternalTaskConfigurationProps');\n\n// field injection\nvar fieldInjections = require('./parts/FieldInjectionProps');\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    eventDefinitionHelper = require('../../helper/EventDefinitionHelper'),\n    implementationTypeHelper = require('../../helper/ImplementationTypeHelper');\n\n// helpers ////////////////////////////////////////\n\nvar isExternalTaskPriorityEnabled = function(element) {\n  var businessObject = getBusinessObject(element);\n\n  // show only if element is a process, a participant ...\n  if (is(element, 'bpmn:Process') || is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n    return true;\n  }\n\n  var externalBo = ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element),\n      isExternalTask = ImplementationTypeHelper.getImplementationType(externalBo) === 'external';\n\n  // ... or an external task with selected external implementation type\n  return !!ImplementationTypeHelper.isExternalCapable(externalBo) && isExternalTask;\n};\n\nvar isJobConfigEnabled = function(element) {\n  var businessObject = getBusinessObject(element);\n\n  if (is(element, 'bpmn:Process') || is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n    return true;\n  }\n\n  // async behavior\n  var bo = getBusinessObject(element);\n  if (asyncCapableHelper.isAsyncBefore(bo) || asyncCapableHelper.isAsyncAfter(bo)) {\n    return true;\n  }\n\n  // timer definition\n  if (is(element, 'bpmn:Event')) {\n    return !!eventDefinitionHelper.getTimerEventDefinition(element);\n  }\n\n  return false;\n};\n\nvar getInputOutputParameterLabel = function(param, translate) {\n\n  if (is(param, 'camunda:InputParameter')) {\n    return translate('Input Parameter');\n  }\n\n  if (is(param, 'camunda:OutputParameter')) {\n    return translate('Output Parameter');\n  }\n\n  return '';\n};\n\nvar getListenerLabel = function(param, translate) {\n\n  if (is(param, 'camunda:ExecutionListener')) {\n    return translate('Execution Listener');\n  }\n\n  if (is(param, 'camunda:TaskListener')) {\n    return translate('Task Listener');\n  }\n\n  return '';\n};\n\nvar PROCESS_KEY_HINT = 'This maps to the process definition key.';\nvar TASK_KEY_HINT = 'This maps to the task definition key.';\n\nfunction createGeneralTabGroups(\n    element, canvas, bpmnFactory,\n    elementRegistry, elementTemplates, translate) {\n\n  // refer to target element for external labels\n  element = element.labelTarget || element;\n\n  var generalGroup = {\n    id: 'general',\n    label: translate('General'),\n    entries: []\n  };\n\n  var idOptions;\n  var processOptions;\n\n  if (is(element, 'bpmn:Process')) {\n    idOptions = { description: PROCESS_KEY_HINT };\n  }\n\n  if (is(element, 'bpmn:UserTask')) {\n    idOptions = { description: TASK_KEY_HINT };\n  }\n\n  if (is(element, 'bpmn:Participant')) {\n    processOptions = { processIdDescription: PROCESS_KEY_HINT };\n  }\n\n  idProps(generalGroup, element, translate, idOptions);\n  nameProps(generalGroup, element, bpmnFactory, canvas, translate);\n  processProps(generalGroup, element, translate, processOptions);\n  versionTag(generalGroup, element, translate);\n  executableProps(generalGroup, element, translate);\n  elementTemplateChooserProps(generalGroup, element, elementTemplates, translate);\n\n  var customFieldsGroups = elementTemplateCustomProps(element, elementTemplates, bpmnFactory, translate);\n\n  var detailsGroup = {\n    id: 'details',\n    label: translate('Details'),\n    entries: []\n  };\n  serviceTaskDelegateProps(detailsGroup, element, bpmnFactory, translate);\n  userTaskProps(detailsGroup, element, translate);\n  scriptProps(detailsGroup, element, bpmnFactory, translate);\n  linkProps(detailsGroup, element, translate);\n  callActivityProps(detailsGroup, element, bpmnFactory, translate);\n  eventProps(detailsGroup, element, bpmnFactory, elementRegistry, translate);\n  errorProps(detailsGroup, element, bpmnFactory, translate);\n  conditionalProps(detailsGroup, element, bpmnFactory, translate);\n  startEventInitiator(detailsGroup, element, translate); // this must be the last element of the details group!\n\n  var multiInstanceGroup = {\n    id: 'multiInstance',\n    label: translate('Multi Instance'),\n    entries: []\n  };\n  multiInstanceProps(multiInstanceGroup, element, bpmnFactory, translate);\n\n  var asyncGroup = {\n    id : 'async',\n    label: translate('Asynchronous Continuations'),\n    entries : []\n  };\n  asynchronousContinuationProps(asyncGroup, element, bpmnFactory, translate);\n\n  var jobConfigurationGroup = {\n    id : 'jobConfiguration',\n    label : translate('Job Configuration'),\n    entries : [],\n    enabled: isJobConfigEnabled\n  };\n  jobConfiguration(jobConfigurationGroup, element, bpmnFactory, translate);\n\n  var externalTaskGroup = {\n    id : 'externalTaskConfiguration',\n    label : translate('External Task Configuration'),\n    entries : [],\n    enabled: isExternalTaskPriorityEnabled\n  };\n  externalTaskConfiguration(externalTaskGroup, element, bpmnFactory, translate);\n\n\n  var candidateStarterGroup = {\n    id: 'candidateStarterConfiguration',\n    label: translate('Candidate Starter Configuration'),\n    entries: []\n  };\n  candidateStarter(candidateStarterGroup, element, bpmnFactory, translate);\n\n  var historyTimeToLiveGroup = {\n    id: 'historyConfiguration',\n    label: translate('History Configuration'),\n    entries: []\n  };\n  historyTimeToLive(historyTimeToLiveGroup, element, bpmnFactory, translate);\n\n  var tasklistGroup = {\n    id: 'tasklist',\n    label: translate('Tasklist Configuration'),\n    entries: []\n  };\n  tasklist(tasklistGroup, element, bpmnFactory, translate);\n\n  var documentationGroup = {\n    id: 'documentation',\n    label: translate('Documentation'),\n    entries: []\n  };\n  documentationProps(documentationGroup, element, bpmnFactory, translate);\n\n  var groups = [];\n  groups.push(generalGroup);\n  customFieldsGroups.forEach(function(group) {\n    groups.push(group);\n  });\n  groups.push(detailsGroup);\n  groups.push(externalTaskGroup);\n  groups.push(multiInstanceGroup);\n  groups.push(asyncGroup);\n  groups.push(jobConfigurationGroup);\n  groups.push(candidateStarterGroup);\n  groups.push(historyTimeToLiveGroup);\n  groups.push(tasklistGroup);\n  groups.push(documentationGroup);\n\n  return groups;\n}\n\nfunction createVariablesTabGroups(element, bpmnFactory, elementRegistry, translate) {\n  var variablesGroup = {\n    id : 'variables',\n    label : translate('Variables'),\n    entries: []\n  };\n  variableMapping(variablesGroup, element, bpmnFactory, translate);\n\n  return [\n    variablesGroup\n  ];\n}\n\nfunction createFormsTabGroups(element, bpmnFactory, elementRegistry, translate) {\n  var formGroup = {\n    id : 'forms',\n    label : translate('Forms'),\n    entries: []\n  };\n  formProps(formGroup, element, bpmnFactory, translate);\n\n  return [\n    formGroup\n  ];\n}\n\nfunction createListenersTabGroups(element, bpmnFactory, elementRegistry, translate) {\n\n  var listenersGroup = {\n    id : 'listeners',\n    label: translate('Listeners'),\n    entries: []\n  };\n\n  var options = listenerProps(listenersGroup, element, bpmnFactory, translate);\n\n  var listenerDetailsGroup = {\n    id: 'listener-details',\n    entries: [],\n    enabled: function(element, node) {\n      return options.getSelectedListener(element, node);\n    },\n    label: function(element, node) {\n      var param = options.getSelectedListener(element, node);\n      return getListenerLabel(param, translate);\n    }\n  };\n\n  listenerDetails(listenerDetailsGroup, element, bpmnFactory, options, translate);\n\n  var listenerFieldsGroup = {\n    id: 'listener-fields',\n    label: translate('Field Injection'),\n    entries: [],\n    enabled: function(element, node) {\n      return options.getSelectedListener(element, node);\n    }\n  };\n\n  listenerFields(listenerFieldsGroup, element, bpmnFactory, options, translate);\n\n  return [\n    listenersGroup,\n    listenerDetailsGroup,\n    listenerFieldsGroup\n  ];\n}\n\nfunction createInputOutputTabGroups(element, bpmnFactory, elementRegistry, translate) {\n\n  var inputOutputGroup = {\n    id: 'input-output',\n    label: translate('Parameters'),\n    entries: []\n  };\n\n  var options = inputOutput(inputOutputGroup, element, bpmnFactory, translate);\n\n  var inputOutputParameterGroup = {\n    id: 'input-output-parameter',\n    entries: [],\n    enabled: function(element, node) {\n      return options.getSelectedParameter(element, node);\n    },\n    label: function(element, node) {\n      var param = options.getSelectedParameter(element, node);\n      return getInputOutputParameterLabel(param, translate);\n    }\n  };\n\n  inputOutputParameter(inputOutputParameterGroup, element, bpmnFactory, options, translate);\n\n  return [\n    inputOutputGroup,\n    inputOutputParameterGroup\n  ];\n}\n\nfunction createConnectorTabGroups(element, bpmnFactory, elementRegistry, translate) {\n  var connectorDetailsGroup = {\n    id: 'connector-details',\n    label: translate('Details'),\n    entries: []\n  };\n\n  connectorDetails(connectorDetailsGroup, element, bpmnFactory, translate);\n\n  var connectorInputOutputGroup = {\n    id: 'connector-input-output',\n    label: translate('Input/Output'),\n    entries: []\n  };\n\n  var options = connectorInputOutput(connectorInputOutputGroup, element, bpmnFactory, translate);\n\n  var connectorInputOutputParameterGroup = {\n    id: 'connector-input-output-parameter',\n    entries: [],\n    enabled: function(element, node) {\n      return options.getSelectedParameter(element, node);\n    },\n    label: function(element, node) {\n      var param = options.getSelectedParameter(element, node);\n      return getInputOutputParameterLabel(param, translate);\n    }\n  };\n\n  connectorInputOutputParameter(connectorInputOutputParameterGroup, element, bpmnFactory, options, translate);\n\n  return [\n    connectorDetailsGroup,\n    connectorInputOutputGroup,\n    connectorInputOutputParameterGroup\n  ];\n}\n\nfunction createFieldInjectionsTabGroups(element, bpmnFactory, elementRegistry, translate) {\n\n  var fieldGroup = {\n    id: 'field-injections-properties',\n    label: translate('Field Injections'),\n    entries: []\n  };\n\n  fieldInjections(fieldGroup, element, bpmnFactory, translate);\n\n  return [\n    fieldGroup\n  ];\n}\n\nfunction createExtensionElementsGroups(element, bpmnFactory, elementRegistry, translate) {\n\n  var propertiesGroup = {\n    id : 'extensionElements-properties',\n    label: translate('Properties'),\n    entries: []\n  };\n  properties(propertiesGroup, element, bpmnFactory, translate);\n\n  return [\n    propertiesGroup\n  ];\n}\n\n// Camunda Properties Provider /////////////////////////////////////\n\n\n/**\n * A properties provider for Camunda related properties.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {BpmnFactory} bpmnFactory\n * @param {ElementRegistry} elementRegistry\n * @param {ElementTemplates} elementTemplates\n * @param {Translate} translate\n */\nfunction CamundaPropertiesProvider(\n    eventBus, canvas, bpmnFactory,\n    elementRegistry, elementTemplates, translate) {\n\n  PropertiesActivator.call(this, eventBus);\n\n  this.getTabs = function(element) {\n\n    var generalTab = {\n      id: 'general',\n      label: translate('General'),\n      groups: createGeneralTabGroups(\n        element, canvas, bpmnFactory,\n        elementRegistry, elementTemplates, translate)\n    };\n\n    var variablesTab = {\n      id: 'variables',\n      label: translate('Variables'),\n      groups: createVariablesTabGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    var formsTab = {\n      id: 'forms',\n      label: translate('Forms'),\n      groups: createFormsTabGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    var listenersTab = {\n      id: 'listeners',\n      label: translate('Listeners'),\n      groups: createListenersTabGroups(element, bpmnFactory, elementRegistry, translate),\n      enabled: function(element) {\n        return !eventDefinitionHelper.getLinkEventDefinition(element)\n          || (!is(element, 'bpmn:IntermediateThrowEvent')\n          && eventDefinitionHelper.getLinkEventDefinition(element));\n      }\n    };\n\n    var inputOutputTab = {\n      id: 'input-output',\n      label: translate('Input/Output'),\n      groups: createInputOutputTabGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    var connectorTab = {\n      id: 'connector',\n      label: translate('Connector'),\n      groups: createConnectorTabGroups(element, bpmnFactory, elementRegistry, translate),\n      enabled: function(element) {\n        var bo = implementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n        return bo && implementationTypeHelper.getImplementationType(bo) === 'connector';\n      }\n    };\n\n    var fieldInjectionsTab = {\n      id: 'field-injections',\n      label: translate('Field Injections'),\n      groups: createFieldInjectionsTabGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    var extensionsTab = {\n      id: 'extensionElements',\n      label: translate('Extensions'),\n      groups: createExtensionElementsGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    return [\n      generalTab,\n      variablesTab,\n      connectorTab,\n      formsTab,\n      listenersTab,\n      inputOutputTab,\n      fieldInjectionsTab,\n      extensionsTab\n    ];\n  };\n\n}\n\nCamundaPropertiesProvider.$inject = [\n  'eventBus',\n  'canvas',\n  'bpmnFactory',\n  'elementRegistry',\n  'elementTemplates',\n  'translate'\n];\n\ninherits(CamundaPropertiesProvider, PropertiesActivator);\n\nmodule.exports = CamundaPropertiesProvider;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nmodule.exports = stackGet;\n","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nmodule.exports = arrayEach;\n","'use strict';\n\nvar forEach = require('lodash/forEach');\n\nvar HANDLERS = {\n  'properties-panel.update-businessobject': require('./UpdateBusinessObjectHandler'),\n  'properties-panel.create-and-reference': require('./CreateAndReferenceHandler'),\n  'properties-panel.create-businessobject-list': require('./CreateBusinessObjectListHandler'),\n  'properties-panel.update-businessobject-list': require('./UpdateBusinessObjectListHandler'),\n  'properties-panel.multi-command-executor': require('./MultiCommandHandler')\n};\n\n\nfunction CommandInitializer(eventBus, commandStack) {\n\n  eventBus.on('diagram.init', function() {\n    forEach(HANDLERS, function(handler, id) {\n      commandStack.registerHandler(id, handler);\n    });\n  });\n}\n\nCommandInitializer.$inject = [ 'eventBus', 'commandStack' ];\n\nmodule.exports = {\n  __init__: [ CommandInitializer ]\n};","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\n/**\n * Create a linkified and HTML escaped entry field description.\n *\n * As a special feature, this description may contain both markdown,\n * plain <a href> links and <br />\n *\n * @param {String} description\n */\nmodule.exports = function entryFieldDescription(description) {\n\n  // we tokenize the description to extract text, HTML and markdown links\n  // text, links and new lines are handled seperately\n\n  var escaped = [];\n\n  // match markdown [{TEXT}]({URL}) and HTML links <a href=\"{URL}\">{TEXT}</a>\n  var pattern = /(?:\\[([^\\]]+)\\]\\((https?:\\/\\/[^)]+)\\))|(?:<a href=\"(https?:\\/\\/[^\"]+)\">(.+?(?=<\\/))<\\/a>)/gi;\n\n  var index = 0;\n  var match;\n  var link, text;\n\n  while ((match = pattern.exec(description))) {\n\n    // escape + insert text before match\n    if (match.index > index) {\n      escaped.push(escapeText(description.substring(index, match.index)));\n    }\n\n    link = match[2] && encodeURI(match[2]) || match[3];\n    text = match[1] || match[4];\n\n    // insert safe link\n    escaped.push('<a href=\"' + link + '\" target=\"_blank\">' + escapeText(text) + '</a>');\n\n    index = match.index + match[0].length;\n  }\n\n  // escape and insert text after last match\n  if (index < description.length) {\n    escaped.push(escapeText(description.substring(index)));\n  }\n\n  return '<div class=\"bpp-field-description\">' + escaped.join('') + '</div>';\n};\n\nfunction escapeText(text) {\n  var match, index = 0, escaped = [];\n\n  // match new line <br/> <br /> <br.... /> etc.\n  var pattern = /<br\\s*\\/?>/gi;\n\n  while ((match = pattern.exec(text))) {\n\n    if (match.index > index) {\n      escaped.push(escapeHTML(text.substring(index, match.index)));\n    }\n\n    escaped.push('<br />');\n\n    index = match.index + match[0].length;\n  }\n\n  if (index < text.length) {\n    escaped.push(escapeHTML(text.substring(index)));\n  }\n\n  return escaped.join('');\n}\n","'use strict';\nvar toPrimitive = require('../internals/to-primitive');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPrimitive(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n","var baseHasIn = require('./_baseHasIn'),\n    hasPath = require('./_hasPath');\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nmodule.exports = hasIn;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    escapeHTML = require('../../../../Utils').escapeHTML;\n\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar domClasses = require('min-dom').classes;\n\n/**\n * Get a property value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n * @param {string} propertyName\n *\n * @return {any} the property value\n */\nfunction getProperty(element, propertyName) {\n  var loopCharacteristics = getLoopCharacteristics(element);\n  return loopCharacteristics && loopCharacteristics.get(propertyName);\n}\n\n/**\n * Get the body of a given expression.\n *\n * @param {ModdleElement<bpmn:FormalExpression>} expression\n *\n * @return {string} the body (value) of the expression\n */\nfunction getBody(expression) {\n  return expression && expression.get('body');\n}\n\n\n/**\n * Get the loop characteristics of an element.\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement<bpmn:MultiInstanceLoopCharacteristics>} the loop characteristics\n */\nfunction getLoopCharacteristics(element) {\n  var bo = getBusinessObject(element);\n  return bo.loopCharacteristics;\n}\n\n/**\n * Get the loop cardinality of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement<bpmn:FormalExpression>} an expression representing the loop cardinality\n */\nfunction getLoopCardinality(element) {\n  return getProperty(element, 'loopCardinality');\n}\n\n/**\n * Get the loop cardinality value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {string} the loop cardinality value\n */\nfunction getLoopCardinalityValue(element) {\n  var loopCardinality = getLoopCardinality(element);\n  return getBody(loopCardinality);\n}\n\n/**\n * Get the completion condition of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement<bpmn:FormalExpression>} an expression representing the completion condition\n */\nfunction getCompletionCondition(element) {\n  return getProperty(element, 'completionCondition');\n}\n\n/**\n * Get the completion condition value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {string} the completion condition value\n */\nfunction getCompletionConditionValue(element) {\n  var completionCondition = getCompletionCondition(element);\n  return getBody(completionCondition);\n}\n\n/**\n * Get the 'camunda:collection' attribute value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {string} the 'camunda:collection' value\n */\nfunction getCollection(element) {\n  return getProperty(element, 'camunda:collection');\n}\n\n/**\n * Get the 'camunda:elementVariable' attribute value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {string} the 'camunda:elementVariable' value\n */\nfunction getElementVariable(element) {\n  return getProperty(element, 'camunda:elementVariable');\n}\n\n\n/**\n * Creates 'bpmn:FormalExpression' element.\n *\n * @param {ModdleElement} parent\n * @param {string} body\n * @param {BpmnFactory} bpmnFactory\n *\n * @result {ModdleElement<bpmn:FormalExpression>} a formal expression\n */\nfunction createFormalExpression(parent, body, bpmnFactory) {\n  return elementHelper.createElement('bpmn:FormalExpression', { body: body }, parent, bpmnFactory);\n}\n\n/**\n * Updates a specific formal expression of the loop characteristics.\n *\n * @param {djs.model.Base} element\n * @param {string} propertyName\n * @param {string} newValue\n * @param {BpmnFactory} bpmnFactory\n */\nfunction updateFormalExpression(element, propertyName, newValue, bpmnFactory) {\n  var loopCharacteristics = getLoopCharacteristics(element);\n\n  var expressionProps = {};\n\n  if (!newValue) {\n    // remove formal expression\n    expressionProps[propertyName] = undefined;\n    return cmdHelper.updateBusinessObject(element, loopCharacteristics, expressionProps);\n  }\n\n  var existingExpression = loopCharacteristics.get(propertyName);\n\n  if (!existingExpression) {\n    // add formal expression\n    expressionProps[propertyName] = createFormalExpression(loopCharacteristics, newValue, bpmnFactory);\n    return cmdHelper.updateBusinessObject(element, loopCharacteristics, expressionProps);\n  }\n\n  // edit existing formal expression\n  return cmdHelper.updateBusinessObject(element, existingExpression, {\n    body: newValue\n  });\n}\n\n\nmodule.exports = function(element, bpmnFactory, translate) {\n\n  var entries = [];\n\n  // error message /////////////////////////////////////////////////////////////////\n\n  entries.push({\n    id: 'multiInstance-errorMessage',\n    html: '<div data-show=\"isValid\">' +\n             '<span class=\"bpp-icon-warning\"></span> ' +\n             escapeHTML(translate('Must provide either loop cardinality or collection')) +\n          '</div>',\n\n    isValid: function(element, node, notification, scope) {\n      var loopCharacteristics = getLoopCharacteristics(element);\n\n      var isValid = true;\n      if (loopCharacteristics) {\n        var loopCardinality = getLoopCardinalityValue(element);\n        var collection = getCollection(element);\n\n        isValid = !loopCardinality && !collection;\n      }\n\n      domClasses(node).toggle('bpp-hidden', !isValid);\n      domClasses(notification).toggle('bpp-error-message', isValid);\n\n      return isValid;\n    }\n  });\n\n  // loop cardinality //////////////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textField({\n    id: 'multiInstance-loopCardinality',\n    label: translate('Loop Cardinality'),\n    modelProperty: 'loopCardinality',\n\n    get: function(element, node) {\n      return {\n        loopCardinality: getLoopCardinalityValue(element)\n      };\n    },\n\n    set: function(element, values) {\n      return updateFormalExpression(element, 'loopCardinality', values.loopCardinality, bpmnFactory);\n    }\n  }));\n\n\n  // collection //////////////////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textField({\n    id: 'multiInstance-collection',\n    label: translate('Collection'),\n    modelProperty: 'collection',\n\n    get: function(element, node) {\n      return {\n        collection: getCollection(element)\n      };\n    },\n\n    set: function(element, values) {\n      var loopCharacteristics = getLoopCharacteristics(element);\n      return cmdHelper.updateBusinessObject(element, loopCharacteristics, {\n        'camunda:collection': values.collection || undefined\n      });\n    },\n\n    validate: function(element, values, node) {\n      var collection = getCollection(element);\n      var elementVariable = getElementVariable(element);\n\n      if (!collection && elementVariable) {\n        return { collection : 'Must provide a value' };\n      }\n    }\n  }));\n\n\n  // element variable ////////////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textField({\n    id: 'multiInstance-elementVariable',\n    label: translate('Element Variable'),\n    modelProperty: 'elementVariable',\n\n    get: function(element, node) {\n      return {\n        elementVariable: getElementVariable(element)\n      };\n    },\n\n    set: function(element, values) {\n      var loopCharacteristics = getLoopCharacteristics(element);\n      return cmdHelper.updateBusinessObject(element, loopCharacteristics, {\n        'camunda:elementVariable': values.elementVariable || undefined\n      });\n    }\n  }));\n\n\n  // Completion Condition //////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textField({\n    id: 'multiInstance-completionCondition',\n    label: translate('Completion Condition'),\n    modelProperty: 'completionCondition',\n\n    get: function(element) {\n      return {\n        completionCondition: getCompletionConditionValue(element)\n      };\n    },\n\n    set: function(element, values) {\n      return updateFormalExpression(element, 'completionCondition', values.completionCondition, bpmnFactory);\n    }\n  }));\n\n  return entries;\n\n};\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","var createCtor = require('./_createCtor'),\n    root = require('./_root');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1;\n\n/**\n * Creates a function that wraps `func` to invoke it with the optional `this`\n * binding of `thisArg`.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {*} [thisArg] The `this` binding of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createBind(func, bitmask, thisArg) {\n  var isBind = bitmask & WRAP_BIND_FLAG,\n      Ctor = createCtor(func);\n\n  function wrapper() {\n    var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n    return fn.apply(isBind ? thisArg : this, arguments);\n  }\n  return wrapper;\n}\n\nmodule.exports = createBind;\n","'use strict';\n\nvar eventDefinitionReference = require('./EventDefinitionReference'),\n    elementReferenceProperty = require('./ElementReferenceProperty');\n\n\nmodule.exports = function(group, element, bpmnFactory, errorEventDefinition, translate) {\n\n\n  group.entries = group.entries.concat(eventDefinitionReference(element, errorEventDefinition, bpmnFactory, {\n    label: translate('Error'),\n    elementName: 'error',\n    elementType: 'bpmn:Error',\n    referenceProperty: 'errorRef',\n    newElementIdPrefix: 'Error_'\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, errorEventDefinition, bpmnFactory, {\n    id: 'error-element-name',\n    label: translate('Error Name'),\n    referenceProperty: 'errorRef',\n    modelProperty: 'name',\n    shouldValidate: true\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, errorEventDefinition, bpmnFactory, {\n    id: 'error-element-code',\n    label: translate('Error Code'),\n    referenceProperty: 'errorRef',\n    modelProperty: 'errorCode'\n  }));\n\n};\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    cmdHelper = require('../helper/CmdHelper'),\n    escapeHTML = require('../Utils').escapeHTML;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar checkbox = function(options, defaultParameters) {\n  var resource = defaultParameters,\n      id = resource.id,\n      label = options.label || id,\n      canBeDisabled = !!options.disabled && typeof options.disabled === 'function',\n      canBeHidden = !!options.hidden && typeof options.hidden === 'function',\n      description = options.description;\n\n  resource.html =\n    '<input id=\"camunda-' + escapeHTML(id) + '\" ' +\n         'type=\"checkbox\" ' +\n         'name=\"' + escapeHTML(options.modelProperty) + '\" ' +\n         (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n         (canBeHidden ? 'data-show=\"isHidden\"' : '') +\n         ' />' +\n    '<label for=\"camunda-' + escapeHTML(id) + '\" ' +\n         (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n         (canBeHidden ? 'data-show=\"isHidden\"' : '') +\n         '>' + escapeHTML(label) + '</label>';\n\n  // add description below checkbox entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  resource.get = function(element) {\n    var bo = getBusinessObject(element),\n        res = {};\n\n    res[options.modelProperty] = bo.get(options.modelProperty);\n\n    return res;\n  };\n\n  resource.set = function(element, values) {\n    var res = {};\n\n    res[options.modelProperty] = !!values[options.modelProperty];\n\n    return cmdHelper.updateProperties(element, res);\n  };\n\n  if (typeof options.set === 'function') {\n    resource.set = options.set;\n  }\n\n  if (typeof options.get === 'function') {\n    resource.get = options.get;\n  }\n\n  if (canBeDisabled) {\n    resource.isDisabled = function() {\n      return options.disabled.apply(resource, arguments);\n    };\n  }\n\n  if (canBeHidden) {\n    resource.isHidden = function() {\n      return !options.hidden.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['bpp-checkbox'];\n\n  return resource;\n};\n\nmodule.exports = checkbox;\n","const {\n  is\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks, whether a gateway forks and joins\n * at the same time.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:Gateway')) {\n      return;\n    }\n\n    const incoming = node.incoming || [];\n    const outgoing = node.outgoing || [];\n\n    if (incoming.length > 1 && outgoing.length > 1) {\n      reporter.report(node.id, 'Gateway forks and joins');\n    }\n  }\n\n  return {\n    check\n  };\n\n};","var baseIndexOf = require('./_baseIndexOf');\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\nmodule.exports = arrayIncludes;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","var arrayFilter = require('./_arrayFilter'),\n    baseFilter = require('./_baseFilter'),\n    baseIteratee = require('./_baseIteratee'),\n    isArray = require('./isArray');\n\n/**\n * Iterates over elements of `collection`, returning an array of all elements\n * `predicate` returns truthy for. The predicate is invoked with three\n * arguments: (value, index|key, collection).\n *\n * **Note:** Unlike `_.remove`, this method returns a new array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n * @see _.reject\n * @example\n *\n * var users = [\n *   { 'user': 'barney', 'age': 36, 'active': true },\n *   { 'user': 'fred',   'age': 40, 'active': false }\n * ];\n *\n * _.filter(users, function(o) { return !o.active; });\n * // => objects for ['fred']\n *\n * // The `_.matches` iteratee shorthand.\n * _.filter(users, { 'age': 36, 'active': true });\n * // => objects for ['barney']\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.filter(users, ['active', false]);\n * // => objects for ['fred']\n *\n * // The `_.property` iteratee shorthand.\n * _.filter(users, 'active');\n * // => objects for ['barney']\n */\nfunction filter(collection, predicate) {\n  var func = isArray(collection) ? arrayFilter : baseFilter;\n  return func(collection, baseIteratee(predicate, 3));\n}\n\nmodule.exports = filter;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    asyncContinuation = require('./implementation/AsyncContinuation');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (is(element, 'camunda:AsyncCapable')) {\n\n    group.entries = group.entries.concat(asyncContinuation(element, bpmnFactory, {\n      getBusinessObject: getBusinessObject\n    }, translate));\n\n  }\n};","var getMapData = require('./_getMapData');\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = mapCacheDelete;\n","'use strict';\n\nvar collectionAdd = require('diagram-js/lib/util/Collections').add,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar CategoryHelper = {};\n\nmodule.exports = CategoryHelper;\n\n/**\n * Creates a new bpmn:CategoryValue inside a new bpmn:Category\n *\n * @param {ModdleElement} definitions\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement} categoryValue.\n */\nCategoryHelper.createCategoryValue = function(definitions, bpmnFactory) {\n  var categoryValue = bpmnFactory.create('bpmn:CategoryValue'),\n      category = bpmnFactory.create('bpmn:Category', {\n        categoryValue: [ categoryValue ]\n      });\n\n  // add to correct place\n  collectionAdd(definitions.get('rootElements'), category);\n  getBusinessObject(category).$parent = definitions;\n  getBusinessObject(categoryValue).$parent = category;\n\n  return categoryValue;\n\n};","var isArrayLike = require('./isArrayLike');\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nmodule.exports = createBaseEach;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    elementHelper = require('../../../../helper/ElementHelper');\n\nvar assign = require('lodash/assign');\nvar map = require('lodash/map');\n\nvar DEFAULT_DELEGATE_PROPS = [ 'class', 'expression', 'delegateExpression' ];\n\nvar DELEGATE_PROPS = {\n  'camunda:class': undefined,\n  'camunda:expression': undefined,\n  'camunda:delegateExpression': undefined,\n  'camunda:resultVariable': undefined\n};\n\nvar DMN_CAPABLE_PROPS = {\n  'camunda:decisionRef': undefined,\n  'camunda:decisionRefBinding': 'latest',\n  'camunda:decisionRefVersion': undefined,\n  'camunda:mapDecisionResult': 'resultList',\n  'camunda:decisionRefTenantId': undefined\n};\n\n\nvar EXTERNAL_CAPABLE_PROPS = {\n  'camunda:type': undefined,\n  'camunda:topic': undefined\n};\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var DEFAULT_OPTIONS = [\n    { value: 'class', name: translate('Java Class') },\n    { value: 'expression', name: translate('Expression') },\n    { value: 'delegateExpression', name: translate('Delegate Expression') }\n  ];\n\n  var DMN_OPTION = [\n    { value: 'dmn', name: translate('DMN') }\n  ];\n\n  var EXTERNAL_OPTION = [\n    { value: 'external', name: translate('External') }\n  ];\n\n  var CONNECTOR_OPTION = [\n    { value: 'connector', name: translate('Connector') }\n  ];\n\n  var SCRIPT_OPTION = [\n    { value: 'script', name: translate('Script') }\n  ];\n\n  var getType = options.getImplementationType,\n      getBusinessObject = options.getBusinessObject;\n\n  var hasDmnSupport = options.hasDmnSupport,\n      hasExternalSupport = options.hasExternalSupport,\n      hasServiceTaskLikeSupport = options.hasServiceTaskLikeSupport,\n      hasScriptSupport = options.hasScriptSupport;\n\n  var entries = [];\n\n  var selectOptions = DEFAULT_OPTIONS.concat([]);\n\n  if (hasDmnSupport) {\n    selectOptions = selectOptions.concat(DMN_OPTION);\n  }\n\n  if (hasExternalSupport) {\n    selectOptions = selectOptions.concat(EXTERNAL_OPTION);\n  }\n\n  if (hasServiceTaskLikeSupport) {\n    selectOptions = selectOptions.concat(CONNECTOR_OPTION);\n  }\n\n  if (hasScriptSupport) {\n    selectOptions = selectOptions.concat(SCRIPT_OPTION);\n  }\n\n  selectOptions.push({ value: '' });\n\n  entries.push(entryFactory.selectBox({\n    id : 'implementation',\n    label: translate('Implementation'),\n    selectOptions: selectOptions,\n    modelProperty: 'implType',\n\n    get: function(element, node) {\n      return {\n        implType: getType(element) || ''\n      };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n      var oldType = getType(element);\n      var newType = values.implType;\n\n      var props = assign({}, DELEGATE_PROPS);\n\n      if (DEFAULT_DELEGATE_PROPS.indexOf(newType) !== -1) {\n\n        var newValue = '';\n        if (DEFAULT_DELEGATE_PROPS.indexOf(oldType) !== -1) {\n          newValue = bo.get('camunda:' + oldType);\n        }\n        props['camunda:' + newType] = newValue;\n      }\n\n      if (hasDmnSupport) {\n        props = assign(props, DMN_CAPABLE_PROPS);\n        if (newType === 'dmn') {\n          props['camunda:decisionRef'] = '';\n        }\n      }\n\n      if (hasExternalSupport) {\n        props = assign(props, EXTERNAL_CAPABLE_PROPS);\n        if (newType === 'external') {\n          props['camunda:type'] = 'external';\n          props['camunda:topic'] = '';\n        }\n      }\n\n      if (hasScriptSupport) {\n        props['camunda:script'] = undefined;\n\n        if (newType === 'script') {\n          props['camunda:script'] = elementHelper.createElement('camunda:Script', {}, bo, bpmnFactory);\n        }\n      }\n\n      var commands = [];\n      commands.push(cmdHelper.updateBusinessObject(element, bo, props));\n\n      if (hasServiceTaskLikeSupport) {\n        var connectors = extensionElementsHelper.getExtensionElements(bo, 'camunda:Connector');\n        commands.push(map(connectors, function(connector) {\n          return extensionElementsHelper.removeEntry(bo, element, connector);\n        }));\n\n        if (newType === 'connector') {\n          var extensionElements = bo.get('extensionElements');\n          if (!extensionElements) {\n            extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n            commands.push(cmdHelper.updateBusinessObject(element, bo, { extensionElements: extensionElements }));\n          }\n          var connector = elementHelper.createElement('camunda:Connector', {}, extensionElements, bpmnFactory);\n          commands.push(cmdHelper.addAndRemoveElementsFromList(\n            element,\n            extensionElements,\n            'values',\n            'extensionElements',\n            [ connector ],\n            []\n          ));\n        }\n      }\n\n      return commands;\n\n    }\n  }));\n\n  return entries;\n\n};\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    entryFactory = require('../../../factory/EntryFactory'),\n    participantHelper = require('../../../helper/ParticipantHelper'),\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    nameEntryFactory = require('./implementation/Name'),\n    utils = require('../../../Utils');\n\nmodule.exports = function(group, element, translate, options) {\n  var businessObject = getBusinessObject(element);\n\n  var processIdDescription = options && options.processIdDescription;\n\n  if (is(element, 'bpmn:Process') || (is(element, 'bpmn:Participant') && businessObject.get('processRef'))) {\n\n    /**\n     * processId\n     */\n    if (is(element, 'bpmn:Participant')) {\n      var idEntry = entryFactory.validationAwareTextField({\n        id: 'process-id',\n        label: translate('Process Id'),\n        description: processIdDescription && translate(processIdDescription),\n        modelProperty: 'processId'\n      });\n\n      // in participants we have to change the default behavior of set and get\n      idEntry.get = function(element) {\n        var properties = participantHelper.getProcessBusinessObject(element, 'id');\n        return { processId: properties.id };\n      };\n\n      idEntry.set = function(element, values) {\n        return participantHelper.modifyProcessBusinessObject(element, 'id', { id: values.processId });\n      };\n\n      idEntry.validate = function(element, values) {\n        var idValue = values.processId;\n\n        var bo = getBusinessObject(element);\n\n        var processIdError = utils.isIdValid(bo.processRef, idValue, translate);\n\n        return processIdError ? { processId: processIdError } : {};\n      };\n\n      group.entries.push(idEntry);\n\n\n      /**\n       * process name\n       */\n      var processNameEntry = nameEntryFactory(element, {\n        id: 'process-name',\n        label: translate('Process Name')\n      })[0];\n\n      // in participants we have to change the default behavior of set and get\n      processNameEntry.get = function(element) {\n        return participantHelper.getProcessBusinessObject(element, 'name');\n      };\n\n      processNameEntry.set = function(element, values) {\n        return participantHelper.modifyProcessBusinessObject(element, 'name', values);\n      };\n\n      group.entries.push(processNameEntry);\n    }\n  }\n};\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var Stack = require('./_Stack'),\n    baseIsEqual = require('./_baseIsEqual');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nmodule.exports = baseIsMatch;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    getExtensionElements = require('./ExtensionElementsHelper').getExtensionElements;\n\nvar FormHelper = {};\n\nmodule.exports = FormHelper;\n\n/**\n * Return form data from business object or undefined if none exist\n *\n * @param  {djs.model.Base} element\n *\n * @return {ModdleElement|undefined} formData\n */\nFormHelper.getFormData = function(element) {\n  var bo = getBusinessObject(element);\n\n  var formData = getExtensionElements(bo, 'camunda:FormData');\n\n  if (typeof formData !== 'undefined') {\n    return formData[0];\n  }\n};\n\n\n/**\n * Return all form fields existing in the business object, and\n * an empty array if none exist.\n *\n * @param  {djs.model.Base} element\n *\n * @return {Array} a list of form field objects\n */\nFormHelper.getFormFields = function(element) {\n  var formData = this.getFormData(element);\n\n  if (typeof formData === 'undefined') {\n    return [];\n  }\n\n  return formData.fields || [];\n};\n\n\n/**\n * Get a form field from the business object at given index\n *\n * @param {djs.model.Base} element\n * @param {number} idx\n *\n * @return {ModdleElement} the form field\n */\nFormHelper.getFormField = function(element, idx) {\n\n  var formFields = this.getFormFields(element);\n\n  return formFields[idx];\n};\n\n\n/**\n * Get all constraints for a specific form field from the business object\n *\n * @param  {ModdleElement} formField\n *\n * @return {Array<ModdleElement>} a list of constraint objects\n */\nFormHelper.getConstraints = function(formField) {\n  if (formField && formField.validation && formField.validation.constraints) {\n    return formField.validation.constraints;\n  }\n  return [];\n};\n\n\n/**\n * Get all camunda:value objects for a specific form field from the business object\n *\n * @param  {ModdleElement} formField\n *\n * @return {Array<ModdleElement>} a list of camunda:value objects\n */\nFormHelper.getEnumValues = function(formField) {\n  if (formField && formField.values) {\n    return formField.values;\n  }\n  return [];\n};\n\n","var baseEach = require('./_baseEach'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * The base implementation of `_.map` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction baseMap(collection, iteratee) {\n  var index = -1,\n      result = isArrayLike(collection) ? Array(collection.length) : [];\n\n  baseEach(collection, function(value, key, collection) {\n    result[++index] = iteratee(value, key, collection);\n  });\n  return result;\n}\n\nmodule.exports = baseMap;\n","'use strict';\n// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.array.iterator');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar USE_NATIVE_URL = require('../internals/native-url');\nvar redefine = require('../internals/redefine');\nvar redefineAll = require('../internals/redefine-all');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar InternalStateModule = require('../internals/internal-state');\nvar anInstance = require('../internals/an-instance');\nvar hasOwn = require('../internals/has');\nvar bind = require('../internals/function-bind-context');\nvar classof = require('../internals/classof');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar create = require('../internals/object-create');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar $fetch = getBuiltIn('fetch');\nvar Headers = getBuiltIn('Headers');\nvar ITERATOR = wellKnownSymbol('iterator');\nvar URL_SEARCH_PARAMS = 'URLSearchParams';\nvar URL_SEARCH_PARAMS_ITERATOR = URL_SEARCH_PARAMS + 'Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalParamsState = InternalStateModule.getterFor(URL_SEARCH_PARAMS);\nvar getInternalIteratorState = InternalStateModule.getterFor(URL_SEARCH_PARAMS_ITERATOR);\n\nvar plus = /\\+/g;\nvar sequences = Array(4);\n\nvar percentSequence = function (bytes) {\n  return sequences[bytes - 1] || (sequences[bytes - 1] = RegExp('((?:%[\\\\da-f]{2}){' + bytes + '})', 'gi'));\n};\n\nvar percentDecode = function (sequence) {\n  try {\n    return decodeURIComponent(sequence);\n  } catch (error) {\n    return sequence;\n  }\n};\n\nvar deserialize = function (it) {\n  var result = it.replace(plus, ' ');\n  var bytes = 4;\n  try {\n    return decodeURIComponent(result);\n  } catch (error) {\n    while (bytes) {\n      result = result.replace(percentSequence(bytes--), percentDecode);\n    }\n    return result;\n  }\n};\n\nvar find = /[!'()~]|%20/g;\n\nvar replace = {\n  '!': '%21',\n  \"'\": '%27',\n  '(': '%28',\n  ')': '%29',\n  '~': '%7E',\n  '%20': '+'\n};\n\nvar replacer = function (match) {\n  return replace[match];\n};\n\nvar serialize = function (it) {\n  return encodeURIComponent(it).replace(find, replacer);\n};\n\nvar parseSearchParams = function (result, query) {\n  if (query) {\n    var attributes = query.split('&');\n    var index = 0;\n    var attribute, entry;\n    while (index < attributes.length) {\n      attribute = attributes[index++];\n      if (attribute.length) {\n        entry = attribute.split('=');\n        result.push({\n          key: deserialize(entry.shift()),\n          value: deserialize(entry.join('='))\n        });\n      }\n    }\n  }\n};\n\nvar updateSearchParams = function (query) {\n  this.entries.length = 0;\n  parseSearchParams(this.entries, query);\n};\n\nvar validateArgumentsLength = function (passed, required) {\n  if (passed < required) throw TypeError('Not enough arguments');\n};\n\nvar URLSearchParamsIterator = createIteratorConstructor(function Iterator(params, kind) {\n  setInternalState(this, {\n    type: URL_SEARCH_PARAMS_ITERATOR,\n    iterator: getIterator(getInternalParamsState(params).entries),\n    kind: kind\n  });\n}, 'Iterator', function next() {\n  var state = getInternalIteratorState(this);\n  var kind = state.kind;\n  var step = state.iterator.next();\n  var entry = step.value;\n  if (!step.done) {\n    step.value = kind === 'keys' ? entry.key : kind === 'values' ? entry.value : [entry.key, entry.value];\n  } return step;\n});\n\n// `URLSearchParams` constructor\n// https://url.spec.whatwg.org/#interface-urlsearchparams\nvar URLSearchParamsConstructor = function URLSearchParams(/* init */) {\n  anInstance(this, URLSearchParamsConstructor, URL_SEARCH_PARAMS);\n  var init = arguments.length > 0 ? arguments[0] : undefined;\n  var that = this;\n  var entries = [];\n  var iteratorMethod, iterator, next, step, entryIterator, entryNext, first, second, key;\n\n  setInternalState(that, {\n    type: URL_SEARCH_PARAMS,\n    entries: entries,\n    updateURL: function () { /* empty */ },\n    updateSearchParams: updateSearchParams\n  });\n\n  if (init !== undefined) {\n    if (isObject(init)) {\n      iteratorMethod = getIteratorMethod(init);\n      if (typeof iteratorMethod === 'function') {\n        iterator = iteratorMethod.call(init);\n        next = iterator.next;\n        while (!(step = next.call(iterator)).done) {\n          entryIterator = getIterator(anObject(step.value));\n          entryNext = entryIterator.next;\n          if (\n            (first = entryNext.call(entryIterator)).done ||\n            (second = entryNext.call(entryIterator)).done ||\n            !entryNext.call(entryIterator).done\n          ) throw TypeError('Expected sequence with length 2');\n          entries.push({ key: first.value + '', value: second.value + '' });\n        }\n      } else for (key in init) if (hasOwn(init, key)) entries.push({ key: key, value: init[key] + '' });\n    } else {\n      parseSearchParams(entries, typeof init === 'string' ? init.charAt(0) === '?' ? init.slice(1) : init : init + '');\n    }\n  }\n};\n\nvar URLSearchParamsPrototype = URLSearchParamsConstructor.prototype;\n\nredefineAll(URLSearchParamsPrototype, {\n  // `URLSearchParams.prototype.appent` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-append\n  append: function append(name, value) {\n    validateArgumentsLength(arguments.length, 2);\n    var state = getInternalParamsState(this);\n    state.entries.push({ key: name + '', value: value + '' });\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.delete` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-delete\n  'delete': function (name) {\n    validateArgumentsLength(arguments.length, 1);\n    var state = getInternalParamsState(this);\n    var entries = state.entries;\n    var key = name + '';\n    var index = 0;\n    while (index < entries.length) {\n      if (entries[index].key === key) entries.splice(index, 1);\n      else index++;\n    }\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.get` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-get\n  get: function get(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = name + '';\n    var index = 0;\n    for (; index < entries.length; index++) {\n      if (entries[index].key === key) return entries[index].value;\n    }\n    return null;\n  },\n  // `URLSearchParams.prototype.getAll` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-getall\n  getAll: function getAll(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = name + '';\n    var result = [];\n    var index = 0;\n    for (; index < entries.length; index++) {\n      if (entries[index].key === key) result.push(entries[index].value);\n    }\n    return result;\n  },\n  // `URLSearchParams.prototype.has` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-has\n  has: function has(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = name + '';\n    var index = 0;\n    while (index < entries.length) {\n      if (entries[index++].key === key) return true;\n    }\n    return false;\n  },\n  // `URLSearchParams.prototype.set` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-set\n  set: function set(name, value) {\n    validateArgumentsLength(arguments.length, 1);\n    var state = getInternalParamsState(this);\n    var entries = state.entries;\n    var found = false;\n    var key = name + '';\n    var val = value + '';\n    var index = 0;\n    var entry;\n    for (; index < entries.length; index++) {\n      entry = entries[index];\n      if (entry.key === key) {\n        if (found) entries.splice(index--, 1);\n        else {\n          found = true;\n          entry.value = val;\n        }\n      }\n    }\n    if (!found) entries.push({ key: key, value: val });\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.sort` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-sort\n  sort: function sort() {\n    var state = getInternalParamsState(this);\n    var entries = state.entries;\n    // Array#sort is not stable in some engines\n    var slice = entries.slice();\n    var entry, entriesIndex, sliceIndex;\n    entries.length = 0;\n    for (sliceIndex = 0; sliceIndex < slice.length; sliceIndex++) {\n      entry = slice[sliceIndex];\n      for (entriesIndex = 0; entriesIndex < sliceIndex; entriesIndex++) {\n        if (entries[entriesIndex].key > entry.key) {\n          entries.splice(entriesIndex, 0, entry);\n          break;\n        }\n      }\n      if (entriesIndex === sliceIndex) entries.push(entry);\n    }\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.forEach` method\n  forEach: function forEach(callback /* , thisArg */) {\n    var entries = getInternalParamsState(this).entries;\n    var boundFunction = bind(callback, arguments.length > 1 ? arguments[1] : undefined, 3);\n    var index = 0;\n    var entry;\n    while (index < entries.length) {\n      entry = entries[index++];\n      boundFunction(entry.value, entry.key, this);\n    }\n  },\n  // `URLSearchParams.prototype.keys` method\n  keys: function keys() {\n    return new URLSearchParamsIterator(this, 'keys');\n  },\n  // `URLSearchParams.prototype.values` method\n  values: function values() {\n    return new URLSearchParamsIterator(this, 'values');\n  },\n  // `URLSearchParams.prototype.entries` method\n  entries: function entries() {\n    return new URLSearchParamsIterator(this, 'entries');\n  }\n}, { enumerable: true });\n\n// `URLSearchParams.prototype[@@iterator]` method\nredefine(URLSearchParamsPrototype, ITERATOR, URLSearchParamsPrototype.entries);\n\n// `URLSearchParams.prototype.toString` method\n// https://url.spec.whatwg.org/#urlsearchparams-stringification-behavior\nredefine(URLSearchParamsPrototype, 'toString', function toString() {\n  var entries = getInternalParamsState(this).entries;\n  var result = [];\n  var index = 0;\n  var entry;\n  while (index < entries.length) {\n    entry = entries[index++];\n    result.push(serialize(entry.key) + '=' + serialize(entry.value));\n  } return result.join('&');\n}, { enumerable: true });\n\nsetToStringTag(URLSearchParamsConstructor, URL_SEARCH_PARAMS);\n\n$({ global: true, forced: !USE_NATIVE_URL }, {\n  URLSearchParams: URLSearchParamsConstructor\n});\n\n// Wrap `fetch` for correct work with polyfilled `URLSearchParams`\n// https://github.com/zloirock/core-js/issues/674\nif (!USE_NATIVE_URL && typeof $fetch == 'function' && typeof Headers == 'function') {\n  $({ global: true, enumerable: true, forced: true }, {\n    fetch: function fetch(input /* , init */) {\n      var args = [input];\n      var init, body, headers;\n      if (arguments.length > 1) {\n        init = arguments[1];\n        if (isObject(init)) {\n          body = init.body;\n          if (classof(body) === URL_SEARCH_PARAMS) {\n            headers = init.headers ? new Headers(init.headers) : new Headers();\n            if (!headers.has('content-type')) {\n              headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n            }\n            init = create(init, {\n              body: createPropertyDescriptor(0, String(body)),\n              headers: createPropertyDescriptor(0, headers)\n            });\n          }\n        }\n        args.push(init);\n      } return $fetch.apply(this, args);\n    }\n  });\n}\n\nmodule.exports = {\n  URLSearchParams: URLSearchParamsConstructor,\n  getState: getInternalParamsState\n};\n","var baseFlatten = require('./_baseFlatten');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Recursively flattens `array`.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Array\n * @param {Array} array The array to flatten.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * _.flattenDeep([1, [2, [3, [4]], 5]]);\n * // => [1, 2, 3, 4, 5]\n */\nfunction flattenDeep(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? baseFlatten(array, INFINITY) : [];\n}\n\nmodule.exports = flattenDeep;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nmodule.exports = createBaseFor;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","var anObject = require('../internals/an-object');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\nmodule.exports = function (it) {\n  var iteratorMethod = getIteratorMethod(it);\n  if (typeof iteratorMethod != 'function') {\n    throw TypeError(String(it) + ' is not iterable');\n  } return anObject(iteratorMethod.call(it));\n};\n","'use strict';\n\nvar assign = require('lodash/assign');\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    getTemplate = require('../Helper').getTemplate,\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    elementHelper = require('../../../../helper/ElementHelper');\n\nvar findExtension = require('../Helper').findExtension,\n    findExtensions = require('../Helper').findExtensions,\n    findInputParameter = require('../Helper').findInputParameter,\n    findOutputParameter = require('../Helper').findOutputParameter,\n    findCamundaProperty = require('../Helper').findCamundaProperty,\n    findCamundaInOut = require('../Helper').findCamundaInOut;\n\nvar createCamundaProperty = require('../CreateHelper').createCamundaProperty,\n    createInputParameter = require('../CreateHelper').createInputParameter,\n    createOutputParameter = require('../CreateHelper').createOutputParameter,\n    createCamundaIn = require('../CreateHelper').createCamundaIn,\n    createCamundaOut = require('../CreateHelper').createCamundaOut,\n    createCamundaInWithBusinessKey = require('../CreateHelper').createCamundaInWithBusinessKey,\n    createCamundaFieldInjection = require('../CreateHelper').createCamundaFieldInjection;\n\nvar CAMUNDA_PROPERTY_TYPE = 'camunda:property',\n    CAMUNDA_INPUT_PARAMETER_TYPE = 'camunda:inputParameter',\n    CAMUNDA_OUTPUT_PARAMETER_TYPE = 'camunda:outputParameter',\n    CAMUNDA_IN_TYPE = 'camunda:in',\n    CAMUNDA_OUT_TYPE = 'camunda:out',\n    CAMUNDA_IN_BUSINESS_KEY_TYPE = 'camunda:in:businessKey',\n    CAMUNDA_EXECUTION_LISTENER_TYPE = 'camunda:executionListener',\n    CAMUNDA_FIELD = 'camunda:field';\n\nvar BASIC_MODDLE_TYPES = [\n  'Boolean',\n  'Integer',\n  'String'\n];\n\nvar EXTENSION_BINDING_TYPES = [\n  CAMUNDA_PROPERTY_TYPE,\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE,\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_OUT_TYPE,\n  CAMUNDA_IN_BUSINESS_KEY_TYPE,\n  CAMUNDA_FIELD\n];\n\nvar IO_BINDING_TYPES = [\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE\n];\n\nvar IN_OUT_BINDING_TYPES = [\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_OUT_TYPE,\n  CAMUNDA_IN_BUSINESS_KEY_TYPE\n];\n\n/**\n * Injects custom properties into the given group.\n *\n * @param {djs.model.Base} element\n * @param {ElementTemplates} elementTemplates\n * @param {BpmnFactory} bpmnFactory\n * @param {Function} translate\n */\nmodule.exports = function(element, elementTemplates, bpmnFactory, translate) {\n\n  var template = getTemplate(element, elementTemplates);\n\n  if (!template) {\n    return [];\n  }\n\n  var renderCustomField = function(id, p, idx) {\n    var propertyType = p.type;\n\n    var entryOptions = {\n      id: id,\n      description: p.description,\n      label: p.label ? translate(p.label) : p.label,\n      modelProperty: id,\n      get: propertyGetter(id, p),\n      set: propertySetter(id, p, bpmnFactory),\n      validate: propertyValidator(id, p, translate)\n    };\n\n    var entry;\n\n    if (propertyType === 'Boolean') {\n      entry = entryFactory.checkbox(entryOptions);\n    }\n\n    if (propertyType === 'String') {\n      entry = entryFactory.textField(entryOptions);\n    }\n\n    if (propertyType === 'Text') {\n      entry = entryFactory.textBox(entryOptions);\n    }\n\n    if (propertyType === 'Dropdown') {\n      entryOptions.selectOptions = p.choices;\n\n      entry = entryFactory.selectBox(entryOptions);\n    }\n\n    return entry;\n  };\n\n  var groups = [];\n  var id, entry;\n\n  var customFieldsGroup = {\n    id: 'customField',\n    label: translate('Custom Fields'),\n    entries: []\n  };\n  template.properties.forEach(function(p, idx) {\n\n    id = 'custom-' + template.id + '-' + idx;\n\n    entry = renderCustomField(id, p, idx);\n    if (entry) {\n      customFieldsGroup.entries.push(entry);\n    }\n  });\n  if (customFieldsGroup.entries.length > 0) {\n    groups.push(customFieldsGroup);\n  }\n\n  if (template.scopes) {\n    for (var scopeName in template.scopes) {\n\n      var scope = template.scopes[scopeName];\n      var idScopeName = scopeName.replace(/:/g, '_');\n\n      var customScopeFieldsGroup = {\n        id: 'customField-' + idScopeName,\n        label: translate('Custom Fields for scope: ') + scopeName,\n        entries: []\n      };\n\n      scope.properties.forEach(function(p, idx) {\n\n        var propertyId = 'custom-' + template.id + '-' + idScopeName + '-' + idx;\n\n        var scopedProperty = propertyWithScope(p, scopeName);\n\n        entry = renderCustomField(propertyId, scopedProperty, idx);\n        if (entry) {\n          customScopeFieldsGroup.entries.push(entry);\n        }\n      });\n\n      if (customScopeFieldsGroup.entries.length > 0) {\n        groups.push(customScopeFieldsGroup);\n      }\n    }\n  }\n\n  return groups;\n};\n\n\n// getters, setters and validators ///////////////\n\n\n/**\n * Return a getter that retrieves the given property.\n *\n * @param {String} name\n * @param {PropertyDescriptor} property\n *\n * @return {Function}\n */\nfunction propertyGetter(name, property) {\n\n  /* getter */\n  return function get(element) {\n    var value = getPropertyValue(element, property);\n\n    return objectWithKey(name, value);\n  };\n}\n\n/**\n * Return a setter that updates the given property.\n *\n * @param {String} name\n * @param {PropertyDescriptor} property\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {Function}\n */\nfunction propertySetter(name, property, bpmnFactory) {\n\n  /* setter */\n  return function set(element, values) {\n\n    var value = values[name];\n\n    return setPropertyValue(element, property, value, bpmnFactory);\n  };\n}\n\n/**\n * Return a validator that ensures the property is ok.\n *\n * @param {String} name\n * @param {PropertyDescriptor} property\n * @param {Function} translate\n *\n * @return {Function}\n */\nfunction propertyValidator(name, property, translate) {\n\n  /* validator */\n  return function validate(element, values) {\n    var value = values[name];\n\n    var error = validateValue(value, property, translate);\n\n    if (error) {\n      return objectWithKey(name, error);\n    }\n  };\n}\n\n\n// get, set and validate helpers ///////////////////\n\n/**\n * Return the value of the specified property descriptor,\n * on the passed diagram element.\n *\n * @param {djs.model.Base} element\n * @param {PropertyDescriptor} property\n *\n * @return {Any}\n */\nfunction getPropertyValue(element, property) {\n\n  var bo = getBusinessObject(element);\n\n  var binding = property.binding,\n      scope = property.scope;\n\n  var bindingType = binding.type,\n      bindingName = binding.name;\n\n  var propertyValue = property.value || '';\n\n  if (scope) {\n    bo = findExtension(bo, scope.name);\n    if (!bo) {\n      return propertyValue;\n    }\n  }\n\n  // property\n  if (bindingType === 'property') {\n\n    var value = bo.get(bindingName);\n\n    if (bindingName === 'conditionExpression') {\n      if (value) {\n        return value.body;\n      } else {\n        // return defined default\n        return propertyValue;\n      }\n    } else {\n      // return value; default to defined default\n      return typeof value !== 'undefined' ? value : propertyValue;\n    }\n  }\n\n  var camundaProperties,\n      camundaProperty;\n\n  if (bindingType === CAMUNDA_PROPERTY_TYPE) {\n    if (scope) {\n      camundaProperties = bo.get('properties');\n    } else {\n      camundaProperties = findExtension(bo, 'camunda:Properties');\n    }\n\n    if (camundaProperties) {\n      camundaProperty = findCamundaProperty(camundaProperties, binding);\n\n      if (camundaProperty) {\n        return camundaProperty.value;\n      }\n    }\n\n    return propertyValue;\n  }\n\n  var inputOutput,\n      ioParameter;\n\n  if (IO_BINDING_TYPES.indexOf(bindingType) !== -1) {\n\n    if (scope) {\n      inputOutput = bo.get('inputOutput');\n    } else {\n      inputOutput = findExtension(bo, 'camunda:InputOutput');\n    }\n\n    if (!inputOutput) {\n      // ioParameter cannot exist yet, return property value\n      return propertyValue;\n    }\n  }\n\n  // camunda input parameter\n  if (bindingType === CAMUNDA_INPUT_PARAMETER_TYPE) {\n    ioParameter = findInputParameter(inputOutput, binding);\n\n    if (ioParameter) {\n      if (binding.scriptFormat) {\n        if (ioParameter.definition) {\n          return ioParameter.definition.value;\n        }\n      } else {\n        return ioParameter.value || '';\n      }\n    }\n\n    return propertyValue;\n  }\n\n  // camunda output parameter\n  if (binding.type === CAMUNDA_OUTPUT_PARAMETER_TYPE) {\n    ioParameter = findOutputParameter(inputOutput, binding);\n\n    if (ioParameter) {\n      return ioParameter.name;\n    }\n\n    return propertyValue;\n  }\n\n\n  var ioElement;\n\n  if (IN_OUT_BINDING_TYPES.indexOf(bindingType) != -1) {\n    ioElement = findCamundaInOut(bo, binding);\n\n    if (ioElement) {\n      if (bindingType === CAMUNDA_IN_BUSINESS_KEY_TYPE) {\n        return ioElement.businessKey;\n      } else\n      if (bindingType === CAMUNDA_OUT_TYPE) {\n        return ioElement.target;\n      } else\n      if (bindingType === CAMUNDA_IN_TYPE) {\n        return ioElement[binding.expression ? 'sourceExpression' : 'source'];\n      }\n    }\n\n    return propertyValue;\n  }\n\n  if (bindingType === CAMUNDA_EXECUTION_LISTENER_TYPE) {\n    var executionListener;\n    if (scope) {\n      executionListener = bo.get('executionListener');\n    } else {\n      executionListener = findExtension(bo, 'camunda:ExecutionListener');\n    }\n\n    return executionListener.script.value;\n  }\n\n  var fieldInjection;\n  if (CAMUNDA_FIELD === bindingType) {\n    var fieldInjections = findExtensions(bo, [ 'camunda:Field' ]);\n    fieldInjections.forEach(function(item) {\n      if (item.name === binding.name) {\n        fieldInjection = item;\n      }\n    });\n    if (fieldInjection) {\n      return fieldInjection.string || fieldInjection.expression;\n    } else {\n      return '';\n    }\n  }\n\n  throw unknownPropertyBinding(property);\n}\n\nmodule.exports.getPropertyValue = getPropertyValue;\n\n\n/**\n * Return an update operation that changes the diagram\n * element's custom property to the given value.\n *\n * The response of this method will be processed via\n * {@link PropertiesPanel#applyChanges}.\n *\n * @param {djs.model.Base} element\n * @param {PropertyDescriptor} property\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {Object|Array<Object>} results to be processed\n */\nfunction setPropertyValue(element, property, value, bpmnFactory) {\n  var bo = getBusinessObject(element);\n\n  var binding = property.binding,\n      scope = property.scope;\n\n  var bindingType = binding.type,\n      bindingName = binding.name;\n\n  var propertyValue;\n\n  var updates = [];\n\n  var extensionElements;\n\n  if (EXTENSION_BINDING_TYPES.indexOf(bindingType) !== -1) {\n    extensionElements = bo.get('extensionElements');\n\n    // create extension elements, if they do not exist (yet)\n    if (!extensionElements) {\n      extensionElements = elementHelper.createElement('bpmn:ExtensionElements', null, element, bpmnFactory);\n\n      updates.push(cmdHelper.updateBusinessObject(\n        element, bo, objectWithKey('extensionElements', extensionElements)\n      ));\n    }\n  }\n\n  if (scope) {\n    bo = findExtension(bo, scope.name);\n    if (!bo) {\n      bo = elementHelper.createElement(scope.name, null, element, bpmnFactory);\n\n      updates.push(cmdHelper.addElementsTolist(\n        bo, extensionElements, 'values', [ bo ]\n      ));\n    }\n  }\n\n  // property\n  if (bindingType === 'property') {\n\n    if (bindingName === 'conditionExpression') {\n\n      propertyValue = elementHelper.createElement('bpmn:FormalExpression', {\n        body: value,\n        language: binding.scriptFormat\n      }, bo, bpmnFactory);\n    } else {\n\n      var moddlePropertyDescriptor = bo.$descriptor.propertiesByName[bindingName];\n\n      var moddleType = moddlePropertyDescriptor.type;\n\n      // make sure we only update String, Integer, Real and\n      // Boolean properties (do not accidentally override complex objects...)\n      if (BASIC_MODDLE_TYPES.indexOf(moddleType) === -1) {\n        throw new Error('cannot set moddle type <' + moddleType + '>');\n      }\n\n      if (moddleType === 'Boolean') {\n        propertyValue = !!value;\n      } else\n      if (moddleType === 'Integer') {\n        propertyValue = parseInt(value, 10);\n\n        if (isNaN(propertyValue)) {\n          // do not write NaN value\n          propertyValue = undefined;\n        }\n      } else {\n        propertyValue = value;\n      }\n    }\n\n    if (propertyValue !== undefined) {\n      updates.push(cmdHelper.updateBusinessObject(\n        element, bo, objectWithKey(bindingName, propertyValue)\n      ));\n    }\n  }\n\n  // camunda:property\n  var camundaProperties,\n      existingCamundaProperty,\n      newCamundaProperty;\n\n  if (bindingType === CAMUNDA_PROPERTY_TYPE) {\n\n    if (scope) {\n      camundaProperties = bo.get('properties');\n    } else {\n      camundaProperties = findExtension(extensionElements, 'camunda:Properties');\n    }\n\n    if (!camundaProperties) {\n      camundaProperties = elementHelper.createElement('camunda:Properties', null, bo, bpmnFactory);\n\n      if (scope) {\n        updates.push(cmdHelper.updateBusinessObject(\n          element, bo, { properties: camundaProperties }\n        ));\n      }\n      else {\n        updates.push(cmdHelper.addElementsTolist(\n          element, extensionElements, 'values', [ camundaProperties ]\n        ));\n      }\n    }\n\n    existingCamundaProperty = findCamundaProperty(camundaProperties, binding);\n\n    newCamundaProperty = createCamundaProperty(binding, value, bpmnFactory);\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      camundaProperties,\n      'values',\n      null,\n      [ newCamundaProperty ],\n      existingCamundaProperty ? [ existingCamundaProperty ] : []\n    ));\n  }\n\n  // camunda:inputParameter\n  // camunda:outputParameter\n  var inputOutput,\n      existingIoParameter,\n      newIoParameter;\n\n  if (IO_BINDING_TYPES.indexOf(bindingType) !== -1) {\n\n    if (scope) {\n      inputOutput = bo.get('inputOutput');\n    } else {\n      inputOutput = findExtension(extensionElements, 'camunda:InputOutput');\n    }\n\n    // create inputOutput element, if it do not exist (yet)\n    if (!inputOutput) {\n      inputOutput = elementHelper.createElement('camunda:InputOutput', null, bo, bpmnFactory);\n\n      if (scope) {\n        updates.push(cmdHelper.updateBusinessObject(\n          element, bo, { inputOutput: inputOutput }\n        ));\n      }\n      else {\n        updates.push(cmdHelper.addElementsTolist(\n          element, extensionElements, 'values', inputOutput\n        ));\n      }\n    }\n  }\n\n  if (bindingType === CAMUNDA_INPUT_PARAMETER_TYPE) {\n\n    existingIoParameter = findInputParameter(inputOutput, binding);\n\n    newIoParameter = createInputParameter(binding, value, bpmnFactory);\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      inputOutput,\n      'inputParameters',\n      null,\n      [ newIoParameter ],\n      existingIoParameter ? [ existingIoParameter ] : []\n    ));\n  }\n\n  if (bindingType === CAMUNDA_OUTPUT_PARAMETER_TYPE) {\n\n    existingIoParameter = findOutputParameter(inputOutput, binding);\n\n    newIoParameter = createOutputParameter(binding, value, bpmnFactory);\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      inputOutput,\n      'outputParameters',\n      null,\n      [ newIoParameter ],\n      existingIoParameter ? [ existingIoParameter ] : []\n    ));\n  }\n\n\n  // camunda:in\n  // camunda:out\n  // camunda:in:businessKey\n  var existingInOut,\n      newInOut;\n\n  if (IN_OUT_BINDING_TYPES.indexOf(bindingType) !== -1) {\n\n    existingInOut = findCamundaInOut(bo, binding);\n\n    if (bindingType === CAMUNDA_IN_TYPE) {\n      newInOut = createCamundaIn(binding, value, bpmnFactory);\n    } else\n    if (bindingType === CAMUNDA_OUT_TYPE) {\n      newInOut = createCamundaOut(binding, value, bpmnFactory);\n    } else {\n      newInOut = createCamundaInWithBusinessKey(binding, value, bpmnFactory);\n    }\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      extensionElements,\n      'values',\n      null,\n      [ newInOut ],\n      existingInOut ? [ existingInOut ] : []\n    ));\n  }\n\n  if (bindingType === CAMUNDA_FIELD) {\n    var existingFieldInjections = findExtensions(bo, [ 'camunda:Field' ]);\n    var newFieldInjections = [];\n\n    if (existingFieldInjections.length > 0) {\n      existingFieldInjections.forEach(function(item) {\n        if (item.name === binding.name) {\n          newFieldInjections.push(createCamundaFieldInjection(binding, value, bpmnFactory));\n        } else {\n          newFieldInjections.push(item);\n        }\n      });\n    } else {\n      newFieldInjections.push(createCamundaFieldInjection(binding, value, bpmnFactory));\n    }\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      extensionElements,\n      'values',\n      null,\n      newFieldInjections,\n      existingFieldInjections ? existingFieldInjections : []\n    ));\n  }\n\n  if (updates.length) {\n    return updates;\n  }\n\n  // quick warning for better debugging\n  console.warn('no update', element, property, value);\n}\n\nmodule.exports.setPropertyValue = setPropertyValue;\n\n/**\n * Validate value of a given property.\n *\n * @param {String} value\n * @param {PropertyDescriptor} property\n * @param {Function} translate\n *\n * @return {Object} with validation errors\n */\nfunction validateValue(value, property, translate) {\n\n  var constraints = property.constraints || {};\n\n  if (constraints.notEmpty && isEmpty(value)) {\n    return translate('Must not be empty');\n  }\n\n  if (constraints.maxLength && value.length > constraints.maxLength) {\n    return translate('Must have max length {length}', { length: constraints.maxLength });\n  }\n\n  if (constraints.minLength && value.length < constraints.minLength) {\n    return translate('Must have min length {length}', { length: constraints.minLength });\n  }\n\n  var pattern = constraints.pattern,\n      message;\n\n  if (pattern) {\n\n    if (typeof pattern !== 'string') {\n      message = pattern.message;\n      pattern = pattern.value;\n    }\n\n    if (!matchesPattern(value, pattern)) {\n      return message || translate('Must match pattern {pattern}', { pattern: pattern });\n    }\n  }\n}\n\n\n// misc helpers ///////////////////////////////\n\nfunction propertyWithScope(property, scopeName) {\n  if (!scopeName) {\n    return property;\n  }\n\n  return assign({}, property, {\n    scope: {\n      name: scopeName\n    }\n  });\n}\n\n/**\n * Return an object with a single key -> value association.\n *\n * @param {String} key\n * @param {Any} value\n *\n * @return {Object}\n */\nfunction objectWithKey(key, value) {\n  var obj = {};\n\n  obj[key] = value;\n\n  return obj;\n}\n\n/**\n * Does the given string match the specified pattern?\n *\n * @param {String} str\n * @param {String} pattern\n *\n * @return {Boolean}\n */\nfunction matchesPattern(str, pattern) {\n  var regexp = new RegExp(pattern);\n\n  return regexp.test(str);\n}\n\nfunction isEmpty(str) {\n  return !str || /^\\s*$/.test(str);\n}\n\n/**\n * Create a new {@link Error} indicating an unknown\n * property binding.\n *\n * @param {PropertyDescriptor} property\n *\n * @return {Error}\n */\nfunction unknownPropertyBinding(property) {\n  var binding = property.binding;\n\n  return new Error('unknown binding: <' + binding.type + '>');\n}\n","var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n","var baseGet = require('./_baseGet');\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar asyncCapableHelper = require('../../../../helper/AsyncCapableHelper');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    eventDefinitionHelper = require('../../../../helper/EventDefinitionHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nfunction isAsyncBefore(bo) {\n  return asyncCapableHelper.isAsyncBefore(bo);\n}\n\nfunction isAsyncAfter(bo) {\n  return asyncCapableHelper.isAsyncAfter(bo);\n}\n\nfunction getFailedJobRetryTimeCycle(bo) {\n  return asyncCapableHelper.getFailedJobRetryTimeCycle(bo);\n}\n\nfunction removeFailedJobRetryTimeCycle(bo, element) {\n  return asyncCapableHelper.removeFailedJobRetryTimeCycle(bo, element);\n}\n\nfunction createExtensionElements(parent, bpmnFactory) {\n  return elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, parent, bpmnFactory);\n}\n\nfunction createFailedJobRetryTimeCycle(parent, bpmnFactory, cycle) {\n  return elementHelper.createElement('camunda:FailedJobRetryTimeCycle', { body: cycle }, parent, bpmnFactory);\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var idPrefix = options.idPrefix || '',\n      labelPrefix = options.labelPrefix || '';\n\n  var retryTimeCycleEntry = entryFactory.textField({\n    id: idPrefix + 'retryTimeCycle',\n    label: labelPrefix + translate('Retry Time Cycle'),\n    modelProperty: 'cycle',\n\n    get: function(element, node) {\n      var retryTimeCycle = getFailedJobRetryTimeCycle(getBusinessObject(element));\n      var value = retryTimeCycle && retryTimeCycle.get('body');\n      return {\n        cycle: value\n      };\n    },\n\n    set: function(element, values, node) {\n      var newCycle = values.cycle;\n      var bo = getBusinessObject(element);\n\n      if (newCycle === '' || typeof newCycle === 'undefined') {\n        // remove retry time cycle element(s)\n        return removeFailedJobRetryTimeCycle(bo, element);\n      }\n\n      var retryTimeCycle = getFailedJobRetryTimeCycle(bo);\n\n      if (!retryTimeCycle) {\n        // add new retry time cycle element\n        var commands = [];\n\n        var extensionElements = bo.get('extensionElements');\n        if (!extensionElements) {\n          extensionElements = createExtensionElements(bo, bpmnFactory);\n          commands.push(cmdHelper.updateBusinessObject(element, bo, { extensionElements: extensionElements }));\n        }\n\n        retryTimeCycle = createFailedJobRetryTimeCycle(extensionElements, bpmnFactory, newCycle);\n        commands.push(cmdHelper.addAndRemoveElementsFromList(\n          element,\n          extensionElements,\n          'values',\n          'extensionElements',\n          [ retryTimeCycle ],\n          []\n        ));\n\n        return commands;\n      }\n\n      // update existing retry time cycle element\n      return cmdHelper.updateBusinessObject(element, retryTimeCycle, { body: newCycle });\n    },\n\n    hidden: function(element) {\n      var bo = getBusinessObject(element);\n\n      if (bo && (isAsyncBefore(bo) || isAsyncAfter(bo))) {\n        return false;\n      }\n\n      if (is(element, 'bpmn:Event')) {\n        return !eventDefinitionHelper.getTimerEventDefinition(element);\n      }\n\n      return true;\n    }\n\n  });\n\n  return [ retryTimeCycleEntry ];\n\n};\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var baseEach = require('./_baseEach');\n\n/**\n * The base implementation of `_.filter` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction baseFilter(collection, predicate) {\n  var result = [];\n  baseEach(collection, function(value, index, collection) {\n    if (predicate(value, index, collection)) {\n      result.push(value);\n    }\n  });\n  return result;\n}\n\nmodule.exports = baseFilter;\n","'use strict';\n\nvar domQuery = require('min-dom').query,\n    escapeHTML = require('../../../../Utils').escapeHTML,\n    utils = require('../../../../Utils');\n\n\nfunction getScriptType(node) {\n  return utils.selectedType('select[name=scriptType]', node.parentElement);\n}\n\n\nmodule.exports = function(scriptLanguagePropName, scriptValuePropName, isFormatRequired, translate) {\n\n  return {\n    template:\n    '<div class=\"bpp-row bpp-textfield\">' +\n      '<label for=\"cam-script-format\">' + escapeHTML(translate('Script Format')) + '</label>' +\n      '<div class=\"bpp-field-wrapper\">' +\n        '<input id=\"cam-script-format\" type=\"text\" name=\"scriptFormat\" />' +\n        '<button class=\"clear\" data-action=\"script.clearScriptFormat\" data-show=\"script.canClearScriptFormat\">' +\n          '<span>X</span>' +\n        '</button>' +\n      '</div>' +\n    '</div>' +\n\n    '<div class=\"bpp-row\">' +\n      '<label for=\"cam-script-type\">' + escapeHTML(translate('Script Type')) + '</label>' +\n      '<div class=\"bpp-field-wrapper\">' +\n        '<select id=\"cam-script-type\" name=\"scriptType\" data-value>' +\n          '<option value=\"script\" selected>' + escapeHTML(translate('Inline Script')) + '</option>' +\n          '<option value=\"scriptResource\">' + escapeHTML(translate('External Resource')) + '</option>' +\n        '</select>' +\n      '</div>' +\n    '</div>' +\n\n    '<div class=\"bpp-row bpp-textfield\">' +\n      '<label for=\"cam-script-resource-val\" data-show=\"script.isScriptResource\">' + escapeHTML(translate('Resource')) + '</label>' +\n      '<div class=\"bpp-field-wrapper\" data-show=\"script.isScriptResource\">' +\n        '<input id=\"cam-script-resource-val\" type=\"text\" name=\"scriptResourceValue\" />' +\n        '<button class=\"clear\" data-action=\"script.clearScriptResource\" data-show=\"script.canClearScriptResource\">' +\n          '<span>X</span>' +\n        '</button>' +\n      '</div>' +\n    '</div>' +\n\n    '<div class=\"bpp-row\">' +\n      '<label for=\"cam-script-val\" data-show=\"script.isScript\">' + escapeHTML(translate('Script')) + '</label>' +\n      '<div class=\"bpp-field-wrapper\" data-show=\"script.isScript\">' +\n        '<textarea id=\"cam-script-val\" type=\"text\" name=\"scriptValue\"></textarea>' +\n      '</div>'+\n    '</div>',\n\n    get: function(element, bo) {\n      var values = {};\n\n      // read values from xml:\n      var boScriptResource = bo.get('camunda:resource'),\n          boScript = bo.get(scriptValuePropName),\n          boScriptFormat = bo.get(scriptLanguagePropName);\n\n      if (typeof boScriptResource !== 'undefined') {\n        values.scriptResourceValue = boScriptResource;\n        values.scriptType = 'scriptResource';\n      } else {\n        values.scriptValue = boScript;\n        values.scriptType = 'script';\n      }\n\n      values.scriptFormat = boScriptFormat;\n\n      return values;\n    },\n\n    set: function(element, values, containerElement) {\n      var scriptFormat = values.scriptFormat,\n          scriptType = values.scriptType,\n          scriptResourceValue = values.scriptResourceValue,\n          scriptValue = values.scriptValue;\n\n      // init update\n      var update = {\n        'camunda:resource': undefined\n      };\n      update[scriptValuePropName] = undefined;\n      update[scriptLanguagePropName] = undefined;\n\n      if (isFormatRequired) {\n        // always set language\n        update[scriptLanguagePropName] = scriptFormat || '';\n      } else\n      // set language only when scriptFormat has a value\n      if (scriptFormat !== '') {\n        update[scriptLanguagePropName] = scriptFormat;\n      }\n\n      // set either inline script or resource\n      if ('scriptResource' === scriptType) {\n        update['camunda:resource'] = scriptResourceValue || '';\n      } else {\n        update[scriptValuePropName] = scriptValue || '';\n      }\n\n      return update;\n    },\n\n    validate: function(element, values) {\n      var validationResult = {};\n\n      if (values.scriptType === 'script' && !values.scriptValue) {\n        validationResult.scriptValue = translate('Must provide a value');\n      }\n\n      if (values.scriptType === 'scriptResource' && !values.scriptResourceValue) {\n        validationResult.scriptResourceValue = translate('Must provide a value');\n      }\n\n      if (isFormatRequired && (!values.scriptFormat || values.scriptFormat.length === 0)) {\n        validationResult.scriptFormat = translate('Must provide a value');\n      }\n\n      return validationResult;\n    },\n\n    clearScriptFormat: function(element, inputNode, btnNode, scopeNode) {\n      domQuery('input[name=scriptFormat]', scopeNode).value='';\n\n      return true;\n    },\n\n    canClearScriptFormat: function(element, inputNode, btnNode, scopeNode) {\n      var input = domQuery('input[name=scriptFormat]', scopeNode);\n\n      return input.value !== '';\n    },\n\n    clearScriptResource: function(element, inputNode, btnNode, scopeNode) {\n      domQuery('input[name=scriptResourceValue]', scopeNode).value='';\n\n      return true;\n    },\n\n    canClearScriptResource: function(element, inputNode, btnNode, scopeNode) {\n      var input = domQuery('input[name=scriptResourceValue]', scopeNode);\n\n      return input.value !== '';\n    },\n\n    clearScript: function(element, inputNode, btnNode, scopeNode) {\n      domQuery('textarea[name=scriptValue]', scopeNode).value='';\n\n      return true;\n    },\n\n    canClearScript: function(element, inputNode, btnNode, scopeNode) {\n      var input = domQuery('textarea[name=scriptValue]', scopeNode);\n\n      return input.value !== '';\n    },\n\n    isScriptResource: function(element, inputNode, btnNode, scopeNode) {\n      var scriptType = getScriptType(scopeNode);\n      return scriptType === 'scriptResource';\n    },\n\n    isScript: function(element, inputNode, btnNode, scopeNode) {\n      var scriptType = getScriptType(scopeNode);\n      return scriptType === 'script';\n    }\n\n  };\n\n};\n","/**\n * A specialized version of `baseAggregator` for arrays.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} setter The function to set `accumulator` values.\n * @param {Function} iteratee The iteratee to transform keys.\n * @param {Object} accumulator The initial aggregated object.\n * @returns {Function} Returns `accumulator`.\n */\nfunction arrayAggregator(array, setter, iteratee, accumulator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    var value = array[index];\n    setter(accumulator, value, iteratee(value), array);\n  }\n  return accumulator;\n}\n\nmodule.exports = arrayAggregator;\n","const traverse = require('./traverse');\n\nclass Reporter {\n  constructor({ moddleRoot, rule }) {\n    this.rule = rule;\n    this.moddleRoot = moddleRoot;\n    this.messages = [];\n    this.report = this.report.bind(this);\n  }\n\n  report(id, message) {\n    this.messages.push({ id, message });\n  }\n}\n\nmodule.exports = function testRule({ moddleRoot, rule }) {\n  const reporter = new Reporter({ rule, moddleRoot });\n  traverse(moddleRoot, node => rule.check(node, reporter));\n  return reporter.messages;\n};\n","var SetCache = require('./_SetCache'),\n    arraySome = require('./_arraySome'),\n    cacheHas = require('./_cacheHas');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(array);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalArrays;\n","var constant = require('./constant'),\n    defineProperty = require('./_defineProperty'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nmodule.exports = baseSetToString;\n","var getMapData = require('./_getMapData');\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nmodule.exports = mapCacheHas;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper'),\n    eventDefinitionHelper = require('../../../../helper/EventDefinitionHelper'),\n    utils = require('../../../../Utils');\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar forEach = require('lodash/forEach'),\n    find = require('lodash/find'),\n    filter = require('lodash/filter');\n\n\nfunction getContainedActivities(element) {\n  return getFlowElements(element, 'bpmn:Activity');\n}\n\nfunction getContainedBoundaryEvents(element) {\n  return getFlowElements(element, 'bpmn:BoundaryEvent');\n}\n\nfunction getFlowElements(element, type) {\n  return utils.filterElementsByType(element.flowElements, type);\n}\n\nfunction isCompensationEventAttachedToActivity(activity, boundaryEvents) {\n  var activityId = activity.id;\n  var boundaryEvent = find(boundaryEvents, function(boundaryEvent) {\n    var compensateEventDefinition = eventDefinitionHelper.getCompensateEventDefinition(boundaryEvent);\n    var attachedToRef = boundaryEvent.attachedToRef;\n    return compensateEventDefinition && attachedToRef && attachedToRef.id === activityId;\n  });\n  return !!boundaryEvent;\n}\n\n// subprocess: only when it is not triggeredByEvent\n// activity: only when it attach a compensation boundary event\n// callActivity: no limitation\nfunction canActivityBeCompensated(activity, boundaryEvents) {\n  return (is(activity, 'bpmn:SubProcess') && !activity.triggeredByEvent) ||\n          is(activity, 'bpmn:CallActivity') ||\n          isCompensationEventAttachedToActivity(activity, boundaryEvents);\n}\n\nfunction getActivitiesForCompensation(element) {\n  var boundaryEvents = getContainedBoundaryEvents(element);\n  return filter(getContainedActivities(element), function(activity) {\n    return canActivityBeCompensated(activity, boundaryEvents);\n  });\n}\n\nfunction getActivitiesForActivityRef(element) {\n  var bo = getBusinessObject(element);\n  var parent = bo.$parent;\n\n  var activitiesForActivityRef = getActivitiesForCompensation(parent);\n\n  // if throwing compensation event is in an event sub process:\n  // get also all activities outside of the event sub process\n  if (is(parent, 'bpmn:SubProcess') && parent.triggeredByEvent) {\n    parent = parent.$parent;\n    if (parent) {\n      activitiesForActivityRef = activitiesForActivityRef.concat(getActivitiesForCompensation(parent));\n    }\n\n  }\n\n  return activitiesForActivityRef;\n}\n\nfunction createActivityRefOptions(element) {\n  var options = [ { value: '' } ];\n\n  var activities = getActivitiesForActivityRef(element);\n  forEach(activities, function(activity) {\n    var activityId = activity.id;\n    var name = (activity.name ? (activity.name + ' ') : '') + '(id=' + activityId + ')';\n    options.push({ value: activityId, name: name });\n  });\n\n  return options;\n}\n\n\nmodule.exports = function(group, element, bpmnFactory, compensateEventDefinition, elementRegistry, translate) {\n\n  group.entries.push(entryFactory.checkbox({\n    id: 'wait-for-completion',\n    label: translate('Wait for Completion'),\n    modelProperty: 'waitForCompletion',\n\n    get: function(element, node) {\n      return {\n        waitForCompletion: compensateEventDefinition.waitForCompletion\n      };\n    },\n\n    set: function(element, values) {\n      values.waitForCompletion = values.waitForCompletion || false;\n      return cmdHelper.updateBusinessObject(element, compensateEventDefinition, values);\n    }\n  }));\n\n  group.entries.push(entryFactory.selectBox({\n    id: 'activity-ref',\n    label: translate('Activity Ref'),\n    selectOptions: createActivityRefOptions(element),\n    modelProperty: 'activityRef',\n\n    get: function(element, node) {\n      var activityRef = compensateEventDefinition.activityRef;\n      activityRef = activityRef && activityRef.id;\n      return {\n        activityRef: activityRef || ''\n      };\n    },\n\n    set: function(element, values) {\n      var activityRef = values.activityRef || undefined;\n      activityRef = activityRef && getBusinessObject(elementRegistry.get(activityRef));\n      return cmdHelper.updateBusinessObject(element, compensateEventDefinition, {\n        activityRef: activityRef\n      });\n    }\n  }));\n\n};\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar DELEGATE_TYPES = [\n  'class',\n  'expression',\n  'delegateExpression'\n];\n\nvar PROPERTIES = {\n  class: 'camunda:class',\n  expression: 'camunda:expression',\n  delegateExpression: 'camunda:delegateExpression'\n};\n\nfunction isDelegate(type) {\n  return DELEGATE_TYPES.indexOf(type) !== -1;\n}\n\nfunction getAttribute(type) {\n  return PROPERTIES[type];\n}\n\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getImplementationType = options.getImplementationType,\n      getBusinessObject = options.getBusinessObject;\n\n  function getDelegationLabel(type) {\n    switch (type) {\n    case 'class':\n      return translate('Java Class');\n    case 'expression':\n      return translate('Expression');\n    case 'delegateExpression':\n      return translate('Delegate Expression');\n    default:\n      return '';\n    }\n  }\n\n  var delegateEntry = entryFactory.textField({\n    id: 'delegate',\n    label: translate('Value'),\n    dataValueLabel: 'delegationLabel',\n    modelProperty: 'delegate',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var type = getImplementationType(element);\n      var attr = getAttribute(type);\n      var label = getDelegationLabel(type);\n      return {\n        delegate: bo.get(attr),\n        delegationLabel: label\n      };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n      var type = getImplementationType(element);\n      var attr = getAttribute(type);\n      var prop = {};\n      prop[attr] = values.delegate || '';\n      return cmdHelper.updateBusinessObject(element, bo, prop);\n    },\n\n    validate: function(element, values, node) {\n      return isDelegate(getImplementationType(element)) && !values.delegate ? { delegate: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !isDelegate(getImplementationType(element));\n    }\n\n  });\n\n  return [ delegateEntry ];\n\n};\n","var copyArray = require('./_copyArray'),\n    isIndex = require('./_isIndex');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMin = Math.min;\n\n/**\n * Reorder `array` according to the specified indexes where the element at\n * the first index is assigned as the first element, the element at\n * the second index is assigned as the second element, and so on.\n *\n * @private\n * @param {Array} array The array to reorder.\n * @param {Array} indexes The arranged array indexes.\n * @returns {Array} Returns `array`.\n */\nfunction reorder(array, indexes) {\n  var arrLength = array.length,\n      length = nativeMin(indexes.length, arrLength),\n      oldArray = copyArray(array);\n\n  while (length--) {\n    var index = indexes[length];\n    array[length] = isIndex(index, arrLength) ? oldArray[index] : undefined;\n  }\n  return array;\n}\n\nmodule.exports = reorder;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\n/**\n * Create an entry to modify a property of an element which\n * is referenced by a event definition.\n *\n * @param  {djs.model.Base} element\n * @param  {ModdleElement} definition\n * @param  {BpmnFactory} bpmnFactory\n * @param  {Object} options\n * @param  {string} options.id the id of the entry\n * @param  {string} options.label the label of the entry\n * @param  {string} options.referenceProperty the name of referencing property\n * @param  {string} options.modelProperty the name of property to modify\n * @param  {string} options.shouldValidate a flag indicate whether to validate or not\n *\n * @return {Array<Object>} return an array containing the entries\n */\nmodule.exports = function(element, definition, bpmnFactory, options) {\n\n  var id = options.id || 'element-property';\n  var label = options.label;\n  var referenceProperty = options.referenceProperty;\n  var modelProperty = options.modelProperty || 'name';\n  var shouldValidate = options.shouldValidate || false;\n\n  var entry = entryFactory.textField({\n    id: id,\n    label: label,\n    modelProperty: modelProperty,\n\n    get: function(element, node) {\n      var reference = definition.get(referenceProperty);\n      var props = {};\n      props[modelProperty] = reference && reference.get(modelProperty);\n      return props;\n    },\n\n    set: function(element, values, node) {\n      var reference = definition.get(referenceProperty);\n      var props = {};\n      props[modelProperty] = values[modelProperty] || undefined;\n      return cmdHelper.updateBusinessObject(element, reference, props);\n    },\n\n    hidden: function(element, node) {\n      return !definition.get(referenceProperty);\n    }\n  });\n\n  if (shouldValidate) {\n    entry.validate = function(element, values, node) {\n      var reference = definition.get(referenceProperty);\n      if (reference && !values[modelProperty]) {\n        var validationErrors = {};\n        validationErrors[modelProperty] = 'Must provide a value';\n        return validationErrors;\n      }\n    };\n  }\n\n  return [ entry ];\n};\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbols = require('./_getSymbols'),\n    keys = require('./keys');\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nmodule.exports = getAllKeys;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    inputOutputHelper = require('../../../../helper/InputOutputHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    utils = require('../../../../Utils');\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    scriptImplementation = require('./Script');\n\n\nfunction createElement(type, parent, factory, properties) {\n  return elementHelper.createElement(type, properties, parent, factory);\n}\n\nfunction isScript(elem) {\n  return is(elem, 'camunda:Script');\n}\n\nfunction isList(elem) {\n  return is(elem, 'camunda:List');\n}\n\nfunction isMap(elem) {\n  return is(elem, 'camunda:Map');\n}\n\nfunction ensureInputOutputSupported(element, insideConnector) {\n  return inputOutputHelper.isInputOutputSupported(element, insideConnector);\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var typeInfo = {\n    'camunda:Map': {\n      value: 'map',\n      label: translate('Map')\n    },\n    'camunda:List': {\n      value: 'list',\n      label: translate('List')\n    },\n    'camunda:Script': {\n      value: 'script',\n      label: translate('Script')\n    }\n  };\n\n  options = options || {};\n\n  var insideConnector = !!options.insideConnector,\n      idPrefix = options.idPrefix || '';\n\n  var getSelected = options.getSelectedParameter;\n\n  if (!ensureInputOutputSupported(element, insideConnector)) {\n    return [];\n  }\n\n  var entries = [];\n\n  var isSelected = function(element, node) {\n    return getSelected(element, node);\n  };\n\n\n  // parameter name ////////////////////////////////////////////////////////\n\n  entries.push(entryFactory.validationAwareTextField({\n    id: idPrefix + 'parameterName',\n    label: translate('Name'),\n    modelProperty: 'name',\n\n    getProperty: function(element, node) {\n      return (getSelected(element, node) || {}).name;\n    },\n\n    setProperty: function(element, values, node) {\n      var param = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, param, values);\n    },\n\n    validate: function(element, values, node) {\n      var bo = getSelected(element, node);\n\n      var validation = {};\n      if (bo) {\n        var nameValue = values.name;\n\n        if (nameValue) {\n          if (utils.containsSpace(nameValue)) {\n            validation.name = translate('Name must not contain spaces');\n          }\n        } else {\n          validation.name = translate('Parameter must have a name');\n        }\n      }\n\n      return validation;\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n  }));\n\n\n  // parameter type //////////////////////////////////////////////////////\n\n  var selectOptions = [\n    { value: 'text', name: translate('Text') },\n    { value: 'script', name: translate('Script') },\n    { value: 'list', name: translate('List') },\n    { value: 'map', name: translate('Map') }\n  ];\n\n  entries.push(entryFactory.selectBox({\n    id : idPrefix + 'parameterType',\n    label: translate('Type'),\n    selectOptions: selectOptions,\n    modelProperty: 'parameterType',\n\n    get: function(element, node) {\n      var bo = getSelected(element, node);\n\n      var parameterType = 'text';\n\n      if (typeof bo !== 'undefined') {\n        var definition = bo.get('definition');\n        if (typeof definition !== 'undefined') {\n          var type = definition.$type;\n          parameterType = typeInfo[type].value;\n        }\n      }\n\n      return {\n        parameterType: parameterType\n      };\n    },\n\n    set: function(element, values, node) {\n      var bo = getSelected(element, node);\n\n      var properties = {\n        value: undefined,\n        definition: undefined\n      };\n\n      var createParameterTypeElem = function(type) {\n        return createElement(type, bo, bpmnFactory);\n      };\n\n      var parameterType = values.parameterType;\n\n      if (parameterType === 'script') {\n        properties.definition = createParameterTypeElem('camunda:Script');\n      }\n      else if (parameterType === 'list') {\n        properties.definition = createParameterTypeElem('camunda:List');\n      }\n      else if (parameterType === 'map') {\n        properties.definition = createParameterTypeElem('camunda:Map');\n      }\n\n      return cmdHelper.updateBusinessObject(element, bo, properties);\n    },\n\n    show: function(element, node) {\n      return isSelected(element, node);\n    }\n\n  }));\n\n\n  // parameter value (type = text) ///////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textBox({\n    id : idPrefix + 'parameterType-text',\n    label : translate('Value'),\n    modelProperty: 'value',\n    get: function(element, node) {\n      return {\n        value: (getSelected(element, node) || {}).value\n      };\n    },\n\n    set: function(element, values, node) {\n      var param = getSelected(element, node);\n      values.value = values.value || undefined;\n      return cmdHelper.updateBusinessObject(element, param, values);\n    },\n\n    show: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && !bo.definition;\n    }\n\n  }));\n\n\n  // parameter value (type = script) ///////////////////////////////////////////////////////\n  var script = scriptImplementation('scriptFormat', 'value', true, translate);\n  entries.push({\n    id: idPrefix + 'parameterType-script',\n    html: '<div data-show=\"isScript\">' +\n            script.template +\n          '</div>',\n    get: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && isScript(bo.definition) ? script.get(element, bo.definition) : {};\n    },\n\n    set: function(element, values, node) {\n      var bo = getSelected(element, node);\n      var update = script.set(element, values);\n      return cmdHelper.updateBusinessObject(element, bo.definition, update);\n    },\n\n    validate: function(element, values, node) {\n      var bo = getSelected(element, node);\n      return bo && isScript(bo.definition) ? script.validate(element, bo.definition) : {};\n    },\n\n    isScript: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && isScript(bo.definition);\n    },\n\n    script: script\n\n  });\n\n\n  // parameter value (type = list) ///////////////////////////////////////////////////////\n\n  entries.push(entryFactory.table({\n    id: idPrefix + 'parameterType-list',\n    modelProperties: [ 'value' ],\n    labels: [ translate('Value') ],\n    addLabel: translate('Add Value'),\n\n    getElements: function(element, node) {\n      var bo = getSelected(element, node);\n\n      if (bo && isList(bo.definition)) {\n        return bo.definition.items;\n      }\n\n      return [];\n    },\n\n    updateElement: function(element, values, node, idx) {\n      var bo = getSelected(element, node);\n      var item = bo.definition.items[idx];\n      return cmdHelper.updateBusinessObject(element, item, values);\n    },\n\n    addElement: function(element, node) {\n      var bo = getSelected(element, node);\n      var newValue = createElement('camunda:Value', bo.definition, bpmnFactory, { value: undefined });\n      return cmdHelper.addElementsTolist(element, bo.definition, 'items', [ newValue ]);\n    },\n\n    removeElement: function(element, node, idx) {\n      var bo = getSelected(element, node);\n      return cmdHelper.removeElementsFromList(element, bo.definition, 'items', null, [ bo.definition.items[idx] ]);\n    },\n\n    editable: function(element, node, prop, idx) {\n      var bo = getSelected(element, node);\n      var item = bo.definition.items[idx];\n      return !isMap(item) && !isList(item) && !isScript(item);\n    },\n\n    setControlValue: function(element, node, input, prop, value, idx) {\n      var bo = getSelected(element, node);\n      var item = bo.definition.items[idx];\n\n      if (!isMap(item) && !isList(item) && !isScript(item)) {\n        input.value = value;\n      } else {\n        input.value = typeInfo[item.$type].label;\n      }\n    },\n\n    show: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && bo.definition && isList(bo.definition);\n    }\n\n  }));\n\n\n  // parameter value (type = map) ///////////////////////////////////////////////////////\n\n  entries.push(entryFactory.table({\n    id: idPrefix + 'parameterType-map',\n    modelProperties: [ 'key', 'value' ],\n    labels: [ translate('Key'), translate('Value') ],\n    addLabel: translate('Add Entry'),\n\n    getElements: function(element, node) {\n      var bo = getSelected(element, node);\n\n      if (bo && isMap(bo.definition)) {\n        return bo.definition.entries;\n      }\n\n      return [];\n    },\n\n    updateElement: function(element, values, node, idx) {\n      var bo = getSelected(element, node);\n      var entry = bo.definition.entries[idx];\n\n      if (isMap(entry.definition) || isList(entry.definition) || isScript(entry.definition)) {\n        values = {\n          key: values.key\n        };\n      }\n\n      return cmdHelper.updateBusinessObject(element, entry, values);\n    },\n\n    addElement: function(element, node) {\n      var bo = getSelected(element, node);\n      var newEntry = createElement('camunda:Entry', bo.definition, bpmnFactory, { key: undefined, value: undefined });\n      return cmdHelper.addElementsTolist(element, bo.definition, 'entries', [ newEntry ]);\n    },\n\n    removeElement: function(element, node, idx) {\n      var bo = getSelected(element, node);\n      return cmdHelper.removeElementsFromList(element, bo.definition, 'entries', null, [ bo.definition.entries[idx] ]);\n    },\n\n    editable: function(element, node, prop, idx) {\n      var bo = getSelected(element, node);\n      var entry = bo.definition.entries[idx];\n      return prop === 'key' || (!isMap(entry.definition) && !isList(entry.definition) && !isScript(entry.definition));\n    },\n\n    setControlValue: function(element, node, input, prop, value, idx) {\n      var bo = getSelected(element, node);\n      var entry = bo.definition.entries[idx];\n\n      if (prop === 'key' || (!isMap(entry.definition) && !isList(entry.definition) && !isScript(entry.definition))) {\n        input.value = value;\n      } else {\n        input.value = typeInfo[entry.definition.$type].label;\n      }\n    },\n\n    show: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && bo.definition && isMap(bo.definition);\n    }\n\n  }));\n\n  return entries;\n\n};\n","'use strict';\n\nvar inputOutputParameter = require('./implementation/InputOutputParameter');\n\nvar assign = require('lodash/assign');\n\nmodule.exports = function(group, element, bpmnFactory, options, translate) {\n\n  group.entries = group.entries.concat(inputOutputParameter(element, bpmnFactory, assign({}, options), translate));\n\n};\n","var composeArgs = require('./_composeArgs'),\n    composeArgsRight = require('./_composeArgsRight'),\n    replaceHolders = require('./_replaceHolders');\n\n/** Used as the internal argument placeholder. */\nvar PLACEHOLDER = '__lodash_placeholder__';\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_BOUND_FLAG = 4,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_ARY_FLAG = 128,\n    WRAP_REARG_FLAG = 256;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMin = Math.min;\n\n/**\n * Merges the function metadata of `source` into `data`.\n *\n * Merging metadata reduces the number of wrappers used to invoke a function.\n * This is possible because methods like `_.bind`, `_.curry`, and `_.partial`\n * may be applied regardless of execution order. Methods like `_.ary` and\n * `_.rearg` modify function arguments, making the order in which they are\n * executed important, preventing the merging of metadata. However, we make\n * an exception for a safe combined case where curried functions have `_.ary`\n * and or `_.rearg` applied.\n *\n * @private\n * @param {Array} data The destination metadata.\n * @param {Array} source The source metadata.\n * @returns {Array} Returns `data`.\n */\nfunction mergeData(data, source) {\n  var bitmask = data[1],\n      srcBitmask = source[1],\n      newBitmask = bitmask | srcBitmask,\n      isCommon = newBitmask < (WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG | WRAP_ARY_FLAG);\n\n  var isCombo =\n    ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_CURRY_FLAG)) ||\n    ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_REARG_FLAG) && (data[7].length <= source[8])) ||\n    ((srcBitmask == (WRAP_ARY_FLAG | WRAP_REARG_FLAG)) && (source[7].length <= source[8]) && (bitmask == WRAP_CURRY_FLAG));\n\n  // Exit early if metadata can't be merged.\n  if (!(isCommon || isCombo)) {\n    return data;\n  }\n  // Use source `thisArg` if available.\n  if (srcBitmask & WRAP_BIND_FLAG) {\n    data[2] = source[2];\n    // Set when currying a bound function.\n    newBitmask |= bitmask & WRAP_BIND_FLAG ? 0 : WRAP_CURRY_BOUND_FLAG;\n  }\n  // Compose partial arguments.\n  var value = source[3];\n  if (value) {\n    var partials = data[3];\n    data[3] = partials ? composeArgs(partials, value, source[4]) : value;\n    data[4] = partials ? replaceHolders(data[3], PLACEHOLDER) : source[4];\n  }\n  // Compose partial right arguments.\n  value = source[5];\n  if (value) {\n    partials = data[5];\n    data[5] = partials ? composeArgsRight(partials, value, source[6]) : value;\n    data[6] = partials ? replaceHolders(data[5], PLACEHOLDER) : source[6];\n  }\n  // Use source `argPos` if available.\n  value = source[7];\n  if (value) {\n    data[7] = value;\n  }\n  // Use source `ary` if it's smaller.\n  if (srcBitmask & WRAP_ARY_FLAG) {\n    data[8] = data[8] == null ? source[8] : nativeMin(data[8], source[8]);\n  }\n  // Use source `arity` if one is not provided.\n  if (data[9] == null) {\n    data[9] = source[9];\n  }\n  // Use source `func` and merge bitmasks.\n  data[0] = source[0];\n  data[1] = newBitmask;\n\n  return data;\n}\n\nmodule.exports = mergeData;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nmodule.exports = setToArray;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar assign = require('lodash/assign');\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject,\n      hideResultVariable = options.hideResultVariable,\n      id = options.id || 'resultVariable';\n\n\n  var resultVariableEntry = entryFactory.textField({\n    id: id,\n    label: translate('Result Variable'),\n    modelProperty: 'resultVariable',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return { resultVariable: bo.get('camunda:resultVariable') };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n\n      var resultVariable = values.resultVariable || undefined;\n\n      var props = {\n        'camunda:resultVariable': resultVariable\n      };\n\n      if (is(bo, 'camunda:DmnCapable') && !resultVariable) {\n        props = assign({ 'camunda:mapDecisionResult': 'resultList' }, props);\n      }\n\n      return cmdHelper.updateBusinessObject(element, bo, props);\n    },\n\n    hidden: function(element, node) {\n      if (typeof hideResultVariable === 'function') {\n        return hideResultVariable.apply(resultVariableEntry, arguments);\n      }\n    }\n\n  });\n\n  return [ resultVariableEntry ];\n\n};\n","'use strict';\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\n\nmodule.exports = function(group, element, translate) {\n\n  var bo = getBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  if (is(element, 'camunda:Initiator') && !is(element.parent, 'bpmn:SubProcess')) {\n    group.entries.push(entryFactory.textField({\n      id: 'initiator',\n      label: translate('Initiator'),\n      modelProperty: 'initiator'\n    }));\n  }\n};\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","var getAllKeys = require('./_getAllKeys');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(object);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalObjects;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    eventDefinitionHelper = require('../../../helper/EventDefinitionHelper'),\n    error = require('./implementation/ErrorEventDefinition');\n\nvar forEach = require('lodash/forEach');\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var errorEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:EndEvent'\n  ];\n\n  forEach(errorEvents, function(event) {\n    if (is(element, event)) {\n\n      var errorEventDefinition = eventDefinitionHelper.getErrorEventDefinition(element);\n\n      if (errorEventDefinition) {\n        var isCatchingErrorEvent = is(element, 'bpmn:StartEvent') || is (element, 'bpmn:BoundaryEvent');\n\n        var showErrorCodeVariable = isCatchingErrorEvent,\n            showErrorMessageVariable = isCatchingErrorEvent;\n\n        error(\n          group,\n          element,\n          bpmnFactory,\n          errorEventDefinition,\n          showErrorCodeVariable,\n          showErrorMessageVariable,\n          translate);\n      }\n    }\n  });\n};\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var identity = require('./identity'),\n    metaMap = require('./_metaMap');\n\n/**\n * The base implementation of `setData` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to associate metadata with.\n * @param {*} data The metadata.\n * @returns {Function} Returns `func`.\n */\nvar baseSetData = !metaMap ? identity : function(func, data) {\n  metaMap.set(func, data);\n  return func;\n};\n\nmodule.exports = baseSetData;\n","const {\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks that no implicit split is modeled\n * starting from a task.\n *\n * users should model the parallel splitting gateway\n * explicitly instead.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Task',\n      'bpmn:Event'\n    ])) {\n      return;\n    }\n\n    const outgoing = node.outgoing || [];\n\n    const outgoingWithoutCondition = outgoing.filter((flow) => {\n      return !hasCondition(flow) && !isDefaultFlow(node, flow);\n    });\n\n    if (outgoingWithoutCondition.length > 1) {\n      reporter.report(node.id, 'Flow splits implicitly');\n    }\n  }\n\n  return {\n    check\n  };\n\n};\n\n\n// helpers /////////////////////////////\n\nfunction hasCondition(flow) {\n  return !!flow.conditionExpression;\n}\n\nfunction isDefaultFlow(node, flow) {\n  return node['default'] === flow;\n}","var isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nmodule.exports = listCacheGet;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nmodule.exports = DataView;\n","/**\n * Gets the number of `placeholder` occurrences in `array`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} placeholder The placeholder to search for.\n * @returns {number} Returns the placeholder count.\n */\nfunction countHolders(array, placeholder) {\n  var length = array.length,\n      result = 0;\n\n  while (length--) {\n    if (array[length] === placeholder) {\n      ++result;\n    }\n  }\n  return result;\n}\n\nmodule.exports = countHolders;\n","'use strict';\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nmodule.exports = function(group, element, translate) {\n\n  var bo = getBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  if (is(element, 'bpmn:Process') || is(element, 'bpmn:Participant') && bo.get('processRef')) {\n    var versionTagEntry = entryFactory.textField({\n      id: 'versionTag',\n      label: translate('Version Tag'),\n      modelProperty: 'versionTag'\n    });\n\n    // in participants we have to change the default behavior of set and get\n    if (is(element, 'bpmn:Participant')) {\n      versionTagEntry.get = function(element) {\n        var processBo = bo.get('processRef');\n\n        return {\n          versionTag: processBo.get('camunda:versionTag')\n        };\n      };\n\n      versionTagEntry.set = function(element, values) {\n        var processBo = bo.get('processRef');\n\n        return cmdHelper.updateBusinessObject(element, processBo, {\n          'camunda:versionTag': values.versionTag || undefined\n        });\n      };\n    }\n\n    group.entries.push(versionTagEntry);\n\n  }\n};\n","'use strict';\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A component that decides upon the visibility / editable\n * state of properties in the properties panel.\n *\n * Implementors must subclass this component and override\n * {@link PropertiesActivator#isEntryVisible} and\n * {@link PropertiesActivator#isPropertyEditable} to provide\n * custom behavior.\n *\n * @class\n * @constructor\n *\n * @param {EventBus} eventBus\n * @param {Number} [priority] at which priority to hook into the activation\n */\nfunction PropertiesActivator(eventBus, priority) {\n  var self = this;\n\n  priority = priority || DEFAULT_PRIORITY;\n\n  eventBus.on('propertiesPanel.isEntryVisible', priority, function(e) {\n    return self.isEntryVisible(e.entry, e.element);\n  });\n\n  eventBus.on('propertiesPanel.isPropertyEditable', priority, function(e) {\n    return self.isPropertyEditable(e.entry, e.propertyName, e.element);\n  });\n}\n\nPropertiesActivator.$inject = [ 'eventBus' ];\n\nmodule.exports = PropertiesActivator;\n\n\n/**\n * Should the given entry be visible for the specified element.\n *\n * @method  PropertiesActivator#isEntryVisible\n *\n * @param {EntryDescriptor} entry\n * @param {ModdleElement} element\n *\n * @returns {Boolean}\n */\nPropertiesActivator.prototype.isEntryVisible = function(entry, element) {\n  return true;\n};\n\n/**\n * Should the given property be editable for the specified element\n *\n * @method  PropertiesActivator#isPropertyEditable\n *\n * @param {EntryDescriptor} entry\n * @param {String} propertyName\n * @param {ModdleElement} element\n *\n * @returns {Boolean}\n */\nPropertiesActivator.prototype.isPropertyEditable = function(entry, propertyName, element) {\n  return true;\n};","'use strict';\n\nvar properties = require('./implementation/Properties'),\n    elementHelper = require('../../../helper/ElementHelper'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var propertiesEntry = properties(element, bpmnFactory, {\n    id: 'properties',\n    modelProperties: [ 'name', 'value' ],\n    labels: [ translate('Name'), translate('Value') ],\n\n    getParent: function(element, node, bo) {\n      return bo.extensionElements;\n    },\n\n    createParent: function(element, bo) {\n      var parent = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n      var cmd = cmdHelper.updateBusinessObject(element, bo, { extensionElements: parent });\n      return {\n        cmd: cmd,\n        parent: parent\n      };\n    }\n  }, translate);\n\n  if (propertiesEntry) {\n    group.entries.push(propertiesEntry);\n  }\n\n};\n","/** Used to match wrap detail comments. */\nvar reWrapDetails = /\\{\\n\\/\\* \\[wrapped with (.+)\\] \\*/,\n    reSplitDetails = /,? & /;\n\n/**\n * Extracts wrapper details from the `source` body comment.\n *\n * @private\n * @param {string} source The source to inspect.\n * @returns {Array} Returns the wrapper details.\n */\nfunction getWrapDetails(source) {\n  var match = source.match(reWrapDetails);\n  return match ? match[1].split(reSplitDetails) : [];\n}\n\nmodule.exports = getWrapDetails;\n","var baseMatches = require('./_baseMatches'),\n    baseMatchesProperty = require('./_baseMatchesProperty'),\n    identity = require('./identity'),\n    isArray = require('./isArray'),\n    property = require('./property');\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nmodule.exports = baseIteratee;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nmodule.exports = hashGet;\n","/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nmodule.exports = noop;\n","const disallowNodeType = require('./helper').disallowNodeType;\n\nmodule.exports = disallowNodeType('bpmn:ComplexGateway');","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var externalTaskPriorityEntry = entryFactory.textField({\n    id: 'externalTaskPriority',\n    label: translate('Task Priority'),\n    modelProperty: 'taskPriority',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        taskPriority: bo.get('camunda:taskPriority')\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:taskPriority': values.taskPriority || undefined\n      });\n    }\n\n  });\n\n  return [ externalTaskPriorityEntry ];\n\n};\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar domQuery = require('min-dom').query;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar textField = function(options, defaultParameters) {\n\n  // Default action for the button next to the input-field\n  var defaultButtonAction = function(element, inputNode) {\n    var input = domQuery('input[name=\"' + options.modelProperty + '\"]', inputNode);\n    input.value = '';\n\n    return true;\n  };\n\n  // default method to determine if the button should be visible\n  var defaultButtonShow = function(element, inputNode) {\n    var input = domQuery('input[name=\"' + options.modelProperty + '\"]', inputNode);\n\n    return input.value !== '';\n  };\n\n\n  var resource = defaultParameters,\n      label = options.label || resource.id,\n      dataValueLabel = options.dataValueLabel,\n      buttonLabel = (options.buttonLabel || 'X'),\n      actionName = (typeof options.buttonAction != 'undefined') ? options.buttonAction.name : 'clear',\n      actionMethod = (typeof options.buttonAction != 'undefined') ? options.buttonAction.method : defaultButtonAction,\n      showName = (typeof options.buttonShow != 'undefined') ? options.buttonShow.name : 'canClear',\n      showMethod = (typeof options.buttonShow != 'undefined') ? options.buttonShow.method : defaultButtonShow,\n      canBeDisabled = !!options.disabled && typeof options.disabled === 'function',\n      canBeHidden = !!options.hidden && typeof options.hidden === 'function',\n      description = options.description;\n\n  resource.html =\n    '<label for=\"camunda-' + escapeHTML(resource.id) + '\" ' +\n      (canBeDisabled ? 'data-disable=\"isDisabled\" ' : '') +\n      (canBeHidden ? 'data-show=\"isHidden\" ' : '') +\n      (dataValueLabel ? 'data-value=\"' + escapeHTML(dataValueLabel) + '\"' : '') + '>'+ escapeHTML(label) +'</label>' +\n    '<div class=\"bpp-field-wrapper\" ' +\n      (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n      (canBeHidden ? 'data-show=\"isHidden\"' : '') +\n      '>' +\n      '<input id=\"camunda-' + escapeHTML(resource.id) + '\" type=\"text\" name=\"' + escapeHTML(options.modelProperty) + '\" ' +\n        (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n        (canBeHidden ? 'data-show=\"isHidden\"' : '') +\n        ' />' +\n      '<button class=\"' + escapeHTML(actionName) + '\" data-action=\"' + escapeHTML(actionName) + '\" data-show=\"' + escapeHTML(showName) + '\" ' +\n        (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n        (canBeHidden ? ' data-show=\"isHidden\"' : '') + '>' +\n        '<span>' + escapeHTML(buttonLabel) + '</span>' +\n      '</button>' +\n    '</div>';\n\n  // add description below text input entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  resource[actionName] = actionMethod;\n  resource[showName] = showMethod;\n\n  if (canBeDisabled) {\n    resource.isDisabled = function() {\n      return options.disabled.apply(resource, arguments);\n    };\n  }\n\n  if (canBeHidden) {\n    resource.isHidden = function() {\n      return !options.hidden.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['bpp-textfield'];\n\n  return resource;\n};\n\nmodule.exports = textField;\n","'use strict';\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\nvar ModelUtil = require('bpmn-js/lib/util/ModelUtil'),\n    is = ModelUtil.is,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var getValue = function(businessObject) {\n    return function(element) {\n      var documentations = businessObject && businessObject.get('documentation'),\n          text = (documentations && documentations.length > 0) ? documentations[0].text : '';\n\n      return { documentation: text };\n    };\n  };\n\n  var setValue = function(businessObject) {\n    return function(element, values) {\n      var newObjectList = [];\n\n      if (typeof values.documentation !== 'undefined' && values.documentation !== '') {\n        newObjectList.push(bpmnFactory.create('bpmn:Documentation', {\n          text: values.documentation\n        }));\n      }\n\n      return cmdHelper.setList(element, businessObject, 'documentation', newObjectList);\n    };\n  };\n\n  // Element Documentation\n  var elementDocuEntry = entryFactory.textBox({\n    id: 'documentation',\n    label: translate('Element Documentation'),\n    modelProperty: 'documentation'\n  });\n\n  elementDocuEntry.set = setValue(getBusinessObject(element));\n\n  elementDocuEntry.get = getValue(getBusinessObject(element));\n\n  group.entries.push(elementDocuEntry);\n\n\n  var processRef;\n\n  // Process Documentation when having a Collaboration Diagram\n  if (is(element, 'bpmn:Participant')) {\n\n    processRef = getBusinessObject(element).processRef;\n\n    // do not show for collapsed Pools/Participants\n    if (processRef) {\n      var processDocuEntry = entryFactory.textBox({\n        id: 'process-documentation',\n        label: translate('Process Documentation'),\n        modelProperty: 'documentation'\n      });\n\n      processDocuEntry.set = setValue(processRef);\n\n      processDocuEntry.get = getValue(processRef);\n\n      group.entries.push(processDocuEntry);\n    }\n  }\n\n};\n","var baseIsEqualDeep = require('./_baseIsEqualDeep'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nmodule.exports = baseIsEqual;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isEventSubProcess = require('bpmn-js/lib/util/DiUtil').isEventSubProcess;\n\nmodule.exports = function(group, element, bpmnFactory, conditionalEventDefinition, elementRegistry, translate) {\n\n  var getValue = function(modelProperty) {\n    return function(element) {\n      var modelPropertyValue = conditionalEventDefinition.get('camunda:' + modelProperty);\n      var value = {};\n\n      value[modelProperty] = modelPropertyValue;\n      return value;\n    };\n  };\n\n  var setValue = function(modelProperty) {\n    return function(element, values) {\n      var props = {};\n\n      props['camunda:' + modelProperty] = values[modelProperty] || undefined;\n\n      return cmdHelper.updateBusinessObject(element, conditionalEventDefinition, props);\n    };\n  };\n\n  group.entries.push(entryFactory.textField({\n    id: 'variableName',\n    label: translate('Variable Name'),\n    modelProperty : 'variableName',\n\n    get: getValue('variableName'),\n    set: setValue('variableName')\n  }));\n\n  var isConditionalStartEvent =\n    is(element, 'bpmn:StartEvent') && !isEventSubProcess(element.parent);\n\n  if (!isConditionalStartEvent) {\n    group.entries.push(entryFactory.textField({\n      id: 'variableEvent',\n      label: translate('Variable Event'),\n      description: translate('Specify more than one variable change event as a comma separated list.'),\n      modelProperty : 'variableEvent',\n\n      get: getValue('variableEvent'),\n      set: setValue('variableEvent')\n    }));\n  }\n};\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","const {\n  is\n} = require('bpmnlint-utils');\n\n/**\n * Create a checker that disallows the given element type.\n *\n * @param {String} type\n *\n * @return {Function} ruleImpl\n */\nfunction disallowNodeType(type) {\n\n  return function() {\n\n    function check(node, reporter) {\n\n      if (is(node, type)) {\n        reporter.report(node.id, 'Element has disallowed type <' + type + '>');\n      }\n    }\n\n    return {\n      check\n    };\n\n  };\n\n}\n\nmodule.exports.disallowNodeType = disallowNodeType;","'use strict';\n\nvar elementHelper = require('../helper/ElementHelper');\n\n/**\n * A handler capable of creating a new element under a provided parent\n * and updating / creating a reference to it in one atomic action.\n *\n * @class\n * @constructor\n */\nfunction CreateAndReferenceElementHandler(elementRegistry, bpmnFactory) {\n  this._elementRegistry = elementRegistry;\n  this._bpmnFactory = bpmnFactory;\n}\n\nCreateAndReferenceElementHandler.$inject = [ 'elementRegistry', 'bpmnFactory' ];\n\nmodule.exports = CreateAndReferenceElementHandler;\n\n\n// api ////////////////////\n\n/**\n * Creates a new element under a provided parent and updates / creates a reference to it in\n * one atomic action.\n *\n * @method  CreateAndReferenceElementHandler#execute\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element which is the context for the reference\n * @param {moddle.referencingObject} context.referencingObject the object which creates the reference\n * @param {String} context.referenceProperty the property of the referencingObject which makes the reference\n * @param {moddle.newObject} context.newObject the new object to add\n * @param {moddle.newObjectContainer} context.newObjectContainer the container for the new object\n *\n * @returns {Array<djs.mode.Base>} the updated element\n */\nCreateAndReferenceElementHandler.prototype.execute = function(context) {\n\n  var referencingObject = ensureNotNull(context.referencingObject, 'referencingObject'),\n      referenceProperty = ensureNotNull(context.referenceProperty, 'referenceProperty'),\n      newObject = ensureNotNull(context.newObject, 'newObject'),\n      newObjectContainer = ensureNotNull(context.newObjectContainer, 'newObjectContainer'),\n      newObjectParent = ensureNotNull(context.newObjectParent, 'newObjectParent'),\n      changed = [ context.element ]; // this will not change any diagram-js elements\n\n  // create new object\n  var referencedObject = elementHelper\n    .createElement(newObject.type, newObject.properties, newObjectParent, this._bpmnFactory);\n  context.referencedObject = referencedObject;\n\n  // add to containing list\n  newObjectContainer.push(referencedObject);\n\n  // adjust reference attribute\n  context.previousReference = referencingObject[referenceProperty];\n  referencingObject[referenceProperty] = referencedObject;\n\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update\n *\n * @method  CreateAndReferenceElementHandler#revert\n *\n * @param {Object} context\n *\n * @returns {djs.mode.Base} the updated element\n */\nCreateAndReferenceElementHandler.prototype.revert = function(context) {\n\n  var referencingObject = context.referencingObject,\n      referenceProperty = context.referenceProperty,\n      previousReference = context.previousReference,\n      referencedObject = context.referencedObject,\n      newObjectContainer = context.newObjectContainer;\n\n  // reset reference\n  referencingObject.set(referenceProperty, previousReference);\n\n  // remove new element\n  newObjectContainer.splice(newObjectContainer.indexOf(referencedObject), 1);\n\n  return context.changed;\n};\n\n\n\n// helpers //////////////\n\nfunction ensureNotNull(prop, name) {\n  if (!prop) {\n    throw new Error(name + ' required');\n  }\n  return prop;\n}\n","const {\n  is\n} = require('bpmnlint-utils');\n\n/**\n * A rule that checks whether not more than one blank start event\n * exists per scope.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:FlowElementsContainer')) {\n      return;\n    }\n\n    const flowElements = node.flowElements || [];\n\n    const blankStartEvents = flowElements.filter(function(flowElement) {\n\n      if (!is(flowElement, 'bpmn:StartEvent')) {\n        return false;\n      }\n\n      const eventDefinitions = flowElement.eventDefinitions || [];\n\n      return eventDefinitions.length === 0;\n    });\n\n    if (blankStartEvents.length > 1) {\n      const type = is(node, 'bpmn:SubProcess') ? 'Sub process' : 'Process';\n\n      reporter.report(node.id, type + ' has multiple blank start events');\n    }\n  }\n\n  return {\n    check\n  };\n\n};","var baseSetToString = require('./_baseSetToString'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nmodule.exports = setToString;\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=style&index=0&lang=css&\"","var LazyWrapper = require('./_LazyWrapper'),\n    LodashWrapper = require('./_LodashWrapper'),\n    copyArray = require('./_copyArray');\n\n/**\n * Creates a clone of `wrapper`.\n *\n * @private\n * @param {Object} wrapper The wrapper to clone.\n * @returns {Object} Returns the cloned wrapper.\n */\nfunction wrapperClone(wrapper) {\n  if (wrapper instanceof LazyWrapper) {\n    return wrapper.clone();\n  }\n  var result = new LodashWrapper(wrapper.__wrapped__, wrapper.__chain__);\n  result.__actions__ = copyArray(wrapper.__actions__);\n  result.__index__  = wrapper.__index__;\n  result.__values__ = wrapper.__values__;\n  return result;\n}\n\nmodule.exports = wrapperClone;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isAny = require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar filter = require('lodash/filter');\n\nvar extensionElementsHelper = require('../../../helper/ExtensionElementsHelper'),\n    cmdHelper = require('../../../helper/CmdHelper'),\n    elementHelper = require('../../../helper/ElementHelper'),\n    eventDefinitionHelper = require('../../../helper/EventDefinitionHelper');\n\nvar extensionElementsEntry = require('./implementation/ExtensionElements');\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\n/**\n  * return depend on parameter 'type' camunda:in or camunda:out extension elements\n  */\nfunction getCamundaInOutMappings(element, type) {\n  var bo = getBusinessObject(element);\n\n  var signalEventDefinition = eventDefinitionHelper.getSignalEventDefinition(bo);\n\n  return extensionElementsHelper.getExtensionElements(signalEventDefinition || bo, type) || [];\n}\n\n/**\n  * return depend on parameter 'type' camunda:in or camunda:out extension elements\n  * with source or sourceExpression attribute\n  */\nfunction getVariableMappings(element, type) {\n  var camundaMappings = getCamundaInOutMappings(element, type);\n\n  return filter(camundaMappings, function(mapping) {\n    return !mapping.businessKey;\n  });\n}\n\nfunction getInOutType(mapping) {\n  var inOutType = 'source';\n\n  if (mapping.variables === 'all') {\n    inOutType = 'variables';\n  }\n  else if (typeof mapping.source !== 'undefined') {\n    inOutType = 'source';\n  }\n  else if (typeof mapping.sourceExpression !== 'undefined') {\n    inOutType = 'sourceExpression';\n  }\n\n  return inOutType;\n}\n\nvar CAMUNDA_IN_EXTENSION_ELEMENT = 'camunda:In',\n    CAMUNDA_OUT_EXTENSION_ELEMENT = 'camunda:Out';\n\nvar WHITESPACE_REGEX = /\\s/;\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var inOutTypeOptions = [\n    {\n      name: translate('Source'),\n      value: 'source'\n    },\n    {\n      name: translate('Source Expression'),\n      value: 'sourceExpression'\n    },\n    {\n      name: translate('All'),\n      value: 'variables'\n    }\n  ];\n\n  var signalEventDefinition = eventDefinitionHelper.getSignalEventDefinition(element);\n\n  if (!is(element, 'camunda:CallActivity') && !signalEventDefinition) {\n    return;\n  }\n\n  if (signalEventDefinition && !(isAny(element, [\n    'bpmn:IntermediateThrowEvent',\n    'bpmn:EndEvent'\n  ]))) {\n    return;\n  }\n\n  var isSelected = function(element, node) {\n    return !!getSelected(element, node);\n  };\n\n  var getSelected = function(element, node) {\n    var parentNode = node.parentNode;\n    var selection = inEntry.getSelected(element, parentNode);\n\n    var parameter = getVariableMappings(element, CAMUNDA_IN_EXTENSION_ELEMENT)[selection.idx];\n\n    if (!parameter && outEntry) {\n      selection = outEntry.getSelected(element, parentNode);\n      parameter = getVariableMappings(element, CAMUNDA_OUT_EXTENSION_ELEMENT)[selection.idx];\n    }\n\n    return parameter;\n  };\n\n  var setOptionLabelValue = function(type) {\n    return function(element, node, option, property, value, idx) {\n      var variableMappings = getVariableMappings(element, type);\n      var mappingValue = variableMappings[idx];\n      var label = (mappingValue.target || '<undefined>') + ' := ';\n      var mappingType = getInOutType(mappingValue);\n\n      if (mappingType === 'variables') {\n        label = 'all';\n      }\n      else if (mappingType === 'source') {\n        label = label + (mappingValue.source || '<empty>');\n      }\n      else if (mappingType === 'sourceExpression') {\n        label = label + (mappingValue.sourceExpression || '<empty>');\n      } else {\n        label = label + '<empty>';\n      }\n\n      option.text = label;\n    };\n  };\n\n  var newElement = function(type) {\n    return function(element, extensionElements, value) {\n      var newElem = elementHelper.createElement(type, { source: '' }, extensionElements, bpmnFactory);\n\n      return cmdHelper.addElementsTolist(element, extensionElements, 'values', [ newElem ]);\n    };\n  };\n\n  var removeElement = function(type) {\n    return function(element, extensionElements, value, idx) {\n      var variablesMappings= getVariableMappings(element, type);\n      var mapping = variablesMappings[idx];\n\n      if (mapping) {\n        return extensionElementsHelper\n          .removeEntry(signalEventDefinition || getBusinessObject(element), element, mapping);\n      }\n    };\n  };\n\n  // in mapping for source and sourceExpression ///////////////////////////////////////////////////////////////\n\n  var inEntry = extensionElementsEntry(element, bpmnFactory, {\n    id: 'variableMapping-in',\n    label: translate('In Mapping'),\n    modelProperty: 'source',\n    prefix: 'In',\n    idGeneration: false,\n    resizable: true,\n    businessObject: signalEventDefinition || getBusinessObject(element),\n\n    createExtensionElement: newElement(CAMUNDA_IN_EXTENSION_ELEMENT),\n    removeExtensionElement: removeElement(CAMUNDA_IN_EXTENSION_ELEMENT),\n\n    getExtensionElements: function(element) {\n      return getVariableMappings(element, CAMUNDA_IN_EXTENSION_ELEMENT);\n    },\n\n    onSelectionChange: function(element, node, event, scope) {\n      outEntry && outEntry.deselect(element, node.parentNode);\n    },\n\n    setOptionLabelValue: setOptionLabelValue(CAMUNDA_IN_EXTENSION_ELEMENT)\n  });\n  group.entries.push(inEntry);\n\n  // out mapping for source and sourceExpression ///////////////////////////////////////////////////////\n\n  if (!signalEventDefinition) {\n    var outEntry = extensionElementsEntry(element, bpmnFactory, {\n      id: 'variableMapping-out',\n      label: translate('Out Mapping'),\n      modelProperty: 'source',\n      prefix: 'Out',\n      idGeneration: false,\n      resizable: true,\n\n      createExtensionElement: newElement(CAMUNDA_OUT_EXTENSION_ELEMENT),\n      removeExtensionElement: removeElement(CAMUNDA_OUT_EXTENSION_ELEMENT),\n\n      getExtensionElements: function(element) {\n        return getVariableMappings(element, CAMUNDA_OUT_EXTENSION_ELEMENT);\n      },\n\n      onSelectionChange: function(element, node, event, scope) {\n        inEntry.deselect(element, node.parentNode);\n      },\n\n      setOptionLabelValue: setOptionLabelValue(CAMUNDA_OUT_EXTENSION_ELEMENT)\n    });\n    group.entries.push(outEntry);\n  }\n\n  // label for selected mapping ///////////////////////////////////////////////////////\n\n  group.entries.push(entryFactory.label({\n    id: 'variableMapping-typeLabel',\n    get: function(element, node) {\n      var mapping = getSelected(element, node);\n\n      var value = '';\n      if (is(mapping, CAMUNDA_IN_EXTENSION_ELEMENT)) {\n        value = translate('In Mapping');\n      }\n      else if (is(mapping, CAMUNDA_OUT_EXTENSION_ELEMENT)) {\n        value = translate('Out Mapping');\n      }\n\n      return {\n        label: value\n      };\n    },\n\n    showLabel: function(element, node) {\n      return isSelected(element, node);\n    }\n  }));\n\n\n  group.entries.push(entryFactory.selectBox({\n    id: 'variableMapping-inOutType',\n    label: translate('Type'),\n    selectOptions: inOutTypeOptions,\n    modelProperty: 'inOutType',\n    get: function(element, node) {\n      var mapping = getSelected(element, node) || {};\n      return {\n        inOutType: getInOutType(mapping)\n      };\n    },\n    set: function(element, values, node) {\n      var inOutType = values.inOutType;\n\n      var props = {\n        'source' : undefined,\n        'sourceExpression' : undefined,\n        'variables' : undefined\n      };\n\n      if (inOutType === 'source') {\n        props.source = '';\n      }\n      else if (inOutType === 'sourceExpression') {\n        props.sourceExpression = '';\n      }\n      else if (inOutType === 'variables') {\n        props.variables = 'all';\n        props.target = undefined;\n      }\n\n      var mapping = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, mapping, props);\n    },\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n    id: 'variableMapping-source',\n    dataValueLabel: 'sourceLabel',\n    modelProperty: 'source',\n    get: function(element, node) {\n      var mapping = getSelected(element, node) || {};\n\n      var label = '';\n      var inOutType = getInOutType(mapping);\n      if (inOutType === 'source') {\n        label = translate('Source');\n      }\n      else if (inOutType === 'sourceExpression') {\n        label = translate('Source Expression');\n      }\n\n      return {\n        source: mapping[inOutType],\n        sourceLabel: label\n      };\n    },\n    set: function(element, values, node) {\n      values.source = values.source || undefined;\n\n      var mapping = getSelected(element, node);\n      var inOutType = getInOutType(mapping);\n\n      var props = {};\n      props[inOutType] = values.source || '';\n\n      return cmdHelper.updateBusinessObject(element, mapping, props);\n    },\n    // one of both (source or sourceExpression) must have a value to make\n    // the configuration easier and more understandable\n    // it is not engine conform\n    validate: function(element, values, node) {\n      var mapping = getSelected(element, node);\n\n      var validation = {};\n      if (mapping) {\n        if (!values.source) {\n          validation.source =\n          validation.source = values.sourceLabel ?\n            translate('Mapping must have a {value}', { value: values.sourceLabel.toLowerCase() }) :\n            translate('Mapping must have a value');\n        }\n\n        var inOutType = getInOutType(mapping);\n\n        if (WHITESPACE_REGEX.test(values.source) && inOutType !== 'sourceExpression') {\n          validation.source = translate('{label} must not contain whitespace', { label: values.sourceLabel });\n        }\n      }\n\n      return validation;\n    },\n    hidden: function(element, node) {\n      var selectedMapping = getSelected(element, node);\n      return !selectedMapping || (selectedMapping && selectedMapping.variables);\n    }\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n    id: 'variableMapping-target',\n    label: translate('Target'),\n    modelProperty: 'target',\n    get: function(element, node) {\n      return {\n        target: (getSelected(element, node) || {}).target\n      };\n    },\n    set: function(element, values, node) {\n      values.target = values.target || undefined;\n      var mapping = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, mapping, values);\n    },\n    validate: function(element, values, node) {\n      var mapping = getSelected(element, node);\n\n      var validation = {};\n      if (mapping) {\n        var mappingType = getInOutType(mapping);\n\n        if (!values.target && mappingType !== 'variables') {\n          validation.target = translate('Mapping must have a target');\n        }\n\n        if (values.target\n          && WHITESPACE_REGEX.test(values.target)\n          && mappingType !== 'variables') {\n          validation.target = translate('Target must not contain whitespace');\n        }\n      }\n\n      return validation;\n    },\n    hidden: function(element, node) {\n      var selectedMapping = getSelected(element, node);\n      return !selectedMapping || (selectedMapping && selectedMapping.variables);\n    }\n  }));\n\n\n  group.entries.push(entryFactory.checkbox({\n    id: 'variableMapping-local',\n    label: translate('Local'),\n    modelProperty: 'local',\n    get: function(element, node) {\n      return {\n        local: (getSelected(element, node) || {}).local\n      };\n    },\n    set: function(element, values, node) {\n      values.local = values.local || false;\n      var mapping = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, mapping, values);\n    },\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n  }));\n\n};\n","const {\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that verifies that there exists no disconnected\n * flow elements, i.e. elements without incoming\n * _or_ outgoing sequence flows\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Task',\n      'bpmn:Gateway',\n      'bpmn:SubProcess',\n      'bpmn:Event'\n    ]) || node.triggeredByEvent) {\n      return;\n    }\n\n    const incoming = node.incoming || [];\n    const outgoing = node.outgoing || [];\n\n    if (!incoming.length && !outgoing.length) {\n      reporter.report(node.id, 'Element is not connected');\n    }\n  }\n\n  return {\n    check\n  };\n\n};\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nmodule.exports = cacheHas;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nmodule.exports = Set;\n","/*! Hammer.JS - v2.0.7 - 2016-04-22\n * http://hammerjs.github.io/\n *\n * Copyright (c) 2016 Jorik Tangelder;\n * Licensed under the MIT license */\n(function(window, document, exportName, undefined) {\n  'use strict';\n\nvar VENDOR_PREFIXES = ['', 'webkit', 'Moz', 'MS', 'ms', 'o'];\nvar TEST_ELEMENT = document.createElement('div');\n\nvar TYPE_FUNCTION = 'function';\n\nvar round = Math.round;\nvar abs = Math.abs;\nvar now = Date.now;\n\n/**\n * set a timeout with a given scope\n * @param {Function} fn\n * @param {Number} timeout\n * @param {Object} context\n * @returns {number}\n */\nfunction setTimeoutContext(fn, timeout, context) {\n    return setTimeout(bindFn(fn, context), timeout);\n}\n\n/**\n * if the argument is an array, we want to execute the fn on each entry\n * if it aint an array we don't want to do a thing.\n * this is used by all the methods that accept a single and array argument.\n * @param {*|Array} arg\n * @param {String} fn\n * @param {Object} [context]\n * @returns {Boolean}\n */\nfunction invokeArrayArg(arg, fn, context) {\n    if (Array.isArray(arg)) {\n        each(arg, context[fn], context);\n        return true;\n    }\n    return false;\n}\n\n/**\n * walk objects and arrays\n * @param {Object} obj\n * @param {Function} iterator\n * @param {Object} context\n */\nfunction each(obj, iterator, context) {\n    var i;\n\n    if (!obj) {\n        return;\n    }\n\n    if (obj.forEach) {\n        obj.forEach(iterator, context);\n    } else if (obj.length !== undefined) {\n        i = 0;\n        while (i < obj.length) {\n            iterator.call(context, obj[i], i, obj);\n            i++;\n        }\n    } else {\n        for (i in obj) {\n            obj.hasOwnProperty(i) && iterator.call(context, obj[i], i, obj);\n        }\n    }\n}\n\n/**\n * wrap a method with a deprecation warning and stack trace\n * @param {Function} method\n * @param {String} name\n * @param {String} message\n * @returns {Function} A new function wrapping the supplied method.\n */\nfunction deprecate(method, name, message) {\n    var deprecationMessage = 'DEPRECATED METHOD: ' + name + '\\n' + message + ' AT \\n';\n    return function() {\n        var e = new Error('get-stack-trace');\n        var stack = e && e.stack ? e.stack.replace(/^[^\\(]+?[\\n$]/gm, '')\n            .replace(/^\\s+at\\s+/gm, '')\n            .replace(/^Object.<anonymous>\\s*\\(/gm, '{anonymous}()@') : 'Unknown Stack Trace';\n\n        var log = window.console && (window.console.warn || window.console.log);\n        if (log) {\n            log.call(window.console, deprecationMessage, stack);\n        }\n        return method.apply(this, arguments);\n    };\n}\n\n/**\n * extend object.\n * means that properties in dest will be overwritten by the ones in src.\n * @param {Object} target\n * @param {...Object} objects_to_assign\n * @returns {Object} target\n */\nvar assign;\nif (typeof Object.assign !== 'function') {\n    assign = function assign(target) {\n        if (target === undefined || target === null) {\n            throw new TypeError('Cannot convert undefined or null to object');\n        }\n\n        var output = Object(target);\n        for (var index = 1; index < arguments.length; index++) {\n            var source = arguments[index];\n            if (source !== undefined && source !== null) {\n                for (var nextKey in source) {\n                    if (source.hasOwnProperty(nextKey)) {\n                        output[nextKey] = source[nextKey];\n                    }\n                }\n            }\n        }\n        return output;\n    };\n} else {\n    assign = Object.assign;\n}\n\n/**\n * extend object.\n * means that properties in dest will be overwritten by the ones in src.\n * @param {Object} dest\n * @param {Object} src\n * @param {Boolean} [merge=false]\n * @returns {Object} dest\n */\nvar extend = deprecate(function extend(dest, src, merge) {\n    var keys = Object.keys(src);\n    var i = 0;\n    while (i < keys.length) {\n        if (!merge || (merge && dest[keys[i]] === undefined)) {\n            dest[keys[i]] = src[keys[i]];\n        }\n        i++;\n    }\n    return dest;\n}, 'extend', 'Use `assign`.');\n\n/**\n * merge the values from src in the dest.\n * means that properties that exist in dest will not be overwritten by src\n * @param {Object} dest\n * @param {Object} src\n * @returns {Object} dest\n */\nvar merge = deprecate(function merge(dest, src) {\n    return extend(dest, src, true);\n}, 'merge', 'Use `assign`.');\n\n/**\n * simple class inheritance\n * @param {Function} child\n * @param {Function} base\n * @param {Object} [properties]\n */\nfunction inherit(child, base, properties) {\n    var baseP = base.prototype,\n        childP;\n\n    childP = child.prototype = Object.create(baseP);\n    childP.constructor = child;\n    childP._super = baseP;\n\n    if (properties) {\n        assign(childP, properties);\n    }\n}\n\n/**\n * simple function bind\n * @param {Function} fn\n * @param {Object} context\n * @returns {Function}\n */\nfunction bindFn(fn, context) {\n    return function boundFn() {\n        return fn.apply(context, arguments);\n    };\n}\n\n/**\n * let a boolean value also be a function that must return a boolean\n * this first item in args will be used as the context\n * @param {Boolean|Function} val\n * @param {Array} [args]\n * @returns {Boolean}\n */\nfunction boolOrFn(val, args) {\n    if (typeof val == TYPE_FUNCTION) {\n        return val.apply(args ? args[0] || undefined : undefined, args);\n    }\n    return val;\n}\n\n/**\n * use the val2 when val1 is undefined\n * @param {*} val1\n * @param {*} val2\n * @returns {*}\n */\nfunction ifUndefined(val1, val2) {\n    return (val1 === undefined) ? val2 : val1;\n}\n\n/**\n * addEventListener with multiple events at once\n * @param {EventTarget} target\n * @param {String} types\n * @param {Function} handler\n */\nfunction addEventListeners(target, types, handler) {\n    each(splitStr(types), function(type) {\n        target.addEventListener(type, handler, false);\n    });\n}\n\n/**\n * removeEventListener with multiple events at once\n * @param {EventTarget} target\n * @param {String} types\n * @param {Function} handler\n */\nfunction removeEventListeners(target, types, handler) {\n    each(splitStr(types), function(type) {\n        target.removeEventListener(type, handler, false);\n    });\n}\n\n/**\n * find if a node is in the given parent\n * @method hasParent\n * @param {HTMLElement} node\n * @param {HTMLElement} parent\n * @return {Boolean} found\n */\nfunction hasParent(node, parent) {\n    while (node) {\n        if (node == parent) {\n            return true;\n        }\n        node = node.parentNode;\n    }\n    return false;\n}\n\n/**\n * small indexOf wrapper\n * @param {String} str\n * @param {String} find\n * @returns {Boolean} found\n */\nfunction inStr(str, find) {\n    return str.indexOf(find) > -1;\n}\n\n/**\n * split string on whitespace\n * @param {String} str\n * @returns {Array} words\n */\nfunction splitStr(str) {\n    return str.trim().split(/\\s+/g);\n}\n\n/**\n * find if a array contains the object using indexOf or a simple polyFill\n * @param {Array} src\n * @param {String} find\n * @param {String} [findByKey]\n * @return {Boolean|Number} false when not found, or the index\n */\nfunction inArray(src, find, findByKey) {\n    if (src.indexOf && !findByKey) {\n        return src.indexOf(find);\n    } else {\n        var i = 0;\n        while (i < src.length) {\n            if ((findByKey && src[i][findByKey] == find) || (!findByKey && src[i] === find)) {\n                return i;\n            }\n            i++;\n        }\n        return -1;\n    }\n}\n\n/**\n * convert array-like objects to real arrays\n * @param {Object} obj\n * @returns {Array}\n */\nfunction toArray(obj) {\n    return Array.prototype.slice.call(obj, 0);\n}\n\n/**\n * unique array with objects based on a key (like 'id') or just by the array's value\n * @param {Array} src [{id:1},{id:2},{id:1}]\n * @param {String} [key]\n * @param {Boolean} [sort=False]\n * @returns {Array} [{id:1},{id:2}]\n */\nfunction uniqueArray(src, key, sort) {\n    var results = [];\n    var values = [];\n    var i = 0;\n\n    while (i < src.length) {\n        var val = key ? src[i][key] : src[i];\n        if (inArray(values, val) < 0) {\n            results.push(src[i]);\n        }\n        values[i] = val;\n        i++;\n    }\n\n    if (sort) {\n        if (!key) {\n            results = results.sort();\n        } else {\n            results = results.sort(function sortUniqueArray(a, b) {\n                return a[key] > b[key];\n            });\n        }\n    }\n\n    return results;\n}\n\n/**\n * get the prefixed property\n * @param {Object} obj\n * @param {String} property\n * @returns {String|Undefined} prefixed\n */\nfunction prefixed(obj, property) {\n    var prefix, prop;\n    var camelProp = property[0].toUpperCase() + property.slice(1);\n\n    var i = 0;\n    while (i < VENDOR_PREFIXES.length) {\n        prefix = VENDOR_PREFIXES[i];\n        prop = (prefix) ? prefix + camelProp : property;\n\n        if (prop in obj) {\n            return prop;\n        }\n        i++;\n    }\n    return undefined;\n}\n\n/**\n * get a unique id\n * @returns {number} uniqueId\n */\nvar _uniqueId = 1;\nfunction uniqueId() {\n    return _uniqueId++;\n}\n\n/**\n * get the window object of an element\n * @param {HTMLElement} element\n * @returns {DocumentView|Window}\n */\nfunction getWindowForElement(element) {\n    var doc = element.ownerDocument || element;\n    return (doc.defaultView || doc.parentWindow || window);\n}\n\nvar MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i;\n\nvar SUPPORT_TOUCH = ('ontouchstart' in window);\nvar SUPPORT_POINTER_EVENTS = prefixed(window, 'PointerEvent') !== undefined;\nvar SUPPORT_ONLY_TOUCH = SUPPORT_TOUCH && MOBILE_REGEX.test(navigator.userAgent);\n\nvar INPUT_TYPE_TOUCH = 'touch';\nvar INPUT_TYPE_PEN = 'pen';\nvar INPUT_TYPE_MOUSE = 'mouse';\nvar INPUT_TYPE_KINECT = 'kinect';\n\nvar COMPUTE_INTERVAL = 25;\n\nvar INPUT_START = 1;\nvar INPUT_MOVE = 2;\nvar INPUT_END = 4;\nvar INPUT_CANCEL = 8;\n\nvar DIRECTION_NONE = 1;\nvar DIRECTION_LEFT = 2;\nvar DIRECTION_RIGHT = 4;\nvar DIRECTION_UP = 8;\nvar DIRECTION_DOWN = 16;\n\nvar DIRECTION_HORIZONTAL = DIRECTION_LEFT | DIRECTION_RIGHT;\nvar DIRECTION_VERTICAL = DIRECTION_UP | DIRECTION_DOWN;\nvar DIRECTION_ALL = DIRECTION_HORIZONTAL | DIRECTION_VERTICAL;\n\nvar PROPS_XY = ['x', 'y'];\nvar PROPS_CLIENT_XY = ['clientX', 'clientY'];\n\n/**\n * create new input type manager\n * @param {Manager} manager\n * @param {Function} callback\n * @returns {Input}\n * @constructor\n */\nfunction Input(manager, callback) {\n    var self = this;\n    this.manager = manager;\n    this.callback = callback;\n    this.element = manager.element;\n    this.target = manager.options.inputTarget;\n\n    // smaller wrapper around the handler, for the scope and the enabled state of the manager,\n    // so when disabled the input events are completely bypassed.\n    this.domHandler = function(ev) {\n        if (boolOrFn(manager.options.enable, [manager])) {\n            self.handler(ev);\n        }\n    };\n\n    this.init();\n\n}\n\nInput.prototype = {\n    /**\n     * should handle the inputEvent data and trigger the callback\n     * @virtual\n     */\n    handler: function() { },\n\n    /**\n     * bind the events\n     */\n    init: function() {\n        this.evEl && addEventListeners(this.element, this.evEl, this.domHandler);\n        this.evTarget && addEventListeners(this.target, this.evTarget, this.domHandler);\n        this.evWin && addEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    },\n\n    /**\n     * unbind the events\n     */\n    destroy: function() {\n        this.evEl && removeEventListeners(this.element, this.evEl, this.domHandler);\n        this.evTarget && removeEventListeners(this.target, this.evTarget, this.domHandler);\n        this.evWin && removeEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    }\n};\n\n/**\n * create new input type manager\n * called by the Manager constructor\n * @param {Hammer} manager\n * @returns {Input}\n */\nfunction createInputInstance(manager) {\n    var Type;\n    var inputClass = manager.options.inputClass;\n\n    if (inputClass) {\n        Type = inputClass;\n    } else if (SUPPORT_POINTER_EVENTS) {\n        Type = PointerEventInput;\n    } else if (SUPPORT_ONLY_TOUCH) {\n        Type = TouchInput;\n    } else if (!SUPPORT_TOUCH) {\n        Type = MouseInput;\n    } else {\n        Type = TouchMouseInput;\n    }\n    return new (Type)(manager, inputHandler);\n}\n\n/**\n * handle input events\n * @param {Manager} manager\n * @param {String} eventType\n * @param {Object} input\n */\nfunction inputHandler(manager, eventType, input) {\n    var pointersLen = input.pointers.length;\n    var changedPointersLen = input.changedPointers.length;\n    var isFirst = (eventType & INPUT_START && (pointersLen - changedPointersLen === 0));\n    var isFinal = (eventType & (INPUT_END | INPUT_CANCEL) && (pointersLen - changedPointersLen === 0));\n\n    input.isFirst = !!isFirst;\n    input.isFinal = !!isFinal;\n\n    if (isFirst) {\n        manager.session = {};\n    }\n\n    // source event is the normalized value of the domEvents\n    // like 'touchstart, mouseup, pointerdown'\n    input.eventType = eventType;\n\n    // compute scale, rotation etc\n    computeInputData(manager, input);\n\n    // emit secret event\n    manager.emit('hammer.input', input);\n\n    manager.recognize(input);\n    manager.session.prevInput = input;\n}\n\n/**\n * extend the data with some usable properties like scale, rotate, velocity etc\n * @param {Object} manager\n * @param {Object} input\n */\nfunction computeInputData(manager, input) {\n    var session = manager.session;\n    var pointers = input.pointers;\n    var pointersLength = pointers.length;\n\n    // store the first input to calculate the distance and direction\n    if (!session.firstInput) {\n        session.firstInput = simpleCloneInputData(input);\n    }\n\n    // to compute scale and rotation we need to store the multiple touches\n    if (pointersLength > 1 && !session.firstMultiple) {\n        session.firstMultiple = simpleCloneInputData(input);\n    } else if (pointersLength === 1) {\n        session.firstMultiple = false;\n    }\n\n    var firstInput = session.firstInput;\n    var firstMultiple = session.firstMultiple;\n    var offsetCenter = firstMultiple ? firstMultiple.center : firstInput.center;\n\n    var center = input.center = getCenter(pointers);\n    input.timeStamp = now();\n    input.deltaTime = input.timeStamp - firstInput.timeStamp;\n\n    input.angle = getAngle(offsetCenter, center);\n    input.distance = getDistance(offsetCenter, center);\n\n    computeDeltaXY(session, input);\n    input.offsetDirection = getDirection(input.deltaX, input.deltaY);\n\n    var overallVelocity = getVelocity(input.deltaTime, input.deltaX, input.deltaY);\n    input.overallVelocityX = overallVelocity.x;\n    input.overallVelocityY = overallVelocity.y;\n    input.overallVelocity = (abs(overallVelocity.x) > abs(overallVelocity.y)) ? overallVelocity.x : overallVelocity.y;\n\n    input.scale = firstMultiple ? getScale(firstMultiple.pointers, pointers) : 1;\n    input.rotation = firstMultiple ? getRotation(firstMultiple.pointers, pointers) : 0;\n\n    input.maxPointers = !session.prevInput ? input.pointers.length : ((input.pointers.length >\n        session.prevInput.maxPointers) ? input.pointers.length : session.prevInput.maxPointers);\n\n    computeIntervalInputData(session, input);\n\n    // find the correct target\n    var target = manager.element;\n    if (hasParent(input.srcEvent.target, target)) {\n        target = input.srcEvent.target;\n    }\n    input.target = target;\n}\n\nfunction computeDeltaXY(session, input) {\n    var center = input.center;\n    var offset = session.offsetDelta || {};\n    var prevDelta = session.prevDelta || {};\n    var prevInput = session.prevInput || {};\n\n    if (input.eventType === INPUT_START || prevInput.eventType === INPUT_END) {\n        prevDelta = session.prevDelta = {\n            x: prevInput.deltaX || 0,\n            y: prevInput.deltaY || 0\n        };\n\n        offset = session.offsetDelta = {\n            x: center.x,\n            y: center.y\n        };\n    }\n\n    input.deltaX = prevDelta.x + (center.x - offset.x);\n    input.deltaY = prevDelta.y + (center.y - offset.y);\n}\n\n/**\n * velocity is calculated every x ms\n * @param {Object} session\n * @param {Object} input\n */\nfunction computeIntervalInputData(session, input) {\n    var last = session.lastInterval || input,\n        deltaTime = input.timeStamp - last.timeStamp,\n        velocity, velocityX, velocityY, direction;\n\n    if (input.eventType != INPUT_CANCEL && (deltaTime > COMPUTE_INTERVAL || last.velocity === undefined)) {\n        var deltaX = input.deltaX - last.deltaX;\n        var deltaY = input.deltaY - last.deltaY;\n\n        var v = getVelocity(deltaTime, deltaX, deltaY);\n        velocityX = v.x;\n        velocityY = v.y;\n        velocity = (abs(v.x) > abs(v.y)) ? v.x : v.y;\n        direction = getDirection(deltaX, deltaY);\n\n        session.lastInterval = input;\n    } else {\n        // use latest velocity info if it doesn't overtake a minimum period\n        velocity = last.velocity;\n        velocityX = last.velocityX;\n        velocityY = last.velocityY;\n        direction = last.direction;\n    }\n\n    input.velocity = velocity;\n    input.velocityX = velocityX;\n    input.velocityY = velocityY;\n    input.direction = direction;\n}\n\n/**\n * create a simple clone from the input used for storage of firstInput and firstMultiple\n * @param {Object} input\n * @returns {Object} clonedInputData\n */\nfunction simpleCloneInputData(input) {\n    // make a simple copy of the pointers because we will get a reference if we don't\n    // we only need clientXY for the calculations\n    var pointers = [];\n    var i = 0;\n    while (i < input.pointers.length) {\n        pointers[i] = {\n            clientX: round(input.pointers[i].clientX),\n            clientY: round(input.pointers[i].clientY)\n        };\n        i++;\n    }\n\n    return {\n        timeStamp: now(),\n        pointers: pointers,\n        center: getCenter(pointers),\n        deltaX: input.deltaX,\n        deltaY: input.deltaY\n    };\n}\n\n/**\n * get the center of all the pointers\n * @param {Array} pointers\n * @return {Object} center contains `x` and `y` properties\n */\nfunction getCenter(pointers) {\n    var pointersLength = pointers.length;\n\n    // no need to loop when only one touch\n    if (pointersLength === 1) {\n        return {\n            x: round(pointers[0].clientX),\n            y: round(pointers[0].clientY)\n        };\n    }\n\n    var x = 0, y = 0, i = 0;\n    while (i < pointersLength) {\n        x += pointers[i].clientX;\n        y += pointers[i].clientY;\n        i++;\n    }\n\n    return {\n        x: round(x / pointersLength),\n        y: round(y / pointersLength)\n    };\n}\n\n/**\n * calculate the velocity between two points. unit is in px per ms.\n * @param {Number} deltaTime\n * @param {Number} x\n * @param {Number} y\n * @return {Object} velocity `x` and `y`\n */\nfunction getVelocity(deltaTime, x, y) {\n    return {\n        x: x / deltaTime || 0,\n        y: y / deltaTime || 0\n    };\n}\n\n/**\n * get the direction between two points\n * @param {Number} x\n * @param {Number} y\n * @return {Number} direction\n */\nfunction getDirection(x, y) {\n    if (x === y) {\n        return DIRECTION_NONE;\n    }\n\n    if (abs(x) >= abs(y)) {\n        return x < 0 ? DIRECTION_LEFT : DIRECTION_RIGHT;\n    }\n    return y < 0 ? DIRECTION_UP : DIRECTION_DOWN;\n}\n\n/**\n * calculate the absolute distance between two points\n * @param {Object} p1 {x, y}\n * @param {Object} p2 {x, y}\n * @param {Array} [props] containing x and y keys\n * @return {Number} distance\n */\nfunction getDistance(p1, p2, props) {\n    if (!props) {\n        props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n        y = p2[props[1]] - p1[props[1]];\n\n    return Math.sqrt((x * x) + (y * y));\n}\n\n/**\n * calculate the angle between two coordinates\n * @param {Object} p1\n * @param {Object} p2\n * @param {Array} [props] containing x and y keys\n * @return {Number} angle\n */\nfunction getAngle(p1, p2, props) {\n    if (!props) {\n        props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n        y = p2[props[1]] - p1[props[1]];\n    return Math.atan2(y, x) * 180 / Math.PI;\n}\n\n/**\n * calculate the rotation degrees between two pointersets\n * @param {Array} start array of pointers\n * @param {Array} end array of pointers\n * @return {Number} rotation\n */\nfunction getRotation(start, end) {\n    return getAngle(end[1], end[0], PROPS_CLIENT_XY) + getAngle(start[1], start[0], PROPS_CLIENT_XY);\n}\n\n/**\n * calculate the scale factor between two pointersets\n * no scale is 1, and goes down to 0 when pinched together, and bigger when pinched out\n * @param {Array} start array of pointers\n * @param {Array} end array of pointers\n * @return {Number} scale\n */\nfunction getScale(start, end) {\n    return getDistance(end[0], end[1], PROPS_CLIENT_XY) / getDistance(start[0], start[1], PROPS_CLIENT_XY);\n}\n\nvar MOUSE_INPUT_MAP = {\n    mousedown: INPUT_START,\n    mousemove: INPUT_MOVE,\n    mouseup: INPUT_END\n};\n\nvar MOUSE_ELEMENT_EVENTS = 'mousedown';\nvar MOUSE_WINDOW_EVENTS = 'mousemove mouseup';\n\n/**\n * Mouse events input\n * @constructor\n * @extends Input\n */\nfunction MouseInput() {\n    this.evEl = MOUSE_ELEMENT_EVENTS;\n    this.evWin = MOUSE_WINDOW_EVENTS;\n\n    this.pressed = false; // mousedown state\n\n    Input.apply(this, arguments);\n}\n\ninherit(MouseInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function MEhandler(ev) {\n        var eventType = MOUSE_INPUT_MAP[ev.type];\n\n        // on start we want to have the left mouse button down\n        if (eventType & INPUT_START && ev.button === 0) {\n            this.pressed = true;\n        }\n\n        if (eventType & INPUT_MOVE && ev.which !== 1) {\n            eventType = INPUT_END;\n        }\n\n        // mouse must be down\n        if (!this.pressed) {\n            return;\n        }\n\n        if (eventType & INPUT_END) {\n            this.pressed = false;\n        }\n\n        this.callback(this.manager, eventType, {\n            pointers: [ev],\n            changedPointers: [ev],\n            pointerType: INPUT_TYPE_MOUSE,\n            srcEvent: ev\n        });\n    }\n});\n\nvar POINTER_INPUT_MAP = {\n    pointerdown: INPUT_START,\n    pointermove: INPUT_MOVE,\n    pointerup: INPUT_END,\n    pointercancel: INPUT_CANCEL,\n    pointerout: INPUT_CANCEL\n};\n\n// in IE10 the pointer types is defined as an enum\nvar IE10_POINTER_TYPE_ENUM = {\n    2: INPUT_TYPE_TOUCH,\n    3: INPUT_TYPE_PEN,\n    4: INPUT_TYPE_MOUSE,\n    5: INPUT_TYPE_KINECT // see https://twitter.com/jacobrossi/status/480596438489890816\n};\n\nvar POINTER_ELEMENT_EVENTS = 'pointerdown';\nvar POINTER_WINDOW_EVENTS = 'pointermove pointerup pointercancel';\n\n// IE10 has prefixed support, and case-sensitive\nif (window.MSPointerEvent && !window.PointerEvent) {\n    POINTER_ELEMENT_EVENTS = 'MSPointerDown';\n    POINTER_WINDOW_EVENTS = 'MSPointerMove MSPointerUp MSPointerCancel';\n}\n\n/**\n * Pointer events input\n * @constructor\n * @extends Input\n */\nfunction PointerEventInput() {\n    this.evEl = POINTER_ELEMENT_EVENTS;\n    this.evWin = POINTER_WINDOW_EVENTS;\n\n    Input.apply(this, arguments);\n\n    this.store = (this.manager.session.pointerEvents = []);\n}\n\ninherit(PointerEventInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function PEhandler(ev) {\n        var store = this.store;\n        var removePointer = false;\n\n        var eventTypeNormalized = ev.type.toLowerCase().replace('ms', '');\n        var eventType = POINTER_INPUT_MAP[eventTypeNormalized];\n        var pointerType = IE10_POINTER_TYPE_ENUM[ev.pointerType] || ev.pointerType;\n\n        var isTouch = (pointerType == INPUT_TYPE_TOUCH);\n\n        // get index of the event in the store\n        var storeIndex = inArray(store, ev.pointerId, 'pointerId');\n\n        // start and mouse must be down\n        if (eventType & INPUT_START && (ev.button === 0 || isTouch)) {\n            if (storeIndex < 0) {\n                store.push(ev);\n                storeIndex = store.length - 1;\n            }\n        } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n            removePointer = true;\n        }\n\n        // it not found, so the pointer hasn't been down (so it's probably a hover)\n        if (storeIndex < 0) {\n            return;\n        }\n\n        // update the event in the store\n        store[storeIndex] = ev;\n\n        this.callback(this.manager, eventType, {\n            pointers: store,\n            changedPointers: [ev],\n            pointerType: pointerType,\n            srcEvent: ev\n        });\n\n        if (removePointer) {\n            // remove from the store\n            store.splice(storeIndex, 1);\n        }\n    }\n});\n\nvar SINGLE_TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n};\n\nvar SINGLE_TOUCH_TARGET_EVENTS = 'touchstart';\nvar SINGLE_TOUCH_WINDOW_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n/**\n * Touch events input\n * @constructor\n * @extends Input\n */\nfunction SingleTouchInput() {\n    this.evTarget = SINGLE_TOUCH_TARGET_EVENTS;\n    this.evWin = SINGLE_TOUCH_WINDOW_EVENTS;\n    this.started = false;\n\n    Input.apply(this, arguments);\n}\n\ninherit(SingleTouchInput, Input, {\n    handler: function TEhandler(ev) {\n        var type = SINGLE_TOUCH_INPUT_MAP[ev.type];\n\n        // should we handle the touch events?\n        if (type === INPUT_START) {\n            this.started = true;\n        }\n\n        if (!this.started) {\n            return;\n        }\n\n        var touches = normalizeSingleTouches.call(this, ev, type);\n\n        // when done, reset the started state\n        if (type & (INPUT_END | INPUT_CANCEL) && touches[0].length - touches[1].length === 0) {\n            this.started = false;\n        }\n\n        this.callback(this.manager, type, {\n            pointers: touches[0],\n            changedPointers: touches[1],\n            pointerType: INPUT_TYPE_TOUCH,\n            srcEvent: ev\n        });\n    }\n});\n\n/**\n * @this {TouchInput}\n * @param {Object} ev\n * @param {Number} type flag\n * @returns {undefined|Array} [all, changed]\n */\nfunction normalizeSingleTouches(ev, type) {\n    var all = toArray(ev.touches);\n    var changed = toArray(ev.changedTouches);\n\n    if (type & (INPUT_END | INPUT_CANCEL)) {\n        all = uniqueArray(all.concat(changed), 'identifier', true);\n    }\n\n    return [all, changed];\n}\n\nvar TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n};\n\nvar TOUCH_TARGET_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n/**\n * Multi-user touch events input\n * @constructor\n * @extends Input\n */\nfunction TouchInput() {\n    this.evTarget = TOUCH_TARGET_EVENTS;\n    this.targetIds = {};\n\n    Input.apply(this, arguments);\n}\n\ninherit(TouchInput, Input, {\n    handler: function MTEhandler(ev) {\n        var type = TOUCH_INPUT_MAP[ev.type];\n        var touches = getTouches.call(this, ev, type);\n        if (!touches) {\n            return;\n        }\n\n        this.callback(this.manager, type, {\n            pointers: touches[0],\n            changedPointers: touches[1],\n            pointerType: INPUT_TYPE_TOUCH,\n            srcEvent: ev\n        });\n    }\n});\n\n/**\n * @this {TouchInput}\n * @param {Object} ev\n * @param {Number} type flag\n * @returns {undefined|Array} [all, changed]\n */\nfunction getTouches(ev, type) {\n    var allTouches = toArray(ev.touches);\n    var targetIds = this.targetIds;\n\n    // when there is only one touch, the process can be simplified\n    if (type & (INPUT_START | INPUT_MOVE) && allTouches.length === 1) {\n        targetIds[allTouches[0].identifier] = true;\n        return [allTouches, allTouches];\n    }\n\n    var i,\n        targetTouches,\n        changedTouches = toArray(ev.changedTouches),\n        changedTargetTouches = [],\n        target = this.target;\n\n    // get target touches from touches\n    targetTouches = allTouches.filter(function(touch) {\n        return hasParent(touch.target, target);\n    });\n\n    // collect touches\n    if (type === INPUT_START) {\n        i = 0;\n        while (i < targetTouches.length) {\n            targetIds[targetTouches[i].identifier] = true;\n            i++;\n        }\n    }\n\n    // filter changed touches to only contain touches that exist in the collected target ids\n    i = 0;\n    while (i < changedTouches.length) {\n        if (targetIds[changedTouches[i].identifier]) {\n            changedTargetTouches.push(changedTouches[i]);\n        }\n\n        // cleanup removed touches\n        if (type & (INPUT_END | INPUT_CANCEL)) {\n            delete targetIds[changedTouches[i].identifier];\n        }\n        i++;\n    }\n\n    if (!changedTargetTouches.length) {\n        return;\n    }\n\n    return [\n        // merge targetTouches with changedTargetTouches so it contains ALL touches, including 'end' and 'cancel'\n        uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier', true),\n        changedTargetTouches\n    ];\n}\n\n/**\n * Combined touch and mouse input\n *\n * Touch has a higher priority then mouse, and while touching no mouse events are allowed.\n * This because touch devices also emit mouse events while doing a touch.\n *\n * @constructor\n * @extends Input\n */\n\nvar DEDUP_TIMEOUT = 2500;\nvar DEDUP_DISTANCE = 25;\n\nfunction TouchMouseInput() {\n    Input.apply(this, arguments);\n\n    var handler = bindFn(this.handler, this);\n    this.touch = new TouchInput(this.manager, handler);\n    this.mouse = new MouseInput(this.manager, handler);\n\n    this.primaryTouch = null;\n    this.lastTouches = [];\n}\n\ninherit(TouchMouseInput, Input, {\n    /**\n     * handle mouse and touch events\n     * @param {Hammer} manager\n     * @param {String} inputEvent\n     * @param {Object} inputData\n     */\n    handler: function TMEhandler(manager, inputEvent, inputData) {\n        var isTouch = (inputData.pointerType == INPUT_TYPE_TOUCH),\n            isMouse = (inputData.pointerType == INPUT_TYPE_MOUSE);\n\n        if (isMouse && inputData.sourceCapabilities && inputData.sourceCapabilities.firesTouchEvents) {\n            return;\n        }\n\n        // when we're in a touch event, record touches to  de-dupe synthetic mouse event\n        if (isTouch) {\n            recordTouches.call(this, inputEvent, inputData);\n        } else if (isMouse && isSyntheticEvent.call(this, inputData)) {\n            return;\n        }\n\n        this.callback(manager, inputEvent, inputData);\n    },\n\n    /**\n     * remove the event listeners\n     */\n    destroy: function destroy() {\n        this.touch.destroy();\n        this.mouse.destroy();\n    }\n});\n\nfunction recordTouches(eventType, eventData) {\n    if (eventType & INPUT_START) {\n        this.primaryTouch = eventData.changedPointers[0].identifier;\n        setLastTouch.call(this, eventData);\n    } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n        setLastTouch.call(this, eventData);\n    }\n}\n\nfunction setLastTouch(eventData) {\n    var touch = eventData.changedPointers[0];\n\n    if (touch.identifier === this.primaryTouch) {\n        var lastTouch = {x: touch.clientX, y: touch.clientY};\n        this.lastTouches.push(lastTouch);\n        var lts = this.lastTouches;\n        var removeLastTouch = function() {\n            var i = lts.indexOf(lastTouch);\n            if (i > -1) {\n                lts.splice(i, 1);\n            }\n        };\n        setTimeout(removeLastTouch, DEDUP_TIMEOUT);\n    }\n}\n\nfunction isSyntheticEvent(eventData) {\n    var x = eventData.srcEvent.clientX, y = eventData.srcEvent.clientY;\n    for (var i = 0; i < this.lastTouches.length; i++) {\n        var t = this.lastTouches[i];\n        var dx = Math.abs(x - t.x), dy = Math.abs(y - t.y);\n        if (dx <= DEDUP_DISTANCE && dy <= DEDUP_DISTANCE) {\n            return true;\n        }\n    }\n    return false;\n}\n\nvar PREFIXED_TOUCH_ACTION = prefixed(TEST_ELEMENT.style, 'touchAction');\nvar NATIVE_TOUCH_ACTION = PREFIXED_TOUCH_ACTION !== undefined;\n\n// magical touchAction value\nvar TOUCH_ACTION_COMPUTE = 'compute';\nvar TOUCH_ACTION_AUTO = 'auto';\nvar TOUCH_ACTION_MANIPULATION = 'manipulation'; // not implemented\nvar TOUCH_ACTION_NONE = 'none';\nvar TOUCH_ACTION_PAN_X = 'pan-x';\nvar TOUCH_ACTION_PAN_Y = 'pan-y';\nvar TOUCH_ACTION_MAP = getTouchActionProps();\n\n/**\n * Touch Action\n * sets the touchAction property or uses the js alternative\n * @param {Manager} manager\n * @param {String} value\n * @constructor\n */\nfunction TouchAction(manager, value) {\n    this.manager = manager;\n    this.set(value);\n}\n\nTouchAction.prototype = {\n    /**\n     * set the touchAction value on the element or enable the polyfill\n     * @param {String} value\n     */\n    set: function(value) {\n        // find out the touch-action by the event handlers\n        if (value == TOUCH_ACTION_COMPUTE) {\n            value = this.compute();\n        }\n\n        if (NATIVE_TOUCH_ACTION && this.manager.element.style && TOUCH_ACTION_MAP[value]) {\n            this.manager.element.style[PREFIXED_TOUCH_ACTION] = value;\n        }\n        this.actions = value.toLowerCase().trim();\n    },\n\n    /**\n     * just re-set the touchAction value\n     */\n    update: function() {\n        this.set(this.manager.options.touchAction);\n    },\n\n    /**\n     * compute the value for the touchAction property based on the recognizer's settings\n     * @returns {String} value\n     */\n    compute: function() {\n        var actions = [];\n        each(this.manager.recognizers, function(recognizer) {\n            if (boolOrFn(recognizer.options.enable, [recognizer])) {\n                actions = actions.concat(recognizer.getTouchAction());\n            }\n        });\n        return cleanTouchActions(actions.join(' '));\n    },\n\n    /**\n     * this method is called on each input cycle and provides the preventing of the browser behavior\n     * @param {Object} input\n     */\n    preventDefaults: function(input) {\n        var srcEvent = input.srcEvent;\n        var direction = input.offsetDirection;\n\n        // if the touch action did prevented once this session\n        if (this.manager.session.prevented) {\n            srcEvent.preventDefault();\n            return;\n        }\n\n        var actions = this.actions;\n        var hasNone = inStr(actions, TOUCH_ACTION_NONE) && !TOUCH_ACTION_MAP[TOUCH_ACTION_NONE];\n        var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y];\n        var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];\n\n        if (hasNone) {\n            //do not prevent defaults if this is a tap gesture\n\n            var isTapPointer = input.pointers.length === 1;\n            var isTapMovement = input.distance < 2;\n            var isTapTouchTime = input.deltaTime < 250;\n\n            if (isTapPointer && isTapMovement && isTapTouchTime) {\n                return;\n            }\n        }\n\n        if (hasPanX && hasPanY) {\n            // `pan-x pan-y` means browser handles all scrolling/panning, do not prevent\n            return;\n        }\n\n        if (hasNone ||\n            (hasPanY && direction & DIRECTION_HORIZONTAL) ||\n            (hasPanX && direction & DIRECTION_VERTICAL)) {\n            return this.preventSrc(srcEvent);\n        }\n    },\n\n    /**\n     * call preventDefault to prevent the browser's default behavior (scrolling in most cases)\n     * @param {Object} srcEvent\n     */\n    preventSrc: function(srcEvent) {\n        this.manager.session.prevented = true;\n        srcEvent.preventDefault();\n    }\n};\n\n/**\n * when the touchActions are collected they are not a valid value, so we need to clean things up. *\n * @param {String} actions\n * @returns {*}\n */\nfunction cleanTouchActions(actions) {\n    // none\n    if (inStr(actions, TOUCH_ACTION_NONE)) {\n        return TOUCH_ACTION_NONE;\n    }\n\n    var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X);\n    var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y);\n\n    // if both pan-x and pan-y are set (different recognizers\n    // for different directions, e.g. horizontal pan but vertical swipe?)\n    // we need none (as otherwise with pan-x pan-y combined none of these\n    // recognizers will work, since the browser would handle all panning\n    if (hasPanX && hasPanY) {\n        return TOUCH_ACTION_NONE;\n    }\n\n    // pan-x OR pan-y\n    if (hasPanX || hasPanY) {\n        return hasPanX ? TOUCH_ACTION_PAN_X : TOUCH_ACTION_PAN_Y;\n    }\n\n    // manipulation\n    if (inStr(actions, TOUCH_ACTION_MANIPULATION)) {\n        return TOUCH_ACTION_MANIPULATION;\n    }\n\n    return TOUCH_ACTION_AUTO;\n}\n\nfunction getTouchActionProps() {\n    if (!NATIVE_TOUCH_ACTION) {\n        return false;\n    }\n    var touchMap = {};\n    var cssSupports = window.CSS && window.CSS.supports;\n    ['auto', 'manipulation', 'pan-y', 'pan-x', 'pan-x pan-y', 'none'].forEach(function(val) {\n\n        // If css.supports is not supported but there is native touch-action assume it supports\n        // all values. This is the case for IE 10 and 11.\n        touchMap[val] = cssSupports ? window.CSS.supports('touch-action', val) : true;\n    });\n    return touchMap;\n}\n\n/**\n * Recognizer flow explained; *\n * All recognizers have the initial state of POSSIBLE when a input session starts.\n * The definition of a input session is from the first input until the last input, with all it's movement in it. *\n * Example session for mouse-input: mousedown -> mousemove -> mouseup\n *\n * On each recognizing cycle (see Manager.recognize) the .recognize() method is executed\n * which determines with state it should be.\n *\n * If the recognizer has the state FAILED, CANCELLED or RECOGNIZED (equals ENDED), it is reset to\n * POSSIBLE to give it another change on the next cycle.\n *\n *               Possible\n *                  |\n *            +-----+---------------+\n *            |                     |\n *      +-----+-----+               |\n *      |           |               |\n *   Failed      Cancelled          |\n *                          +-------+------+\n *                          |              |\n *                      Recognized       Began\n *                                         |\n *                                      Changed\n *                                         |\n *                                  Ended/Recognized\n */\nvar STATE_POSSIBLE = 1;\nvar STATE_BEGAN = 2;\nvar STATE_CHANGED = 4;\nvar STATE_ENDED = 8;\nvar STATE_RECOGNIZED = STATE_ENDED;\nvar STATE_CANCELLED = 16;\nvar STATE_FAILED = 32;\n\n/**\n * Recognizer\n * Every recognizer needs to extend from this class.\n * @constructor\n * @param {Object} options\n */\nfunction Recognizer(options) {\n    this.options = assign({}, this.defaults, options || {});\n\n    this.id = uniqueId();\n\n    this.manager = null;\n\n    // default is enable true\n    this.options.enable = ifUndefined(this.options.enable, true);\n\n    this.state = STATE_POSSIBLE;\n\n    this.simultaneous = {};\n    this.requireFail = [];\n}\n\nRecognizer.prototype = {\n    /**\n     * @virtual\n     * @type {Object}\n     */\n    defaults: {},\n\n    /**\n     * set options\n     * @param {Object} options\n     * @return {Recognizer}\n     */\n    set: function(options) {\n        assign(this.options, options);\n\n        // also update the touchAction, in case something changed about the directions/enabled state\n        this.manager && this.manager.touchAction.update();\n        return this;\n    },\n\n    /**\n     * recognize simultaneous with an other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    recognizeWith: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'recognizeWith', this)) {\n            return this;\n        }\n\n        var simultaneous = this.simultaneous;\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        if (!simultaneous[otherRecognizer.id]) {\n            simultaneous[otherRecognizer.id] = otherRecognizer;\n            otherRecognizer.recognizeWith(this);\n        }\n        return this;\n    },\n\n    /**\n     * drop the simultaneous link. it doesnt remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRecognizeWith: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'dropRecognizeWith', this)) {\n            return this;\n        }\n\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        delete this.simultaneous[otherRecognizer.id];\n        return this;\n    },\n\n    /**\n     * recognizer can only run when an other is failing\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    requireFailure: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'requireFailure', this)) {\n            return this;\n        }\n\n        var requireFail = this.requireFail;\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        if (inArray(requireFail, otherRecognizer) === -1) {\n            requireFail.push(otherRecognizer);\n            otherRecognizer.requireFailure(this);\n        }\n        return this;\n    },\n\n    /**\n     * drop the requireFailure link. it does not remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRequireFailure: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'dropRequireFailure', this)) {\n            return this;\n        }\n\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        var index = inArray(this.requireFail, otherRecognizer);\n        if (index > -1) {\n            this.requireFail.splice(index, 1);\n        }\n        return this;\n    },\n\n    /**\n     * has require failures boolean\n     * @returns {boolean}\n     */\n    hasRequireFailures: function() {\n        return this.requireFail.length > 0;\n    },\n\n    /**\n     * if the recognizer can recognize simultaneous with an other recognizer\n     * @param {Recognizer} otherRecognizer\n     * @returns {Boolean}\n     */\n    canRecognizeWith: function(otherRecognizer) {\n        return !!this.simultaneous[otherRecognizer.id];\n    },\n\n    /**\n     * You should use `tryEmit` instead of `emit` directly to check\n     * that all the needed recognizers has failed before emitting.\n     * @param {Object} input\n     */\n    emit: function(input) {\n        var self = this;\n        var state = this.state;\n\n        function emit(event) {\n            self.manager.emit(event, input);\n        }\n\n        // 'panstart' and 'panmove'\n        if (state < STATE_ENDED) {\n            emit(self.options.event + stateStr(state));\n        }\n\n        emit(self.options.event); // simple 'eventName' events\n\n        if (input.additionalEvent) { // additional event(panleft, panright, pinchin, pinchout...)\n            emit(input.additionalEvent);\n        }\n\n        // panend and pancancel\n        if (state >= STATE_ENDED) {\n            emit(self.options.event + stateStr(state));\n        }\n    },\n\n    /**\n     * Check that all the require failure recognizers has failed,\n     * if true, it emits a gesture event,\n     * otherwise, setup the state to FAILED.\n     * @param {Object} input\n     */\n    tryEmit: function(input) {\n        if (this.canEmit()) {\n            return this.emit(input);\n        }\n        // it's failing anyway\n        this.state = STATE_FAILED;\n    },\n\n    /**\n     * can we emit?\n     * @returns {boolean}\n     */\n    canEmit: function() {\n        var i = 0;\n        while (i < this.requireFail.length) {\n            if (!(this.requireFail[i].state & (STATE_FAILED | STATE_POSSIBLE))) {\n                return false;\n            }\n            i++;\n        }\n        return true;\n    },\n\n    /**\n     * update the recognizer\n     * @param {Object} inputData\n     */\n    recognize: function(inputData) {\n        // make a new copy of the inputData\n        // so we can change the inputData without messing up the other recognizers\n        var inputDataClone = assign({}, inputData);\n\n        // is is enabled and allow recognizing?\n        if (!boolOrFn(this.options.enable, [this, inputDataClone])) {\n            this.reset();\n            this.state = STATE_FAILED;\n            return;\n        }\n\n        // reset when we've reached the end\n        if (this.state & (STATE_RECOGNIZED | STATE_CANCELLED | STATE_FAILED)) {\n            this.state = STATE_POSSIBLE;\n        }\n\n        this.state = this.process(inputDataClone);\n\n        // the recognizer has recognized a gesture\n        // so trigger an event\n        if (this.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED | STATE_CANCELLED)) {\n            this.tryEmit(inputDataClone);\n        }\n    },\n\n    /**\n     * return the state of the recognizer\n     * the actual recognizing happens in this method\n     * @virtual\n     * @param {Object} inputData\n     * @returns {Const} STATE\n     */\n    process: function(inputData) { }, // jshint ignore:line\n\n    /**\n     * return the preferred touch-action\n     * @virtual\n     * @returns {Array}\n     */\n    getTouchAction: function() { },\n\n    /**\n     * called when the gesture isn't allowed to recognize\n     * like when another is being recognized or it is disabled\n     * @virtual\n     */\n    reset: function() { }\n};\n\n/**\n * get a usable string, used as event postfix\n * @param {Const} state\n * @returns {String} state\n */\nfunction stateStr(state) {\n    if (state & STATE_CANCELLED) {\n        return 'cancel';\n    } else if (state & STATE_ENDED) {\n        return 'end';\n    } else if (state & STATE_CHANGED) {\n        return 'move';\n    } else if (state & STATE_BEGAN) {\n        return 'start';\n    }\n    return '';\n}\n\n/**\n * direction cons to string\n * @param {Const} direction\n * @returns {String}\n */\nfunction directionStr(direction) {\n    if (direction == DIRECTION_DOWN) {\n        return 'down';\n    } else if (direction == DIRECTION_UP) {\n        return 'up';\n    } else if (direction == DIRECTION_LEFT) {\n        return 'left';\n    } else if (direction == DIRECTION_RIGHT) {\n        return 'right';\n    }\n    return '';\n}\n\n/**\n * get a recognizer by name if it is bound to a manager\n * @param {Recognizer|String} otherRecognizer\n * @param {Recognizer} recognizer\n * @returns {Recognizer}\n */\nfunction getRecognizerByNameIfManager(otherRecognizer, recognizer) {\n    var manager = recognizer.manager;\n    if (manager) {\n        return manager.get(otherRecognizer);\n    }\n    return otherRecognizer;\n}\n\n/**\n * This recognizer is just used as a base for the simple attribute recognizers.\n * @constructor\n * @extends Recognizer\n */\nfunction AttrRecognizer() {\n    Recognizer.apply(this, arguments);\n}\n\ninherit(AttrRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof AttrRecognizer\n     */\n    defaults: {\n        /**\n         * @type {Number}\n         * @default 1\n         */\n        pointers: 1\n    },\n\n    /**\n     * Used to check if it the recognizer receives valid input, like input.distance > 10.\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {Boolean} recognized\n     */\n    attrTest: function(input) {\n        var optionPointers = this.options.pointers;\n        return optionPointers === 0 || input.pointers.length === optionPointers;\n    },\n\n    /**\n     * Process the input and return the state for the recognizer\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {*} State\n     */\n    process: function(input) {\n        var state = this.state;\n        var eventType = input.eventType;\n\n        var isRecognized = state & (STATE_BEGAN | STATE_CHANGED);\n        var isValid = this.attrTest(input);\n\n        // on cancel input and we've recognized before, return STATE_CANCELLED\n        if (isRecognized && (eventType & INPUT_CANCEL || !isValid)) {\n            return state | STATE_CANCELLED;\n        } else if (isRecognized || isValid) {\n            if (eventType & INPUT_END) {\n                return state | STATE_ENDED;\n            } else if (!(state & STATE_BEGAN)) {\n                return STATE_BEGAN;\n            }\n            return state | STATE_CHANGED;\n        }\n        return STATE_FAILED;\n    }\n});\n\n/**\n * Pan\n * Recognized when the pointer is down and moved in the allowed direction.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction PanRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n\n    this.pX = null;\n    this.pY = null;\n}\n\ninherit(PanRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PanRecognizer\n     */\n    defaults: {\n        event: 'pan',\n        threshold: 10,\n        pointers: 1,\n        direction: DIRECTION_ALL\n    },\n\n    getTouchAction: function() {\n        var direction = this.options.direction;\n        var actions = [];\n        if (direction & DIRECTION_HORIZONTAL) {\n            actions.push(TOUCH_ACTION_PAN_Y);\n        }\n        if (direction & DIRECTION_VERTICAL) {\n            actions.push(TOUCH_ACTION_PAN_X);\n        }\n        return actions;\n    },\n\n    directionTest: function(input) {\n        var options = this.options;\n        var hasMoved = true;\n        var distance = input.distance;\n        var direction = input.direction;\n        var x = input.deltaX;\n        var y = input.deltaY;\n\n        // lock to axis?\n        if (!(direction & options.direction)) {\n            if (options.direction & DIRECTION_HORIZONTAL) {\n                direction = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;\n                hasMoved = x != this.pX;\n                distance = Math.abs(input.deltaX);\n            } else {\n                direction = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;\n                hasMoved = y != this.pY;\n                distance = Math.abs(input.deltaY);\n            }\n        }\n        input.direction = direction;\n        return hasMoved && distance > options.threshold && direction & options.direction;\n    },\n\n    attrTest: function(input) {\n        return AttrRecognizer.prototype.attrTest.call(this, input) &&\n            (this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));\n    },\n\n    emit: function(input) {\n\n        this.pX = input.deltaX;\n        this.pY = input.deltaY;\n\n        var direction = directionStr(input.direction);\n\n        if (direction) {\n            input.additionalEvent = this.options.event + direction;\n        }\n        this._super.emit.call(this, input);\n    }\n});\n\n/**\n * Pinch\n * Recognized when two or more pointers are moving toward (zoom-in) or away from each other (zoom-out).\n * @constructor\n * @extends AttrRecognizer\n */\nfunction PinchRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(PinchRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n        event: 'pinch',\n        threshold: 0,\n        pointers: 2\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_NONE];\n    },\n\n    attrTest: function(input) {\n        return this._super.attrTest.call(this, input) &&\n            (Math.abs(input.scale - 1) > this.options.threshold || this.state & STATE_BEGAN);\n    },\n\n    emit: function(input) {\n        if (input.scale !== 1) {\n            var inOut = input.scale < 1 ? 'in' : 'out';\n            input.additionalEvent = this.options.event + inOut;\n        }\n        this._super.emit.call(this, input);\n    }\n});\n\n/**\n * Press\n * Recognized when the pointer is down for x ms without any movement.\n * @constructor\n * @extends Recognizer\n */\nfunction PressRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    this._timer = null;\n    this._input = null;\n}\n\ninherit(PressRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PressRecognizer\n     */\n    defaults: {\n        event: 'press',\n        pointers: 1,\n        time: 251, // minimal time of the pointer to be pressed\n        threshold: 9 // a minimal movement is ok, but keep it low\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_AUTO];\n    },\n\n    process: function(input) {\n        var options = this.options;\n        var validPointers = input.pointers.length === options.pointers;\n        var validMovement = input.distance < options.threshold;\n        var validTime = input.deltaTime > options.time;\n\n        this._input = input;\n\n        // we only allow little movement\n        // and we've reached an end event, so a tap is possible\n        if (!validMovement || !validPointers || (input.eventType & (INPUT_END | INPUT_CANCEL) && !validTime)) {\n            this.reset();\n        } else if (input.eventType & INPUT_START) {\n            this.reset();\n            this._timer = setTimeoutContext(function() {\n                this.state = STATE_RECOGNIZED;\n                this.tryEmit();\n            }, options.time, this);\n        } else if (input.eventType & INPUT_END) {\n            return STATE_RECOGNIZED;\n        }\n        return STATE_FAILED;\n    },\n\n    reset: function() {\n        clearTimeout(this._timer);\n    },\n\n    emit: function(input) {\n        if (this.state !== STATE_RECOGNIZED) {\n            return;\n        }\n\n        if (input && (input.eventType & INPUT_END)) {\n            this.manager.emit(this.options.event + 'up', input);\n        } else {\n            this._input.timeStamp = now();\n            this.manager.emit(this.options.event, this._input);\n        }\n    }\n});\n\n/**\n * Rotate\n * Recognized when two or more pointer are moving in a circular motion.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction RotateRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(RotateRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof RotateRecognizer\n     */\n    defaults: {\n        event: 'rotate',\n        threshold: 0,\n        pointers: 2\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_NONE];\n    },\n\n    attrTest: function(input) {\n        return this._super.attrTest.call(this, input) &&\n            (Math.abs(input.rotation) > this.options.threshold || this.state & STATE_BEGAN);\n    }\n});\n\n/**\n * Swipe\n * Recognized when the pointer is moving fast (velocity), with enough distance in the allowed direction.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction SwipeRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(SwipeRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof SwipeRecognizer\n     */\n    defaults: {\n        event: 'swipe',\n        threshold: 10,\n        velocity: 0.3,\n        direction: DIRECTION_HORIZONTAL | DIRECTION_VERTICAL,\n        pointers: 1\n    },\n\n    getTouchAction: function() {\n        return PanRecognizer.prototype.getTouchAction.call(this);\n    },\n\n    attrTest: function(input) {\n        var direction = this.options.direction;\n        var velocity;\n\n        if (direction & (DIRECTION_HORIZONTAL | DIRECTION_VERTICAL)) {\n            velocity = input.overallVelocity;\n        } else if (direction & DIRECTION_HORIZONTAL) {\n            velocity = input.overallVelocityX;\n        } else if (direction & DIRECTION_VERTICAL) {\n            velocity = input.overallVelocityY;\n        }\n\n        return this._super.attrTest.call(this, input) &&\n            direction & input.offsetDirection &&\n            input.distance > this.options.threshold &&\n            input.maxPointers == this.options.pointers &&\n            abs(velocity) > this.options.velocity && input.eventType & INPUT_END;\n    },\n\n    emit: function(input) {\n        var direction = directionStr(input.offsetDirection);\n        if (direction) {\n            this.manager.emit(this.options.event + direction, input);\n        }\n\n        this.manager.emit(this.options.event, input);\n    }\n});\n\n/**\n * A tap is ecognized when the pointer is doing a small tap/click. Multiple taps are recognized if they occur\n * between the given interval and position. The delay option can be used to recognize multi-taps without firing\n * a single tap.\n *\n * The eventData from the emitted event contains the property `tapCount`, which contains the amount of\n * multi-taps being recognized.\n * @constructor\n * @extends Recognizer\n */\nfunction TapRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    // previous time and center,\n    // used for tap counting\n    this.pTime = false;\n    this.pCenter = false;\n\n    this._timer = null;\n    this._input = null;\n    this.count = 0;\n}\n\ninherit(TapRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n        event: 'tap',\n        pointers: 1,\n        taps: 1,\n        interval: 300, // max time between the multi-tap taps\n        time: 250, // max time of the pointer to be down (like finger on the screen)\n        threshold: 9, // a minimal movement is ok, but keep it low\n        posThreshold: 10 // a multi-tap can be a bit off the initial position\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_MANIPULATION];\n    },\n\n    process: function(input) {\n        var options = this.options;\n\n        var validPointers = input.pointers.length === options.pointers;\n        var validMovement = input.distance < options.threshold;\n        var validTouchTime = input.deltaTime < options.time;\n\n        this.reset();\n\n        if ((input.eventType & INPUT_START) && (this.count === 0)) {\n            return this.failTimeout();\n        }\n\n        // we only allow little movement\n        // and we've reached an end event, so a tap is possible\n        if (validMovement && validTouchTime && validPointers) {\n            if (input.eventType != INPUT_END) {\n                return this.failTimeout();\n            }\n\n            var validInterval = this.pTime ? (input.timeStamp - this.pTime < options.interval) : true;\n            var validMultiTap = !this.pCenter || getDistance(this.pCenter, input.center) < options.posThreshold;\n\n            this.pTime = input.timeStamp;\n            this.pCenter = input.center;\n\n            if (!validMultiTap || !validInterval) {\n                this.count = 1;\n            } else {\n                this.count += 1;\n            }\n\n            this._input = input;\n\n            // if tap count matches we have recognized it,\n            // else it has began recognizing...\n            var tapCount = this.count % options.taps;\n            if (tapCount === 0) {\n                // no failing requirements, immediately trigger the tap event\n                // or wait as long as the multitap interval to trigger\n                if (!this.hasRequireFailures()) {\n                    return STATE_RECOGNIZED;\n                } else {\n                    this._timer = setTimeoutContext(function() {\n                        this.state = STATE_RECOGNIZED;\n                        this.tryEmit();\n                    }, options.interval, this);\n                    return STATE_BEGAN;\n                }\n            }\n        }\n        return STATE_FAILED;\n    },\n\n    failTimeout: function() {\n        this._timer = setTimeoutContext(function() {\n            this.state = STATE_FAILED;\n        }, this.options.interval, this);\n        return STATE_FAILED;\n    },\n\n    reset: function() {\n        clearTimeout(this._timer);\n    },\n\n    emit: function() {\n        if (this.state == STATE_RECOGNIZED) {\n            this._input.tapCount = this.count;\n            this.manager.emit(this.options.event, this._input);\n        }\n    }\n});\n\n/**\n * Simple way to create a manager with a default set of recognizers.\n * @param {HTMLElement} element\n * @param {Object} [options]\n * @constructor\n */\nfunction Hammer(element, options) {\n    options = options || {};\n    options.recognizers = ifUndefined(options.recognizers, Hammer.defaults.preset);\n    return new Manager(element, options);\n}\n\n/**\n * @const {string}\n */\nHammer.VERSION = '2.0.7';\n\n/**\n * default settings\n * @namespace\n */\nHammer.defaults = {\n    /**\n     * set if DOM events are being triggered.\n     * But this is slower and unused by simple implementations, so disabled by default.\n     * @type {Boolean}\n     * @default false\n     */\n    domEvents: false,\n\n    /**\n     * The value for the touchAction property/fallback.\n     * When set to `compute` it will magically set the correct value based on the added recognizers.\n     * @type {String}\n     * @default compute\n     */\n    touchAction: TOUCH_ACTION_COMPUTE,\n\n    /**\n     * @type {Boolean}\n     * @default true\n     */\n    enable: true,\n\n    /**\n     * EXPERIMENTAL FEATURE -- can be removed/changed\n     * Change the parent input target element.\n     * If Null, then it is being set the to main element.\n     * @type {Null|EventTarget}\n     * @default null\n     */\n    inputTarget: null,\n\n    /**\n     * force an input class\n     * @type {Null|Function}\n     * @default null\n     */\n    inputClass: null,\n\n    /**\n     * Default recognizer setup when calling `Hammer()`\n     * When creating a new Manager these will be skipped.\n     * @type {Array}\n     */\n    preset: [\n        // RecognizerClass, options, [recognizeWith, ...], [requireFailure, ...]\n        [RotateRecognizer, {enable: false}],\n        [PinchRecognizer, {enable: false}, ['rotate']],\n        [SwipeRecognizer, {direction: DIRECTION_HORIZONTAL}],\n        [PanRecognizer, {direction: DIRECTION_HORIZONTAL}, ['swipe']],\n        [TapRecognizer],\n        [TapRecognizer, {event: 'doubletap', taps: 2}, ['tap']],\n        [PressRecognizer]\n    ],\n\n    /**\n     * Some CSS properties can be used to improve the working of Hammer.\n     * Add them to this method and they will be set when creating a new Manager.\n     * @namespace\n     */\n    cssProps: {\n        /**\n         * Disables text selection to improve the dragging gesture. Mainly for desktop browsers.\n         * @type {String}\n         * @default 'none'\n         */\n        userSelect: 'none',\n\n        /**\n         * Disable the Windows Phone grippers when pressing an element.\n         * @type {String}\n         * @default 'none'\n         */\n        touchSelect: 'none',\n\n        /**\n         * Disables the default callout shown when you touch and hold a touch target.\n         * On iOS, when you touch and hold a touch target such as a link, Safari displays\n         * a callout containing information about the link. This property allows you to disable that callout.\n         * @type {String}\n         * @default 'none'\n         */\n        touchCallout: 'none',\n\n        /**\n         * Specifies whether zooming is enabled. Used by IE10>\n         * @type {String}\n         * @default 'none'\n         */\n        contentZooming: 'none',\n\n        /**\n         * Specifies that an entire element should be draggable instead of its contents. Mainly for desktop browsers.\n         * @type {String}\n         * @default 'none'\n         */\n        userDrag: 'none',\n\n        /**\n         * Overrides the highlight color shown when the user taps a link or a JavaScript\n         * clickable element in iOS. This property obeys the alpha value, if specified.\n         * @type {String}\n         * @default 'rgba(0,0,0,0)'\n         */\n        tapHighlightColor: 'rgba(0,0,0,0)'\n    }\n};\n\nvar STOP = 1;\nvar FORCED_STOP = 2;\n\n/**\n * Manager\n * @param {HTMLElement} element\n * @param {Object} [options]\n * @constructor\n */\nfunction Manager(element, options) {\n    this.options = assign({}, Hammer.defaults, options || {});\n\n    this.options.inputTarget = this.options.inputTarget || element;\n\n    this.handlers = {};\n    this.session = {};\n    this.recognizers = [];\n    this.oldCssProps = {};\n\n    this.element = element;\n    this.input = createInputInstance(this);\n    this.touchAction = new TouchAction(this, this.options.touchAction);\n\n    toggleCssProps(this, true);\n\n    each(this.options.recognizers, function(item) {\n        var recognizer = this.add(new (item[0])(item[1]));\n        item[2] && recognizer.recognizeWith(item[2]);\n        item[3] && recognizer.requireFailure(item[3]);\n    }, this);\n}\n\nManager.prototype = {\n    /**\n     * set options\n     * @param {Object} options\n     * @returns {Manager}\n     */\n    set: function(options) {\n        assign(this.options, options);\n\n        // Options that need a little more setup\n        if (options.touchAction) {\n            this.touchAction.update();\n        }\n        if (options.inputTarget) {\n            // Clean up existing event listeners and reinitialize\n            this.input.destroy();\n            this.input.target = options.inputTarget;\n            this.input.init();\n        }\n        return this;\n    },\n\n    /**\n     * stop recognizing for this session.\n     * This session will be discarded, when a new [input]start event is fired.\n     * When forced, the recognizer cycle is stopped immediately.\n     * @param {Boolean} [force]\n     */\n    stop: function(force) {\n        this.session.stopped = force ? FORCED_STOP : STOP;\n    },\n\n    /**\n     * run the recognizers!\n     * called by the inputHandler function on every movement of the pointers (touches)\n     * it walks through all the recognizers and tries to detect the gesture that is being made\n     * @param {Object} inputData\n     */\n    recognize: function(inputData) {\n        var session = this.session;\n        if (session.stopped) {\n            return;\n        }\n\n        // run the touch-action polyfill\n        this.touchAction.preventDefaults(inputData);\n\n        var recognizer;\n        var recognizers = this.recognizers;\n\n        // this holds the recognizer that is being recognized.\n        // so the recognizer's state needs to be BEGAN, CHANGED, ENDED or RECOGNIZED\n        // if no recognizer is detecting a thing, it is set to `null`\n        var curRecognizer = session.curRecognizer;\n\n        // reset when the last recognizer is recognized\n        // or when we're in a new session\n        if (!curRecognizer || (curRecognizer && curRecognizer.state & STATE_RECOGNIZED)) {\n            curRecognizer = session.curRecognizer = null;\n        }\n\n        var i = 0;\n        while (i < recognizers.length) {\n            recognizer = recognizers[i];\n\n            // find out if we are allowed try to recognize the input for this one.\n            // 1.   allow if the session is NOT forced stopped (see the .stop() method)\n            // 2.   allow if we still haven't recognized a gesture in this session, or the this recognizer is the one\n            //      that is being recognized.\n            // 3.   allow if the recognizer is allowed to run simultaneous with the current recognized recognizer.\n            //      this can be setup with the `recognizeWith()` method on the recognizer.\n            if (session.stopped !== FORCED_STOP && ( // 1\n                    !curRecognizer || recognizer == curRecognizer || // 2\n                    recognizer.canRecognizeWith(curRecognizer))) { // 3\n                recognizer.recognize(inputData);\n            } else {\n                recognizer.reset();\n            }\n\n            // if the recognizer has been recognizing the input as a valid gesture, we want to store this one as the\n            // current active recognizer. but only if we don't already have an active recognizer\n            if (!curRecognizer && recognizer.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED)) {\n                curRecognizer = session.curRecognizer = recognizer;\n            }\n            i++;\n        }\n    },\n\n    /**\n     * get a recognizer by its event name.\n     * @param {Recognizer|String} recognizer\n     * @returns {Recognizer|Null}\n     */\n    get: function(recognizer) {\n        if (recognizer instanceof Recognizer) {\n            return recognizer;\n        }\n\n        var recognizers = this.recognizers;\n        for (var i = 0; i < recognizers.length; i++) {\n            if (recognizers[i].options.event == recognizer) {\n                return recognizers[i];\n            }\n        }\n        return null;\n    },\n\n    /**\n     * add a recognizer to the manager\n     * existing recognizers with the same event name will be removed\n     * @param {Recognizer} recognizer\n     * @returns {Recognizer|Manager}\n     */\n    add: function(recognizer) {\n        if (invokeArrayArg(recognizer, 'add', this)) {\n            return this;\n        }\n\n        // remove existing\n        var existing = this.get(recognizer.options.event);\n        if (existing) {\n            this.remove(existing);\n        }\n\n        this.recognizers.push(recognizer);\n        recognizer.manager = this;\n\n        this.touchAction.update();\n        return recognizer;\n    },\n\n    /**\n     * remove a recognizer by name or instance\n     * @param {Recognizer|String} recognizer\n     * @returns {Manager}\n     */\n    remove: function(recognizer) {\n        if (invokeArrayArg(recognizer, 'remove', this)) {\n            return this;\n        }\n\n        recognizer = this.get(recognizer);\n\n        // let's make sure this recognizer exists\n        if (recognizer) {\n            var recognizers = this.recognizers;\n            var index = inArray(recognizers, recognizer);\n\n            if (index !== -1) {\n                recognizers.splice(index, 1);\n                this.touchAction.update();\n            }\n        }\n\n        return this;\n    },\n\n    /**\n     * bind event\n     * @param {String} events\n     * @param {Function} handler\n     * @returns {EventEmitter} this\n     */\n    on: function(events, handler) {\n        if (events === undefined) {\n            return;\n        }\n        if (handler === undefined) {\n            return;\n        }\n\n        var handlers = this.handlers;\n        each(splitStr(events), function(event) {\n            handlers[event] = handlers[event] || [];\n            handlers[event].push(handler);\n        });\n        return this;\n    },\n\n    /**\n     * unbind event, leave emit blank to remove all handlers\n     * @param {String} events\n     * @param {Function} [handler]\n     * @returns {EventEmitter} this\n     */\n    off: function(events, handler) {\n        if (events === undefined) {\n            return;\n        }\n\n        var handlers = this.handlers;\n        each(splitStr(events), function(event) {\n            if (!handler) {\n                delete handlers[event];\n            } else {\n                handlers[event] && handlers[event].splice(inArray(handlers[event], handler), 1);\n            }\n        });\n        return this;\n    },\n\n    /**\n     * emit event to the listeners\n     * @param {String} event\n     * @param {Object} data\n     */\n    emit: function(event, data) {\n        // we also want to trigger dom events\n        if (this.options.domEvents) {\n            triggerDomEvent(event, data);\n        }\n\n        // no handlers, so skip it all\n        var handlers = this.handlers[event] && this.handlers[event].slice();\n        if (!handlers || !handlers.length) {\n            return;\n        }\n\n        data.type = event;\n        data.preventDefault = function() {\n            data.srcEvent.preventDefault();\n        };\n\n        var i = 0;\n        while (i < handlers.length) {\n            handlers[i](data);\n            i++;\n        }\n    },\n\n    /**\n     * destroy the manager and unbinds all events\n     * it doesn't unbind dom events, that is the user own responsibility\n     */\n    destroy: function() {\n        this.element && toggleCssProps(this, false);\n\n        this.handlers = {};\n        this.session = {};\n        this.input.destroy();\n        this.element = null;\n    }\n};\n\n/**\n * add/remove the css properties as defined in manager.options.cssProps\n * @param {Manager} manager\n * @param {Boolean} add\n */\nfunction toggleCssProps(manager, add) {\n    var element = manager.element;\n    if (!element.style) {\n        return;\n    }\n    var prop;\n    each(manager.options.cssProps, function(value, name) {\n        prop = prefixed(element.style, name);\n        if (add) {\n            manager.oldCssProps[prop] = element.style[prop];\n            element.style[prop] = value;\n        } else {\n            element.style[prop] = manager.oldCssProps[prop] || '';\n        }\n    });\n    if (!add) {\n        manager.oldCssProps = {};\n    }\n}\n\n/**\n * trigger dom event\n * @param {String} event\n * @param {Object} data\n */\nfunction triggerDomEvent(event, data) {\n    var gestureEvent = document.createEvent('Event');\n    gestureEvent.initEvent(event, true, true);\n    gestureEvent.gesture = data;\n    data.target.dispatchEvent(gestureEvent);\n}\n\nassign(Hammer, {\n    INPUT_START: INPUT_START,\n    INPUT_MOVE: INPUT_MOVE,\n    INPUT_END: INPUT_END,\n    INPUT_CANCEL: INPUT_CANCEL,\n\n    STATE_POSSIBLE: STATE_POSSIBLE,\n    STATE_BEGAN: STATE_BEGAN,\n    STATE_CHANGED: STATE_CHANGED,\n    STATE_ENDED: STATE_ENDED,\n    STATE_RECOGNIZED: STATE_RECOGNIZED,\n    STATE_CANCELLED: STATE_CANCELLED,\n    STATE_FAILED: STATE_FAILED,\n\n    DIRECTION_NONE: DIRECTION_NONE,\n    DIRECTION_LEFT: DIRECTION_LEFT,\n    DIRECTION_RIGHT: DIRECTION_RIGHT,\n    DIRECTION_UP: DIRECTION_UP,\n    DIRECTION_DOWN: DIRECTION_DOWN,\n    DIRECTION_HORIZONTAL: DIRECTION_HORIZONTAL,\n    DIRECTION_VERTICAL: DIRECTION_VERTICAL,\n    DIRECTION_ALL: DIRECTION_ALL,\n\n    Manager: Manager,\n    Input: Input,\n    TouchAction: TouchAction,\n\n    TouchInput: TouchInput,\n    MouseInput: MouseInput,\n    PointerEventInput: PointerEventInput,\n    TouchMouseInput: TouchMouseInput,\n    SingleTouchInput: SingleTouchInput,\n\n    Recognizer: Recognizer,\n    AttrRecognizer: AttrRecognizer,\n    Tap: TapRecognizer,\n    Pan: PanRecognizer,\n    Swipe: SwipeRecognizer,\n    Pinch: PinchRecognizer,\n    Rotate: RotateRecognizer,\n    Press: PressRecognizer,\n\n    on: addEventListeners,\n    off: removeEventListeners,\n    each: each,\n    merge: merge,\n    extend: extend,\n    assign: assign,\n    inherit: inherit,\n    bindFn: bindFn,\n    prefixed: prefixed\n});\n\n// this prevents errors when Hammer is loaded in the presence of an AMD\n//  style loader but by script tag, not by the loader.\nvar freeGlobal = (typeof window !== 'undefined' ? window : (typeof self !== 'undefined' ? self : {})); // jshint ignore:line\nfreeGlobal.Hammer = Hammer;\n\nif (typeof define === 'function' && define.amd) {\n    define(function() {\n        return Hammer;\n    });\n} else if (typeof module != 'undefined' && module.exports) {\n    module.exports = Hammer;\n} else {\n    window[exportName] = Hammer;\n}\n\n})(window, document, 'Hammer');\n","const {\n  is,\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks the presence of a label.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (isAny(node, [\n      'bpmn:ParallelGateway',\n      'bpmn:EventBasedGateway'\n    ])) {\n      return;\n    }\n\n    // ignore joining gateways\n    if (is(node, 'bpmn:Gateway') && !isForking(node)) {\n      return;\n    }\n\n    if (is(node, 'bpmn:BoundaryEvent')) {\n      return;\n    }\n\n    // ignore sub-processes\n    if (is(node, 'bpmn:SubProcess')) {\n      // TODO(nikku): better ignore expanded sub-processes only\n      return;\n    }\n\n    // ignore sequence flow without condition\n    if (is(node, 'bpmn:SequenceFlow') && !hasCondition(node)) {\n      return;\n    }\n\n    // ignore data objects and artifacts for now\n    if (isAny(node, [\n      'bpmn:FlowNode',\n      'bpmn:SequenceFlow',\n      'bpmn:Participant',\n      'bpmn:Lane'\n    ])) {\n\n      const name = (node.name || '').trim();\n\n      if (name.length === 0) {\n        reporter.report(node.id, 'Element is missing label/name');\n      }\n    }\n  }\n\n  return { check };\n};\n\n\n// helpers ////////////////////////\n\nfunction isForking(node) {\n  const outgoing = node.outgoing || [];\n\n  return outgoing.length > 1;\n}\n\nfunction hasCondition(node) {\n  return node.conditionExpression;\n}","var eq = require('./eq');\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = assocIndexOf;\n","/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * Creates an array that is the composition of partially applied arguments,\n * placeholders, and provided arguments into a single array of arguments.\n *\n * @private\n * @param {Array} args The provided arguments.\n * @param {Array} partials The arguments to prepend to those provided.\n * @param {Array} holders The `partials` placeholder indexes.\n * @params {boolean} [isCurried] Specify composing for a curried function.\n * @returns {Array} Returns the new array of composed arguments.\n */\nfunction composeArgs(args, partials, holders, isCurried) {\n  var argsIndex = -1,\n      argsLength = args.length,\n      holdersLength = holders.length,\n      leftIndex = -1,\n      leftLength = partials.length,\n      rangeLength = nativeMax(argsLength - holdersLength, 0),\n      result = Array(leftLength + rangeLength),\n      isUncurried = !isCurried;\n\n  while (++leftIndex < leftLength) {\n    result[leftIndex] = partials[leftIndex];\n  }\n  while (++argsIndex < holdersLength) {\n    if (isUncurried || argsIndex < argsLength) {\n      result[holders[argsIndex]] = args[argsIndex];\n    }\n  }\n  while (rangeLength--) {\n    result[leftIndex++] = args[argsIndex++];\n  }\n  return result;\n}\n\nmodule.exports = composeArgs;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","var Symbol = require('./_Symbol'),\n    arrayMap = require('./_arrayMap'),\n    isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = baseToString;\n","var apply = require('./_apply'),\n    createCtor = require('./_createCtor'),\n    root = require('./_root');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1;\n\n/**\n * Creates a function that wraps `func` to invoke it with the `this` binding\n * of `thisArg` and `partials` prepended to the arguments it receives.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} partials The arguments to prepend to those provided to\n *  the new function.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createPartial(func, bitmask, thisArg, partials) {\n  var isBind = bitmask & WRAP_BIND_FLAG,\n      Ctor = createCtor(func);\n\n  function wrapper() {\n    var argsIndex = -1,\n        argsLength = arguments.length,\n        leftIndex = -1,\n        leftLength = partials.length,\n        args = Array(leftLength + argsLength),\n        fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n\n    while (++leftIndex < leftLength) {\n      args[leftIndex] = partials[leftIndex];\n    }\n    while (argsLength--) {\n      args[leftIndex++] = arguments[++argsIndex];\n    }\n    return apply(fn, isBind ? thisArg : this, args);\n  }\n  return wrapper;\n}\n\nmodule.exports = createPartial;\n","var ListCache = require('./_ListCache'),\n    Map = require('./_Map'),\n    MapCache = require('./_MapCache');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nmodule.exports = stackSet;\n","'use strict';\n\nvar escapeHTML = require('./Utils').escapeHTML;\n\nvar domify = require('min-dom').domify,\n    domQuery = require('min-dom').query,\n    domQueryAll = require('min-dom').queryAll,\n    domRemove = require('min-dom').remove,\n    domClasses = require('min-dom').classes,\n    domClosest = require('min-dom').closest,\n    domAttr = require('min-dom').attr,\n    domDelegate = require('min-dom').delegate,\n    domMatches = require('min-dom').matches;\n\nvar forEach = require('lodash/forEach'),\n    filter = require('lodash/filter'),\n    get = require('lodash/get'),\n    keys = require('lodash/keys'),\n    isEmpty = require('lodash/isEmpty'),\n    isArray = require('lodash/isArray'),\n    xor = require('lodash/xor'),\n    debounce = require('lodash/debounce');\n\nvar updateSelection = require('selection-update');\n\nvar scrollTabs = require('scroll-tabs').default;\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar HIDE_CLASS = 'bpp-hidden';\nvar DEBOUNCE_DELAY = 300;\n\n\nfunction isToggle(node) {\n  return node.type === 'checkbox' || node.type === 'radio';\n}\n\nfunction isSelect(node) {\n  return node.type === 'select-one';\n}\n\nfunction isContentEditable(node) {\n  return domAttr(node, 'contenteditable');\n}\n\nfunction getPropertyPlaceholders(node) {\n  var selector = 'input[name], textarea[name], [data-value], [contenteditable]';\n  var placeholders = domQueryAll(selector, node);\n  if ((!placeholders || !placeholders.length) && domMatches(node, selector)) {\n    placeholders = [ node ];\n  }\n  return placeholders;\n}\n\n/**\n * Return all active form controls.\n * This excludes the invisible controls unless all is true\n *\n * @param {Element} node\n * @param {Boolean} [all=false]\n */\nfunction getFormControls(node, all) {\n  var controls = domQueryAll('input[name], textarea[name], select[name], [contenteditable]', node);\n\n  if (!controls || !controls.length) {\n    controls = domMatches(node, 'option') ? [ node ] : controls;\n  }\n\n  if (!all) {\n    controls = filter(controls, function(node) {\n      return !domClosest(node, '.' + HIDE_CLASS);\n    });\n  }\n\n  return controls;\n}\n\nfunction getFormControlValuesInScope(entryNode) {\n  var values = {};\n\n  var controlNodes = getFormControls(entryNode);\n\n  forEach(controlNodes, function(controlNode) {\n    var value = controlNode.value;\n\n    var name = domAttr(controlNode, 'name') || domAttr(controlNode, 'data-name');\n\n    // take toggle state into account for radio / checkboxes\n    if (isToggle(controlNode)) {\n      if (controlNode.checked) {\n        if (!domAttr(controlNode, 'value')) {\n          value = true;\n        } else {\n          value = controlNode.value;\n        }\n      } else {\n        value = null;\n      }\n    } else\n    if (isContentEditable(controlNode)) {\n      value = controlNode.innerText;\n    }\n\n    if (value !== null) {\n      // return the actual value\n      // handle serialization in entry provider\n      // (ie. if empty string should be serialized or not)\n      values[name] = value;\n    }\n  });\n\n  return values;\n\n}\n\n/**\n * Extract input values from entry node\n *\n * @param  {DOMElement} entryNode\n * @returns {Object}\n */\nfunction getFormControlValues(entryNode) {\n\n  var values;\n\n  var listContainer = domQuery('[data-list-entry-container]', entryNode);\n  if (listContainer) {\n    values = [];\n    var listNodes = listContainer.children || [];\n    forEach(listNodes, function(listNode) {\n      values.push(getFormControlValuesInScope(listNode));\n    });\n  } else {\n    values = getFormControlValuesInScope(entryNode);\n  }\n\n  return values;\n}\n\n/**\n * Return true if the given form extracted value equals\n * to an old cached version.\n *\n * @param {Object} value\n * @param {Object} oldValue\n * @return {Boolean}\n */\nfunction valueEqual(value, oldValue) {\n\n  if (value && !oldValue) {\n    return false;\n  }\n\n  var allKeys = keys(value).concat(keys(oldValue));\n\n  return allKeys.every(function(key) {\n    return value[key] === oldValue[key];\n  });\n}\n\n/**\n * Return true if the given form extracted value(s)\n * equal an old cached version.\n *\n * @param {Array<Object>|Object} values\n * @param {Array<Object>|Object} oldValues\n * @return {Boolean}\n */\nfunction valuesEqual(values, oldValues) {\n\n  if (isArray(values)) {\n\n    if (values.length !== oldValues.length) {\n      return false;\n    }\n\n    return values.every(function(v, idx) {\n      return valueEqual(v, oldValues[idx]);\n    });\n  }\n\n  return valueEqual(values, oldValues);\n}\n\n/**\n * Return a mapping of { id: entry } for all entries in the given groups in the given tabs.\n *\n * @param {Object} tabs\n * @return {Object}\n */\nfunction extractEntries(tabs) {\n  return keyBy(flattenDeep(map(flattenDeep(map(tabs, 'groups')), 'entries')), 'id');\n}\n\n/**\n * Return a mapping of { id: group } for all groups in the given tabs.\n *\n * @param {Object} tabs\n * @return {Object}\n */\nfunction extractGroups(tabs) {\n  return keyBy(flattenDeep(map(tabs, 'groups')), 'id');\n}\n\n/**\n * A properties panel implementation.\n *\n * To use it provide a `propertiesProvider` component that knows\n * about which properties to display.\n *\n * Properties edit state / visibility can be intercepted\n * via a custom {@link PropertiesActivator}.\n *\n * @class\n * @constructor\n *\n * @param {Object} config\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {PropertiesProvider} propertiesProvider\n * @param {Canvas} canvas\n * @param {CommandStack} commandStack\n */\nfunction PropertiesPanel(config, eventBus, modeling, propertiesProvider, commandStack, canvas) {\n\n  this._eventBus = eventBus;\n  this._modeling = modeling;\n  this._commandStack = commandStack;\n  this._canvas = canvas;\n  this._propertiesProvider = propertiesProvider;\n\n  this._init(config);\n}\n\nPropertiesPanel.$inject = [\n  'config.propertiesPanel',\n  'eventBus',\n  'modeling',\n  'propertiesProvider',\n  'commandStack',\n  'canvas'\n];\n\nmodule.exports = PropertiesPanel;\n\n\nPropertiesPanel.prototype._init = function(config) {\n\n  var canvas = this._canvas,\n      eventBus = this._eventBus;\n\n  var self = this;\n\n  /**\n   * Select the root element once it is added to the canvas\n   */\n  eventBus.on('root.added', function(e) {\n    var element = e.element;\n\n    if (isImplicitRoot(element)) {\n      return;\n    }\n\n    self.update(element);\n  });\n\n  eventBus.on('selection.changed', function(e) {\n    var newElement = e.newSelection[0];\n\n    var rootElement = canvas.getRootElement();\n\n    if (isImplicitRoot(rootElement)) {\n      return;\n    }\n\n    self.update(newElement);\n  });\n\n  // add / update tab-bar scrolling\n  eventBus.on([\n    'propertiesPanel.changed',\n    'propertiesPanel.resized'\n  ], function(event) {\n\n    var tabBarNode = domQuery('.bpp-properties-tab-bar', self._container);\n\n    if (!tabBarNode) {\n      return;\n    }\n\n    var scroller = scrollTabs.get(tabBarNode);\n\n    if (!scroller) {\n\n      // we did not initialize yet, do that\n      // now and make sure we select the active\n      // tab on scroll update\n      scroller = scrollTabs(tabBarNode, {\n        selectors: {\n          tabsContainer: '.bpp-properties-tabs-links',\n          tab: '.bpp-properties-tabs-links li',\n          ignore: '.bpp-hidden',\n          active: '.bpp-active'\n        }\n      });\n\n\n      scroller.on('scroll', function(newActiveNode, oldActiveNode, direction) {\n\n        var linkNode = domQuery('[data-tab-target]', newActiveNode);\n\n        var tabId = domAttr(linkNode, 'data-tab-target');\n\n        self.activateTab(tabId);\n      });\n    }\n\n    // react on tab changes and or tabContainer resize\n    // and make sure the active tab is shown completely\n    scroller.update();\n  });\n\n  eventBus.on('elements.changed', function(e) {\n\n    var current = self._current;\n    var element = current && current.element;\n\n    if (element) {\n      if (e.elements.indexOf(element) !== -1) {\n        self.update(element);\n      }\n    }\n  });\n\n  eventBus.on('elementTemplates.changed', function() {\n    var current = self._current;\n    var element = current && current.element;\n\n    if (element) {\n      self.update(element);\n    }\n  });\n\n  eventBus.on('diagram.destroy', function() {\n    self.detach();\n  });\n\n  this._container = domify('<div class=\"bpp-properties-panel\"></div>');\n\n  this._bindListeners(this._container);\n\n  if (config && config.parent) {\n    this.attachTo(config.parent);\n  }\n};\n\n\nPropertiesPanel.prototype.attachTo = function(parentNode) {\n\n  if (!parentNode) {\n    throw new Error('parentNode required');\n  }\n\n  // ensure we detach from the\n  // previous, old parent\n  this.detach();\n\n  // unwrap jQuery if provided\n  if (parentNode.get && parentNode.constructor.prototype.jquery) {\n    parentNode = parentNode.get(0);\n  }\n\n  if (typeof parentNode === 'string') {\n    parentNode = domQuery(parentNode);\n  }\n\n  var container = this._container;\n\n  parentNode.appendChild(container);\n\n  this._emit('attach');\n};\n\nPropertiesPanel.prototype.detach = function() {\n\n  var container = this._container,\n      parentNode = container.parentNode;\n\n  if (!parentNode) {\n    return;\n  }\n\n  this._emit('detach');\n\n  parentNode.removeChild(container);\n};\n\n\n/**\n * Select the given tab within the properties panel.\n *\n * @param {Object|String} tab\n */\nPropertiesPanel.prototype.activateTab = function(tab) {\n\n  var tabId = typeof tab === 'string' ? tab : tab.id;\n\n  var current = this._current;\n\n  var panelNode = current.panel;\n\n  var allTabNodes = domQueryAll('.bpp-properties-tab', panelNode),\n      allTabLinkNodes = domQueryAll('.bpp-properties-tab-link', panelNode);\n\n  forEach(allTabNodes, function(tabNode) {\n\n    var currentTabId = domAttr(tabNode, 'data-tab');\n\n    domClasses(tabNode).toggle('bpp-active', tabId === currentTabId);\n  });\n\n  forEach(allTabLinkNodes, function(tabLinkNode) {\n\n    var tabLink = domQuery('[data-tab-target]', tabLinkNode),\n        currentTabId = domAttr(tabLink, 'data-tab-target');\n\n    domClasses(tabLinkNode).toggle('bpp-active', tabId === currentTabId);\n  });\n};\n\n/**\n * Update the DOM representation of the properties panel\n */\nPropertiesPanel.prototype.update = function(element) {\n  var current = this._current;\n\n  // no actual selection change\n  var needsCreate = true;\n\n  if (typeof element === 'undefined') {\n\n    // use RootElement of BPMN diagram to generate properties panel if no element is selected\n    element = this._canvas.getRootElement();\n  }\n\n  var newTabs = this._propertiesProvider.getTabs(element);\n\n  if (current && current.element === element) {\n    // see if we can reuse the existing panel\n\n    needsCreate = this._entriesChanged(current, newTabs);\n  }\n\n  if (needsCreate) {\n\n    if (current) {\n\n      // get active tab from the existing panel before remove it\n      var activeTabNode = domQuery('.bpp-properties-tab.bpp-active', current.panel);\n\n      var activeTabId;\n      if (activeTabNode) {\n        activeTabId = domAttr(activeTabNode, 'data-tab');\n      }\n\n      // remove old panel\n      domRemove(current.panel);\n    }\n\n    this._current = this._create(element, newTabs);\n\n    // activate the saved active tab from the remove panel or the first tab\n    (activeTabId) ? this.activateTab(activeTabId) : this.activateTab(this._current.tabs[0]);\n\n  }\n\n  if (this._current) {\n    // make sure correct tab contents are visible\n    this._updateActivation(this._current);\n\n  }\n\n  this._emit('changed');\n};\n\n\n/**\n * Returns true if one of two groups has different entries than the other.\n *\n * @param  {Object} current\n * @param  {Object} newTabs\n * @return {Boolean}\n */\nPropertiesPanel.prototype._entriesChanged = function(current, newTabs) {\n\n  var oldEntryIds = keys(current.entries),\n      newEntryIds = keys(extractEntries(newTabs));\n\n  return !isEmpty(xor(oldEntryIds, newEntryIds));\n};\n\nPropertiesPanel.prototype._emit = function(event) {\n  this._eventBus.fire('propertiesPanel.' + event, { panel: this, current: this._current });\n};\n\nPropertiesPanel.prototype._bindListeners = function(container) {\n\n  var self = this;\n\n  // handles a change for a given event\n  var handleChange = function handleChange(event) {\n\n    // see if we handle a change inside a [data-entry] element.\n    // if not, drop out\n    var inputNode = event.delegateTarget,\n        entryNode = domClosest(inputNode, '[data-entry]'),\n        entryId, entry;\n\n    // change from outside a [data-entry] element, simply ignore\n    if (!entryNode) {\n      return;\n    }\n\n    entryId = domAttr(entryNode, 'data-entry');\n    entry = self.getEntry(entryId);\n\n    var values = getFormControlValues(entryNode);\n\n    if (event.type === 'change') {\n\n      // - if the \"data-on-change\" attribute is present and a value is changed,\n      //   then the associated action is performed.\n      // - if the associated action returns \"true\" then an update to the business\n      //   object is done\n      // - if it does not return \"true\", then only the DOM content is updated\n      var onChangeAction = domAttr(inputNode, 'data-on-change');\n\n      if (onChangeAction) {\n        var isEntryDirty = self.executeAction(entry, entryNode, onChangeAction, event);\n\n        if (!isEntryDirty) {\n          return self.update(self._current.element);\n        }\n      }\n    }\n    self.applyChanges(entry, values, entryNode);\n    self.updateState(entry, entryNode);\n  };\n\n  // debounce update only elements that are target of key events,\n  // i.e. INPUT and TEXTAREA. SELECTs will trigger an immediate update anyway.\n  domDelegate.bind(container, 'input, textarea, [contenteditable]', 'input', debounce(handleChange, DEBOUNCE_DELAY));\n  domDelegate.bind(container, 'input, textarea, select, [contenteditable]', 'change', handleChange);\n\n  // paste as plain text only\n  domDelegate.bind(container, '[contenteditable]', 'paste', handlePaste);\n\n  function handlePaste(event) {\n    var text = (event.clipboardData || window.clipboardData).getData('text');\n    document.execCommand('insertText', false, text);\n\n    event.preventDefault();\n  }\n\n  // handle key events\n  domDelegate.bind(container, 'select', 'keydown', function(e) {\n\n    // DEL\n    if (e.keyCode === 46) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  });\n\n  domDelegate.bind(container, '[data-action]', 'click', function onClick(event) {\n\n    // triggers on all inputs\n    var inputNode = event.delegateTarget,\n        entryNode = domClosest(inputNode, '[data-entry]');\n\n    var actionId = domAttr(inputNode, 'data-action'),\n        entryId = domAttr(entryNode, 'data-entry');\n\n    var entry = self.getEntry(entryId);\n\n    var isEntryDirty = self.executeAction(entry, entryNode, actionId, event);\n\n    if (isEntryDirty) {\n      var values = getFormControlValues(entryNode);\n\n      self.applyChanges(entry, values, entryNode);\n    }\n\n    self.updateState(entry, entryNode);\n  });\n\n  function handleInput(event, element) {\n    // triggers on all inputs\n    var inputNode = event.delegateTarget;\n\n    var entryNode = domClosest(inputNode, '[data-entry]');\n\n    // only work on data entries\n    if (!entryNode) {\n      return;\n    }\n\n    var eventHandlerId = domAttr(inputNode, 'data-blur'),\n        entryId = domAttr(entryNode, 'data-entry');\n\n    var entry = self.getEntry(entryId);\n\n    var isEntryDirty = self.executeAction(entry, entryNode, eventHandlerId, event);\n\n    if (isEntryDirty) {\n      var values = getFormControlValues(entryNode);\n\n      self.applyChanges(entry, values, entryNode);\n    }\n\n    self.updateState(entry, entryNode);\n  }\n\n  domDelegate.bind(container, '[data-blur]', 'blur', handleInput, true);\n\n  // make tab links interactive\n  domDelegate.bind(container, '.bpp-properties-tabs-links [data-tab-target]', 'click', function(event) {\n    event.preventDefault();\n\n    var delegateTarget = event.delegateTarget;\n\n    var tabId = domAttr(delegateTarget, 'data-tab-target');\n\n    // activate tab on link click\n    self.activateTab(tabId);\n  });\n\n};\n\nPropertiesPanel.prototype.updateState = function(entry, entryNode) {\n  this.updateShow(entry, entryNode);\n  this.updateDisable(entry, entryNode);\n};\n\n/**\n * Update the visibility of the entry node in the DOM\n */\nPropertiesPanel.prototype.updateShow = function(entry, node) {\n\n  var current = this._current;\n\n  if (!current) {\n    return;\n  }\n\n  var showNodes = domQueryAll('[data-show]', node) || [];\n\n  forEach(showNodes, function(showNode) {\n\n    var expr = domAttr(showNode, 'data-show');\n    var fn = get(entry, expr);\n    if (fn) {\n      var scope = domClosest(showNode, '[data-scope]') || node;\n      var shouldShow = fn(current.element, node, showNode, scope) || false;\n      if (shouldShow) {\n        domClasses(showNode).remove(HIDE_CLASS);\n      } else {\n        domClasses(showNode).add(HIDE_CLASS);\n      }\n    }\n  });\n};\n\n/**\n * Evaluates a given function. If it returns true, then the\n * node is marked as \"disabled\".\n */\nPropertiesPanel.prototype.updateDisable = function(entry, node) {\n  var current = this._current;\n\n  if (!current) {\n    return;\n  }\n\n  var nodes = domQueryAll('[data-disable]', node) || [];\n\n  forEach(nodes, function(currentNode) {\n    var expr = domAttr(currentNode, 'data-disable');\n    var fn = get(entry, expr);\n    if (fn) {\n      var scope = domClosest(currentNode, '[data-scope]') || node;\n      var shouldDisable = fn(current.element, node, currentNode, scope) || false;\n      domAttr(currentNode, 'disabled', shouldDisable ? '' : null);\n    }\n  });\n};\n\nPropertiesPanel.prototype.executeAction = function(entry, entryNode, actionId, event) {\n  var current = this._current;\n\n  if (!current) {\n    return;\n  }\n\n  var fn = get(entry, actionId);\n  if (fn) {\n    var scopeNode = domClosest(event.target, '[data-scope]') || entryNode;\n    return fn.apply(entry, [ current.element, entryNode, event, scopeNode ]);\n  }\n};\n\n/**\n * Apply changes to the business object by executing a command\n */\nPropertiesPanel.prototype.applyChanges = function(entry, values, containerElement) {\n\n  var element = this._current.element;\n\n  // ensure we only update the model if we got dirty changes\n  if (valuesEqual(values, entry.oldValues)) {\n    return;\n  }\n\n  var command = entry.set(element, values, containerElement);\n\n  var commandToExecute;\n\n  if (isArray(command)) {\n    if (command.length) {\n      commandToExecute = {\n        cmd: 'properties-panel.multi-command-executor',\n        context: flattenDeep(command)\n      };\n    }\n  } else {\n    commandToExecute = command;\n  }\n\n  if (commandToExecute) {\n    this._commandStack.execute(commandToExecute.cmd, commandToExecute.context || { element : element });\n  } else {\n    this.update(element);\n  }\n};\n\n\n/**\n * apply validation errors in the DOM and show or remove an error message near the entry node.\n */\nPropertiesPanel.prototype.applyValidationErrors = function(validationErrors, entryNode) {\n\n  var valid = true;\n\n  var controlNodes = getFormControls(entryNode, true);\n\n  forEach(controlNodes, function(controlNode) {\n\n    var name = domAttr(controlNode, 'name') || domAttr(controlNode, 'data-name');\n\n    var error = validationErrors && validationErrors[name];\n\n    var errorMessageNode = domQuery('.bpp-error-message', controlNode.parentNode);\n\n    if (error) {\n      valid = false;\n\n      if (!errorMessageNode) {\n        errorMessageNode = domify('<div></div>');\n\n        domClasses(errorMessageNode).add('bpp-error-message');\n\n        // insert errorMessageNode after controlNode\n        controlNode.parentNode.insertBefore(errorMessageNode, controlNode.nextSibling);\n      }\n\n      errorMessageNode.textContent = error;\n\n      domClasses(controlNode).add('invalid');\n    } else {\n      domClasses(controlNode).remove('invalid');\n\n      if (errorMessageNode) {\n        controlNode.parentNode.removeChild(errorMessageNode);\n      }\n    }\n  });\n\n  return valid;\n};\n\n\n/**\n * Check if the entry contains valid input\n */\nPropertiesPanel.prototype.validate = function(entry, values, entryNode) {\n  var self = this;\n\n  var current = this._current;\n\n  var valid = true;\n\n  entryNode = entryNode || domQuery('[data-entry=\"' + entry.id + '\"]', current.panel);\n\n  if (values instanceof Array) {\n    var listContainer = domQuery('[data-list-entry-container]', entryNode),\n        listEntryNodes = listContainer.children || [];\n\n    // create new elements\n    for (var i = 0; i < values.length; i++) {\n      var listValue = values[i];\n\n      if (entry.validateListItem) {\n\n        var validationErrors = entry.validateListItem(current.element, listValue, entryNode, i),\n            listEntryNode = listEntryNodes[i];\n\n        valid = self.applyValidationErrors(validationErrors, listEntryNode) && valid;\n      }\n    }\n  } else {\n    if (entry.validate) {\n      this.validationErrors = entry.validate(current.element, values, entryNode);\n\n      valid = self.applyValidationErrors(this.validationErrors, entryNode) && valid;\n    }\n  }\n\n  return valid;\n};\n\nPropertiesPanel.prototype.getEntry = function(id) {\n  return this._current && this._current.entries[id];\n};\n\nvar flattenDeep = require('lodash/flattenDeep'),\n    keyBy = require('lodash/keyBy'),\n    map = require('lodash/map');\n\nPropertiesPanel.prototype._create = function(element, tabs) {\n\n  if (!element) {\n    return null;\n  }\n\n  var containerNode = this._container;\n\n  var panelNode = this._createPanel(element, tabs);\n\n  containerNode.appendChild(panelNode);\n\n  var entries = extractEntries(tabs);\n  var groups = extractGroups(tabs);\n\n  return {\n    tabs: tabs,\n    groups: groups,\n    entries: entries,\n    element: element,\n    panel: panelNode\n  };\n};\n\n/**\n * Update variable parts of the entry node on element changes.\n *\n * @param {djs.model.Base} element\n * @param {EntryDescriptor} entry\n * @param {Object} values\n * @param {HTMLElement} entryNode\n * @param {Number} idx\n */\nPropertiesPanel.prototype._bindTemplate = function(element, entry, values, entryNode, idx) {\n\n  var eventBus = this._eventBus;\n\n  function isPropertyEditable(entry, propertyName) {\n    return eventBus.fire('propertiesPanel.isPropertyEditable', {\n      entry: entry,\n      propertyName: propertyName,\n      element: element\n    });\n  }\n\n  var inputNodes = getPropertyPlaceholders(entryNode);\n\n  forEach(inputNodes, function(node) {\n\n    var name,\n        newValue,\n        editable;\n\n    // we deal with an input element\n    if ('value' in node || isContentEditable(node) === 'true') {\n      name = domAttr(node, 'name') || domAttr(node, 'data-name');\n      newValue = values[name];\n\n      editable = isPropertyEditable(entry, name);\n      if (editable && entry.editable) {\n        editable = entry.editable(element, entryNode, node, name, newValue, idx);\n      }\n\n      domAttr(node, 'readonly', editable ? null : '');\n      domAttr(node, 'disabled', editable ? null : '');\n\n      // take full control over setting the value\n      // and possibly updating the input in entry#setControlValue\n      if (entry.setControlValue) {\n        entry.setControlValue(element, entryNode, node, name, newValue, idx);\n      } else if (isToggle(node)) {\n        setToggleValue(node, newValue);\n      } else if (isSelect(node)) {\n        setSelectValue(node, newValue);\n      } else {\n        setInputValue(node, newValue);\n      }\n    }\n\n    // we deal with some non-editable html element\n    else {\n      name = domAttr(node, 'data-value');\n      newValue = values[name];\n      if (entry.setControlValue) {\n        entry.setControlValue(element, entryNode, node, name, newValue, idx);\n      } else {\n        setTextValue(node, newValue);\n      }\n    }\n  });\n};\n\n// TODO(nikku): WTF freaking name? Change / clarify.\nPropertiesPanel.prototype._updateActivation = function(current) {\n  var self = this;\n\n  var eventBus = this._eventBus;\n\n  var element = current.element;\n\n  function isEntryVisible(entry) {\n    return eventBus.fire('propertiesPanel.isEntryVisible', {\n      entry: entry,\n      element: element\n    });\n  }\n\n  function isGroupVisible(group, element, groupNode) {\n    if (typeof group.enabled === 'function') {\n      return group.enabled(element, groupNode);\n    } else {\n      return true;\n    }\n  }\n\n  function isTabVisible(tab, element) {\n    if (typeof tab.enabled === 'function') {\n      return tab.enabled(element);\n    } else {\n      return true;\n    }\n  }\n\n  function toggleVisible(node, visible) {\n    domClasses(node).toggle(HIDE_CLASS, !visible);\n  }\n\n  // check whether the active tab is visible\n  // if not: set the first tab as active tab\n  function checkActiveTabVisibility(node, visible) {\n    var isActive = domClasses(node).has('bpp-active');\n    if (!visible && isActive) {\n      self.activateTab(current.tabs[0]);\n    }\n  }\n\n  function updateLabel(element, selector, text) {\n    var labelNode = domQuery(selector, element);\n\n    if (!labelNode) {\n      return;\n    }\n\n    labelNode.textContent = text;\n  }\n\n  var panelNode = current.panel;\n\n  forEach(current.tabs, function(tab) {\n\n    var tabNode = domQuery('[data-tab=' + tab.id + ']', panelNode);\n    var tabLinkNode = domQuery('[data-tab-target=' + tab.id + ']', panelNode).parentNode;\n\n    var tabVisible = false;\n\n    forEach(tab.groups, function(group) {\n\n      var groupVisible = false;\n\n      var groupNode = domQuery('[data-group=' + group.id + ']', tabNode);\n\n      forEach(group.entries, function(entry) {\n\n        var entryNode = domQuery('[data-entry=\"' + entry.id + '\"]', groupNode);\n\n        var entryVisible = isEntryVisible(entry);\n\n        groupVisible = groupVisible || entryVisible;\n\n        toggleVisible(entryNode, entryVisible);\n\n        var values = 'get' in entry ? entry.get(element, entryNode) : {};\n\n        if (values instanceof Array) {\n          var listEntryContainer = domQuery('[data-list-entry-container]', entryNode);\n          var existingElements = listEntryContainer.children || [];\n\n          for (var i = 0; i < values.length; i++) {\n            var listValue = values[i];\n            var listItemNode = existingElements[i];\n            if (!listItemNode) {\n              listItemNode = domify(entry.createListEntryTemplate(listValue, i, listEntryContainer));\n              listEntryContainer.appendChild(listItemNode);\n            }\n            domAttr(listItemNode, 'data-index', i);\n\n            self._bindTemplate(element, entry, listValue, listItemNode, i);\n          }\n\n          var entriesToRemove = existingElements.length - values.length;\n\n          for (var j = 0; j < entriesToRemove; j++) {\n            // remove orphaned element\n            listEntryContainer.removeChild(listEntryContainer.lastChild);\n          }\n\n        } else {\n          self._bindTemplate(element, entry, values, entryNode);\n        }\n\n        // update conditionally visible elements\n        self.updateState(entry, entryNode);\n        self.validate(entry, values, entryNode);\n\n        // remember initial state for later dirty checking\n        entry.oldValues = getFormControlValues(entryNode);\n      });\n\n      if (typeof group.label === 'function') {\n        updateLabel(groupNode, '.group-label', group.label(element, groupNode));\n      }\n\n      groupVisible = groupVisible && isGroupVisible(group, element, groupNode);\n\n      tabVisible = tabVisible || groupVisible;\n\n      toggleVisible(groupNode, groupVisible);\n    });\n\n    tabVisible = tabVisible && isTabVisible(tab, element);\n\n    toggleVisible(tabNode, tabVisible);\n    toggleVisible(tabLinkNode, tabVisible);\n\n    checkActiveTabVisibility(tabNode, tabVisible);\n  });\n\n  // inject elements id into header\n  updateLabel(panelNode, '[data-label-id]', getBusinessObject(element).id || '');\n};\n\nPropertiesPanel.prototype._createPanel = function(element, tabs) {\n  var self = this;\n\n  var panelNode = domify('<div class=\"bpp-properties\"></div>'),\n      headerNode = domify('<div class=\"bpp-properties-header\">' +\n        '<div class=\"label\" data-label-id></div>' +\n        '<div class=\"search\">' +\n          '<input type=\"search\" placeholder=\"Search for property\" />' +\n          '<button><span>Search</span></button>' +\n        '</div>' +\n      '</div>'),\n      tabBarNode = domify('<div class=\"bpp-properties-tab-bar\"></div>'),\n      tabLinksNode = domify('<ul class=\"bpp-properties-tabs-links\"></ul>'),\n      tabContainerNode = domify('<div class=\"bpp-properties-tabs-container\"></div>');\n\n  panelNode.appendChild(headerNode);\n\n  forEach(tabs, function(tab, tabIndex) {\n\n    if (!tab.id) {\n      throw new Error('tab must have an id');\n    }\n\n    var tabNode = domify('<div class=\"bpp-properties-tab\" data-tab=\"' + escapeHTML(tab.id) + '\"></div>'),\n        tabLinkNode = domify('<li class=\"bpp-properties-tab-link\">' +\n          '<a href data-tab-target=\"' + escapeHTML(tab.id) + '\">' + escapeHTML(tab.label) + '</a>' +\n        '</li>');\n\n    var groups = tab.groups;\n\n    forEach(groups, function(group) {\n\n      if (!group.id) {\n        throw new Error('group must have an id');\n      }\n\n      var groupNode = domify('<div class=\"bpp-properties-group\" data-group=\"' + escapeHTML(group.id) + '\">' +\n          '<span class=\"group-toggle\"></span>' +\n          '<span class=\"group-label\">' + escapeHTML(group.label) + '</span>' +\n        '</div>');\n\n      // TODO(nre): use event delegation to handle that...\n      groupNode.querySelector('.group-toggle').addEventListener('click', function(evt) {\n        domClasses(groupNode).toggle('group-closed');\n        evt.preventDefault();\n        evt.stopPropagation();\n      });\n      groupNode.addEventListener('click', function(evt) {\n        if (!evt.defaultPrevented && domClasses(groupNode).has('group-closed')) {\n          domClasses(groupNode).remove('group-closed');\n        }\n      });\n\n      forEach(group.entries, function(entry) {\n\n        if (!entry.id) {\n          throw new Error('entry must have an id');\n        }\n\n        var html = entry.html;\n\n        if (typeof html === 'string') {\n          html = domify(html);\n        }\n\n        // unwrap jquery\n        if (html.get && html.constructor.prototype.jquery) {\n          html = html.get(0);\n        }\n\n        var entryNode = domify('<div class=\"bpp-properties-entry\" data-entry=\"' + escapeHTML(entry.id) + '\"></div>');\n\n        forEach(entry.cssClasses || [], function(cssClass) {\n          domClasses(entryNode).add(cssClass);\n        });\n\n        entryNode.appendChild(html);\n\n        groupNode.appendChild(entryNode);\n\n        // update conditionally visible elements\n        self.updateState(entry, entryNode);\n      });\n\n      tabNode.appendChild(groupNode);\n    });\n\n    tabLinksNode.appendChild(tabLinkNode);\n    tabContainerNode.appendChild(tabNode);\n  });\n\n  tabBarNode.appendChild(tabLinksNode);\n\n  panelNode.appendChild(tabBarNode);\n  panelNode.appendChild(tabContainerNode);\n\n  return panelNode;\n};\n\n\n\nfunction setInputValue(node, value) {\n\n  var contentEditable = isContentEditable(node);\n\n  var oldValue = contentEditable ? node.innerText : node.value;\n\n  var selection;\n\n  // prevents input fields from having the value 'undefined'\n  if (value === undefined) {\n    value = '';\n  }\n\n  if (oldValue === value) {\n    return;\n  }\n\n  // update selection on undo/redo\n  if (document.activeElement === node) {\n    selection = updateSelection(getSelection(node), oldValue, value);\n  }\n\n  if (contentEditable) {\n    node.innerText = value;\n  } else {\n    node.value = value;\n  }\n\n  if (selection) {\n    setSelection(node, selection);\n  }\n}\n\nfunction setSelectValue(node, value) {\n  if (value !== undefined) {\n    node.value = value;\n  }\n}\n\nfunction setToggleValue(node, value) {\n  var nodeValue = node.value;\n\n  node.checked = (value === nodeValue) || (!domAttr(node, 'value') && value);\n}\n\nfunction setTextValue(node, value) {\n  node.textContent = value;\n}\n\nfunction getSelection(node) {\n\n  return isContentEditable(node) ? getContentEditableSelection(node) : {\n    start: node.selectionStart,\n    end: node.selectionEnd\n  };\n}\n\nfunction getContentEditableSelection(node) {\n\n  var selection = window.getSelection();\n\n  var focusNode = selection.focusNode,\n      focusOffset = selection.focusOffset,\n      anchorOffset = selection.anchorOffset;\n\n  if (!focusNode) {\n    throw new Error('not selected');\n  }\n\n  // verify we have selection on the current element\n  if (!node.contains(focusNode)) {\n    throw new Error('not selected');\n  }\n\n  return {\n    start: Math.min(focusOffset, anchorOffset),\n    end: Math.max(focusOffset, anchorOffset)\n  };\n}\n\nfunction setSelection(node, selection) {\n\n  if (isContentEditable(node)) {\n    setContentEditableSelection(node, selection);\n  } else {\n    node.selectionStart = selection.start;\n    node.selectionEnd = selection.end;\n  }\n}\n\nfunction setContentEditableSelection(node, selection) {\n\n  var focusNode,\n      domRange,\n      domSelection;\n\n  focusNode = node.firstChild || node,\n  domRange = document.createRange();\n  domRange.setStart(focusNode, selection.start);\n  domRange.setEnd(focusNode, selection.end);\n\n  domSelection = window.getSelection();\n  domSelection.removeAllRanges();\n  domSelection.addRange(domRange);\n}\n\nfunction isImplicitRoot(element) {\n  return element.id === '__implicitroot';\n}\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nmodule.exports = stubArray;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","const disallowNodeType = require('./helper').disallowNodeType;\n\nmodule.exports = disallowNodeType('bpmn:InclusiveGateway');","'use strict';\n\nvar forEach = require('lodash/forEach');\n\n/**\n * A handler that combines and executes multiple commands.\n *\n * All updates are bundled on the command stack and executed in one step.\n * This also makes it possible to revert the changes in one step.\n *\n * Example use case: remove the camunda:formKey attribute and in addition\n * add all form fields needed for the camunda:formData property.\n *\n * @class\n * @constructor\n */\nfunction MultiCommandHandler(commandStack) {\n  this._commandStack = commandStack;\n}\n\nMultiCommandHandler.$inject = [ 'commandStack' ];\n\nmodule.exports = MultiCommandHandler;\n\nMultiCommandHandler.prototype.preExecute = function(context) {\n\n  var commandStack = this._commandStack;\n\n  forEach(context, function(command) {\n    commandStack.execute(command.cmd, command.context);\n  });\n};","const {\n  is,\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks for the presence of a start event per scope.\n */\nmodule.exports = function() {\n\n  function hasStartEvent(node) {\n    const flowElements = node.flowElements || [];\n\n    return (\n      flowElements.some(node => is(node, 'bpmn:StartEvent'))\n    );\n  }\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Process',\n      'bpmn:SubProcess'\n    ])) {\n      return;\n    }\n\n    if (!hasStartEvent(node)) {\n      const type = is(node, 'bpmn:SubProcess') ? 'Sub process' : 'Process';\n\n      reporter.report(node.id, type + ' is missing start event');\n    }\n  }\n\n  return { check };\n};\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    forEach = require('lodash/forEach');\n\nvar EventDefinitionHelper = {};\n\nmodule.exports = EventDefinitionHelper;\n\nEventDefinitionHelper.getEventDefinition = function(element, eventType) {\n\n  var bo = getBusinessObject(element),\n      eventDefinition = null;\n\n  if (bo.eventDefinitions) {\n    forEach(bo.eventDefinitions, function(event) {\n      if (is(event, eventType)) {\n        eventDefinition = event;\n      }\n    });\n  }\n\n  return eventDefinition;\n};\n\nEventDefinitionHelper.getTimerEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:TimerEventDefinition');\n};\n\nEventDefinitionHelper.getMessageEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:MessageEventDefinition');\n};\n\nEventDefinitionHelper.getSignalEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:SignalEventDefinition');\n};\n\nEventDefinitionHelper.getErrorEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:ErrorEventDefinition');\n};\n\nEventDefinitionHelper.getEscalationEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:EscalationEventDefinition');\n};\n\nEventDefinitionHelper.getCompensateEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:CompensateEventDefinition');\n};\n\nEventDefinitionHelper.getLinkEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:LinkEventDefinition');\n};\n\nEventDefinitionHelper.getConditionalEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:ConditionalEventDefinition');\n};\n","var MapCache = require('./_MapCache'),\n    setCacheAdd = require('./_setCacheAdd'),\n    setCacheHas = require('./_setCacheHas');\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nmodule.exports = SetCache;\n","/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nmodule.exports = baseIsNaN;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","/** Used to match wrap detail comments. */\nvar reWrapComment = /\\{(?:\\n\\/\\* \\[wrapped with .+\\] \\*\\/)?\\n?/;\n\n/**\n * Inserts wrapper `details` in a comment at the top of the `source` body.\n *\n * @private\n * @param {string} source The source to modify.\n * @returns {Array} details The details to insert.\n * @returns {string} Returns the modified source.\n */\nfunction insertWrapDetails(source, details) {\n  var length = details.length;\n  if (!length) {\n    return source;\n  }\n  var lastIndex = length - 1;\n  details[lastIndex] = (length > 1 ? '& ' : '') + details[lastIndex];\n  details = details.join(length > 2 ? ', ' : ' ');\n  return source.replace(reWrapComment, '{\\n/* [wrapped with ' + details + '] */\\n');\n}\n\nmodule.exports = insertWrapDetails;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nmodule.exports = setCacheHas;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var isArrayLike = require('./isArrayLike'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nmodule.exports = isArrayLikeObject;\n","var assignValue = require('./_assignValue'),\n    copyObject = require('./_copyObject'),\n    createAssigner = require('./_createAssigner'),\n    isArrayLike = require('./isArrayLike'),\n    isPrototype = require('./_isPrototype'),\n    keys = require('./keys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns own enumerable string keyed properties of source objects to the\n * destination object. Source objects are applied from left to right.\n * Subsequent sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object` and is loosely based on\n * [`Object.assign`](https://mdn.io/Object/assign).\n *\n * @static\n * @memberOf _\n * @since 0.10.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.assignIn\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * function Bar() {\n *   this.c = 3;\n * }\n *\n * Foo.prototype.b = 2;\n * Bar.prototype.d = 4;\n *\n * _.assign({ 'a': 0 }, new Foo, new Bar);\n * // => { 'a': 1, 'c': 3 }\n */\nvar assign = createAssigner(function(object, source) {\n  if (isPrototype(source) || isArrayLike(source)) {\n    copyObject(source, keys(source), object);\n    return;\n  }\n  for (var key in source) {\n    if (hasOwnProperty.call(source, key)) {\n      assignValue(object, key, source[key]);\n    }\n  }\n});\n\nmodule.exports = assign;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    cmdHelper = require('./CmdHelper');\n\n\nvar ParticipantHelper = {};\n\nmodule.exports = ParticipantHelper;\n\nParticipantHelper.modifyProcessBusinessObject = function(element, property, values) {\n  if (!is(element, 'bpmn:Participant')) {\n    return {};\n  }\n\n  var bo = getBusinessObject(element).get('processRef'),\n      properties = {};\n\n  properties[property] = values[property];\n\n  return cmdHelper.updateBusinessObject(element, bo, properties);\n};\n\nParticipantHelper.getProcessBusinessObject = function(element, propertyName) {\n  if (!is(element, 'bpmn:Participant')) {\n    return {};\n  }\n\n  var bo = getBusinessObject(element).get('processRef'),\n      properties = {};\n\n  properties[propertyName] = bo.get(propertyName);\n\n  return properties;\n};","var arrayMap = require('./_arrayMap'),\n    baseIteratee = require('./_baseIteratee'),\n    baseMap = require('./_baseMap'),\n    isArray = require('./isArray');\n\n/**\n * Creates an array of values by running each element in `collection` thru\n * `iteratee`. The iteratee is invoked with three arguments:\n * (value, index|key, collection).\n *\n * Many lodash methods are guarded to work as iteratees for methods like\n * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n *\n * The guarded methods are:\n * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * _.map([4, 8], square);\n * // => [16, 64]\n *\n * _.map({ 'a': 4, 'b': 8 }, square);\n * // => [16, 64] (iteration order is not guaranteed)\n *\n * var users = [\n *   { 'user': 'barney' },\n *   { 'user': 'fred' }\n * ];\n *\n * // The `_.property` iteratee shorthand.\n * _.map(users, 'user');\n * // => ['barney', 'fred']\n */\nfunction map(collection, iteratee) {\n  var func = isArray(collection) ? arrayMap : baseMap;\n  return func(collection, baseIteratee(iteratee, 3));\n}\n\nmodule.exports = map;\n","var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar ArrayIteratorMethods = require('../modules/es.array.iterator');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar ArrayValues = ArrayIteratorMethods.values;\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  var Collection = global[COLLECTION_NAME];\n  var CollectionPrototype = Collection && Collection.prototype;\n  if (CollectionPrototype) {\n    // some Chrome versions have non-configurable methods on DOMTokenList\n    if (CollectionPrototype[ITERATOR] !== ArrayValues) try {\n      createNonEnumerableProperty(CollectionPrototype, ITERATOR, ArrayValues);\n    } catch (error) {\n      CollectionPrototype[ITERATOR] = ArrayValues;\n    }\n    if (!CollectionPrototype[TO_STRING_TAG]) {\n      createNonEnumerableProperty(CollectionPrototype, TO_STRING_TAG, COLLECTION_NAME);\n    }\n    if (DOMIterables[COLLECTION_NAME]) for (var METHOD_NAME in ArrayIteratorMethods) {\n      // some Chrome versions have non-configurable methods on DOMTokenList\n      if (CollectionPrototype[METHOD_NAME] !== ArrayIteratorMethods[METHOD_NAME]) try {\n        createNonEnumerableProperty(CollectionPrototype, METHOD_NAME, ArrayIteratorMethods[METHOD_NAME]);\n      } catch (error) {\n        CollectionPrototype[METHOD_NAME] = ArrayIteratorMethods[METHOD_NAME];\n      }\n    }\n  }\n}\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar domify = require('min-dom').domify;\n\nvar forEach = require('lodash/forEach');\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar isList = function(list) {\n  return !(!list || Object.prototype.toString.call(list) !== '[object Array]');\n};\n\nvar addEmptyParameter = function(list) {\n  return list.concat([ { name: '', value: '' } ]);\n};\n\nvar createOption = function(option) {\n  return '<option value=\"' + option.value + '\">' + option.name + '</option>';\n};\n\n/**\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {string} [options.label]\n * @param  {Array<Object>} options.selectOptions\n * @param  {string} options.modelProperty\n * @param  {boolean} options.emptyParameter\n * @param  {function} options.disabled\n * @param  {function} options.hidden\n * @param  {Object} defaultParameters\n *\n * @return {Object}\n */\nvar selectbox = function(options, defaultParameters) {\n  var resource = defaultParameters,\n      label = options.label || resource.id,\n      selectOptions = options.selectOptions || [ { name: '', value: '' } ],\n      modelProperty = options.modelProperty,\n      emptyParameter = options.emptyParameter,\n      canBeDisabled = !!options.disabled && typeof options.disabled === 'function',\n      canBeHidden = !!options.hidden && typeof options.hidden === 'function',\n      description = options.description;\n\n\n  if (emptyParameter) {\n    selectOptions = addEmptyParameter(selectOptions);\n  }\n\n\n  resource.html =\n    '<label for=\"camunda-' + escapeHTML(resource.id) + '\"' +\n    (canBeDisabled ? 'data-disable=\"isDisabled\" ' : '') +\n    (canBeHidden ? 'data-show=\"isHidden\" ' : '') +\n    '>' + escapeHTML(label) + '</label>' +\n    '<select id=\"camunda-' + escapeHTML(resource.id) + '-select\" name=\"' +\n    escapeHTML(modelProperty) + '\"' +\n    (canBeDisabled ? 'data-disable=\"isDisabled\" ' : '') +\n    (canBeHidden ? 'data-show=\"isHidden\" ' : '') +\n    ' data-value>';\n\n  if (isList(selectOptions)) {\n    forEach(selectOptions, function(option) {\n      resource.html += '<option value=\"' + escapeHTML(option.value) + '\">' +\n      (option.name ? escapeHTML(option.name) : '') + '</option>';\n    });\n  }\n\n  resource.html += '</select>';\n\n  // add description below select box entry field\n  if (description && typeof options.showCustomInput !== 'function') {\n    resource.html += entryFieldDescription(description);\n  }\n\n  /**\n   * Fill the select box options dynamically.\n   *\n   * Calls the defined function #selectOptions in the entry to get the\n   * values for the options and set the value to the inputNode.\n   *\n   * @param {djs.model.Base} element\n   * @param {HTMLElement} entryNode\n   * @param {EntryDescriptor} inputNode\n   * @param {Object} inputName\n   * @param {Object} newValue\n   */\n  resource.setControlValue = function(element, entryNode, inputNode, inputName, newValue) {\n    if (typeof selectOptions === 'function') {\n\n      var options = selectOptions(element, inputNode);\n\n      if (options) {\n\n        // remove existing options\n        while (inputNode.firstChild) {\n          inputNode.removeChild(inputNode.firstChild);\n        }\n\n        // add options\n        forEach(options, function(option) {\n          var template = domify(createOption(option));\n\n          inputNode.appendChild(template);\n        });\n\n\n      }\n    }\n\n    // set select value\n    if (newValue !== undefined) {\n      inputNode.value = newValue;\n    }\n\n  };\n\n  if (canBeDisabled) {\n    resource.isDisabled = function() {\n      return options.disabled.apply(resource, arguments);\n    };\n  }\n\n  if (canBeHidden) {\n    resource.isHidden = function() {\n      return !options.hidden.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['bpp-dropdown'];\n\n  return resource;\n};\n\nmodule.exports = selectbox;\n","'use strict';\n\nvar reduce = require('lodash/transform'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    keys = require('lodash/keys'),\n    forEach = require('lodash/forEach');\n\n/**\n * A handler that implements a BPMN 2.0 property update\n * for business objects which are not represented in the\n * diagram.\n *\n * This is useful in the context of the properties panel in\n * order to update child elements of elements visible in\n * the diagram.\n *\n * Example: perform an update of a specific event definition\n * of an intermediate event.\n *\n * @class\n * @constructor\n */\nfunction UpdateBusinessObjectHandler(elementRegistry) {\n  this._elementRegistry = elementRegistry;\n}\n\nUpdateBusinessObjectHandler.$inject = [ 'elementRegistry' ];\n\nmodule.exports = UpdateBusinessObjectHandler;\n\n/**\n * returns the root element\n */\nfunction getRoot(businessObject) {\n  var parent = businessObject;\n  while (parent.$parent) {\n    parent = parent.$parent;\n  }\n  return parent;\n}\n\nfunction getProperties(businessObject, propertyNames) {\n  return reduce(propertyNames, function(result, key) {\n    result[key] = businessObject.get(key);\n    return result;\n  }, {});\n}\n\n\nfunction setProperties(businessObject, properties) {\n  forEach(properties, function(value, key) {\n    businessObject.set(key, value);\n  });\n}\n\n\n// api /////////////////////////////////////////////\n\n/**\n * Updates a business object with a list of new properties\n *\n * @method  UpdateBusinessObjectHandler#execute\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element the element which has a child business object updated\n * @param {moddle.businessObject} context.businessObject the businessObject to update\n * @param {Object} context.properties a list of properties to set on the businessObject\n *\n * @return {Array<djs.mode.Base>} the updated element\n */\nUpdateBusinessObjectHandler.prototype.execute = function(context) {\n\n  var element = context.element,\n      businessObject = context.businessObject,\n      rootElements = getRoot(businessObject).rootElements,\n      referenceType = context.referenceType,\n      referenceProperty = context.referenceProperty,\n      changed = [ element ]; // this will not change any diagram-js elements\n\n  if (!element) {\n    throw new Error('element required');\n  }\n\n  if (!businessObject) {\n    throw new Error('businessObject required');\n  }\n\n  var properties = context.properties,\n      oldProperties = context.oldProperties || getProperties(businessObject, keys(properties));\n\n  // check if there the update needs an external element for reference\n  if (typeof referenceType !== 'undefined' && typeof referenceProperty !== 'undefined') {\n    forEach(rootElements, function(rootElement) {\n      if (is(rootElement, referenceType)) {\n        if (rootElement.id === properties[referenceProperty]) {\n          properties[referenceProperty] = rootElement;\n        }\n      }\n    });\n  }\n\n  // update properties\n  setProperties(businessObject, properties);\n\n  // store old values\n  context.oldProperties = oldProperties;\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update\n *\n * @method  UpdateBusinessObjectHandler#revert\n *\n * @param {Object} context\n *\n * @return {djs.mode.Base} the updated element\n */\nUpdateBusinessObjectHandler.prototype.revert = function(context) {\n\n  var oldProperties = context.oldProperties,\n      businessObject = context.businessObject;\n\n  // update properties\n  setProperties(businessObject, oldProperties);\n\n  return context.changed;\n};\n","'use strict';\n\nvar ModelUtil = require('bpmn-js/lib/util/ModelUtil'),\n    is = ModelUtil.is,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar eventDefinitionHelper = require('./EventDefinitionHelper');\nvar extensionsElementHelper = require('./ExtensionElementsHelper');\n\nvar ImplementationTypeHelper = {};\n\nmodule.exports = ImplementationTypeHelper;\n\n/**\n * Returns 'true' if the given element is 'camunda:ServiceTaskLike'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isServiceTaskLike = function(element) {\n  return is(element, 'camunda:ServiceTaskLike');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:DmnCapable'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isDmnCapable = function(element) {\n  return is(element, 'camunda:DmnCapable');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:ExternalCapable'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isExternalCapable = function(element) {\n  return is(element, 'camunda:ExternalCapable');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:TaskListener'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isTaskListener = function(element) {\n  return is(element, 'camunda:TaskListener');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:ExecutionListener'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isExecutionListener = function(element) {\n  return is(element, 'camunda:ExecutionListener');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:ExecutionListener' or\n * 'camunda:TaskListener'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isListener = function(element) {\n  return this.isTaskListener(element) || this.isExecutionListener(element);\n};\n\n/**\n * Returns 'true' if the given element is 'bpmn:SequenceFlow'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isSequenceFlow = function(element) {\n  return is(element, 'bpmn:SequenceFlow');\n};\n\n/**\n * Get a 'camunda:ServiceTaskLike' business object.\n *\n * If the given element is not a 'camunda:ServiceTaskLike', then 'false'\n * is returned.\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement} the 'camunda:ServiceTaskLike' business object\n */\nImplementationTypeHelper.getServiceTaskLikeBusinessObject = function(element) {\n\n  if (is(element, 'bpmn:IntermediateThrowEvent') || is(element, 'bpmn:EndEvent')) {\n\n    // change business object to 'messageEventDefinition' when\n    // the element is a message intermediate throw event or message end event\n    // because the camunda extensions (e.g. camunda:class) are in the message\n    // event definition tag and not in the intermediate throw event or end event tag\n    var messageEventDefinition = eventDefinitionHelper.getMessageEventDefinition(element);\n    if (messageEventDefinition) {\n      element = messageEventDefinition;\n    }\n  }\n\n  return this.isServiceTaskLike(element) && getBusinessObject(element);\n\n};\n\n/**\n * Returns the implementation type of the given element.\n *\n * Possible implementation types are:\n * - dmn\n * - connector\n * - external\n * - class\n * - expression\n * - delegateExpression\n * - script\n * - or undefined, when no matching implementation type is found\n *\n * @param  {djs.model.Base} element\n *\n * @return {String} the implementation type\n */\nImplementationTypeHelper.getImplementationType = function(element) {\n\n  var bo = this.getServiceTaskLikeBusinessObject(element);\n\n  if (!bo) {\n    if (this.isListener(element)) {\n      bo = element;\n    } else {\n      return;\n    }\n  }\n\n  if (this.isDmnCapable(bo)) {\n    var decisionRef = bo.get('camunda:decisionRef');\n    if (typeof decisionRef !== 'undefined') {\n      return 'dmn';\n    }\n  }\n\n  if (this.isServiceTaskLike(bo)) {\n    var connectors = extensionsElementHelper.getExtensionElements(bo, 'camunda:Connector');\n    if (typeof connectors !== 'undefined') {\n      return 'connector';\n    }\n  }\n\n  if (this.isExternalCapable(bo)) {\n    var type = bo.get('camunda:type');\n    if (type === 'external') {\n      return 'external';\n    }\n  }\n\n  var cls = bo.get('camunda:class');\n  if (typeof cls !== 'undefined') {\n    return 'class';\n  }\n\n  var expression = bo.get('camunda:expression');\n  if (typeof expression !== 'undefined') {\n    return 'expression';\n  }\n\n  var delegateExpression = bo.get('camunda:delegateExpression');\n  if (typeof delegateExpression !== 'undefined') {\n    return 'delegateExpression';\n  }\n\n  if (this.isListener(bo)) {\n    var script = bo.get('script');\n    if (typeof script !== 'undefined') {\n      return 'script';\n    }\n  }\n\n};\n","var hashClear = require('./_hashClear'),\n    hashDelete = require('./_hashDelete'),\n    hashGet = require('./_hashGet'),\n    hashHas = require('./_hashHas'),\n    hashSet = require('./_hashSet');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nmodule.exports = Hash;\n","var castPath = require('./_castPath'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isIndex = require('./_isIndex'),\n    isLength = require('./isLength'),\n    toKey = require('./_toKey');\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nmodule.exports = hasPath;\n","var isArray = require('./isArray'),\n    isKey = require('./_isKey'),\n    stringToPath = require('./_stringToPath'),\n    toString = require('./toString');\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nmodule.exports = castPath;\n","'use strict';\n\nvar assign = require('lodash/assign');\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar asyncCapableHelper = require('../../../../helper/AsyncCapableHelper'),\n    eventDefinitionHelper = require('../../../../helper/EventDefinitionHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nfunction isAsyncBefore(bo) {\n  return asyncCapableHelper.isAsyncBefore(bo);\n}\n\nfunction isAsyncAfter(bo) {\n  return asyncCapableHelper.isAsyncAfter(bo);\n}\n\nfunction isExclusive(bo) {\n  return asyncCapableHelper.isExclusive(bo);\n}\n\nfunction removeFailedJobRetryTimeCycle(bo, element) {\n  return asyncCapableHelper.removeFailedJobRetryTimeCycle(bo, element);\n}\n\nfunction canRemoveFailedJobRetryTimeCycle(element) {\n  return !eventDefinitionHelper.getTimerEventDefinition(element);\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var idPrefix = options.idPrefix || '',\n      labelPrefix = options.labelPrefix || '';\n\n\n  var asyncBeforeEntry = entryFactory.checkbox({\n    id: idPrefix + 'asyncBefore',\n    label: labelPrefix + translate('Asynchronous Before'),\n    modelProperty: 'asyncBefore',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        asyncBefore: isAsyncBefore(bo)\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      var asyncBefore = !!values.asyncBefore;\n\n      var props = {\n        'camunda:asyncBefore': asyncBefore,\n        'camunda:async': false\n      };\n\n      var commands = [];\n      if (!isAsyncAfter(bo) && !asyncBefore) {\n        props = assign({ 'camunda:exclusive' : true }, props);\n        if (canRemoveFailedJobRetryTimeCycle(element)) {\n          commands.push(removeFailedJobRetryTimeCycle(bo, element));\n        }\n      }\n\n      commands.push(cmdHelper.updateBusinessObject(element, bo, props));\n      return commands;\n    }\n  });\n\n\n  var asyncAfterEntry = entryFactory.checkbox({\n    id: idPrefix + 'asyncAfter',\n    label: labelPrefix + translate('Asynchronous After'),\n    modelProperty: 'asyncAfter',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        asyncAfter: isAsyncAfter(bo)\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      var asyncAfter = !!values.asyncAfter;\n\n      var props = {\n        'camunda:asyncAfter': asyncAfter\n      };\n\n      var commands = [];\n      if (!isAsyncBefore(bo) && !asyncAfter) {\n        props = assign({ 'camunda:exclusive' : true }, props);\n        if (canRemoveFailedJobRetryTimeCycle(element)) {\n          commands.push(removeFailedJobRetryTimeCycle(bo, element));\n        }\n      }\n\n      commands.push(cmdHelper.updateBusinessObject(element, bo, props));\n      return commands;\n    }\n  });\n\n\n  var exclusiveEntry = entryFactory.checkbox({\n    id: idPrefix + 'exclusive',\n    label: labelPrefix + translate('Exclusive'),\n    modelProperty: 'exclusive',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return { exclusive: isExclusive(bo) };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, { 'camunda:exclusive': !!values.exclusive });\n    },\n\n    hidden: function(element) {\n      var bo = getBusinessObject(element);\n      return bo && !isAsyncAfter(bo) && !isAsyncBefore(bo);\n    }\n  });\n\n  return [ asyncBeforeEntry, asyncAfterEntry, exclusiveEntry ];\n};\n","const Linter = require('./linter');\n\nmodule.exports = {\n  Linter\n};","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isAny = require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny;\n\nvar find = require('lodash/find');\n\n\nvar TEMPLATE_ATTR = 'camunda:modelerTemplate';\n\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template is stored.\n *\n * @type {String}\n */\nmodule.exports.TEMPLATE_ATTR = TEMPLATE_ATTR;\n\n\n/**\n * Get template id for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\nfunction getTemplateId(element) {\n\n  var bo = getBusinessObject(element);\n\n  if (bo) {\n    return bo.get(TEMPLATE_ATTR);\n  }\n}\n\nmodule.exports.getTemplateId = getTemplateId;\n\n\n/**\n * Get template of a given element.\n *\n * @param {Element} element\n * @param {ElementTemplates} elementTemplates\n *\n * @return {TemplateDefinition}\n */\nfunction getTemplate(element, elementTemplates) {\n  var id = getTemplateId(element);\n\n  return id && elementTemplates.get(id);\n}\n\nmodule.exports.getTemplate = getTemplate;\n\n/**\n * Get default template for a given element.\n *\n * @param {Element} element\n * @param {ElementTemplates} elementTemplates\n *\n * @return {TemplateDefinition}\n */\nfunction getDefaultTemplate(element, elementTemplates) {\n\n  // return first default template, if any exists\n  return (\n    elementTemplates.getAll().filter(function(t) {\n      return isAny(element, t.appliesTo) && t.isDefault;\n    })\n  )[0];\n}\n\nmodule.exports.getDefaultTemplate = getDefaultTemplate;\n\n\n/**\n * Find extension with given type in\n * BPMN element, diagram element or ExtensionElement.\n *\n * @param {ModdleElement|djs.model.Base} element\n * @param {String} type\n *\n * @return {ModdleElement} the extension\n */\nfunction findExtension(element, type) {\n  var bo = getBusinessObject(element);\n\n  var extensionElements;\n\n  if (is(bo, 'bpmn:ExtensionElements')) {\n    extensionElements = bo;\n  } else {\n    extensionElements = bo.extensionElements;\n  }\n\n  if (!extensionElements) {\n    return null;\n  }\n\n  return find(extensionElements.get('values'), function(e) {\n    return is(e, type);\n  });\n}\n\nmodule.exports.findExtension = findExtension;\n\n\nfunction findExtensions(element, types) {\n  var extensionElements = getExtensionElements(element);\n\n  if (!extensionElements) {\n    return [];\n  }\n\n  return extensionElements.get('values').filter(function(e) {\n    return isAny(e, types);\n  });\n}\n\nmodule.exports.findExtensions = findExtensions;\n\n\nfunction findCamundaInOut(element, binding) {\n\n  var extensionElements = getExtensionElements(element);\n\n  if (!extensionElements) {\n    return;\n  }\n\n  var matcher;\n\n  if (binding.type === 'camunda:in') {\n    matcher = function(e) {\n      return is(e, 'camunda:In') && isInOut(e, binding);\n    };\n  } else\n  if (binding.type === 'camunda:out') {\n    matcher = function(e) {\n      return is(e, 'camunda:Out') && isInOut(e, binding);\n    };\n  } else\n  if (binding.type === 'camunda:in:businessKey') {\n    matcher = function(e) {\n      return is(e, 'camunda:In') && 'businessKey' in e;\n    };\n  }\n\n  return find(extensionElements.get('values'), matcher);\n}\n\nmodule.exports.findCamundaInOut = findCamundaInOut;\n\nfunction findCamundaProperty(camundaProperties, binding) {\n  return find(camundaProperties.get('values'), function(p) {\n    return p.name === binding.name;\n  });\n}\n\nmodule.exports.findCamundaProperty = findCamundaProperty;\n\n\nfunction findInputParameter(inputOutput, binding) {\n  var parameters = inputOutput.get('inputParameters');\n\n  return find(parameters, function(p) {\n    return p.name === binding.name;\n  });\n}\n\nmodule.exports.findInputParameter = findInputParameter;\n\n\nfunction findOutputParameter(inputOutput, binding) {\n  var parameters = inputOutput.get('outputParameters');\n\n  return find(parameters, function(p) {\n    var value = p.value;\n\n    if (!binding.scriptFormat) {\n      return value === binding.source;\n    }\n\n    var definition = p.definition;\n\n    if (!definition || binding.scriptFormat !== definition.scriptFormat) {\n      return false;\n    }\n\n    return definition.value === binding.source;\n  });\n}\n\nmodule.exports.findOutputParameter = findOutputParameter;\n\n\n\n// helpers /////////////////////////////////\n\nfunction getExtensionElements(element) {\n  var bo = getBusinessObject(element);\n\n  if (is(bo, 'bpmn:ExtensionElements')) {\n    return bo;\n  } else {\n    return bo.extensionElements;\n  }\n}\n\n\nfunction isInOut(element, binding) {\n\n  if (binding.type === 'camunda:in') {\n    // find based on target attribute\n    if (binding.target) {\n      return element.target === binding.target;\n    }\n  }\n\n  if (binding.type === 'camunda:out') {\n    // find based on source / sourceExpression\n    if (binding.source) {\n      return element.source === binding.source;\n    }\n\n    if (binding.sourceExpression) {\n      return element.sourceExpression === binding.sourceExpression;\n    }\n  }\n\n  // find based variables / local combination\n  if (binding.variables) {\n    return element.variables === 'all' && (\n      binding.variables !== 'local' || element.local\n    );\n  }\n}\n","var MapCache = require('./_MapCache');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nmodule.exports = memoize;\n","var baseGet = require('./_baseGet');\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nmodule.exports = basePropertyDeep;\n","var isLaziable = require('./_isLaziable'),\n    setData = require('./_setData'),\n    setWrapToString = require('./_setWrapToString');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_BOUND_FLAG = 4,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_PARTIAL_FLAG = 32,\n    WRAP_PARTIAL_RIGHT_FLAG = 64;\n\n/**\n * Creates a function that wraps `func` to continue currying.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {Function} wrapFunc The function to create the `func` wrapper.\n * @param {*} placeholder The placeholder value.\n * @param {*} [thisArg] The `this` binding of `func`.\n * @param {Array} [partials] The arguments to prepend to those provided to\n *  the new function.\n * @param {Array} [holders] The `partials` placeholder indexes.\n * @param {Array} [argPos] The argument positions of the new function.\n * @param {number} [ary] The arity cap of `func`.\n * @param {number} [arity] The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createRecurry(func, bitmask, wrapFunc, placeholder, thisArg, partials, holders, argPos, ary, arity) {\n  var isCurry = bitmask & WRAP_CURRY_FLAG,\n      newHolders = isCurry ? holders : undefined,\n      newHoldersRight = isCurry ? undefined : holders,\n      newPartials = isCurry ? partials : undefined,\n      newPartialsRight = isCurry ? undefined : partials;\n\n  bitmask |= (isCurry ? WRAP_PARTIAL_FLAG : WRAP_PARTIAL_RIGHT_FLAG);\n  bitmask &= ~(isCurry ? WRAP_PARTIAL_RIGHT_FLAG : WRAP_PARTIAL_FLAG);\n\n  if (!(bitmask & WRAP_CURRY_BOUND_FLAG)) {\n    bitmask &= ~(WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG);\n  }\n  var newData = [\n    func, bitmask, thisArg, newPartials, newHolders, newPartialsRight,\n    newHoldersRight, argPos, ary, arity\n  ];\n\n  var result = wrapFunc.apply(undefined, newData);\n  if (isLaziable(func)) {\n    setData(result, newData);\n  }\n  result.placeholder = placeholder;\n  return setWrapToString(result, func, bitmask);\n}\n\nmodule.exports = createRecurry;\n","/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n;(function(root, factory) {\n\t// https://github.com/umdjs/umd/blob/master/returnExports.js\n\tif (typeof exports == 'object') {\n\t\t// For Node.js.\n\t\tmodule.exports = factory(root);\n\t} else if (typeof define == 'function' && define.amd) {\n\t\t// For AMD. Register as an anonymous module.\n\t\tdefine([], factory.bind(root, root));\n\t} else {\n\t\t// For browser globals (not exposing the function separately).\n\t\tfactory(root);\n\t}\n}(typeof global != 'undefined' ? global : this, function(root) {\n\n\tif (root.CSS && root.CSS.escape) {\n\t\treturn root.CSS.escape;\n\t}\n\n\t// https://drafts.csswg.org/cssom/#serialize-an-identifier\n\tvar cssEscape = function(value) {\n\t\tif (arguments.length == 0) {\n\t\t\tthrow new TypeError('`CSS.escape` requires an argument.');\n\t\t}\n\t\tvar string = String(value);\n\t\tvar length = string.length;\n\t\tvar index = -1;\n\t\tvar codeUnit;\n\t\tvar result = '';\n\t\tvar firstCodeUnit = string.charCodeAt(0);\n\t\twhile (++index < length) {\n\t\t\tcodeUnit = string.charCodeAt(index);\n\t\t\t// Note: there’s no need to special-case astral symbols, surrogate\n\t\t\t// pairs, or lone surrogates.\n\n\t\t\t// If the character is NULL (U+0000), then the REPLACEMENT CHARACTER\n\t\t\t// (U+FFFD).\n\t\t\tif (codeUnit == 0x0000) {\n\t\t\t\tresult += '\\uFFFD';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is in the range [\\1-\\1F] (U+0001 to U+001F) or is\n\t\t\t\t// U+007F, […]\n\t\t\t\t(codeUnit >= 0x0001 && codeUnit <= 0x001F) || codeUnit == 0x007F ||\n\t\t\t\t// If the character is the first character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039), […]\n\t\t\t\t(index == 0 && codeUnit >= 0x0030 && codeUnit <= 0x0039) ||\n\t\t\t\t// If the character is the second character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039) and the first character is a `-` (U+002D), […]\n\t\t\t\t(\n\t\t\t\t\tindex == 1 &&\n\t\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 &&\n\t\t\t\t\tfirstCodeUnit == 0x002D\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character-as-code-point\n\t\t\t\tresult += '\\\\' + codeUnit.toString(16) + ' ';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is the first character and is a `-` (U+002D), and\n\t\t\t\t// there is no second character, […]\n\t\t\t\tindex == 0 &&\n\t\t\t\tlength == 1 &&\n\t\t\t\tcodeUnit == 0x002D\n\t\t\t) {\n\t\t\t\tresult += '\\\\' + string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If the character is not handled by one of the above rules and is\n\t\t\t// greater than or equal to U+0080, is `-` (U+002D) or `_` (U+005F), or\n\t\t\t// is in one of the ranges [0-9] (U+0030 to U+0039), [A-Z] (U+0041 to\n\t\t\t// U+005A), or [a-z] (U+0061 to U+007A), […]\n\t\t\tif (\n\t\t\t\tcodeUnit >= 0x0080 ||\n\t\t\t\tcodeUnit == 0x002D ||\n\t\t\t\tcodeUnit == 0x005F ||\n\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 ||\n\t\t\t\tcodeUnit >= 0x0041 && codeUnit <= 0x005A ||\n\t\t\t\tcodeUnit >= 0x0061 && codeUnit <= 0x007A\n\t\t\t) {\n\t\t\t\t// the character itself\n\t\t\t\tresult += string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Otherwise, the escaped character.\n\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character\n\t\t\tresult += '\\\\' + string.charAt(index);\n\n\t\t}\n\t\treturn result;\n\t};\n\n\tif (!root.CSS) {\n\t\troot.CSS = {};\n\t}\n\n\troot.CSS.escape = cssEscape;\n\treturn cssEscape;\n\n}));\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\n// input entities\nvar textInputField = require('./TextInputEntryFactory'),\n    checkboxField = require('./CheckboxEntryFactory'),\n    selectBoxField = require('./SelectEntryFactory'),\n    comboBoxField = require('./ComboEntryFactory'),\n    textBoxField = require('./TextBoxEntryFactory'),\n    validationAwareTextInputField = require('./ValidationAwareTextInput'),\n    tableField = require('./TableEntryFactory'),\n    labelEntry = require('./LabelFactory'),\n    link = require('./LinkEntryFactory');\n\nvar cmdHelper = require('../helper/CmdHelper');\n\n// helpers ////////////////////////////////////////\n\nfunction ensureNotNull(prop) {\n  if (!prop) {\n    throw new Error(prop + ' must be set.');\n  }\n\n  return prop;\n}\n\n/**\n * sets the default parameters which are needed to create an entry\n *\n * @param options\n * @returns {{id: *, description: (*|string), get: (*|Function), set: (*|Function),\n *            validate: (*|Function), html: string}}\n */\nvar setDefaultParameters = function(options) {\n\n  // default method to fetch the current value of the input field\n  var defaultGet = function(element) {\n    var bo = getBusinessObject(element),\n        res = {},\n        prop = ensureNotNull(options.modelProperty);\n    res[prop] = bo.get(prop);\n\n    return res;\n  };\n\n  // default method to set a new value to the input field\n  var defaultSet = function(element, values) {\n    var res = {},\n        prop = ensureNotNull(options.modelProperty);\n    if (values[prop] !== '') {\n      res[prop] = values[prop];\n    } else {\n      res[prop] = undefined;\n    }\n\n    return cmdHelper.updateProperties(element, res);\n  };\n\n  // default validation method\n  var defaultValidate = function() {\n    return {};\n  };\n\n  return {\n    id : options.id,\n    description : (options.description || ''),\n    get : (options.get || defaultGet),\n    set : (options.set || defaultSet),\n    validate : (options.validate || defaultValidate),\n    html: ''\n  };\n};\n\nfunction EntryFactory() {\n\n}\n\n/**\n * Generates an text input entry object for a property panel.\n * options are:\n * - id: id of the entry - String\n *\n * - description: description of the property - String\n *\n * - label: label for the input field - String\n *\n * - set: setter method - Function\n *\n * - get: getter method - Function\n *\n * - validate: validation mehtod - Function\n *\n * - modelProperty: name of the model property - String\n *\n * - buttonAction: Object which contains the following properties: - Object\n * ---- name: name of the [data-action] callback - String\n * ---- method: callback function for [data-action] - Function\n *\n * - buttonShow: Object which contains the following properties: - Object\n * ---- name: name of the [data-show] callback - String\n * ---- method: callback function for [data-show] - Function\n *\n * @param options\n * @returns the propertyPanel entry resource object\n */\nEntryFactory.textField = function(options) {\n  return textInputField(options, setDefaultParameters(options));\n};\n\nEntryFactory.validationAwareTextField = function(options) {\n  return validationAwareTextInputField(options, setDefaultParameters(options));\n};\n\n/**\n * Generates a checkbox input entry object for a property panel.\n * options are:\n * - id: id of the entry - String\n *\n * - description: description of the property - String\n *\n * - label: label for the input field - String\n *\n * - set: setter method - Function\n *\n * - get: getter method - Function\n *\n * - validate: validation method - Function\n *\n * - modelProperty: name of the model property - String\n *\n * @param options\n * @returns the propertyPanel entry resource object\n */\nEntryFactory.checkbox = function(options) {\n  return checkboxField(options, setDefaultParameters(options));\n};\n\nEntryFactory.textBox = function(options) {\n  return textBoxField(options, setDefaultParameters(options));\n};\n\nEntryFactory.selectBox = function(options) {\n  return selectBoxField(options, setDefaultParameters(options));\n};\n\nEntryFactory.comboBox = function(options) {\n  return comboBoxField(options);\n};\n\nEntryFactory.table = function(options) {\n  return tableField(options);\n};\n\nEntryFactory.label = function(options) {\n  return labelEntry(options);\n};\n\nEntryFactory.link = function(options) {\n  return link(options);\n};\n\nmodule.exports = EntryFactory;\n","/** Used as the internal argument placeholder. */\nvar PLACEHOLDER = '__lodash_placeholder__';\n\n/**\n * Replaces all `placeholder` elements in `array` with an internal placeholder\n * and returns an array of their indexes.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {*} placeholder The placeholder to replace.\n * @returns {Array} Returns the new array of placeholder indexes.\n */\nfunction replaceHolders(array, placeholder) {\n  var index = -1,\n      length = array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (value === placeholder || value === PLACEHOLDER) {\n      array[index] = PLACEHOLDER;\n      result[resIndex++] = index;\n    }\n  }\n  return result;\n}\n\nmodule.exports = replaceHolders;\n","var baseSetData = require('./_baseSetData'),\n    createBind = require('./_createBind'),\n    createCurry = require('./_createCurry'),\n    createHybrid = require('./_createHybrid'),\n    createPartial = require('./_createPartial'),\n    getData = require('./_getData'),\n    mergeData = require('./_mergeData'),\n    setData = require('./_setData'),\n    setWrapToString = require('./_setWrapToString'),\n    toInteger = require('./toInteger');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_CURRY_RIGHT_FLAG = 16,\n    WRAP_PARTIAL_FLAG = 32,\n    WRAP_PARTIAL_RIGHT_FLAG = 64;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * Creates a function that either curries or invokes `func` with optional\n * `this` binding and partially applied arguments.\n *\n * @private\n * @param {Function|string} func The function or method name to wrap.\n * @param {number} bitmask The bitmask flags.\n *    1 - `_.bind`\n *    2 - `_.bindKey`\n *    4 - `_.curry` or `_.curryRight` of a bound function\n *    8 - `_.curry`\n *   16 - `_.curryRight`\n *   32 - `_.partial`\n *   64 - `_.partialRight`\n *  128 - `_.rearg`\n *  256 - `_.ary`\n *  512 - `_.flip`\n * @param {*} [thisArg] The `this` binding of `func`.\n * @param {Array} [partials] The arguments to be partially applied.\n * @param {Array} [holders] The `partials` placeholder indexes.\n * @param {Array} [argPos] The argument positions of the new function.\n * @param {number} [ary] The arity cap of `func`.\n * @param {number} [arity] The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createWrap(func, bitmask, thisArg, partials, holders, argPos, ary, arity) {\n  var isBindKey = bitmask & WRAP_BIND_KEY_FLAG;\n  if (!isBindKey && typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var length = partials ? partials.length : 0;\n  if (!length) {\n    bitmask &= ~(WRAP_PARTIAL_FLAG | WRAP_PARTIAL_RIGHT_FLAG);\n    partials = holders = undefined;\n  }\n  ary = ary === undefined ? ary : nativeMax(toInteger(ary), 0);\n  arity = arity === undefined ? arity : toInteger(arity);\n  length -= holders ? holders.length : 0;\n\n  if (bitmask & WRAP_PARTIAL_RIGHT_FLAG) {\n    var partialsRight = partials,\n        holdersRight = holders;\n\n    partials = holders = undefined;\n  }\n  var data = isBindKey ? undefined : getData(func);\n\n  var newData = [\n    func, bitmask, thisArg, partials, holders, partialsRight, holdersRight,\n    argPos, ary, arity\n  ];\n\n  if (data) {\n    mergeData(newData, data);\n  }\n  func = newData[0];\n  bitmask = newData[1];\n  thisArg = newData[2];\n  partials = newData[3];\n  holders = newData[4];\n  arity = newData[9] = newData[9] === undefined\n    ? (isBindKey ? 0 : func.length)\n    : nativeMax(newData[9] - length, 0);\n\n  if (!arity && bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG)) {\n    bitmask &= ~(WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG);\n  }\n  if (!bitmask || bitmask == WRAP_BIND_FLAG) {\n    var result = createBind(func, bitmask, thisArg);\n  } else if (bitmask == WRAP_CURRY_FLAG || bitmask == WRAP_CURRY_RIGHT_FLAG) {\n    result = createCurry(func, bitmask, arity);\n  } else if ((bitmask == WRAP_PARTIAL_FLAG || bitmask == (WRAP_BIND_FLAG | WRAP_PARTIAL_FLAG)) && !holders.length) {\n    result = createPartial(func, bitmask, thisArg, partials);\n  } else {\n    result = createHybrid.apply(undefined, newData);\n  }\n  var setter = data ? baseSetData : setData;\n  return setWrapToString(setter(result, newData), func, bitmask);\n}\n\nmodule.exports = createWrap;\n","'use strict';\n\nvar assign = require('lodash/assign');\n\nvar inputOutputParameter = require('./implementation/InputOutputParameter');\n\nmodule.exports = function(group, element, bpmnFactory, options, translate) {\n\n  options = assign({\n    idPrefix: 'connector-',\n    insideConnector: true\n  }, options);\n\n  group.entries = group.entries.concat(inputOutputParameter(element, bpmnFactory, options, translate));\n\n};\n","var baseCreate = require('./_baseCreate'),\n    baseLodash = require('./_baseLodash');\n\n/**\n * The base constructor for creating `lodash` wrapper objects.\n *\n * @private\n * @param {*} value The value to wrap.\n * @param {boolean} [chainAll] Enable explicit method chain sequences.\n */\nfunction LodashWrapper(value, chainAll) {\n  this.__wrapped__ = value;\n  this.__actions__ = [];\n  this.__chain__ = !!chainAll;\n  this.__index__ = 0;\n  this.__values__ = undefined;\n}\n\nLodashWrapper.prototype = baseCreate(baseLodash.prototype);\nLodashWrapper.prototype.constructor = LodashWrapper;\n\nmodule.exports = LodashWrapper;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var baseDifference = require('./_baseDifference'),\n    baseFlatten = require('./_baseFlatten'),\n    baseUniq = require('./_baseUniq');\n\n/**\n * The base implementation of methods like `_.xor`, without support for\n * iteratee shorthands, that accepts an array of arrays to inspect.\n *\n * @private\n * @param {Array} arrays The arrays to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of values.\n */\nfunction baseXor(arrays, iteratee, comparator) {\n  var length = arrays.length;\n  if (length < 2) {\n    return length ? baseUniq(arrays[0]) : [];\n  }\n  var index = -1,\n      result = Array(length);\n\n  while (++index < length) {\n    var array = arrays[index],\n        othIndex = -1;\n\n    while (++othIndex < length) {\n      if (othIndex != index) {\n        result[index] = baseDifference(result[index] || array, arrays[othIndex], iteratee, comparator);\n      }\n    }\n  }\n  return baseUniq(baseFlatten(result, 1), iteratee, comparator);\n}\n\nmodule.exports = baseXor;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nmodule.exports = mapToArray;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar candidateStarter = require('./implementation/CandidateStarter');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var businessObject = getBusinessObject(element);\n\n  if (is(element, 'camunda:Process') ||\n      is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n\n    group.entries = group.entries.concat(candidateStarter(element, bpmnFactory, {\n      getBusinessObject: function(element) {\n        var bo = getBusinessObject(element);\n\n        if (!is(bo, 'bpmn:Participant')) {\n          return bo;\n        }\n\n        return bo.get('processRef');\n      }\n    }, translate));\n\n  }\n};\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nmodule.exports = baseProperty;\n","var ListCache = require('./_ListCache');\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nmodule.exports = stackClear;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    getExtensionElements = require('../../../helper/ExtensionElementsHelper').getExtensionElements,\n    removeEntry = require('../../../helper/ExtensionElementsHelper').removeEntry,\n    extensionElements = require('./implementation/ExtensionElements'),\n    properties = require('./implementation/Properties'),\n    entryFactory = require('../../../factory/EntryFactory'),\n    elementHelper = require('../../../helper/ElementHelper'),\n    cmdHelper = require('../../../helper/CmdHelper'),\n    formHelper = require('../../../helper/FormHelper'),\n    utils = require('../../../Utils'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    find = require('lodash/find'),\n    each = require('lodash/forEach');\n\nfunction generateValueId() {\n  return utils.nextId('Value_');\n}\n\n/**\n * Generate a form field specific textField using entryFactory.\n *\n * @param  {string} options.id\n * @param  {string} options.label\n * @param  {string} options.modelProperty\n * @param  {function} options.validate\n *\n * @return {Object} an entryFactory.textField object\n */\nfunction formFieldTextField(options, getSelectedFormField) {\n\n  var id = options.id,\n      label = options.label,\n      modelProperty = options.modelProperty,\n      validate = options.validate;\n\n  return entryFactory.textField({\n    id: id,\n    label: label,\n    modelProperty: modelProperty,\n    get: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node) || {},\n          values = {};\n\n      values[modelProperty] = selectedFormField[modelProperty];\n\n      return values;\n    },\n\n    set: function(element, values, node) {\n      var commands = [];\n\n      if (typeof options.set === 'function') {\n        var cmd = options.set(element, values, node);\n\n        if (cmd) {\n          commands.push(cmd);\n        }\n      }\n\n      var formField = getSelectedFormField(element, node),\n          properties = {};\n\n      properties[modelProperty] = values[modelProperty] || undefined;\n\n      commands.push(cmdHelper.updateBusinessObject(element, formField, properties));\n\n      return commands;\n    },\n    hidden: function(element, node) {\n      return !getSelectedFormField(element, node);\n    },\n    validate: validate\n  });\n}\n\nfunction ensureFormKeyAndDataSupported(element) {\n  return (\n    is(element, 'bpmn:StartEvent') && !is(element.parent, 'bpmn:SubProcess')\n  ) || is(element, 'bpmn:UserTask');\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (!ensureFormKeyAndDataSupported(element)) {\n    return;\n  }\n\n\n  /**\n   * Return the currently selected form field querying the form field select box\n   * from the DOM.\n   *\n   * @param  {djs.model.Base} element\n   * @param  {DOMElement} node - DOM element of any form field text input\n   *\n   * @return {ModdleElement} the currently selected form field\n   */\n  function getSelectedFormField(element, node) {\n    var selected = formFieldsEntry.getSelected(element, node.parentNode);\n\n    if (selected.idx === -1) {\n      return;\n    }\n\n    return formHelper.getFormField(element, selected.idx);\n  }\n\n  // [FormKey] form key text input field\n  group.entries.push(entryFactory.textField({\n    id : 'form-key',\n    label : translate('Form Key'),\n    modelProperty: 'formKey',\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n\n      return {\n        formKey: bo.get('camunda:formKey')\n      };\n    },\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element),\n          formKey = values.formKey || undefined;\n\n      return cmdHelper.updateBusinessObject(element, bo, { 'camunda:formKey': formKey });\n    }\n  }));\n\n  // [FormData] form field select box\n  var formFieldsEntry = extensionElements(element, bpmnFactory, {\n    id: 'form-fields',\n    label: translate('Form Fields'),\n    modelProperty: 'id',\n    prefix: 'FormField',\n    createExtensionElement: function(element, extensionElements, value) {\n      var bo = getBusinessObject(element), commands = [];\n\n      if (!extensionElements) {\n        extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n        commands.push(cmdHelper.updateProperties(element, { extensionElements: extensionElements }));\n      }\n\n      var formData = formHelper.getFormData(element);\n\n      if (!formData) {\n        formData = elementHelper.createElement('camunda:FormData', { fields: [] }, extensionElements, bpmnFactory);\n        commands.push(cmdHelper.addAndRemoveElementsFromList(\n          element,\n          extensionElements,\n          'values',\n          'extensionElements',\n          [formData],\n          []\n        ));\n      }\n\n      var field = elementHelper.createElement('camunda:FormField', { id: value }, formData, bpmnFactory);\n      if (typeof formData.fields !== 'undefined') {\n        commands.push(cmdHelper.addElementsTolist(element, formData, 'fields', [ field ]));\n      } else {\n        commands.push(cmdHelper.updateBusinessObject(element, formData, {\n          fields: [ field ]\n        }));\n      }\n      return commands;\n    },\n    removeExtensionElement: function(element, extensionElements, value, idx) {\n      var formData = getExtensionElements(getBusinessObject(element), 'camunda:FormData')[0],\n          entry = formData.fields[idx],\n          commands = [];\n\n      if (formData.fields.length < 2) {\n        commands.push(removeEntry(getBusinessObject(element), element, formData));\n      } else {\n        commands.push(cmdHelper.removeElementsFromList(element, formData, 'fields', null, [entry]));\n\n        if (entry.id === formData.get('businessKey')) {\n          commands.push(cmdHelper.updateBusinessObject(element, formData, { 'businessKey': undefined }));\n        }\n      }\n\n      return commands;\n    },\n    getExtensionElements: function(element) {\n      return formHelper.getFormFields(element);\n    },\n    hideExtensionElements: function(element, node) {\n      return false;\n    }\n  });\n  group.entries.push(formFieldsEntry);\n\n  // [FormData] business key form field select box\n  var formBusinessKeyFormFieldEntry = entryFactory.selectBox({\n    id: 'form-business-key',\n    label: translate('Business Key'),\n    modelProperty: 'businessKey',\n    selectOptions: function(element, inputNode) {\n      var selectOptions = [{ name: '', value: '' }];\n      var formFields = formHelper.getFormFields(element);\n      each(formFields, function(field) {\n        if (field.type !== 'boolean') {\n          selectOptions.push({ name: field.id, value: field.id });\n        }\n      });\n      return selectOptions;\n    },\n    get: function(element, node) {\n      var result = { businessKey: '' };\n      var bo = getBusinessObject(element);\n      var formDataExtension = getExtensionElements(bo, 'camunda:FormData');\n      if (formDataExtension) {\n        var formData = formDataExtension[0];\n        var storedValue = formData.get('businessKey');\n        result = { businessKey: storedValue };\n      }\n      return result;\n    },\n    set: function(element, values, node) {\n      var formData = getExtensionElements(getBusinessObject(element), 'camunda:FormData')[0];\n      return cmdHelper.updateBusinessObject(element, formData, { 'businessKey': values.businessKey || undefined });\n    },\n    hidden: function(element, node) {\n      var isStartEvent = is(element,'bpmn:StartEvent');\n      return !(isStartEvent && formHelper.getFormFields(element).length > 0);\n    }\n  });\n  group.entries.push(formBusinessKeyFormFieldEntry);\n\n  // [FormData] Form Field label\n  group.entries.push(entryFactory.label({\n    id: 'form-field-header',\n    labelText: translate('Form Field'),\n    showLabel: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] form field id text input field\n  group.entries.push(entryFactory.validationAwareTextField({\n    id: 'form-field-id',\n    label: translate('ID'),\n    modelProperty: 'id',\n\n    getProperty: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node) || {};\n\n      return selectedFormField.id;\n    },\n\n    setProperty: function(element, properties, node) {\n      var formField = getSelectedFormField(element, node);\n\n      return cmdHelper.updateBusinessObject(element, formField, properties);\n    },\n\n    hidden: function(element, node) {\n      return !getSelectedFormField(element, node);\n    },\n\n    validate: function(element, values, node) {\n\n      var formField = getSelectedFormField(element, node);\n\n      if (formField) {\n\n        var idValue = values.id;\n\n        if (!idValue || idValue.trim() === '') {\n          return { id: 'Form field id must not be empty' };\n        }\n\n        var formFields = formHelper.getFormFields(element);\n\n        var existingFormField = find(formFields, function(f) {\n          return f !== formField && f.id === idValue;\n        });\n\n        if (existingFormField) {\n          return { id: 'Form field id already used in form data.' };\n        }\n      }\n    }\n  }));\n\n  // [FormData] form field type combo box\n  group.entries.push(entryFactory.comboBox({\n    id: 'form-field-type',\n    label: translate('Type'),\n    selectOptions: [\n      { name: 'string', value: 'string' },\n      { name: 'long', value: 'long' },\n      { name: 'boolean', value: 'boolean' },\n      { name: 'date', value: 'date' },\n      { name: 'enum', value: 'enum' }\n    ],\n    modelProperty: 'type',\n    emptyParameter: true,\n\n    get: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node);\n\n      if (selectedFormField) {\n        return { type: selectedFormField.type };\n      } else {\n        return {};\n      }\n    },\n    set: function(element, values, node) {\n      var selectedFormField = getSelectedFormField(element, node),\n          formData = getExtensionElements(getBusinessObject(element), 'camunda:FormData')[0],\n          commands = [];\n\n      if (selectedFormField.type === 'enum' && values.type !== 'enum') {\n        // delete camunda:value objects from formField.values when switching from type enum\n        commands.push(cmdHelper.updateBusinessObject(element, selectedFormField, { values: undefined }));\n      }\n      if (values.type === 'boolean' && selectedFormField.get('id') === formData.get('businessKey')) {\n        commands.push(cmdHelper.updateBusinessObject(element, formData, { 'businessKey': undefined }));\n      }\n      commands.push(cmdHelper.updateBusinessObject(element, selectedFormField, values));\n\n      return commands;\n    },\n    hidden: function(element, node) {\n      return !getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] form field label text input field\n  group.entries.push(formFieldTextField({\n    id: 'form-field-label',\n    label: translate('Label'),\n    modelProperty: 'label'\n  }, getSelectedFormField));\n\n  // [FormData] form field defaultValue text input field\n  group.entries.push(formFieldTextField({\n    id: 'form-field-defaultValue',\n    label: translate('Default Value'),\n    modelProperty: 'defaultValue'\n  }, getSelectedFormField));\n\n\n  // [FormData] form field enum values label\n  group.entries.push(entryFactory.label({\n    id: 'form-field-enum-values-header',\n    labelText: translate('Values'),\n    divider: true,\n    showLabel: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node);\n\n      return selectedFormField && selectedFormField.type === 'enum';\n    }\n  }));\n\n  // [FormData] form field enum values table\n  group.entries.push(entryFactory.table({\n    id: 'form-field-enum-values',\n    labels: [ translate('Id'), translate('Name') ],\n    modelProperties: [ 'id', 'name' ],\n    show: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node);\n\n      return selectedFormField && selectedFormField.type === 'enum';\n    },\n    getElements: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node);\n\n      return formHelper.getEnumValues(selectedFormField);\n    },\n    addElement: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node),\n          id = generateValueId();\n\n      var enumValue = elementHelper.createElement(\n        'camunda:Value',\n        { id: id, name: undefined },\n        getBusinessObject(element),\n        bpmnFactory\n      );\n\n      return cmdHelper.addElementsTolist(element, selectedFormField, 'values', [enumValue]);\n    },\n    removeElement: function(element, node, idx) {\n      var selectedFormField = getSelectedFormField(element, node),\n          enumValue = selectedFormField.values[idx];\n\n      return cmdHelper.removeElementsFromList(element, selectedFormField, 'values', null, [enumValue]);\n    },\n    updateElement: function(element, value, node, idx) {\n      var selectedFormField = getSelectedFormField(element, node),\n          enumValue = selectedFormField.values[idx];\n\n      value.name = value.name || undefined;\n      return cmdHelper.updateBusinessObject(element, enumValue, value);\n    },\n    validate: function(element, value, node, idx) {\n\n      var selectedFormField = getSelectedFormField(element, node),\n          enumValue = selectedFormField.values[idx];\n\n      if (enumValue) {\n        // check if id is valid\n        var validationError = utils.isIdValid(enumValue, value.id, translate);\n\n        if (validationError) {\n          return { id: validationError };\n        }\n      }\n    }\n  }));\n\n  // [FormData] Validation label\n  group.entries.push(entryFactory.label({\n    id: 'form-field-validation-header',\n    labelText: translate('Validation'),\n    divider: true,\n    showLabel: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] form field constraints table\n  group.entries.push(entryFactory.table({\n    id: 'constraints-list',\n    modelProperties: [ 'name', 'config' ],\n    labels: [ translate('Name'), translate('Config') ],\n    addLabel: translate('Add Constraint'),\n    getElements: function(element, node) {\n      var formField = getSelectedFormField(element, node);\n\n      return formHelper.getConstraints(formField);\n    },\n    addElement: function(element, node) {\n\n      var commands = [],\n          formField = getSelectedFormField(element, node),\n          validation = formField.validation;\n\n      if (!validation) {\n        // create validation business object and add it to form data, if it doesn't exist\n        validation = elementHelper.createElement('camunda:Validation', {}, getBusinessObject(element), bpmnFactory);\n\n        commands.push(cmdHelper.updateBusinessObject(element, formField, { 'validation': validation }));\n      }\n\n      var newConstraint = elementHelper.createElement(\n        'camunda:Constraint',\n        { name: undefined, config: undefined },\n        validation,\n        bpmnFactory\n      );\n\n      commands.push(cmdHelper.addElementsTolist(element, validation, 'constraints', [ newConstraint ]));\n\n      return commands;\n    },\n    updateElement: function(element, value, node, idx) {\n      var formField = getSelectedFormField(element, node),\n          constraint = formHelper.getConstraints(formField)[idx];\n\n      value.name = value.name || undefined;\n      value.config = value.config || undefined;\n\n      return cmdHelper.updateBusinessObject(element, constraint, value);\n    },\n    removeElement: function(element, node, idx) {\n      var commands = [],\n          formField = getSelectedFormField(element, node),\n          constraints = formHelper.getConstraints(formField),\n          currentConstraint = constraints[idx];\n\n      commands.push(cmdHelper.removeElementsFromList(\n        element,\n        formField.validation,\n        'constraints',\n        null,\n        [ currentConstraint ]\n      ));\n\n      if (constraints.length === 1) {\n        // remove camunda:validation if the last existing constraint has been removed\n        commands.push(cmdHelper.updateBusinessObject(element, formField, { validation: undefined }));\n      }\n\n      return commands;\n    },\n    show: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] Properties label\n  group.entries.push(entryFactory.label({\n    id: 'form-field-properties-header',\n    labelText: translate('Properties'),\n    divider: true,\n    showLabel: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] camunda:properties table\n  group.entries.push(properties(element, bpmnFactory, {\n    id: 'form-field-properties',\n    modelProperties: [ 'id', 'value' ],\n    labels: [ translate('Id'), translate('Value') ],\n    getParent: function(element, node) {\n      return getSelectedFormField(element, node);\n    },\n    show: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }, translate));\n};\n","'use strict';\r\n\r\nvar entryFactory = require('../../../../factory/EntryFactory');\r\n\r\nvar cmdHelper = require('../../../../helper/CmdHelper');\r\n\r\nmodule.exports = function(element, bpmnFactory, options, translate) {\r\n\r\n  var getBusinessObject = options.getBusinessObject;\r\n\r\n  var isStartableInTasklistEntry = entryFactory.checkbox({\r\n    id: 'isStartableInTasklist',\r\n    label: translate('Startable'),\r\n    modelProperty: 'isStartableInTasklist',\r\n\r\n    get: function(element, node) {\r\n      var bo = getBusinessObject(element);\r\n      var isStartableInTasklist = bo.get('camunda:isStartableInTasklist');\r\n\r\n      return {\r\n        isStartableInTasklist: isStartableInTasklist ? isStartableInTasklist : ''\r\n      };\r\n    },\r\n\r\n    set: function(element, values) {\r\n      var bo = getBusinessObject(element);\r\n      return cmdHelper.updateBusinessObject(element, bo, {\r\n        'camunda:isStartableInTasklist': !!values.isStartableInTasklist\r\n      });\r\n    }\r\n\r\n  });\r\n\r\n  return [\r\n    isStartableInTasklistEntry\r\n  ];\r\n};\r\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\nvar participantHelper = require('../../../helper/ParticipantHelper');\n\nmodule.exports = function(group, element, translate) {\n\n  var bo = getBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  if (is(element, 'bpmn:Process') || (is(element, 'bpmn:Participant') && bo.get('processRef'))) {\n\n    var executableEntry = entryFactory.checkbox({\n      id: 'process-is-executable',\n      label: translate('Executable'),\n      modelProperty: 'isExecutable'\n    });\n\n    // in participants we have to change the default behavior of set and get\n    if (is(element, 'bpmn:Participant')) {\n      executableEntry.get = function(element) {\n        return participantHelper.getProcessBusinessObject(element, 'isExecutable');\n      };\n\n      executableEntry.set = function(element, values) {\n        return participantHelper.modifyProcessBusinessObject(element, 'isExecutable', values);\n      };\n    }\n\n    group.entries.push(executableEntry);\n  }\n\n};\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nmodule.exports = shortOut;\n","var isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = toKey;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar eventDefinitionReference = require('./EventDefinitionReference'),\n    elementReferenceProperty = require('./ElementReferenceProperty');\n\n\nmodule.exports = function(group, element, bpmnFactory, escalationEventDefinition, showEscalationCodeVariable, translate) {\n\n  group.entries = group.entries.concat(eventDefinitionReference(element, escalationEventDefinition, bpmnFactory, {\n    label: translate('Escalation'),\n    elementName: 'escalation',\n    elementType: 'bpmn:Escalation',\n    referenceProperty: 'escalationRef',\n    newElementIdPrefix: 'Escalation_'\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, escalationEventDefinition, bpmnFactory, {\n    id: 'escalation-element-name',\n    label: translate('Escalation Name'),\n    referenceProperty: 'escalationRef',\n    modelProperty: 'name',\n    shouldValidate: true\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, escalationEventDefinition, bpmnFactory, {\n    id: 'escalation-element-code',\n    label: translate('Escalation Code'),\n    referenceProperty: 'escalationRef',\n    modelProperty: 'escalationCode'\n  }));\n\n\n  if (showEscalationCodeVariable) {\n    group.entries.push(entryFactory.textField({\n      id : 'escalationCodeVariable',\n      label : translate('Escalation Code Variable'),\n      modelProperty : 'escalationCodeVariable',\n\n      get: function(element) {\n        var codeVariable = escalationEventDefinition.get('camunda:escalationCodeVariable');\n        return {\n          escalationCodeVariable: codeVariable\n        };\n      },\n\n      set: function(element, values) {\n        return cmdHelper.updateBusinessObject(element, escalationEventDefinition, {\n          'camunda:escalationCodeVariable': values.escalationCodeVariable || undefined\n        });\n      }\n    }));\n  }\n};\n","var isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nmodule.exports = isKey;\n","var baseSetData = require('./_baseSetData'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets metadata for `func`.\n *\n * **Note:** If this function becomes hot, i.e. is invoked a lot in a short\n * period of time, it will trip its breaker and transition to an identity\n * function to avoid garbage collection pauses in V8. See\n * [V8 issue 2070](https://bugs.chromium.org/p/v8/issues/detail?id=2070)\n * for more details.\n *\n * @private\n * @param {Function} func The function to associate metadata with.\n * @param {*} data The metadata.\n * @returns {Function} Returns `func`.\n */\nvar setData = shortOut(baseSetData);\n\nmodule.exports = setData;\n","'use strict';\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nvar domQuery = require('min-dom').query,\n    domify = require('min-dom').domify,\n    domAttr = require('min-dom').attr;\n\nvar forEach = require('lodash/forEach'),\n    find = require('lodash/find');\n\nvar elementHelper = require('../../../../helper/ElementHelper');\nvar utils = require('../../../../Utils'),\n    escapeHTML = utils.escapeHTML;\n\nvar selector = 'select[name=selectedElement]';\n\n/**\n * Get select box containing all elements.\n *\n * @param {DOMElement} node\n *\n * @return {DOMElement} the select box\n */\nfunction getSelectBox(node) {\n  return domQuery(selector, node.parentElement);\n}\n\n/**\n * Find element by given id.\n *\n * @param {ModdleElement} eventDefinition\n *\n * @return {ModdleElement} an element\n */\nfunction findElementById(eventDefinition, type, id) {\n  var elements = utils.findRootElementsByType(eventDefinition, type);\n  return find(elements, function(element) {\n    return element.id === id;\n  });\n}\n\n/**\n * Create an entry to modify the reference to an element from an\n * event definition.\n *\n * @param  {djs.model.Base} element\n * @param  {ModdleElement} definition\n * @param  {BpmnFactory} bpmnFactory\n * @param  {Object} options\n * @param  {string} options.label the label of the entry\n * @param  {string} options.description the description of the entry\n * @param  {string} options.elementName the name of the element\n * @param  {string} options.elementType the type of the element\n * @param  {string} options.referenceProperty the name of referencing property\n * @param  {string} options.newElementIdPrefix the prefix of a new created element\n *\n * @return {Array<Object>} return an array containing the entries\n */\nmodule.exports = function(element, definition, bpmnFactory, options) {\n\n  var elementName = options.elementName || '',\n      elementType = options.elementType,\n      referenceProperty = options.referenceProperty;\n\n  var newElementIdPrefix = options.newElementIdPrefix || 'elem_';\n\n  var label = options.label || '',\n      description = options.description || '';\n\n  var entries = [];\n\n  entries.push({\n\n    id: 'event-definitions-' + elementName,\n    description: description,\n    html: '<div class=\"bpp-row bpp-select\">' +\n             '<label for=\"camunda-' + escapeHTML(elementName) + '\">' + escapeHTML(label) + '</label>' +\n             '<div class=\"bpp-field-wrapper\">' +\n               '<select id=\"camunda-' + escapeHTML(elementName) + '\" name=\"selectedElement\" data-value>' +\n               '</select>' +\n               '<button class=\"add\" id=\"addElement\" data-action=\"addElement\"><span>+</span></button>' +\n             '</div>' +\n          '</div>',\n\n    get: function(element, entryNode) {\n      utils.updateOptionsDropDown(selector, definition, elementType, entryNode);\n      var reference = definition.get(referenceProperty);\n      return {\n        selectedElement: (reference && reference.id) || ''\n      };\n    },\n\n    set: function(element, values) {\n      var selection = values.selectedElement;\n\n      var props = {};\n\n      if (!selection || typeof selection === 'undefined') {\n        // remove reference to element\n        props[referenceProperty] = undefined;\n        return cmdHelper.updateBusinessObject(element, definition, props);\n      }\n\n      var commands = [];\n\n      var selectedElement = findElementById(definition, elementType, selection);\n      if (!selectedElement) {\n        var root = utils.getRoot(definition);\n\n        // create a new element\n        selectedElement = elementHelper.createElement(elementType, { name: selection }, root, bpmnFactory);\n        commands.push(cmdHelper.addAndRemoveElementsFromList(element, root, 'rootElements', null, [ selectedElement ]));\n      }\n\n      // update reference to element\n      props[referenceProperty] = selectedElement;\n      commands.push(cmdHelper.updateBusinessObject(element, definition, props));\n\n      return commands;\n    },\n\n    addElement: function(element, inputNode) {\n      // note: this generated id will be used as name\n      // of the element and not as id\n      var id = utils.nextId(newElementIdPrefix);\n\n      var optionTemplate = domify('<option value=\"' + escapeHTML(id) + '\"> (id='+escapeHTML(id)+')' + '</option>');\n\n      // add new option\n      var selectBox = getSelectBox(inputNode);\n      selectBox.insertBefore(optionTemplate, selectBox.firstChild);\n\n      // select new element in the select box\n      forEach(selectBox, function(option) {\n        if (option.value === id) {\n          domAttr(option, 'selected', 'selected');\n        } else {\n          domAttr(option, 'selected', null);\n        }\n      });\n\n      return true;\n    }\n\n  });\n\n  return entries;\n\n};\n","'use strict';\n\nvar eventDefinitionReference = require('./EventDefinitionReference'),\n    elementReferenceProperty = require('./ElementReferenceProperty');\n\n\nmodule.exports = function(group, element, bpmnFactory, messageEventDefinition, translate) {\n\n  group.entries = group.entries.concat(eventDefinitionReference(element, messageEventDefinition, bpmnFactory, {\n    label: translate('Message'),\n    elementName: 'message',\n    elementType: 'bpmn:Message',\n    referenceProperty: 'messageRef',\n    newElementIdPrefix: 'Message_'\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, messageEventDefinition, bpmnFactory, {\n    id: 'message-element-name',\n    label: translate('Message Name'),\n    referenceProperty: 'messageRef',\n    modelProperty: 'name',\n    shouldValidate: true\n  }));\n\n};\n","var baseProperty = require('./_baseProperty'),\n    basePropertyDeep = require('./_basePropertyDeep'),\n    isKey = require('./_isKey'),\n    toKey = require('./_toKey');\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nmodule.exports = property;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar jobPriority = require('./implementation/JobPriority'),\n    jobRetryTimeCycle = require('./implementation/JobRetryTimeCycle');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var businessObject = getBusinessObject(element);\n\n  if (is(element, 'camunda:JobPriorized') ||\n      is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n\n    group.entries = group.entries.concat(jobPriority(element, bpmnFactory, {\n      getBusinessObject: function(element) {\n        var bo = getBusinessObject(element);\n\n        if (!is(bo, 'bpmn:Participant')) {\n          return bo;\n        }\n\n        return bo.get('processRef');\n      }\n    }, translate));\n  }\n\n  if (is(element, 'camunda:AsyncCapable')) {\n    group.entries = group.entries.concat(jobRetryTimeCycle(element, bpmnFactory, {\n      getBusinessObject: getBusinessObject\n    }, translate));\n  }\n\n};\n","'use strict';\n\nvar extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar utils = require('../../../../Utils');\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar extensionElementsEntry = require('./ExtensionElements');\n\nvar ModelUtil = require('bpmn-js/lib/util/ModelUtil'),\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar assign = require('lodash/assign');\n\n\nvar DEFAULT_PROPS = {\n  'stringValue': undefined,\n  'string': undefined,\n  'expression': undefined\n};\n\nvar CAMUNDA_FIELD_EXTENSION_ELEMENT = 'camunda:Field';\n\nmodule.exports = function(element, bpmnFactory, translate, options) {\n\n  options = options || {};\n\n  var insideListener = !!options.insideListener,\n      idPrefix = options.idPrefix || '',\n      getSelectedListener = options.getSelectedListener,\n      businessObject = options.businessObject || getBusinessObject(element);\n\n  var entries = [];\n\n  var isSelected = function(element, node) {\n    return getSelectedField(element, node);\n  };\n\n  function getSelectedField(element, node) {\n    var selected = fieldEntry.getSelected(element, node.parentNode);\n\n    if (selected.idx === -1) {\n      return;\n    }\n\n    var fields = getCamundaFields(element, node);\n\n    return fields[selected.idx];\n  }\n\n  function getCamundaFields(element, node) {\n    if (!insideListener) {\n      return (\n        businessObject &&\n        extensionElementsHelper.getExtensionElements(businessObject, CAMUNDA_FIELD_EXTENSION_ELEMENT)\n      ) || [];\n    }\n    return getCamundaListenerFields(element, node);\n  }\n\n  function getCamundaListenerFields(element, node) {\n    var selectedListener = getSelectedListener(element, node);\n    return selectedListener && selectedListener.fields || [];\n  }\n\n  function getFieldType(bo) {\n    var fieldType = 'string';\n\n    var expressionValue = bo && bo.expression;\n    var stringValue = bo && (bo.string || bo.stringValue);\n\n    if (typeof stringValue !== 'undefined') {\n      fieldType = 'string';\n    } else if (typeof expressionValue !== 'undefined') {\n      fieldType = 'expression';\n    }\n\n    return fieldType;\n  }\n\n  var setOptionLabelValue = function() {\n    return function(element, node, option, property, value, idx) {\n      var camundaFields = getCamundaFields(element, node);\n      var field = camundaFields[idx];\n\n      value = (field.name) ? field.name : '<empty>';\n\n      var label = idx + ' : ' + value;\n\n      option.text = label;\n    };\n  };\n\n  var newElement = function() {\n    return function(element, extensionElements, value, node) {\n\n      var props = {\n        name: '',\n        string: ''\n      };\n\n      var newFieldElem;\n\n      if (!insideListener) {\n\n        newFieldElem = elementHelper.createElement(CAMUNDA_FIELD_EXTENSION_ELEMENT, props, extensionElements, bpmnFactory);\n        return cmdHelper.addElementsTolist(element, extensionElements, 'values', [ newFieldElem ]);\n\n      } else {\n\n        var selectedListener = getSelectedListener(element, node);\n        newFieldElem = elementHelper.createElement(CAMUNDA_FIELD_EXTENSION_ELEMENT, props, selectedListener, bpmnFactory);\n        return cmdHelper.addElementsTolist(element, selectedListener, 'fields', [ newFieldElem ]);\n\n      }\n\n    };\n  };\n\n  var removeElement = function() {\n    return function(element, extensionElements, value, idx, node) {\n      var camundaFields= getCamundaFields(element, node);\n      var field = camundaFields[idx];\n      if (field) {\n        if (!insideListener) {\n          return extensionElementsHelper.removeEntry(businessObject, element, field);\n        }\n        var selectedListener = getSelectedListener(element, node);\n        return cmdHelper.removeElementsFromList(element, selectedListener, 'fields', null, [ field ]);\n      }\n    };\n  };\n\n\n  var fieldEntry = extensionElementsEntry(element, bpmnFactory, {\n    id : idPrefix + 'fields',\n    label : translate('Fields'),\n    modelProperty: 'fieldName',\n    idGeneration: 'false',\n\n    businessObject: businessObject,\n\n    createExtensionElement: newElement(),\n    removeExtensionElement: removeElement(),\n\n    getExtensionElements: function(element, node) {\n      return getCamundaFields(element, node);\n    },\n\n    setOptionLabelValue: setOptionLabelValue()\n\n  });\n  entries.push(fieldEntry);\n\n\n  entries.push(entryFactory.validationAwareTextField({\n    id: idPrefix + 'field-name',\n    label: translate('Name'),\n    modelProperty: 'fieldName',\n\n    getProperty: function(element, node) {\n      return (getSelectedField(element, node) || {}).name;\n    },\n\n    setProperty: function(element, values, node) {\n      var selectedField = getSelectedField(element, node);\n      return cmdHelper.updateBusinessObject(element, selectedField, { name : values.fieldName });\n    },\n\n    validate: function(element, values, node) {\n      var bo = getSelectedField(element, node);\n\n      var validation = {};\n      if (bo) {\n        var nameValue = values.fieldName;\n\n        if (nameValue) {\n          if (utils.containsSpace(nameValue)) {\n            validation.fieldName = translate('Name must not contain spaces');\n          }\n        } else {\n          validation.fieldName = translate('Parameter must have a name');\n        }\n      }\n\n      return validation;\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n  var fieldTypeOptions = [\n    {\n      name: translate('String'),\n      value: 'string'\n    },\n    {\n      name: translate('Expression'),\n      value: 'expression'\n    }\n  ];\n\n  entries.push(entryFactory.selectBox({\n    id: idPrefix + 'field-type',\n    label: translate('Type'),\n    selectOptions: fieldTypeOptions,\n    modelProperty: 'fieldType',\n\n    get: function(element, node) {\n      var bo = getSelectedField(element, node);\n\n      var fieldType = getFieldType(bo);\n\n      return {\n        fieldType: fieldType\n      };\n    },\n\n    set: function(element, values, node) {\n      var props = assign({}, DEFAULT_PROPS);\n\n      var fieldType = values.fieldType;\n\n      if (fieldType === 'string') {\n        props.string = '';\n      }\n      else if (fieldType === 'expression') {\n        props.expression = '';\n      }\n\n      return cmdHelper.updateBusinessObject(element, getSelectedField(element, node), props);\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  entries.push(entryFactory.textBox({\n    id: idPrefix + 'field-value',\n    label: translate('Value'),\n    modelProperty: 'fieldValue',\n\n    get: function(element, node) {\n      var bo = getSelectedField(element, node);\n      var fieldType = getFieldType(bo);\n\n      var fieldValue;\n\n      if (fieldType === 'string') {\n        fieldValue = bo && (bo.string || bo.stringValue);\n      }\n      else if (fieldType === 'expression') {\n        fieldValue = bo && bo.expression;\n      }\n\n      return {\n        fieldValue: fieldValue\n      };\n    },\n\n    set: function(element, values, node) {\n      var bo = getSelectedField(element, node);\n      var fieldType = getFieldType(bo);\n\n      var props = assign({}, DEFAULT_PROPS);\n\n      var fieldValue = values.fieldValue || undefined;\n\n      if (fieldType === 'string') {\n        props.string = fieldValue;\n      }\n      else if (fieldType === 'expression') {\n        props.expression = fieldValue;\n      }\n\n      return cmdHelper.updateBusinessObject(element, bo, props);\n\n    },\n\n    validate: function(element, values, node) {\n      var bo = getSelectedField(element, node);\n\n      var validation = {};\n      if (bo) {\n        if (!values.fieldValue) {\n          validation.fieldValue = translate('Must provide a value');\n        }\n      }\n\n      return validation;\n    },\n\n    show: function(element, node) {\n      return isSelected(element, node);\n    }\n\n  }));\n\n  return entries;\n\n};\n","'use strict';\n\nvar textField = require('./TextInputEntryFactory');\n\n/**\n * This function is a wrapper around TextInputEntryFactory.\n * It adds functionality to cache an invalid value entered in the\n * text input, instead of setting it on the business object.\n */\nvar validationAwareTextField = function(options, defaultParameters) {\n\n  var modelProperty = options.modelProperty;\n\n  defaultParameters.get = function(element, node) {\n    var value = this.__lastInvalidValue;\n\n    delete this.__lastInvalidValue;\n\n    var properties = {};\n\n    properties[modelProperty] = value !== undefined ? value : options.getProperty(element, node);\n\n    return properties;\n  };\n\n  defaultParameters.set = function(element, values, node) {\n    var validationErrors = validate.apply(this, [ element, values, node ]),\n        propertyValue = values[modelProperty];\n\n    // make sure we do not update the id\n    if (validationErrors && validationErrors[modelProperty]) {\n      this.__lastInvalidValue = propertyValue;\n\n      return options.setProperty(element, {}, node);\n    } else {\n      var properties = {};\n\n      properties[modelProperty] = propertyValue;\n\n      return options.setProperty(element, properties, node);\n    }\n  };\n\n  var validate = defaultParameters.validate = function(element, values, node) {\n    var value = values[modelProperty] || this.__lastInvalidValue;\n\n    var property = {};\n    property[modelProperty] = value;\n\n    return options.validate(element, property, node);\n  };\n\n  return textField(options, defaultParameters);\n};\n\nmodule.exports = validationAwareTextField;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nmodule.exports = listCacheHas;\n","// iterable DOM collections\n// flag - `iterable` interface - 'entries', 'keys', 'values', 'forEach' methods\nmodule.exports = {\n  CSSRuleList: 0,\n  CSSStyleDeclaration: 0,\n  CSSValueList: 0,\n  ClientRectList: 0,\n  DOMRectList: 0,\n  DOMStringList: 0,\n  DOMTokenList: 1,\n  DataTransferItemList: 0,\n  FileList: 0,\n  HTMLAllCollection: 0,\n  HTMLCollection: 0,\n  HTMLFormElement: 0,\n  HTMLSelectElement: 0,\n  MediaList: 0,\n  MimeTypeArray: 0,\n  NamedNodeMap: 0,\n  NodeList: 1,\n  PaintRequestList: 0,\n  Plugin: 0,\n  PluginArray: 0,\n  SVGLengthList: 0,\n  SVGNumberList: 0,\n  SVGPathSegList: 0,\n  SVGPointList: 0,\n  SVGStringList: 0,\n  SVGTransformList: 0,\n  SourceBufferList: 0,\n  StyleSheetList: 0,\n  TextTrackCueList: 0,\n  TextTrackList: 0,\n  TouchList: 0\n};\n","var arrayEach = require('./_arrayEach'),\n    arrayIncludes = require('./_arrayIncludes');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_CURRY_RIGHT_FLAG = 16,\n    WRAP_PARTIAL_FLAG = 32,\n    WRAP_PARTIAL_RIGHT_FLAG = 64,\n    WRAP_ARY_FLAG = 128,\n    WRAP_REARG_FLAG = 256,\n    WRAP_FLIP_FLAG = 512;\n\n/** Used to associate wrap methods with their bit flags. */\nvar wrapFlags = [\n  ['ary', WRAP_ARY_FLAG],\n  ['bind', WRAP_BIND_FLAG],\n  ['bindKey', WRAP_BIND_KEY_FLAG],\n  ['curry', WRAP_CURRY_FLAG],\n  ['curryRight', WRAP_CURRY_RIGHT_FLAG],\n  ['flip', WRAP_FLIP_FLAG],\n  ['partial', WRAP_PARTIAL_FLAG],\n  ['partialRight', WRAP_PARTIAL_RIGHT_FLAG],\n  ['rearg', WRAP_REARG_FLAG]\n];\n\n/**\n * Updates wrapper `details` based on `bitmask` flags.\n *\n * @private\n * @returns {Array} details The details to modify.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @returns {Array} Returns `details`.\n */\nfunction updateWrapDetails(details, bitmask) {\n  arrayEach(wrapFlags, function(pair) {\n    var value = '_.' + pair[0];\n    if ((bitmask & pair[1]) && !arrayIncludes(details, value)) {\n      details.push(value);\n    }\n  });\n  return details.sort();\n}\n\nmodule.exports = updateWrapDetails;\n","const {\n  isAny\n} = require('bpmnlint-utils');\n\n/**\n * A rule that checks that no fake join is modeled by attempting\n * to give a task or event join semantics.\n *\n * Users should model a parallel joining gateway\n * to achieve the desired behavior.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Task',\n      'bpmn:Event'\n    ])) {\n      return;\n    }\n\n    const incoming = node.incoming || [];\n\n    if (incoming.length > 1) {\n      reporter.report(node.id, 'Incoming flows do not join');\n    }\n  }\n\n  return {\n    check\n  };\n\n};","//      \n// An event handler can take an optional event argument\n// and should not return a value\n                                          \n                                                               \n\n// An array of all currently registered event handlers for a type\n                                            \n                                                            \n// A map of event types and their corresponding event handlers.\n                        \n                                 \n                                   \n  \n\n/** Mitt: Tiny (~200b) functional event emitter / pubsub.\n *  @name mitt\n *  @returns {Mitt}\n */\nfunction mitt(all                 ) {\n\tall = all || Object.create(null);\n\n\treturn {\n\t\t/**\n\t\t * Register an event handler for the given type.\n\t\t *\n\t\t * @param  {String} type\tType of event to listen for, or `\"*\"` for all events\n\t\t * @param  {Function} handler Function to call in response to given event\n\t\t * @memberOf mitt\n\t\t */\n\t\ton: function on(type        , handler              ) {\n\t\t\t(all[type] || (all[type] = [])).push(handler);\n\t\t},\n\n\t\t/**\n\t\t * Remove an event handler for the given type.\n\t\t *\n\t\t * @param  {String} type\tType of event to unregister `handler` from, or `\"*\"`\n\t\t * @param  {Function} handler Handler function to remove\n\t\t * @memberOf mitt\n\t\t */\n\t\toff: function off(type        , handler              ) {\n\t\t\tif (all[type]) {\n\t\t\t\tall[type].splice(all[type].indexOf(handler) >>> 0, 1);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Invoke all handlers for the given type.\n\t\t * If present, `\"*\"` handlers are invoked after type-matched handlers.\n\t\t *\n\t\t * @param {String} type  The event type to invoke\n\t\t * @param {Any} [evt]  Any value (object is recommended and powerful), passed to each handler\n\t\t * @memberOf mitt\n\t\t */\n\t\temit: function emit(type        , evt     ) {\n\t\t\t(all[type] || []).slice().map(function (handler) { handler(evt); });\n\t\t\t(all['*'] || []).slice().map(function (handler) { handler(type, evt); });\n\t\t}\n\t};\n}\n\nexport default mitt;\n//# sourceMappingURL=mitt.es.js.map\n","import {\n  domify,\n  classes as domClasses,\n  matches as domMatches,\n  delegate as domDelegate,\n  query as domQuery,\n  queryAll as domQueryAll,\n  event as domEvent,\n  attr as domAttr\n} from 'min-dom';\n\nimport {\n  filter,\n  assign\n} from 'min-dash';\n\nimport createEmitter from 'mitt';\n\nvar DEFAULT_OPTIONS = {\n  scrollSymbolLeft: '‹',\n  scrollSymbolRight: '›'\n};\n\n\n/**\n * This component adds the functionality to scroll over a list of tabs.\n *\n * It adds scroll buttons on the left and right side of the tabs container\n * if not all tabs are visible. It also adds a mouse wheel listener on the\n * container.\n *\n * If either a button is clicked or the mouse wheel is used over the tabs,\n * a 'scroll' event is being fired. This event contains the node elements\n * of the new and old active tab, and the direction in which the tab has\n * changed relative to the old active tab.\n *\n * @example:\n * (1) provide a tabs-container:\n *\n * var $el = (\n *   <div>\n *     <!-- button added by scrollTabs -->\n *     <span class=\"scroll-tabs-button scroll-tabs-left\"></span>\n *     <ul class=\"my-tabs-container\">\n *       <li class=\"my-tab i-am-active\"></li>\n *       <li class=\"my-tab\"></li>\n *       <li class=\"my-tab ignore-me\"></li>\n *     </ul>\n *     <!-- button added by scrollTabs -->\n *     <span class=\"scroll-tabs-button scroll-tabs-right\"></span>\n *   </div>\n * );\n *\n *\n * (2) initialize scrollTabs:\n *\n *  var scroller = scrollTabs(tabBarNode, {\n *    selectors: {\n *      tabsContainer: '.my-tabs-container',\n *      tab: '.my-tab',\n *      ignore: '.ignore-me',\n *      active: '.i-am-active'\n *    }\n *  });\n *\n *\n * (3) listen to the scroll event:\n *\n * scroller.on('scroll', function(newActiveNode, oldActiveNode, direction) {\n *   // direction is any of (-1: left, 1: right)\n *   // activate the new active tab\n * });\n *\n *\n * (4) update the scroller if tabs change and or the tab container resizes:\n *\n * scroller.update();\n *\n *\n * @param  {DOMElement} el\n * @param  {Object} options\n * @param  {Object} options.selectors\n * @param  {String} options.selectors.tabsContainer the container all tabs are contained in\n * @param  {String} options.selectors.tab a single tab inside the tab container\n * @param  {String} options.selectors.ignore tabs that should be ignored during scroll left/right\n * @param  {String} options.selectors.active selector for the current active tab\n * @param  {String} [options.scrollSymbolLeft]\n * @param  {String} [options.scrollSymbolRight]\n */\nfunction ScrollTabs($el, options) {\n\n  // we are an event emitter\n  assign(this, createEmitter());\n\n  this.options = options = assign({}, DEFAULT_OPTIONS, options);\n  this.container = $el;\n\n  this._createScrollButtons($el, options);\n\n  this._bindEvents($el);\n}\n\n\n/**\n * Create a clickable scroll button\n *\n * @param {Object} options\n * @param {String} options.className\n * @param {String} options.label\n * @param {Number} options.direction\n *\n * @return {DOMElement} The created scroll button node\n */\nScrollTabs.prototype._createButton = function(parentNode, options) {\n\n  var className = options.className,\n      direction = options.direction;\n\n\n  var button = domQuery('.' + className, parentNode);\n\n  if (!button) {\n    button = domify('<span class=\"scroll-tabs-button ' + className + '\">' +\n                                options.label +\n                              '</span>');\n\n    parentNode.insertBefore(button, parentNode.childNodes[0]);\n  }\n\n  domAttr(button, 'data-direction', direction);\n\n  return button;\n};\n\n/**\n * Create both scroll buttons\n *\n * @param  {DOMElement} parentNode\n * @param  {Object} options\n * @param  {String} options.scrollSymbolLeft\n * @param  {String} options.scrollSymbolRight\n */\nScrollTabs.prototype._createScrollButtons = function(parentNode, options) {\n\n  // Create a button that scrolls to the tab left to the currently active tab\n  this._createButton(parentNode, {\n    className: 'scroll-tabs-left',\n    label: options.scrollSymbolLeft,\n    direction: -1\n  });\n\n  // Create a button that scrolls to the tab right to the currently active tab\n  this._createButton(parentNode, {\n    className: 'scroll-tabs-right',\n    label: options.scrollSymbolRight,\n    direction: 1\n  });\n};\n\n/**\n * Get the current active tab\n *\n * @return {DOMElement}\n */\nScrollTabs.prototype.getActiveTabNode = function() {\n  return domQuery(this.options.selectors.active, this.container);\n};\n\n\n/**\n * Get the container all tabs are contained in\n *\n * @return {DOMElement}\n */\nScrollTabs.prototype.getTabsContainerNode = function() {\n  return domQuery(this.options.selectors.tabsContainer, this.container);\n};\n\n\n/**\n * Get all tabs (visible and invisible ones)\n *\n * @return {Array<DOMElement>}\n */\nScrollTabs.prototype.getAllTabNodes = function() {\n  return domQueryAll(this.options.selectors.tab, this.container);\n};\n\n\n/**\n * Gets all tabs that don't have the ignore class set\n *\n * @return {Array<DOMElement>}\n */\nScrollTabs.prototype.getVisibleTabs = function() {\n  var allTabs = this.getAllTabNodes();\n\n  var ignore = this.options.selectors.ignore;\n\n  return filter(allTabs, function(tabNode) {\n    return !domMatches(tabNode, ignore);\n  });\n};\n\n\n/**\n * Get a tab relative to a reference tab.\n *\n * @param  {DOMElement} referenceTabNode\n * @param  {Number} n gets the nth tab next or previous to the reference tab\n *\n * @return {DOMElement}\n *\n * @example:\n * Visible tabs: [ A | B | C | D | E ]\n * Assume tab 'C' is the reference tab:\n * If direction === -1, it returns tab 'B',\n * if direction ===  2, it returns tab 'E'\n */\nScrollTabs.prototype.getAdjacentTab = function(referenceTabNode, n) {\n  var visibleTabs = this.getVisibleTabs();\n\n  var index = visibleTabs.indexOf(referenceTabNode);\n\n  return visibleTabs[index + n];\n};\n\nScrollTabs.prototype._bindEvents = function(node) {\n  this._bindWheelEvent(node);\n  this._bindTabClickEvents(node);\n  this._bindScrollButtonEvents(node);\n};\n\n/**\n *  Bind a click listener to a DOM node.\n *  Make sure a tab link is entirely visible after onClick.\n *\n * @param {DOMElement} node\n */\nScrollTabs.prototype._bindTabClickEvents = function(node) {\n  var selector = this.options.selectors.tab;\n\n  var self = this;\n\n  domDelegate.bind(node, selector, 'click', function onClick(event) {\n    self.scrollToTabNode(event.delegateTarget);\n  });\n};\n\n\n/**\n * Bind the wheel event listener to a DOM node\n *\n * @param {DOMElement} node\n */\nScrollTabs.prototype._bindWheelEvent = function(node) {\n  var self = this;\n\n  domEvent.bind(node, 'wheel', function(e) {\n\n    // scroll direction (-1: left, 1: right)\n    var direction = Math.sign(e.deltaY);\n\n    var oldActiveTab = self.getActiveTabNode();\n\n    var newActiveTab = self.getAdjacentTab(oldActiveTab, direction);\n\n    if (newActiveTab) {\n      self.scrollToTabNode(newActiveTab);\n      self.emit('scroll', newActiveTab, oldActiveTab, direction);\n    }\n\n    e.preventDefault();\n  });\n};\n\n/**\n * Bind scroll button events to a DOM node\n *\n * @param  {DOMElement} node\n */\nScrollTabs.prototype._bindScrollButtonEvents = function(node) {\n\n  var self = this;\n\n  domDelegate.bind(node, '.scroll-tabs-button', 'click', function(event) {\n\n    var target = event.delegateTarget;\n\n    // data-direction is either -1 or 1\n    var direction = parseInt(domAttr(target, 'data-direction'), 10);\n\n    var oldActiveTabNode = self.getActiveTabNode();\n\n    var newActiveTabNode = self.getAdjacentTab(oldActiveTabNode, direction);\n\n    if (newActiveTabNode) {\n      self.scrollToTabNode(newActiveTabNode);\n      self.emit('scroll', newActiveTabNode, oldActiveTabNode, direction);\n    }\n\n    event.preventDefault();\n  });\n};\n\n\n/**\n* Scroll to a tab if it is not entirely visible\n*\n* @param  {DOMElement} tabNode tab node to scroll to\n*/\nScrollTabs.prototype.scrollToTabNode = function(tabNode) {\n  if (!tabNode) {\n    return;\n  }\n\n  var tabsContainerNode = tabNode.parentNode;\n\n  var tabWidth = tabNode.offsetWidth,\n      tabOffsetLeft = tabNode.offsetLeft,\n      tabOffsetRight = tabOffsetLeft + tabWidth,\n      containerWidth = tabsContainerNode.offsetWidth,\n      containerScrollLeft = tabsContainerNode.scrollLeft;\n\n  if (containerScrollLeft > tabOffsetLeft) {\n    // scroll to the left, if the tab is overflowing on the left side\n    tabsContainerNode.scrollLeft = 0;\n  } else if (tabOffsetRight > containerWidth) {\n    // scroll to the right, if the tab is overflowing on the right side\n    tabsContainerNode.scrollLeft = tabOffsetRight - containerWidth;\n  }\n};\n\n\n/**\n * React on tab changes from outside (resize/show/hide/add/remove),\n * update scroll button visibility.\n */\nScrollTabs.prototype.update = function() {\n\n  var tabsContainerNode = this.getTabsContainerNode();\n\n  // check if tabs fit in container\n  var overflow = tabsContainerNode.scrollWidth > tabsContainerNode.offsetWidth;\n\n  // TODO(nikku): distinguish overflow left / overflow right?\n  var overflowClass = 'scroll-tabs-overflow';\n\n  domClasses(this.container).toggle(overflowClass, overflow);\n\n  if (overflow) {\n    // make sure the current active tab is always visible\n    this.scrollToTabNode(this.getActiveTabNode());\n  }\n};\n\n\n// exports ////////////////\n\n/**\n * Create a scrollTabs instance on the given element.\n *\n * @param {DOMElement} $el\n * @param {Object} options\n *\n * @return {ScrollTabs}\n */\nexport default function create($el, options) {\n\n  var scrollTabs = get($el);\n\n  if (!scrollTabs) {\n    scrollTabs = new ScrollTabs($el, options);\n\n    $el.__scrollTabs = scrollTabs;\n  }\n\n  return scrollTabs;\n}\n\n\n/**\n * Return the scrollTabs instance that has been previously\n * initialized on the element.\n *\n * @param {DOMElement} $el\n * @return {ScrollTabs}\n */\nfunction get($el) {\n  return $el.__scrollTabs;\n}\n\ncreate.get = get;","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n"],"sourceRoot":""}